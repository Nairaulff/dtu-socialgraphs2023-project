Introduction Precisely estimating an unknown parameter is important both in science and engineering. Depending on the parameter that one wants to estimate, one can use different approaches. In some cases, they may be able to measure the quantity directly, however, sometimes quantities are not directly accessible either in principle or due to experimental impediments, and they need to be estimated indirectly. Different estimation approaches have different precisions in estimating the unknown quantity. Generally speaking, these approaches use the resources of atoms and/or photons to estimate the desired quantity, and by increasing the resources, they can reveal the unknown quantity with better precision. Nevertheless, increasing the resources as much as one wants is not possible in some cases (for example biological samples 1 ), so it is essential to design an apparatus that gives the best possible estimation of the quantity by using a specified number of resources. The optical phase is the most significant parameter in the context of quantum metrology, especially in the optical interferometry 2 , 3 , 4 . Optical interferometers use photons as resources and are one of the most precise tools for measuring quantities such as length, index of refraction, velocity, etc 1 , 5 , by mapping them into a phase shift. By using classical states of light, the best precision that one can estimate the phase shift scales like \(1/\sqrt{N}\) 6 , in which N is the number of photons used. This limit is called the standard quantum limit (SQL). However, this is not the ultimate precision limit; we can enhance the precision by a factor of \(1/\sqrt{N}\) and reach the Heisenberg limit (1/ N ) by employing quantum mechanical strategies like using entangled photonic states. In a typical phase estimation setup, the input state together with the strategy that we use to extract the information and estimate the phase shift, determine the precision of the estimation 7 , 8 , 9 , 10 , 11 , 12 , 13 , 14 , 15 , 16 , 17 , 18 . Choosing the best input state depends on the decoherence existing in the interferometer 6 , 19 and also on the number of resources (for example number of photons) that we can use. Apart from the above factors, our prior knowledge (before making any measurement) about the unknown quantity can also affect the optimal estimation strategy 20 . Consider a two-mode interferometer like Mach–Zehnder for instance. If prior to measurement we know that the unknown phase is around a specific value with slight deviation and the number of photons we can use is N , and there is no photon loss and decoherence in the interferometer, NOON states give the best possible precision and achieve the Heisenberg limit 21 , 22 . However, when there is photon loss in the arms of the interferometer, NOON states become extremely fragile 21 , 23 , 24 , 25 , 26 , 27 and there exist other states which outperform NOON states in different photon loss conditions. A class of path-entangled photon Fock states, called \(mm^{\prime }\) states, were proposed in 28 to outperform NOON states in the presence of photon loss. Huver et al. have introduced a theoretically optimal detection operator and computed the precision of their phase estimation scheme by calculating the expectation value of the detection operator and using the error propagation formula. However, experimental realization of their optimal measurement scheme has not been reported yet. Performance of NOON and \(mm^{\prime }\) states in the presence of photon loss by using experimentally realizable measurements, has also been investigated in 29 , 30 , in which Jiang et al. has chosen single parity measurement as their measurement scheme, and Zhong et al. has explored a double-port measurement strategy with three types of feasible measurements: parity, photon-number-resolving, and homodyne measurements. Another class of definite photon number states that act better than the NOON states in the presence of loss are Holland–Burnett ( HB ) states 31 . Unlike NOON states, HB states can be prepared easily by using a beam splitter and photon pairs from spontaneous parametric down-conversion (SPDC) 32 . HB states are almost optimally robust not only to photon loss but also to inefficiencies in state preparation and photon detection and can beat SQL in realistic phase estimation scenarios 32 , 33 , 34 , 35 , 36 , 37 . In this work, we focus on four different definite photon number input states of light, which all possess six photons and belong to three different classes of non-classical states: NOON states, \(mm^{\prime }\) states, and HB states. We will compare their phase estimation precision in different photon loss conditions in a Mach–Zehnder interferometer by mapping the corresponding quantum optical setups into quantum circuits and simulating them to obtain the information needed. This is a new approach towards investigating phase estimation precision of definite photon number input states in the presence of loss. We will choose a 50–50 beam splitter with two photon number-resolving detectors (PNRD) as our measurement scheme and use Bayesian estimation to estimate the unknown phase shift. Likelihood functions that we need in the Bayesian estimation for different input states will also be approximated by simulating appropriate quantum circuits rather than calculating them theoretically, which can be arduous in the presence of photon loss. Using quantum circuits to investigate phase estimation precision of definite photon number states has two major advantages. The first advantage is that, with this method, it is possible to investigate any definite photon number state, and the general process to build the circuits for these kinds of photonic states is explained in this paper. The second advantage of this method is its ability to consider arbitrary photon loss rates in the arms of the Mach–Zehnder interferometer; this allows us to avoid being limited to specific photon loss conditions, such as cases where the photon loss rate is equal in both arms. In detail, we proceed as follows: “ Describing our model and designing corresponding quantum circuits ” section explains our model and shows how to map the corresponding quantum optical setups into quantum circuits. In section “ Results ” our results are presented and analyzed. Finally, a summary and conclusion are given in “ Summary and conclusion ” section. Describing our model and designing corresponding quantum circuits The phase estimation setup considered here is similar to the ordinary Mach–Zehnder interferometer in which the first beam splitter is replaced by a black box that can generate any desired input photonic state. To model the photon loss, two extra fictitious beam splitters are used in both arms of the interferometer 28 , 29 , 38 , 39 , 40 . Different rates of photon loss can simply be created in the interferometer by adjusting the transmission coefficients of the beam splitters. Figure 1 shows the corresponding optical interferometry setup in which the detectors ( \(D_0\) and \(D_1\) ) are photon-number-resolving detectors (PNRD). Figure 1 The optical interferometry setup. Black box prepares the desired input state. \(\phi\) indicates the phase shift between two arms and photon loss is modeled by adding a fictitious beam splitter (red box) in each arm. The blue box represents a 50–50 beam splitter and \(D_0\) and \(D_1\) are photon-number-resolving detectors. Full size image According to 22 , any quantum interferometry setup can be thought of as a quantum circuit. In this work, to simulate the optical interferometry setup in Fig. 1 , an appropriate quantum circuit is designed. At first, we map the input photonic state into a corresponding state in qubits. There are two modes for input photons: The lower and the upper paths are the first and the second modes, respectively. So an arbitrary pure input state with a definite photon number ( N ) would be like $$\begin{aligned} |\psi _{input}\rangle = \sum _{m=0}^{N} c_m |m\rangle _l |N-m\rangle _u, \end{aligned}$$ (1) where \(\sum _{m=0}^{N} |c_m|^2 = 1\) . Equation ( 1 ) is in mode representation and \(|m\rangle _l |N-m\rangle _u\) means that m out of N photons are in the lower arm and the remaining \(N-m\) photons are in the upper arm. The input state is a superposition of states like \(|m\rangle _l |N-m\rangle _u\) , so if we can map these states into qubits of our circuit appropriately, we can represent the input state by the superposition of these corresponding qubit states. By writing \(|m\rangle _l |N-m\rangle _u\) in the particle representation (and applying bosonic symmetry) we arrive at 41 : $$\begin{aligned} |m\rangle _l |N-m\rangle _u \xrightarrow {\text {map to particle representation}} \frac{1}{\sqrt{\left( {\begin{array}{c}N\\ m\end{array}}\right) }} \sum _{\prod } \prod (|l\rangle _1|l\rangle _2 ... |l\rangle _m |u\rangle _{m+1}|u\rangle _{m+2} ... |u\rangle _N). \end{aligned}$$ (2) Here, \(|l\rangle _j (|u\rangle _j)\) means that the jth photon is in the lower (upper) arm and \(\prod\) is an arbitrary permutation of ‘ l ’s and ‘ u ’s, and summation is over nontrivial permutations. Equation ( 2 ) clarifies how to show the input state in qubits. We choose N qubits and label them from 1 to N by assuming that each qubit corresponds to a photon in Eq. ( 2 ). Then we create the bosonic symmetric state of these qubits. In each term of the total superposition state (Eq. ( 2 )), if the photon is in the lower arm, we put the analogous qubit in \(|0\rangle\) , and if the photon is in the upper arm, we put the qubit in \(|1\rangle\) . The interferometer’s two arms are distinguishable, which means that considering the two orthogonal states (computational bases) in this mapping is legitimate. By this map, we can only devote two distinguishable modes for photons at each stage of the circuit, which can only show the case where there is no loss. When we introduce photon loss in both arms, we need to have two other distinguishable modes to each photon so that they can be in four distinguishable modes: lower arm, upper arm, lost from the lower arm, and lost from the upper arm. Therefore, we change the mapping, and two qubits for each photon are allocated. Our map in the presence of the photon loss is as follows: $$\begin{aligned} {\left\{ \begin{array}{ll} \text {photon in the lower arm} &\rightarrow |0\rangle |0\rangle \\ \text {photon in the upper arm} & \rightarrow |1\rangle |1\rangle \\ \text {photon lost from the lower arm} & \rightarrow |0\rangle |1\rangle \\ \text {photon lost from the upper arm} & \rightarrow |1\rangle |0\rangle \\ \end{array}\right. } \end{aligned}$$ As a result, if the input photonic state has N photons, we allocate 2 N qubits to them in our quantum circuit. Figure 2 Our quantum circuit to simulate setup of Fig. 1 . 2 N qubits are chosen to represent an input state corresponding to N photons. \(U_{input}\) (black box) implements the unitary evolution to prepare the desired input state. Orange, red and blue boxes implement unitary transformations of phase shift, photon loss and the final 50–50 beam splitter respectively. Finally qubits are measured in computational bases. Full size image Figure 2 shows the design of our quantum circuit. We assume that all qubits are initially at \(|0\rangle\) state. \(U_{input}\) is a unitary evolution that transforms \(|0\rangle _1 |0\rangle _2 ... |0\rangle _{2N}\) to our desired input state. Considering that our input state is like Eq. ( 1 ) in photon representation, the analogous state of the qubits would be $$\begin{aligned} \sum _{m=0}^{N} \frac{c_m}{\sqrt{\left( {\begin{array}{c}N\\ m\end{array}}\right) }} \sum _{\prod ^{\prime }} \mathop {{\mathop {\prod }\nolimits '}}\limits (\overset{photon \{1\}}{\overbrace{|0\rangle _1|0\rangle _2}} \; \overset{photon \{2\}}{\overbrace{|0\rangle _3|0\rangle _4}} ... \overset{photon \{m\}}{\overbrace{|0\rangle _{2m-1}|0\rangle _{2m}}} \overset{photon \{m+1\}}{\overbrace{|1\rangle _{2m+1}|1\rangle _{2m+2}}} ... \overset{photon \{N\}}{\overbrace{|1\rangle _{2N-1}|1\rangle _{2N}}}), \end{aligned}$$ (3) where \(\prod ^{\prime }\) arbitrarily permutes the corresponding qubit pairs’ states of different photons and as in Eq. ( 2 ), \(\sum _{\prod ^{\prime }}\) means summation over nontrivial permutations. As mentioned earlier, \(U_{input}\) transforms initial state \(|0\rangle _1...|0\rangle _{2N}\) to the state of Eq. ( 3 ). To implement the \(U_{input}\) , we have to decompose it into products of gates that are available (we call them basis gates here) to us. “ Basis gates ” section in appendix illustrates the list of the gates that we have used in our quantum circuits, and “Implementation of \(U_{input}\) by basis gates” section demonstrates how to do this decomposition. After preparing the input state, the phase shift, fictitious beam splitters, and the final beam splitter of the interferometer are implemented in order. As it is clear from Fig. 2 , each of the above three parts (phase shift, fictitious beam splitters, and the final beam splitter) consist of N similar subroutines. Each particular subroutine acts only on the two qubits corresponding to a specific photon. Subroutines of the three parts transform the state of a qubit pair corresponding to a photon as below 42 $$\begin{aligned} \begin{aligned} \phi&{\left\{ \begin{array}{ll} &|0\rangle |0\rangle \rightarrow |0\rangle |0\rangle \\ &|1\rangle |1\rangle \rightarrow \exp (i\phi )|1\rangle |1\rangle \end{array}\right. } \\ FBS&{\left\{ \begin{array}{ll} &|0\rangle |0\rangle \rightarrow \sqrt{t_0}|0\rangle |0\rangle + i\sqrt{1 - t_0}|0\rangle |1\rangle \\ &|1\rangle |1\rangle \rightarrow \sqrt{t_1}|1\rangle |1\rangle + i\sqrt{1 - t_1}|1\rangle |0\rangle \end{array}\right. } \\ BS&{\left\{ \begin{array}{ll} &|0\rangle |0\rangle \rightarrow \frac{1}{\sqrt{2}}|0\rangle |0\rangle + \frac{i}{\sqrt{2}}|1\rangle |1\rangle \\ &|1\rangle |1\rangle \rightarrow \frac{i}{\sqrt{2}}|0\rangle |0\rangle + \frac{1}{\sqrt{2}}|1\rangle |1\rangle \end{array}\right. } \end{aligned} \end{aligned}$$ (4) In Eq. ( 4 ), \(\phi\) is the phase shift in the interferometer, and \(t_0\) and \(t_1\) are the transmissivity of the lower and upper fictitious beam splitters, respectively. \(L_0 = 1-t_0\) and \(L_1 = 1-t_1\) determine the photon loss rate in the lower and upper arms respectively. We interpret the state after the final beam splitter in a way that \(|0\rangle |0\rangle\) and \(|1\rangle |1\rangle\) mean photon is in the path going to \(D_0\) and \(D_1\) respectively. In the appendix, the sequence of the basis gates to implement these transformations is shown. At the end of the circuit, we measure the qubits in the computational basis and end up with a string of ‘0’s and ‘1’s. Finally, we convert this string to a result that shows us the number of photons detected by \(D_0\) and \(D_1\) . Now our quantum circuit simulates the analogous quantum optical interferometer, and we can compare different input states’ precision in estimating phase shift in different photon loss rates. First, we implement the appropriate \(U_{input}\) to create our desired input state, then we put \(\phi = \phi ^*\) (which is the value of the quantity that the optical interferometer is going to estimate). Then we adjust \(t_0\) and \(t_1\) to create the photon loss rates that we want. Finally, we simulate the circuit for \(N_r\) times, which means that the input state is sent through the interferometer for \(N_r\) times to find a probability distribution \(P(\phi )\) for phase. The variance of this probability distribution shows the error in estimating the phase shift; the lower the variance, the better the precision. To estimate the properties of an object in a real experiment, it is placed in one of the arms of the interferometer and then the phase shift (induced by the object) is estimated by sending the input states (photons) through the interferometer for a specified number of times. The phase shift’s actual value ( \(\phi ^*\) ) is unknown to the experimenter, but the number of photons that get detected at different detectors each time is known, and the phase shift can be estimated by this information. In this work, it is assumed that before sending the input states through the interferometer, the experimenter initially knows that the unknown phase shift is limited to a finite range, $$\begin{aligned} P_{pri}(\phi ) = {\left\{ \begin{array}{ll} \frac{1}{\phi _f - \phi _i} \quad &\phi _i \le \phi \le \phi _f \\ 0 \quad & otherwise \end{array}\right. }. \end{aligned}$$ (5) We show the measurement result of each run of the experiment by \(D(n_0,n_1)\) , which means that \(n_0\) and \(n_1\) photons are detected at \(D_0\) and \(D_1\) respectively; note that \(n_0 + n_1 \le N\) . If we know the conditional likelihood functions \(P_{n_0,n_1}(\phi ) \equiv \frac{P(D(n_0,n_1)|\phi )}{\int _{0}^{2\pi } d\phi ^{\prime } \; P(D(n_0,n_1)|\phi ^{\prime })}\) for different possible values of \(n_0\) and \(n_1\) , the probability distribution could be estimated by the following algorithm 43 , 44 1. \(P(\phi ) \leftarrow P_{pri}(\phi )\) 2. run the experiment 3. \(P(\phi ) \leftarrow P(\phi ) * P_{n_0,n_1}(\phi )\) 4. \(P(\phi ) \leftarrow \frac{P(\phi )}{\int d\phi \; P(\phi )}\) 5. repeat steps 2 to 4 for \(N_r-1\) times The output \(P(\phi )\) of this algorithm is the probability distribution of the unknown phase shift ( \(\phi ^*\) ) after sending the input photonic state for \(N_r\) times, and is a function of the \(N_r\) measurement results ( \(\textbf{D}\) ). We refer to it by \(P_{final}(\phi |\textbf{D})\) . We can estimate the \(\phi ^*\) by the following formula: $$\begin{aligned} \hat{\phi }_{est}(\textbf{D}) = \int _{\phi _i}^{\phi _f}d\phi \; P_{final}(\phi |\textbf{D})\, \phi . \end{aligned}$$ (6) The standard deviation is given by $$\begin{aligned} \Delta \hat{\phi }_{est}(\textbf{D}) = \sqrt{\int _{\phi _i}^{\phi _f}d\phi \; P_{final}(\phi |\textbf{D})\, (\phi - \hat{\phi }_{est}(\textbf{D}))^2}. \end{aligned}$$ (7) \(\Delta \hat{\phi }_{est}\) is a function of the specific measurement results, \(\textbf{D}\) , that has been obtained by doing the experiment for \(N_r\) times 45 . Repeating the same experiment may yield different measurement results \(\mathbf {D^{\prime }}\) , which could result in a slightly different \(\Delta \hat{\phi }_{est}\) . Therefore, in order to remove the dependency on specific \(\textbf{D}\) , we will calculate the average standard deviation $$\begin{aligned} (\Delta \hat{\phi }_{est})_{avg} = \sum _{\textbf{D}} P(\textbf{D}|\phi ^*)\Delta \hat{\phi }_{est}(\textbf{D}). \end{aligned}$$ (8) Now we focus on how to find \(P(D(n_0,n_1)|\phi )\) for each input state in specified condition of photon loss. We can find it by calculating it analytically or using the quantum circuit that we have designed to approximate it. Calculating \(P(D(n_0,n_1)|\phi )\) analytically can sometimes be difficult, especially when there is photon loss, but our method avoids this difficulty and approximate the probability distribution up to the precision that we want. To do that, we prepare the input state, fix the values of \(t_0\) and \(t_1\) , which creates the desired photon loss condition, and choose n equally spaced points from \(\phi _i\) to \(\phi _f\) . Now by running the circuit for W times ( \(W \gg 1\) ) at each of these n points, we can approximate \(P(D(n_0,n_1)|\phi )\) by the following formula: $$\begin{aligned} P(D(n_0,n_1)|\phi ) \approx \frac{R(n_0,n_1)}{W}, \end{aligned}$$ (9) where \(R(n_0,n_1)\) is the number of times that \(n_0\) and \(n_1\) photons are detected at lower and upper detectors respectively. By increasing the number of points ( n ) and the number of times that we simulate the circuit at each point ( W ), we can approach the exact \(P(D(n_0,n_1)|\phi )\) . As mentioned in the introduction, we consider definite photon number input states of three different classes, which all possess the same number of photons. The states of NOON and \(mm^{\prime }\) classes for N photons are written as 29 : $$\begin{aligned} |N::0\rangle = \frac{1}{\sqrt{2}} (|N\rangle _l |0\rangle _u + |0\rangle _l |N\rangle _u), \end{aligned}$$ (10) $$\begin{aligned} |m::m^{\prime }\rangle = \frac{1}{\sqrt{2}} (|m\rangle _l |m^\prime \rangle _u + |m^\prime \rangle _l |m\rangle _u). \end{aligned}$$ (11) Here m and \(m^{\prime }\) are positive integers and without loss of generality we assume that \(m > m^{\prime }\) . \(m+m^{\prime }=N\) is the total number of photons that \(|m::m^{\prime }\rangle\) state possesses. The last input state that is investigated here is called the Holland–Burnett (HB) state, which has an even number of N photons and is given by the following formula 31 , 32 (before experiencing the phase shift): $$\begin{aligned} |HB(N)\rangle = \sum _{n=0}^{N/2} c_n |2n\rangle _l|N-2n\rangle _u, \, c_n = \frac{\sqrt{(2n)!(N-2n)!}}{2^{N/2}n!(\frac{N}{2}-n)!} \end{aligned}$$ (12) In our simulations we take \(N = 6\) and the four input states considered are: \(|6::0\rangle\) , \(|5::1\rangle\) , \(|4::2\rangle\) and \(|HB(6)\rangle\) . Results In this work, two different cases for photon loss are considered. “ Symmetric photon dissipation ” section shows the results for the case of symmetric photon loss where the probability of photon loss in the lower and upper arms of the interferometer are equal \((L_0 = L_1 = L, \, t_0=t_1=t)\) , and “ Asymmetric photon loss ” section shows the results for the asymmetric photon loss case where there is no photon loss in the lower arm of the interferometer \((L_0 = 0)\) . In our simulation of estimating the unknown phase shift, it is assumed that \(\phi \in [\phi _i,\phi _f]\) , where \(\phi _f - \phi _i = \frac{\pi }{6}\) ; this is done to avoid the ambiguity in estimating phase, therefore our phase estimation is a local phase estimation, in which one knows that the phase is in a small range beforehand. In practice, this initial information can be gained by any means (like classical interferometry) before doing the quantum interferometry. The actual value of the unknown phase is \(\phi ^* = \frac{\phi _i + \phi _f}{2}\) , and it is chosen in a way that minimizes \(\delta \phi\) for each input state. For \(|6::0\rangle\) , \(|5::1\rangle\) and \(|4::2\rangle\) , \(\phi ^*\) is \(\pi /12\) , \(\pi /8\) and \(\pi /4\) , respectively 46 . For \(|HB(6)\rangle\) , approximate value of the \(\phi ^*\) is found by simulating the quantum circuits with \(|HB(6)\rangle\) as input state for different values of phase shift, and comparing their estimated average standard deviations. Symmetric photon dissipation Table 1 Unnormalized likelihood functions for different input states in symmetric photon loss when \(t_0=t_1=0.5\) . Full size table Figure 3 Plot of \((\Delta \phi )_{avg}\) (in radian) as a function of t for different input states for \(N_r = 400\) . Circle points are the values that are calculated by simulating the quantum circuits and the dashed lines are appropriate functions fitted to the data. Full size image Table 1 shows the unnormalized likelihood functions \((P_{n_0,n_1}(\phi ))\) of the input states for \(t=t_0=t_1=0.5\) . In this symmetric case, \(P_{n_0,n_1}(\phi )\) for other values of t is similar; note that when \(t=1\) , always the number of photons detected is 6, therefore \(P_{n_0,n_1}(\phi )=0\) for \(n_0 +n_1 <6\) . These probability distributions are calculated by simulating the corresponding quantum circuit at different phases in \([0,2\pi ]\) for a large number of times and fitting an appropriate periodic function on them. They are plotted in a way that their maximum value is 1 (except \(P_{3,3}(\phi )\) for \(|5::1\rangle\) which is zero because this combination of photons never gets detected). They are not normalized, but this is not an issue because we normalize the final probability distribution at each step when we are estimating the unknown phase. Table 1 is ordered in a way that the total number of detected photons \((n_0 + n_1)\) generally decreases as we go below the table. As we can see, whenever the number of detected photons is less than 6 (meaning that at least one photon is lost during the process), the probability distribution for \(|6::0\rangle\) is a constant function, which means that we get no information about the phase shift in this case. Therefore, by increasing the photon loss probability, the precision of phase estimation with the NOON states will decrease more rapidly than the other states. Compering \(|5::1\rangle\) with \(|4::2\rangle\) and \(|HB(6)\rangle\) , we can see that patterns of \(|5::1\rangle\) gives us no information about the phase shift when the number of detected photons is less than 4, while patterns of \(|4::2\rangle\) and \(|HB(6)\rangle\) stop giving information only when the number of detected photons is less than 2. This means that at high loss rates, we expect \(|4::2\rangle\) and \(|HB(6)\rangle\) states to estimate phase better than \(|5::1\rangle\) . Figure 3 shows the average standard deviations of the input states in estimating the phase shift, for \(N_r = 400\) in the symmetric photon loss case. Obviously, for \(t>0.81\) , \(|6::0\rangle\) is the best input state and gives the least error in estimating the phase shift. However, when \(0.32< t < 0.81\) , \(|HB(6)\rangle\) has the highest precision and when \(t<0.32\) , \(|4::2\rangle\) becomes the best state to estimate the phase shift. When \(t=0\) , the photon loss rate is one, and this means that no photons get detected, and we gain no information about the phase shift, regardless of the input state. So, in this case, the information about the phase shift is the initial probability distribution for the phase shift, and at this point, \((\Delta \phi )_{avg}\) of all input states approach to a fixed value. Asymmetric photon loss Figure 4 Plot of \((\Delta \phi )_{avg}\) (in radian) as a function of \(t_1\) for different input states for \(N_r = 400\) . Circle points are the values that are calculated by simulating the quantum circuits and the dashed lines are appropriate functions fitted to the data. Full size image In asymmetric photon loss, our simulation results show that likelihood functions change by altering the value of \(t_1\) , and therefore we had to estimate them for different values of \(t_1\) in [0, 1]. Because of this, we have not shown them here. Figure 4 Shows the average standard deviation of the input states in estimating the phase shift for \(N_r = 400\) in the asymmetric photon loss case. In this case when \(t_1 > 0.79\) , \(|6::0\rangle\) gives the best precision while for other values of \(t_1\) , \(|HB(6)\rangle\) has the best precision. Unlike the symmetric loss case, in asymmetric case, \(|4::2\rangle\) never becomes the state with the lowest \((\Delta \phi )_{avg}\) in any loss rate. Figure 5 Comparing Fisher information of our measurement scheme ( \(F_{\rho _{\phi }, \hat{M}_c}\) ) with QFI ( \(F_Q(\rho _{\phi })\) ) for \(|6::0\rangle\) in symmetric (left plot) and asymmetric (middle plot) loss, and for \(|HB(6)\rangle\) in asymmetric loss (right plot). It can be seen that for the NOON state ( \(|6::0\rangle\) ) our measurement scheme ( \(\hat{M}_c\) ) is optimal. However, for \(|HB(6)\rangle\) , \(F_{\rho _{\phi }, \hat{M}_c}\) at most points is a little lower than the QFI, which means that \(\hat{M}_c\) is not the optimal measurement scheme at these points, but it is very close to the optimum value. Full size image Estimating Fisher information Figure 6 Comparing \(\Delta \phi _{min}\) (in radian) of the three measurement schemes ( \(\hat{M}_c\) , \(\hat{M}_A\) and \(\hat{M}_p\) ) for \(|5::1\rangle\) and \(|4::2\rangle\) in symmetric (the two upper figures) and asymmetric (the two lower figures) losses. By increasing photon loss rate, \(\Delta \phi _{min}\) of parity detection surges drastically compared to the other two schemes, which means that parity detection is not a good measurement scheme for these \(mm^\prime\) states in the presence of loss. However, \(\Delta \phi _{min}\) for our measurement scheme ( \(\hat{M}_c\) ), is close to the optimal scheme ( \(\hat{M}_A\) ), which means that \(\hat{M}_c\) is a near-optimal measurement scheme for the two \(mm^\prime\) states in the presence of loss. Full size image Generally speaking, a phase estimation process can be divided into three steps: In the first step, one prepares a state ( \(\rho _{\phi }\) ), which contains information about the unknown phase that they want to estimate. In the second step, a measurement scheme ( \(\hat{M}\) ) is set up to extract the information of \(\rho _{\phi }\) , and in the last step, an appropriate estimator is chosen to estimate the unknown phase, based on the measurement results. The likelihood functions for the setup depends on \(\rho _{\phi }\) and \(\hat{M}\) , so the Fisher information of the phase estimation process depends on them can be calculated by the following formula 47 , 48 : $$\begin{aligned} F_{\rho _{\phi }, \hat{M}}(\phi ) = \sum _{\textbf{D}} \frac{[\partial P_{\rho _{\phi }, \hat{M}}(\textbf{D}|\phi )/{\partial \phi }]^2}{P_{\rho _{\phi }, \hat{M}}(\textbf{D}|\phi )}, \end{aligned}$$ (13) where the summation is over all possible outcomes of the measurement ( \(\textbf{D}\) ). In frequentist approach, the best possible precision that one can estimate (by using a locally unbiased estimator) the unknown phase is 5 , 45 $$\begin{aligned} \Delta \phi _{min} = \frac{1}{\sqrt{F_{\rho _{\phi }, \hat{M}}}} \end{aligned}$$ (14) and the estimator giving this precision is an efficient estimator. By changing the measurement scheme ( \(\hat{M}\) ), one can change the Fisher information of the setup, and as a result, the best possible precision in phase estimation. Maximizing the Fisher information over all generic quantum measurement schemes yields the Quantum Fisher Information (QFI) of \(\rho _{\phi }\) 5 : $$\begin{aligned} F_{Q}(\rho _{\phi }) = \max _{\hat{M}} F_{\rho _{\phi }, \hat{M}}(\phi ). \end{aligned}$$ (15) The measurement scheme that maximizes Fisher information is called the optimal measurement scheme for \(\rho _{\phi }\) . QFI depends only on \(\rho _{\phi }\) and can ba calculated by 5 : $$\begin{aligned} F_{Q}(\rho _{\phi }) = (\Delta L_\phi )^2 = Tr[\rho _{\phi } L_\phi ^2], \end{aligned}$$ (16) where \(L_\phi\) is the symmetric logarithmic derivative operator and \((\Delta L_\phi )^2\) is its variance over \(\rho _{\phi }\) . Regarding the interferometry setup that we are investigating (Fig. 1 ), \(\rho _{\phi }\) is the quantum state of light (after tracing out environment modes) before the final beam splitter, and the final beam splitter together with the PNRDs is the measurement scheme, which we show it by \(\hat{M}_c\) . We estimate the Fisher information for all the input states in both photon loss cases and discuss the measurement scheme’s optimism. Instead of using Eq. ( 13 ), Fisher information is estimated by using the Bayesian approach and simulating the quantum circuits a large number of times. Figure 7 Comparing \(\Delta \phi _{min}\) (in radian) of our scheme with standard interferometry limit. Circle points are the values that are estimated by simulating the quantum circuits and the dashed lines are appropriate fits. The region between Heisenberg and standard classical limit is colored with light-gray. Whenever a line (corresponding to any input state) is in this region, it means that the corresponding input state has better precision than any classical interferometry setup, using the same number of resources. According to these figures, \(|6::0\rangle , |5::1\rangle\) and \(|HB(6)\rangle\) can beat the classical limit in some loss rates in both symmetric (the left figure) and asymmetric (the right figure) cases; however, \(|4::2\rangle\) cannot beat the classical limit with our measurement scheme in any loss rates of symmetric and asymmetric losses. Full size image In the Bayesian estimation, when the number of measurements \(N_{r}\) increases, the final probability distribution \(P_{final}(\phi |\textbf{D})\) approaches a Gaussian distribution 45 : $$\begin{aligned} P_{final}(\phi |\textbf{D}) \approx \sqrt{\frac{N_r F(\phi ^*)}{2\pi }} e ^{-\frac{N_rF(\phi ^*)}{2} (\phi -\phi ^*)^2}, \, (N_r>> 1). \end{aligned}$$ (17) This probability distribution is centered around the actual value of the unknown phase shift \(\phi ^*\) , with the variance of \(\frac{1}{N_r F(\phi ^*)}\) in which \(F(\phi ^*)\) is the Fisher information of the setup. Using this result and simulating each quantum circuit a large number of times ( \(N_r>>1\) ), we have estimated the input states’ Fisher information in symmetric and asymmetric photon loss conditions for the photon-counting measurement scheme. QFI has been calculated for NOON states in both symmetric and asymmetric photon losses in 6 , 19 , 49 , and for HB states it has been calculated in the asymmetric photon loss in 33 . Figure 5 shows comparison of these QFIs with the Fisher information of our measurement scheme ( \(F_{\rho _{\phi }, \hat{M}_c}\) ). According to this figure, for \(|6::0\rangle\) states in both loss cases, the photon-counting measurement scheme is the optimal measurement because \(F_{\rho _{\phi }, \hat{M}_c}\) is equal to QFI. For \(|HB(6)\rangle\) state in asymmetric loss, Fisher information of our scheme is very close to QFI, and even at some points, it is equal to QFI; however, at most points, it is lower than the QFI which means that at these points our measurement scheme is not optimal. To the best of our knowledge, QFI has not been calculated for \(mm^\prime\) states inside a lossy interferometer. However, the precision of phase estimation for this case has been calculated by two other measurement schemes. Bardhan et al. 46 by measuring the parity operator $$\begin{aligned} \hat{P} = i^{(m+m^\prime )}\sum _{k=0}^{m} (-1)^k |k, n-k\rangle \langle n-k, k|, \end{aligned}$$ (18) and using the error propagation formula have calculated the precision of phase estimation for parity detection. We show this measurement scheme by \(\hat{M}_p\) here. Huver et al. in 28 have introduced another observable to extract phase information from \(mm^\prime\) states: $$\begin{aligned} \hat{A}=\sum _{r,s=0}^{m'}|m'-r,m-s\rangle \langle m-r,m'-s| + |m-r,m'-s\rangle \langle m'-r,m-s|. \end{aligned}$$ (19) They have shown that their operator is theoretically optimal for \(mm^\prime\) states, but they have not discussed the practical implementation of their optimal measurement scheme. We show this measurement scheme by \(\hat{M}_A\) . Figure 6 shows comparison of \(\Delta \phi _{min}\) of our measurement scheme with these two schemes, for \(|5::1\rangle\) and \(|4::2\rangle\) in symmetric and asymmetric losses. It reveals that, (1) when there is no photon loss, all three schemes have the same precision and \(\Delta \phi _{min} = \frac{1}{m-m^\prime }\) , which is the best possible precision for \(mm^\prime\) states in the absence of loss 28 . (2) By increasing the photon loss rate (in both symmetric and asymmetric cases), parity detection’s precision decreases with a much greater slope than the other two schemes. It means that parity detection is not a good measurement scheme to extract the phase information in the presence of loss. (3) The difference between the photon counting measurement scheme and the optimal scheme is tiny, especially for \(|5::1\rangle\) . Therefore the photon counting measurement scheme is near-optimal for these \(mm^\prime\) states and can be implemented in the lab by using a 50–50 beam splitter and two PNRD detectors. At the final part, in Fig. 7 , we have compared \(\Delta \phi _{min} = \frac{1}{F_{\rho _{\phi }, \hat{M}_c}}\) of our phase estimation setups with the Heisenberg limit, \(\Delta \phi _{HL} = \frac{1}{N}\) , and standard interferometry limit (SIL) 6 : $$\begin{aligned} \Delta \phi _{min,SIL} = \frac{\sqrt{t_0} + \sqrt{t_1}}{2\sqrt{N t_0 t_1 }}, \end{aligned}$$ (20) which is the best possible precision that a classical setup can reach. The region between the standard classical limit and the Heisenberg limit is colored with light-gray. Whenever a line is in this colored region, there is an improvement over classical interferometry. According to these results, \(|4::2\rangle\) cannot beat the classical limit in any loss rate. The other three input states can act better than the standard interferometry limit whenever the loss rate is lower than a specific value. In 30 , authors have shown that by using photon-number-resolving detectors, \(|10::4\rangle\) is more robust than \(|6::0\rangle\) against photon loss, but the \(|10::4\rangle\) state has fourteen photons, meaning that it possesses eight photons (resources) more than the considered NOON state \(|6::0\rangle\) . On the other hand, here we have considered \(mm^\prime\) states with the same number of photons, \(|5::1\rangle\) , \(|4::2\rangle\) and shown that these states can outperform (in phase estimation) the corresponding NOON state, with the same number of photons \(|6::0\rangle\) , when photon loss rate is above a certain value. Our results show that \(|5::1\rangle\) state, can in certain loss rates (in both symmetric and asymmetric losses) outperform the \(|6::0\rangle\) state and also have a \(\Delta \Phi\) below the standard interferometry limit. Summary and conclusion We have simulated a lossy Mach–Zehnder interferometer by using quantum circuits, for four definite photon-number states \((|6::0\rangle\) , \(|5::1\rangle\) , \(|4::2\rangle\) and \(|HB(6)\rangle )\) as its input states. The measurement scheme that we have considered here is counting the number of photons detected at the interferometer’s two different output ports. Because of the current quantum hardware’s noise, the quantum circuits have been simulated by a classical computer. We have compared the phase estimation precision of the four input states when there is symmetric and asymmetric photon loss in the interferometer. According to our results, \(|HB(6)\rangle\) state has the highest precision in most of the loss rates in both symmetric and asymmetric cases; in the symmetric loss whenever \(0.68>L>0.19\) , and in the asymmetric loss whenever \(L_1>0.21\) , \(|HB(6)\rangle\) has the highest phase estimation precision. This means that \(|HB(6)\rangle\) is better than the others for real-world quantum optical phase estimations. We have also checked the optimality of the photon-counting measurement scheme for these input states and found that it is optimum for \(|6::0\rangle\) in both loss cases and is near-optimum for the other three states when there is loss. Our results also show the range of photon loss rates, in which one can beat the standard interferometry limit by using \(|6::0\rangle\) , \(|5::1\rangle\) and \(|HB(6)\rangle\) as input states in the Mach–Zehnder interferometer and photon-counting as measurement scheme. By introducing appropriate subroutines into our quantum circuits, we can also implement phase fluctuations, input state preparation inefficiencies, and detector inefficiency. Furthermore, we can also implement any other measurement scheme by adding the appropriate subroutine in the last part of our quantum circuits. These features help us compare different definite photon-number input states’ precision in different decoherence conditions with different measurement schemes.