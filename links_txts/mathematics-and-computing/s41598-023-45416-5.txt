Introduction The simplest non-dissipative kinetic model for a single-component plasma in N space dimensions is the Vlasov–Poisson system, $$\begin{aligned}{} & {} \partial _tf + m^{-1}p_i\,\partial _{q^i} f - e\,m^{-1}\partial _{q^i} V\partial _{p_i}f =0,\quad f:{\mathbb {R}}_q^N\times {\mathbb {R}}_p^N\rightarrow {\mathbb {R}} \end{aligned}$$ (1) $$\begin{aligned}{} & {} -\Delta V = 4\pi e \int f\,dp - 4\pi e n_0,\quad V:{\mathbb {R}}_q^N\rightarrow {\mathbb {R}}. \end{aligned}$$ (2) Here \(f=f(q,p)\) denotes the Vlasov distribution function and \(V = V(q)\) is the electrostatic potential. Particles that comprise the sole plasma species have charge e , mass m , position \(q = (q^1,\dots ,q^N)\) , and momentum \(p=(p_1,\dots ,p_N)\) . A uniform neutralizing background \(n_0\) ensures overall charge neutrality. The explicit time dependence of f and V has been suppressed. This single-component model generalizes simply to allow for multiple plasma species. The Vlasov–Poisson system can be derived as a formal closure of the BBGKY hierarchy 1 using Bogoliubov’s hypothesis 2 , 3 expressing all many-body correlations as functionals of f . Kinetic plasma models, like the Vlasov–Poisson system, are formally equivalent to infinite hierarchies of hydrodynamic equations for the fluid moments. The degree- k fluid moment \(\varvec{M}^k = M_{i_1\dots i_k}\,dq^{i_1}\otimes \dots \otimes dq^{i_k}\) is a symmetric tensor whose components are given by the momentum space integrals $$\begin{aligned} M_{i_1\dots i_{k}}(q) = \int p_{i_1}\dots p_{i_k}\,f(q,p)\,dp,\quad i_\ell =1,\dots ,N,\quad k=0,1,2,\dots . \end{aligned}$$ In general, the evolution equation for the degree- k fluid moment couples to the degree- \((k+1)\) fluid moment, a phenomenon that epitomizes the so-called moment closure problem. For example, evolution equations for the first three fluid moments \((M^0,M^1,M^2)=(n,\varvec{P},{\mathbb {S}})\) are $$\begin{aligned}{} & {} \partial _tn + m^{-1}\nabla \cdot \varvec{P} = 0 \end{aligned}$$ (3) $$\begin{aligned}{} & {} \partial _t\varvec{P} + m^{-1}\nabla \cdot {\mathbb {S}} = -e\,n\,\nabla {V}\end{aligned}$$ (4) $$\begin{aligned}{} & {} \partial _t{\mathbb {S}} + m^{-1}\nabla \cdot {\mathscr {T}} = -e(\nabla {V}\varvec{P} + \varvec{P}\nabla {V}), \end{aligned}$$ (5) where \({\mathscr {T}} = M^3\) denotes the degree-3 fluid moment. Any prescription for expressing the degree- \((k+1)\) fluid moment as a function of lower-degree fluid moments is known as a fluid closure. Upon introducing a fluid closure, the rate of change of the first k fluid moments becomes a function of only those first k fluid moments. Thus, it becomes feasible to solve a finite collection of hydrodynamic equations to find time evolution of the first k fluid moments. Of course, there is no guarantee that moment evolution determined by a fluid closure bears any relation to moment evolution determined by the parent kinetic model, unless the fluid closure is chosen wisely. Traditional methods for developing fluid closures involve some combination of asymptotic expansions 4 , 5 , 6 , 7 and intuitive guesswork. More recently, advances in machine learning 8 , 9 have accelerated the development of data-driven fluid closures, as well as other data-driven reduced-order models 10 . But fluid closures built using black-box neural networks are known to deliver poor results when employed over large simulation time intervals. There is therefore a growing effort to incorporate inductive bias into data-driven fluid closures, with the hope of improving long-term predictions. For example, Huang et al. 11 , 12 and Porteous et al. 13 developed variable-moment neural-network-based fluid closures that automatically enforce hyperbolicity of the ensuing moment evolution equations. This Article presents a framework for building variable-moment fluid closures that automatically enjoy an important structural property inherent to non-dissipative kinetic plasma models: Hamiltonian structure. The framework involves two essential components. (1) Specification of a Poisson bracket for the first \(m_0\) fluid moments, where \(m_0\) is any integer greater than 1. (2) Specification of the plasma system energy as a function of the first \(m_0\) fluid moments. The form of the Poisson bracket only depends on the the number of moments \(m_0\) included in a desired closure. On the other hand, the form of the energy function, or Hamiltonian \({\mathscr {H}}\) , is free to specify. Parameterizing \({\mathscr {H}}\) using a neural network as in Hamiltonian neural networks 14 , or a library of candidate terms 15 , 16 , offers a novel path toward data-driven closure modeling for non-dissipative kinetic plasmas. As presented here, the framework applies specifically to fluid closures of the Vlasov–Poisson system in N space dimensions. However, similar ideas apply to other non-dissipative kinetic plasma models, such as the Vlasov–Maxwell system 17 , 18 , 19 . The framework still applies in the presence of dissipation caused by particle collisions since a dissipative fluid closure should respect the metriplectic 20 structure of collisional kinetic theory. Notably, metriplectic dynamical systems always decompose as the sum of a Hamiltonian part and a dissipative part; the framework developed here applies to the Hamiltonian part. The Hamiltonian structure underlying the infinite hierarchy of fluid moments for the Vlasov–Poisson system was first identified by Gibbons 21 . However, finding true Poisson brackets for finite, but arbitrarily large collections of fluid moments for the Vlasov–Poisson system represents an outstanding theoretical challenge. The Poisson bracket for the closure framework presented here provides the first complete solution. In the context of slab drift kinetic models, Tassi 22 , 23 , 24 previously found Hamiltonian fluid moment closures with any number of fluid moments. But the methods underlying this result fail to extend to other dissipation-free kinetic models in any obvious manner. In the Vlasov–Poisson context, Holm and Tronci 25 found Hamiltonian fluid moment closures that include arbitrarily-large collections of fluid moments that do not include the density moment. Otherwise, the best available partial solutions for Vlasov–Poisson work in one space dimension \((N=1)\) , where the tensorial nature of fluid moments does not appear, and fall into two categories. The first category contains Hamiltonian moment closures derived by way of direct imposition of the Jacobi identity—Jacobi closures. The second category contains closures based on exact solutions of the parent kinetic model that may be parameterized by fluid moments—exact reductions. At a schematic level, derivations of Jacobi closures work by first substituting an unknown closure relation into the Poisson bracket for the parent kinetic model, and then finding conditions the closure relation needs to satisfy in order for the closure bracket to satisfy the Jacobi identity. These conditions take the form of nonlinear partial differential equations (PDEs) that, in general, do not admit solutions or cannot be solved in closed form. However, there are notable exceptions. Tassi 26 studied Jacobi closures for drift kinetics that include two moments. Chandre and Shadwick 27 found a Jacobi closure that accommodates all fluid moments with degree \(k < 5\) and ensures stability of uniform solutions. This extends the earlier result 28 of Perin et al. 29 that also found Hamiltonian closures with \(k<5\) , but without stability guarantees. The feasibility of finding Jacobi closures was first established by Perin et al. 30 through a Jacobi-closure derivation of the earliest Hamiltonian fluid model due to Morrison and Greene. Jacobi closures involving moments with degree \(k<2\) are automatic; the algebra of functionals that depend only on density and momentum density closes under the Vlasov–Maxwell Poisson bracket. The same algebraic closure property is not automatic for models that include moments with degrees \(k\ge 2\) . de Guillebon and Chandre 31 dramatically highlighted this last point by revealing an earlier fluid moment model 32 as a false-positive; a claimed Hamiltonian fluid closure including moments with degree \(k= 2\) that was provably not Hamiltonian. Jacobi closures that include fluid moments of arbitrarily large degree have not yet been discovered. Derivations of Hamiltonian moment closures based on exact reductions work like the classical variation of parameters method. After postulating a parametric form for the distribution function f , evolution equations for the parameters are derived that ensure a time-evolving parametric f solves the kinetic equation exactly. This procedure only works for very special parametric f . For example, a distribution function of the form \(f(q,p) = n(q)\,\delta (p-\varvec{P}(q)/n(q))\) , where n is a positive function and \(\varvec{P}\) is a vector field, solves the Vlasov–Poisson system if and only if \((n,\varvec{P})\) satisfies the Euler equations with a particular barotropic equation of state—the exact reduction. The parameters for this \(\delta\) -closure are just the fluid moments with degrees \(k<2\) ; the Poisson bracket among these parameters induced by the Vlasov–Poisson bracket recovers the \(k<2\) closure bracket mentioned above. Perin et al. 33 initiated a program aimed at finding moment closures with arbitrarily high-degree moments by re-parameterizing a multiple waterbag exact reduction. (Perin et al. 34 also studied waterbags in the drift kinetic context.) Simple explicit formulas express the fluid moments of multiple waterbags as polynomials in waterbag parameters. Whenever these polynomial relationships can be inverted to give waterbag parameters in terms of fluid moments a Hamiltonian moment closure results. However, due to the general insolubility of large-degree polynomial equations, the inversion has only been demonstrated for a single waterbag. Like Jacobi closures, Hamiltonian closures based on exact reductions have yet to accommodate fluid moments of arbitrarily large degree. The Hamiltonian moment closures presented here fall into the exact reduction category. The relevant parametric form for f is given by $$\begin{aligned} f(q,p)&=n(q)\,\delta (p+d\psi (q)) - \mu _{i_1}(q)\,\partial _{p_{i_1}}\delta (p+d\psi (q))\nonumber \\&\quad + \frac{1}{2}\,\mu _{i_1\,i_2}(q)\,\partial ^2_{p_{i_1\,i_2}}\delta (p+d\psi (q)) + \dots + \frac{(-1)^{m_0}}{m_0!}\mu _{i_1\dots i_{m_0}}(q)\,\partial ^{m_0}_{p_{i_1}\dots p_{i_{m_0}}}\delta (p+d\psi (q)). \end{aligned}$$ (6) Here, n denotes the density, the gradient of the scalar function \(\psi\) determines the center of the distribution function, and \(\mu _{i_1\dots i_k} { = \int [p_{i_1}+\partial _{i_i}\psi ]\dots [p_{i_k}+\partial _{i_k}\psi ]f\,dp}\) denotes the degree- k centered fluid moment. " Hamiltonian dynamics of localized momentum distributions " contains a detailed exposition. A simple upper-triangular transformation, Eq. ( 22 ), relates the first \(m_0\) centered fluid moments to the first \(m_0\) standard fluid moments. Hamiltonian closures based on this form of f therefore accommodate arbitrarily high-degree moments by increasing the integer \(m_0\) . This feature of the closures, together with their applicability in every space dimension N , sets them apart from all previous Hamiltonian fluid closures that currently appear in the literature. A priori , the theory developed here implies there will not be any departure from evolution predicted by the reduced moment equations and evolution predicted by the unreduced Vlasov–Poisson system provided the initial distribution function is of the form specified in ( 6 ). For distribution functions with initial conditions that are only approximated by Eq. ( 6 ), this work provides no bounds on the ensuing errors in moment evolution, although formulating such bounds should be addressed in future work. On the other hand the ansatz ( 6 ) is expressive enough to reproduce the first \(m_0\) moments of any distribution, e.g. a bump-on-tail. By changing the system Hamiltonian, the Poisson bracket associated with this exact reduction may therefore be used to model the first \(m_0\) moments of distributions that are not of the form ( 6 ). This observation forms the basis for the proposed data-driven closure modeling approach, described with greater detail in " A closure scheme for general distributions ": fix the Poisson bracket and incorporate all modeling choices into the form of the Hamiltonian \({\mathscr {H}}\) . Demonstrating that ( 6 ) comprises an exact reduction and uncovering the corresponding Poisson bracket structure for general \(m_0\) and N requires considerable bookkeeping technology. Fortunately, Scovel and Weinstein 35 developed the necessary general machinery in the context of distributions f localized near a point \(z = (q,p)\) in single-particle phase space. (Channell 36 provides additional insights into elements of the Scovel–Weinstein construction.) Such distributions, which are relevant to self-consistent beam dynamics in particle accelerators, also give rise to a moment closure problem, where the moments are redefined as the phase space integrals $$\begin{aligned} m^{\nu _1\dots \nu _k} = \int z^{\nu _1}\dots z^{\nu _k}f(z)dz, \quad \nu _\ell =1,\dots ,2N. \end{aligned}$$ In order to find a finite-dimensional Poisson bracket that describes dynamics of the first \(m_0\) phase space moments, Scovel–Weinstein developed a reduction strategy that can be applied to any Lie–Poisson Hamiltonian system whose associated Lie algebra \({\mathfrak {g}}\) decomposes as a sum of subalgebras \({\mathfrak {g}} = {\mathfrak {b}} + {\mathfrak {s}}\) . (The Lie bracket on \({\mathfrak {g}}\) need not factor as the sum of brackets from \({\mathfrak {b}}\) and \({\mathfrak {s}}\) .) For the beam problem, \({\mathfrak {g}}\) comprises the phase space functions with multiplication provided by the usual single-particle Poisson bracket, \({\mathfrak {b}}\) contains the affine phase space functions, and \({\mathfrak {s}}\) is the collection of phase space functions that vanish at \((q,p) = (0,0)\) , together with their first partial derivatives. For fluid moments, the Lie algebra \({\mathfrak {g}}\) remains the same, but the subalgebras \({\mathfrak {b}},{\mathfrak {s}}\) differ substantially. " Lie theory for the contactomorphism group " summarizes the Lie theory necessary to apply Scovel–Weinstein theory to fluid moments, and in particular defines the subalgebras \({\mathfrak {b}}\) and \({\mathfrak {s}}\) . " Scovel–Weinstein theory " precisely states the elements of Scovel–Weinstein theory that enable subsequent development of the new closure method in " Poisson bracket on the space of truncated fluid moment vectors ", " Hamiltonian dynamics of localized momentum distributions ", and " A closure scheme for general distributions ". The following notation is used in what follows without further comment. If \(V={\mathbb {R}}^d\) is any finite-dimensional vector space then C ( V ) contains smooth functions on V with mild growth (e.g. at most polynomial grown) at infinity. The dual space \(C^*(V)\) contains rapidly decaying distributional functions on V . The duality pairing between \(\kappa \in C(V)\) and \(\rho \in C^*(V)\) is \(\langle \rho ,\kappa \rangle = \int _{V} \kappa (v)\,\rho (v)\,dv\) , where dv denotes the Lebesgue measure on \({\mathbb {R}}^d\) . Lie theory for the contactomorphism group A complete understanding of the Hamiltonian moment closures described in this Article requires familiarity with some of the rich structure of the contactomorphism group G . This Section aims to provide a self-contained introduction to G and its properties with greatest relevance to fluid moments. For this Section and " Scovel–Weinstein theory " only, readers should be familiar with the basic mathematical theory of Lie groups at the level of Chapter 4 in the book 37 by Abraham and Marsden. Marsden and Weinstein 18 were first to recognize that G is the Lie group that integrates the Lie algebra underlying the Vlasov equation. Subsequently, Gay-Balmaz and Tronci 38 used structural properties of contactomorphisms to show that the integrable Bloch-Iserles system is geodesic flow on a subgroup of G . Gay-Balmaz and Tronci 39 , 40 also provide additional exposition concerning the contactomorphism group as part of their ongoing efforts in quantum-classical hybrid modeling. Let \(Q\ni q\) be an N -dimensional vector space representing the configuration space for an N -degree of freedom Hamiltonian system with basis \(\{e_i\}_{i=1,\dots ,N}\) and corresponding component functions \(\{q^i\}_{i=1,\dots ,N}\) . It is not necessary to suppose that Q is endowed with any particular inner-product structure. The corresponding momentum phase space is \(P =Q\times Q^* \ni (q,p)\) , where \(Q^*\) denotes the dual vector space to Q . The dual basis on \(Q^*\) will be denoted \(\{ e^i\}_{i=1,\dots ,N}\) , while the corresponding component functions will be denoted \(\{p_i\}_{i=1,\dots ,N}\) . The cotangent projection map is \(\pi :P\rightarrow Q:(q,p)\mapsto q\) . Each \(p\in Q^*\) is a linear mapping \(p:Q\rightarrow {\mathbb {R}}\) . Application of the linear map \(p\in Q^*\) to a vector \(q\in Q\) will be denoted \(\langle p,q\rangle \in {\mathbb {R}}\) . The canonical 1-form \(\vartheta\) on P is defined by \(\vartheta = \langle p,dq\rangle\) . The corresponding canonical symplectic form is the 2-form \(\omega = -d\vartheta\) given by exterior differentiation of \(\vartheta\) . The Poisson bracket associated with the canonical symplectic form \(\omega\) is given on pairs of functions \(f,g:P\rightarrow {\mathbb {R}}\) by $$\begin{aligned} \{f,g\} = { \partial _{q^i}f\,\partial _{p^i}g - \partial _{q^i}f\,\partial _{p^i}g ,\quad \text {(summation implied).} } \end{aligned}$$ A (strict) contactomorphism \(g = (\Phi ,\varphi )\) is a pair comprising a diffeomorphism \(\Phi :P\rightarrow P\) and a smooth function \(\varphi :P\rightarrow {\mathbb {R}}\) that together satisfy the identity $$\begin{aligned} d\varphi + \Phi ^*\vartheta = \vartheta . \end{aligned}$$ The product of a pair of contactomorphisms \(g_1,g_2\) , denoted \(g_1g_2\) , is $$\begin{aligned} g_1g_2 = (\Phi _1\circ \Phi _2, \Phi _2^*\varphi _1 + \varphi _2). \end{aligned}$$ When equipped with this product, the set of all contactomorphisms comprise a group known as the (strict) contactomorphism group. The contactomorphisms \(b = (\Phi ,\varphi )\) such that $$\begin{aligned} \Phi (q,p) = \bigg (q,p - { d\psi } \bigg ),\quad \varphi (q,p) = \psi (q),\quad \psi \in C(Q), \quad { d\psi = \partial _{q^i}\psi \,dq^i}. \end{aligned}$$ form a subgroup B , known as the group of fiber translations . Note that if \(\tau _\psi : P\rightarrow P\) denotes the mapping \((q,p)\mapsto (q,p - { d\psi })\) , then every fiber translation may be written as \(b = (\tau _\psi ,\pi ^*\psi )\) for some unique \(\psi\) . The mapping \(I_B : B\rightarrow C(Q): (\tau _\psi ,\pi ^*\psi )\mapsto \psi\) , from B to the Abelian group of smooth functions on configuration space is a group isomorphism. Let \(Z = \{(q,p)\in P\mid p = 0\}\) denote the zero section in phase space. The submanifold Z contains the static system states. The contactomorphisms \(s= (\Phi ,\varphi )\) such that \(\Phi (Z) = Z\) and \(\varphi (Z)=0\) form a Lie subgroup \(S\subset G\) . In this work, S will be referred to as the group of isostatic contactomorphisms . The isostatic contactomorphisms complement the fiber translations in the following sense. Theorem 1 The product mapping $$\begin{aligned} m:B\times S\rightarrow G: (b,s)\mapsto bs, \end{aligned}$$ restricts to a diffemorphism from a neighborhood of \((e,e)\in B\times S\) to a neighborhood of \(e\in G\) . In particular, for each \(g\in G\) sufficiently close to the identity there is a unique fiber translation b and a unique isostatic contactomorphism s such that \(g=bs\) . Proof The proof proceeds by constructing the inverse of \(m\) on an appropriate neighborhood \(U_G\) of the identity in G . In particular, given \(g\in G\) the key step is finding a cooresponding \(b = b(g)\) such that \(s(g) = b(g)^{-1}g\in S\) . The inverse of \(m\) is then \(m^{-1}(g)=(b(g),s(g))\) , since \(m(b(g),s(g)) = b(g)s(g) = b(g)(b(g)^{-1}g) = g\) . Observe that the zero section Z is a graph over Q . Let \(U_G\subset G\) denote the set of contactomorphisms \(g = (\Phi ,\varphi )\) such that \(\Phi (Z)\) is a graph over Q . Given \(g\in U_G\) , the graph \(\Phi (Z)\) is a Lagrangian submanifold of P . There is therefore a function \(\psi :Q\rightarrow {\mathbb {R}}\) on configuration space such that \(\Phi (Z)\) is the graph of (minus) the differential of \(\psi\) , $$\begin{aligned} \Phi (Z) = \{(q,p)\in P\mid p = -{ d\psi }\}. \end{aligned}$$ In other words, \(\psi\) is (minus) a generating function for the Lagrangian submanifold \(\Phi (Z)\) . A generating function \(\psi\) for \(\Phi (Z)\) determines a fiber translation \(b = (\tau _\psi ,\pi ^*\psi )\) , which very nearly furnishes the \(b = b(g)\) mentioned above. However, there is more to do because \((\tau _\psi ,\pi ^*\psi )^{-1}g\) is not necessarily in S . Moreover, the fiber translation \((\tau _\psi ,\pi ^*\psi )\) is not uniquely determined by g . In fact, \(\psi ^\prime = \psi + c\) , \(c\in {\mathbb {R}}\) , also generates \(\Phi (Z)\) , but determines a different fiber translation \((\tau _{\psi ^\prime },\pi ^*\psi ^\prime ) = (\tau _\psi ,\pi ^*\psi + c)\) . The following argument shows that for each \(g\in U_G\) there is a unique generating function \(\psi = \psi (g)\) for \(\Phi (Z)\) such that \(s = (\tau _\psi ,\pi ^*\psi )^{-1}g\in S\) . Let \(\iota _Q:Q\rightarrow P: q\mapsto (q,0)\) denote the map that embeds Q in P as Z , and set \((\Phi _s,\varphi _s)= s = (\tau _\psi ^{-1}\circ \Phi ,-\Phi ^*\pi ^*\psi + \varphi )\) . As mentioned already, there exists a (non-unique) \(\psi\) that generates \(\Phi (Z)\) . Since \(\Phi (Z)\) is the graph of \(-{ d\psi }\) , the mapping \(\tau _{\psi }^{-1}\) maps the Lagrangian submanifold \(\Phi (Z)\) back to Z , i.e. \(\Phi _s(Z) = \tau _{\psi }^{-1}(\Phi (Z)) = Z\) . Equivalently, there is a diffeomorphism \(\eta _s:Q\rightarrow Q\) such that \(\Phi _s\circ \iota _Q = \iota _Q\circ \eta _s\) . Since s is a contactomorphism, \(d\varphi _s + \Phi _s^*\vartheta = \vartheta\) . Pulling back this identity along \(\iota _Q\) implies $$\begin{aligned} 0 = \iota _Q^*\vartheta = \iota _Q^*(d\varphi _s + \Phi _s^*\vartheta ) = d\iota _Q^*\varphi _s + (\Phi _s\circ \iota _Q)^*\vartheta = d\iota _Q^*\varphi _s + (\iota _Q\circ \eta _s)^*\vartheta =d\iota _Q^*\varphi _s + \eta _s^*\iota _Q^*\vartheta = d\iota _Q^*\varphi _s. \end{aligned}$$ This means \(\varphi _s(q,0) = \varphi (q,0) - \psi (\eta _s(q))\) is constant as a function of q . Eliminate the ambiguity in the definition of \(\psi\) by requiring that \(\varphi _s(q,0) = 0\) . Once this is done, \(b=b(g) = (\tau _{\psi (g)},\pi ^*\psi (g))\) is uniquely determined by g and \(b^{-1}g\in S\) , as desired. The inverse of \(m\) on \(U_G\) is now \(m^{-1}(g) = (b(g),s(g))\) , with \(s(g) = b(g)^{-1}g\) . \(\square\) The Lie algebra \({\mathfrak {g}} = T_eG\) of infinitesmial contactomorphisms comprises pairs \((X,\Sigma )\) , where X is a vector field on P , \(\Sigma :P\rightarrow {\mathbb {R}}\) is a function on P , and \(d\Sigma +{\mathscr {L}}_X\vartheta = 0.\) The adjoint action of G and Lie bracket on \({\mathfrak {g}}\) are given by $$\begin{aligned} \text {Ad}_g(X,\Sigma )&= (\Phi _*X,\Phi _*(\Sigma + {\mathscr {L}}_X\varphi )),\quad g = (\Phi ,\varphi ),\\ [(X_1,\Sigma _1),(X_2,\Sigma _2)]&= (-[X_1,X_2],-{\mathscr {L}}_{X_1}\Sigma _2 +{\mathscr {L}}_{X_2}\Sigma _1). \end{aligned}$$ The linear map \(I_{{\mathfrak {g}}}:{\mathfrak {g}}\rightarrow C(P):(X,\Sigma )\mapsto \Sigma + \vartheta (X)\) , from infinitesimal contactomorphisms to phase space functions under Poisson bracket is a Lie algebra isomorphism. This observation recovers the well-known fact that the contactomorphism group integrates the Lie algebra of phase space functions equipped with the Poisson bracket. The Lie subalgebra \({\mathfrak {b}} = T_{e}B\subset {\mathfrak {g}}\) of infinitesimal fiber translations comprises pairs \((X,\Sigma )\in {\mathfrak {g}}\) , where \(\Sigma = \pi ^*\sigma\) for some \(\sigma \in C(Q)\) and \(X = X_{\pi ^*\sigma }\) . The Lie bracket on \({\mathfrak {b}}\) vanishes because B is Abelian. When identifying \({\mathfrak {g}}\) with phase space functions via \(I_{{\mathfrak {g}}}\) , \({\mathfrak {b}}\) corresponds to p -independent functions. Denote the image Lie subalgebra of \({\mathfrak {b}}\) in \((C(P),\{\cdot ,\cdot \})\) as $$\begin{aligned} C_{{\mathfrak {b}}}(P) = \{h\in C(P)\mid { \partial _{p_i}h=0,\quad i=1,\dots ,N}\}. \end{aligned}$$ The Lie subalgebra \({\mathfrak {s}} = T_{e}S\subset {\mathfrak {g}}\) of isostatic infinitesimal contactomorphisms comprises pairs \((X,\Sigma )\in {\mathfrak {g}}\) such that X is tangent to Z and \(\Sigma (Z) = 0\) . (In fact, the latter condition implies the former, and so can be taken as the sole property characterizing \({\mathfrak {s}}\) as a subspace of \({\mathfrak {g}}\) .) The image Lie subalgebra \(I_{{\mathfrak {g}}}({\mathfrak {s}}){ =\{h\in C(P)\mid \exists s\in {\mathfrak {s}},\,h = I_{{\mathfrak {g}}}(s)\}}\) in \((C(P),\{\cdot ,\cdot \})\) is $$\begin{aligned} C_{{\mathfrak {s}}}(P) = \{h\in C(P)\mid h(Z) = 0\}. \end{aligned}$$ Theorem 1 implies that, as a vector space, the Lie algebra of infinitesimal contactomorphisms is the direct sum of \({\mathfrak {b}}\) and \({\mathfrak {s}}\) , \({\mathfrak {g}} = {\mathfrak {b}} + {\mathfrak {s}}\) . The corresponding statement in C ( P ), namely \(C(P) = C_{{\mathfrak {b}}}(P) + C_{{\mathfrak {s}}}(P)\) , may be understood more simply as a byproduct of Taylor’s theorem with remainder. The dual space \({\mathfrak {g}}^*\) comprises linear functions \(\mu : {\mathfrak {g}}\rightarrow {\mathbb {R}}\) . Since \({\mathfrak {g}} = {\mathfrak {b}} + {\mathfrak {s}}\) , the duals to \({\mathfrak {b}}\) and \({\mathfrak {s}}\) are subspaces of \({\mathfrak {g}}^*\) given by $$\begin{aligned} {\mathfrak {b}}^* = \{\mu \in {\mathfrak {g}}^*\mid \langle \mu ,{\mathfrak {s}} \rangle = 0\},\quad {\mathfrak {s}}^* = \{\mu \in {\mathfrak {g}}^*\mid \langle \mu ,{\mathfrak {b}} \rangle = 0\}. \end{aligned}$$ Similarly, the dual space to C ( P ), \(C^*(P)\) , contains linear functions \({f}:C(P)\rightarrow {\mathbb {R}}\) , and the duals \(C_{{\mathfrak {b}}}^*(P)\) , \(C_{{\mathfrak {s}}}^*(P)\) , are the subspaces of \(C^*(P)\) given by $$\begin{aligned} C_{{\mathfrak {b}}}^*(P)=\{{f}\in C^*(P)\mid \langle {f},C_{{\mathfrak {s}}}(P)\rangle =0\},\quad C_{{\mathfrak {s}}}^*(P)=\{{f}\in C^*(P)\mid \langle {f},C_{{\mathfrak {b}}}(P)\rangle =0\}. \end{aligned}$$ The coadjoint action of G on \({\mathfrak {g}}^*\) is given by \(\text {Ad}^*_g:{\mathfrak {g}}^*\rightarrow {\mathfrak {g}}^*: (X^*,\varphi ^*)\mapsto (\text {Ad}_{g^{-1}})^*(X^*,\varphi ^*)\) . The corresponding coadjoint action of G on \(C^*(P)\) is $$\begin{aligned} \text {Ad}^*_g{f} = \Phi _*{f},\quad {f}\in C^*(P),\quad g=(\Phi ,\varphi )\in G. \end{aligned}$$ Provided the space of phase space functions is restricted to smooth functions with slow growth at infinity, the dual \(C^*(P)\) contains all of the typical smooth Vlasov densities. It includes more exotic functionals as well, such as Dirac \(\delta\) -functions and their derivatives. Scovel–Weinstein theory The (infinite-dimensional) Hamiltonian structure underlying the Vlasov–Poisson system is dual to the Lie algebra C ( P ) of phase space functions under the standard (finite-dimensional) Poisson bracket. The problem of finding reduced models, in particular reduced fluid models, for Vlasov–Poisson may therefore be approached at the level of the algebra C ( P ). Adopting this point of view requires addressing how the Lie algebra C ( P ) might be “reduced.” For the purposes of this Article, any reduction should somehow encode the objects dual to the first \(m_0\) fluid moments, namely the phase space functions h ( q , p ) that are polynomial in momentum p with degree at most \(m_0\) . Plausible reductions of C ( P ) include proper Lie subalgebras: subspaces of C ( P ) that close under Poisson bracket. For example, the phase space functions that only depend on the configuration variable q (i.e. degree-0 momentum polynomials) comprise an Abelian Lie subalgebra dual to the space of density moments. More generally, the momentum polynomials with degree at most 1 close under Poisson bracket because $$\begin{aligned} \left\{ \bigg (c_1(q)+c_1^i(q)p_i\bigg ),\bigg (c_2(q) + c_2^i(q)p_i\bigg )\right\} = -\bigg (c_1^i(q)\partial _ic_2(q)-c_2^i(q)\partial _ic_1(q)\bigg ) - \bigg (c_1^j(q)\partial _jc_2^i(q) - c_2^j(q)\partial _j c_1^i(q)\bigg )p_i. \end{aligned}$$ However, by itself, subalgebra reduction of C ( P ) provides insufficient flexibility to accommodate fluid moments with degree between 0 and \(m_0\) when \(m_0 > 1\) . This follows from the failure of momentum polynomials with degree at most 2 to close under Poisson bracket. Quotient algebra reduction offers a more nuanced alternative to subalgebra reduction. Instead of attempting to encapsulate moments in a small subalgebra, quotient algebra reduction aims to find large ideals \({\mathscr {I}}\) in C ( P ) such that the quotient space \(C_{{\mathscr {I}}}(P) = C(P)/{\mathscr {I}}\) encodes fluid moments. Here, ideals are subalgebras with an additional absorbing property: the bracket of functions in \({\mathscr {I}}\) with arbitrary functions in C ( P ) must be contained in \({\mathscr {I}}\) . The subspace \({\mathscr {I}}\) being an ideal ensures that the quotient \(C_{{\mathscr {I}}}(P)\) inherits a Lie algebra structure from C ( P ). Unfortunately, as for subalgebra reduction, quotient algebra reduction cannot accommodate the fluid moments with degree between 0 and \(m_0\) by itself. As described in detail within the proof of Theorem 2 , it can successfully encode moments with degree between 1 and \(m_0\) . The paper 35 by Scovel and Weinstein devises an alternative Lie-theoretic reduction strategy that hybridizes subalgebra reduction and quotient algebra reduction. Developed originally for application to phase space moments, Scovel–Weinstein theory adapts to the fluid moment context in straightforward fashion. In fact, their methods apply any time a Lie group G admits a decomposition by Lie subgroups \(B,S\subset G\) . Here, decomposition means that for each \(g\in G\) there are unique \(b\in B\) and \(s\in S\) such that \(g = bs\) . In the context of fluid moments, the group G is the contactomorphism group, B is the group of fiber translations, and S is the group of isostatic contactomorphisms. Each of these groups is described with some detail in " Lie theory for the contactomorphism group ". The technical heart of Scovel–Weinstein theory may be described as follows. Suppose that G is a Lie group that admits a decomposition by Lie subgroups \(B,S\subset G\) , \(G = BS\) . The Lie algebra \({\mathfrak {g}}\) then admits a corresponding direct sum decomposition \({\mathfrak {g}} = {\mathfrak {b}} + {\mathfrak {s}}\) by Lie subalgebras. Likewise, the dual space to \({\mathfrak {g}}\) admits the direct sum decomposition \({\mathfrak {g}}^* = {\mathfrak {b}}^* + {\mathfrak {s}}^*\) . The Scovel–Weinstein map \(\Gamma :(B\times {\mathfrak {b}}^*) \times {\mathfrak {s}}^*\rightarrow {\mathfrak {g}}^*\) is given by $$\begin{aligned} \Gamma (b,b^*,s^*) = \text {Ad}^*_{b}(b^* + s^*). \end{aligned}$$ Here \(\text {Ad}^*_g=(\text {Ad}_{g^{-1}})^*\) denotes the (left) coadjoint action of G on \({\mathfrak {g}}^*\) . Let \(\{\cdot ,\cdot \}_{T^*B}\) denote the Poisson bracket on \(B\times {\mathfrak {b}}^*\) given by pulling back the canonical Poisson bracket on \(T^*B\) along the left trivialization map. Let \(\{\cdot ,\cdot \}_{{\mathfrak {s}}^*}\) denote the Lie–Poisson bracket on \({\mathfrak {s}}^*\) . Finally, let \(\{\cdot ,\cdot \}_{{\mathfrak {g}}^*}\) denote the Lie–Poisson bracket on \({\mathfrak {g}}^*\) . The central result due to Scovel–Weinstein is the following. When \((B\times {\mathfrak {b}}^*) \times {\mathfrak {s}}^*\) is equipped with the evident product Poisson manifold structure, the Scovel–Weinstein map \(\Gamma\) is a Poisson map. In other words, the direct product Poisson bracket is compatible with the Lie–Poisson bracket on \({\mathfrak {g}}\) according to $$\begin{aligned} \{\Gamma ^*f,\Gamma ^*g\}_{T^*B} + \{\Gamma ^*f,\Gamma ^*g\}_{{\mathfrak {s}}^*} = \Gamma ^*\{f,g\}_{{\mathfrak {g}}^*},\quad f,g\in C({\mathfrak {g}}^*). \end{aligned}$$ Note that the space \((B\times {\mathfrak {b}}^*)\times {\mathfrak {s}}^*\) is larger that \({\mathfrak {g}}^*\) by the factor B . This extra variable b is the price paid for “untangling” the Lie–Poisson structure on \({\mathfrak {g}}^*\) in terms of standard Poisson structures associated with \({\mathfrak {b}}^*\) and \({\mathfrak {s}}^*\) . Scovel–Weinstein advocate the following interpretation of \(\Gamma\) and its source and target spaces. In the space \((B\times {\mathfrak {b}}^*)\times {\mathfrak {s}}^*\) the factor \({\mathfrak {g}}_0^* = {\mathfrak {b}}^*\times {\mathfrak {s}}^*\) represents a “reference” copy of \({\mathfrak {g}}^*\) sitting at the identity e in the group B . The mapping \(\Gamma\) advects the reference space \({\mathfrak {g}}_0^*\) from e to b . This advection interpretation warrants further elaboration. Along a solution of the Vlasov–Poisson system, the distribution function f ( q , p ) is advected by canonical transformations that prescribe the motion of individual particles in phase space. These canonical transformations naturally reside with the contactomorphism group G . The Scovel–Weinstein map \(\Gamma\) may therefore be interpreted as a general way of identifying special system motions advected by a subgroup \(B\subset G\) . Now suppose that the Lie subalgebra \({\mathfrak {s}}\) contains an ideal \({\mathscr {I}}\subset {\mathfrak {s}}\) . Note that ideals in \({\mathfrak {s}}\) are not necessarily ideals in \({\mathfrak {g}}\) ! The quotient algebra \({\mathfrak {s}}_{{\mathscr {I}}} = {\mathfrak {s}}/{\mathscr {I}}\) then inherits a Lie algebra structure from \({\mathfrak {s}}\) by requiring that the quotient map \(\Pi _{{\mathscr {I}}}:{\mathfrak {s}}\rightarrow {\mathfrak {s}}_{{\mathscr {I}}}\) is a Lie algebra homomorphism. If \(s_1+{\mathscr {I}},s_2+{\mathscr {I}}\in {\mathfrak {s}}_{{\mathscr {I}}}\) are elements of the quotient space their Lie bracket is $$\begin{aligned}{}[s_1+{\mathscr {I}},s_2+{\mathscr {I}}]= [s_1,s_2]+{\mathscr {I}}. \end{aligned}$$ Scovel–Weinstein highlight that since \(\Pi _{{\mathscr {I}}}\) is a Lie algebra homomorphism, the dual map \(\Pi _{{\mathscr {I}}}^*:{\mathfrak {s}}^*_{{\mathscr {I}}}\rightarrow {\mathfrak {s}}^*\) is a Poisson map. Therefore the map $$\begin{aligned} \text {id}\times \Pi _{{\mathscr {I}}}^*: (B\times {\mathfrak {b}}^*)\times {\mathfrak {s}}^*_{{\mathscr {I}}}\rightarrow (B\times {\mathfrak {b}}^*)\times {\mathfrak {s}}^*, \end{aligned}$$ is Poisson as well, relative to the product Poisson manifold structures on the source and target spaces. It follows that there is a second Poisson map related to \(\Gamma\) via the quotient algebra construction. The reduced Scovel–Weinstein map \(\Gamma _{{\mathscr {I}}}\) is the Poisson map $$\begin{aligned} \Gamma _{{\mathscr {I}}}: (B\times {\mathfrak {b}}^*)\times {\mathfrak {s}}^*_{{\mathscr {I}}}\rightarrow {\mathfrak {g}}^* \end{aligned}$$ given as the composition \(\Gamma _{{\mathscr {I}}} = \Gamma \circ [\text {id}\times \Pi _{{\mathscr {I}}}^*]\) . Theorem 3 below represents a restatement of the Poisson map property for \(\Gamma _{{\mathscr {I}}}\) within the fluid moment context. Poisson bracket on the space of truncated fluid moment vectors This Section uses Poisson-geometric and Lie-theoretic methods to identify a Poisson bracket on a space that encodes density, fluid momentum, pressure, and higher fluid moments up to some truncation order \(m_0\) . The precise relationship between the Poisson bracket constructed here and the Lie Poisson bracket on the space of distribution functions \(f\in C^*(P)\) will be described in " Hamiltonian dynamics of localized momentum distributions ". A degree- k fluid moment \(M^k\) , \(k\in \{0,1,2,\dots \}\) , is a symmetric, covariant, degree- k tensor field on configuration space \(Q{ ={\mathbb {R}}^N}\) . (Geometrically, fluid moments are naturally tensor densities 41 instead of ordinary tensors, but here these two kinds of objects are identified using the standard flat metric on configuration space.) If \(\{q^i\}_{i=1,\dots ,N}\) denotes the standard coordinate system on \(Q={\mathbb {R}}^N\) , \(M^k\) may be written as $$\begin{aligned} M^k = M_{i_1\,\dots \,i_k}\,dq^{i_1}\otimes \dots \otimes dq^{i_k},\quad M_{i_1\,\dots \,i_k}\in C^*(Q). \end{aligned}$$ Any phase space distribution \(f=f(q,p)\) that decays sufficiently fast as \(|p|\rightarrow \infty\) determines fluid moments of each degree by the formula $$\begin{aligned} M_{i_1\dots i_k}(q) = \int p_{i_1}\dots p_{i_k}\,f(q,p)\,dp. \end{aligned}$$ Conversely, under certain conditions a sequence of fluid moments \(M^k\) , \(k=0,\dots ,\infty\) , determines a distribution f . This is true, for example, when the moment generating function associated with the sequence \(M^k\) exists. A fluid moment vector with degree between \(n\ge 0\) and \(m\ge n\) is a tuple \(\varvec{M} = (M^n,M^{n+1},\dots ,M^{m})\) whose \(i^{\text {th}}\) entry is a fluid moment of degree i . Denote the set of all such fluid moment vectors \({\mathscr {M}}_n^{m_0}\) . Note that \({\mathscr {M}}_{k}^k\) is the vector space of degree- k fluid moments, and that $$\begin{aligned} {\mathscr {M}}_{n}^{m_0} = \bigoplus _{k=n}^{m_0} {\mathscr {M}}_{k}^k. \end{aligned}$$ Also note that elements of \({\mathscr {M}}_{0}^0\) are just fluid densities \(n\in C^*(Q)\) . Although specifying moments of each degree \(k=0,\dots ,\infty\) formally specifies a unique phase space distribution, specifying only the moments with degree \(k\le m_0\) does not. Additional data must be supplied to recover a distribution function from a fluid moment vector in \({\mathscr {M}}_0^{m_0}\) . In this work that additional data will comprise a scalar configuration space function \(\psi \in C(Q)\) whose derivative \(d\psi (q)\) specifies the “center” of the distribution f ( q , p ) at q . The precise goal of this Section is constructing a Poisson bracket on the space $$\begin{aligned} P_{m_0} = C(Q)\times {\mathscr {M}}_0^{m_0} = C(Q)\times C^*(Q) \times {\mathscr {M}}_1^{m_0}\ni (\psi ,n,\varvec{\mu }), \end{aligned}$$ for any non-negative integer \(m_0\) . Here the symbol \(\varvec{\mu }\) is used in place of \(\varvec{M}\) to emphasize that the moment vector \(\varvec{\mu }\) contains centered moments . The Poisson bracket on \(P_{m_0}\) originates from a Lie algebra structure on the objects dual to fluid moment vectors: fluid comoment vectors. A fluid comoment \(C^k\) of degree \(k\in \{0,1,2,\dots \}\) is a symmetric, contravariant, degree- k tensor field on configuration space Q . If \(\{e_i\}_{i\in \{1,\dots ,N\}}\) denotes the standard basis for Q (recall that \(Q={\mathbb {R}}^N\) is an N -dimensional vector space), every degree- k fluid comoment may be expressed using index notation as $$\begin{aligned} C^k = C^{i_1\,i_2\,\dots \, i_k} e_{i_1}\otimes e_{i_2}\otimes \dots \otimes e_{i_k},\quad C^{i_1\,i_2\,\dots \, i_k}\in C(Q), \end{aligned}$$ where the array of component functions \(C^{i_1\,i_2\,\dots \, i_k}\) is symmetric under index permutation. A fluid comoment vector with degree between \(n\ge 0\) and \(m\ge n\) is a tuple \(\varvec{C} = (C^n,C^{n+1},\dots ,C^{m})\) whose \(i^{\text {th}}\) entry is a fluid comoment of degree i . The vector space of all fluid comoment vectors with degree between n and \(m_0\) is \({\mathscr {C}}_n^{m_0}\) . Fluid comoments with degrees \(k=0,1,2\) will be denoted using the special symbols \(\sigma , \varvec{w}, {\mathbb {Q}}\) , respectively. The duality pairing between fluid moment vectors \({\mathscr {M}}_n^{m_0}\) and fluid comoment vectors \({\mathscr {C}}_n^{m_0}\) is given by $$\begin{aligned} \langle \varvec{M},\varvec{C}\rangle = \sum _{k=n}^{m_0} \int M_{i_1\dots i_k}(q)\,C^{i_1\dots i_k}(q)\,dq. \end{aligned}$$ By way of this pairing, the fluid moment vectors arise as the dual space to fluid comoment vectors, \({\mathscr {M}}_n^{m_0} = ({\mathscr {C}}_n^{m_0})^*\) . Fluid comoment vectors with degree between 1 and \(m_0\ge 1\) comprise a Lie algebra. This result is striking because the comoment vectors with degree between 0 and \(m_0\) do not comprise a Lie algebra! The following Theorem exhibits the relevant Lie bracket and proves that it satisfies the Jacobi identity. Theorem 2 Let \(m_0\ge 1\) be an integer. The space \({\mathscr {C}}_1^{m_0}\) of fluid comoment vectors with degree between 1 and \(m_0\) is a Lie algebra. The Lie bracket between pairs of comoment vectors \(\varvec{C}_1,\varvec{C}_2\) is given by $$\begin{aligned}{}[\varvec{C}_1,\varvec{C}_2]_{m_0}&= (B^1,B^2,\dots ,B^{m_0})\nonumber \\ B^k&= \sum _{k_1+k_2-1 = k} \bigg (k_2\,\partial _{q^I}C_1^{(i_1\dots i_{k_1}}C_2^{i_{k_1 + 1}\dots i_{k})I}-k_1\,\partial _{q^I}C_2^{(i_1\dots i_{k_2}}C_1^{i_{k_2 + 1}\dots i_{k})I}\bigg )\,e_{i_1}\otimes \dots \otimes e_{i_k}, \end{aligned}$$ (7) where the sum is over all integer pairs \((k_1,k_2)\) with \(k_1,k_2\ge 1\) and \(k_1+k_2-1 = k\) . Remark 1 This formula for the Lie bracket on \({\mathscr {C}}_1^{m_0}\) reproduces the indicial form of the so-called Schouten concomitant 41 , 42 between symmetric contravariant tensors, modulo degree \(m_0+1\) . This observation is consistent with the method of proof given below since the Schouten concomitant is the unique Lie algebra structure on symmetric tensors that makes the map sending symmetric tensors to momentum polynomials a Lie algebra homomorphism. However, note that the symmetric contravariant tensors with degree between 1 and \(m_0\) are not closed under the Schouten concomitant. Instead, these tensors possess a quotient Lie algebra structure. A similar quotient algebra structure was first noticed by Channell 36 in the context of phase space moments. Partially motivated by Channell’s observations, Holm and Tronci 25 found the Lie–Poisson bracket associated with ( 7 ) without identifying its corresponding Lie-algebraic origin. Therefore, Theorem 2 may be formulated in the following alternative manner: the Poisson bracket for fluid moments with degree between 1 and \(m_0\) presented in Holm and Tronci’s Section 2.3 is a Lie Poisson bracket for the Lie algebra whose bracket is given by ( 7 ). Finally, it is worth mentioning that this result applies on general configuration manifolds, not just the special case of linear spaces considered here. In the more general setting, the basis vectors \(e_i\) should be replaced with the the coordinate frame \(\partial _{q^i}\) associated with any system of coordinates \(q^i\) on Q . Proof First observe that for any non-negative integers \(n_1\le n_2\) there is a linear isomorphism \(I_{n_1}^{n_2}:{\mathscr {C}}_{n_1}^{n_2}\rightarrow C_{n_1}^{n_2}(P)\) between the space \({\mathscr {C}}_{n_1}^{n_2}\) and the space \(C_{n_1}^{n_2}(P)\) of momentum polynomials on phase space P with degree between \(n_1\) and \(n_2\) . If \(\varvec{C}\in {\mathscr {C}}_{n_1}^{n_2}\) then the corresponding momentum polynomial \(I_{n_1}^{n_2}(\varvec{C}) = c\in C_{n_1}^{n_2}(P)\) is $$\begin{aligned} c(q,p) = \sum _{k=n_1}^{n_2} p_{i_1}\,\dots \,p_{i_k}C^{i_1\,\dots \,i_k}(q). \end{aligned}$$ Note the the sum over comoment degree is denoted explicitly, while the sums over tensor indices are implicit. The proof now proceeds by examining momentum polynomials in place of comoment vectors. Let \(C_{{\mathfrak {s}}}(P)\) denote the smooth phase space functions that vanish when \(p=0\) . Note that \(C_1^\ell (P)\subset C_{{\mathfrak {s}}}(P)\) for each integer \(\ell \ge 1\) . The space \(C_{{\mathfrak {s}}}(P)\) a Lie subalgebra of the Lie algebra of phase space functions under Poisson bracket. This follows immediately from the discussion of Lie subgroups of contactomorphisms in " Lie theory for the contactomorphism group ". Alternatively it can be verified directly as follows. Suppose \(s_1,s_2\in C_{{\mathfrak {s}}}(P)\) . The Poisson bracket of these functions is $$\begin{aligned} \{s_1,s_2\} = \partial _{q^i}s_1\,\partial _{p_i}s_2 - \partial _{q^i}s_2\,\partial _{p_i}s_1. \end{aligned}$$ The sums on the right-hand-side each vanish when \(p=0\) because \((\partial _{q^i}s_\ell )(q,0) = \partial _{q^i}(s_\ell (q,0)) = \partial _{q^i}(0) = 0\) , \(\ell = 1,2\) . Therefore \(\{s_1,s_2\}\in C_{{\mathfrak {s}}}(P)\) , as claimed. For each integer \(\ell \ge 0\) let \({\mathscr {I}}_\ell \subset C_{{\mathfrak {s}}}(P)\) denote the phase space functions that vanish together with their first \(\ell\) momentum derivatives when \(p=0\) . If \(r\in {\mathscr {I}}_\ell\) and \(s\in C_{{\mathfrak {s}}}(P)\) the Poisson bracket \(\{r,s\}\) is $$\begin{aligned} \{r,s\} = \partial _{q^i}r\,\partial _{p_i}s - \partial _{q^i}s\,\partial _{p_i}r. \end{aligned}$$ Differentiating the first sum with respect to momentum \(\ell\) times or less produces a function that vanishes when \(p=0\) because \(\partial _{q_i}r\) vanishes together with its first \(\ell\) momentum derivatives when \(p=0\) . Differentiating the second sum with respect to momentum fewer than \(\ell\) times likewise produces a function that vanishes when \(p=0\) because \(\partial _{p_i}r\) vanishes when \(p=0\) together with its first \(\ell -1\) momentum derivatives. The only contribution to the \(\ell ^{\text {th}}\) -order momentum derivative of the second sum that does not vanish at \(p=0\) due to vanishing of \(\partial _{p_i}r\) is a product of \(\ell\) momentum derivatives of \(\partial _{p_i}r\) with \(\partial _{q^i}s\) ; \(\ell {\text {th}}\) -order derivatives of \(\partial _{p_i}r\) need not vanish when \(p=0\) . But this product vanishes when \(p=0\) because \(\partial _{q^i}s\) vanishes when \(p=0\) . Therefore \(\{r,s\}\in {\mathscr {I}}_{\ell }\) . In other words \({\mathscr {I}}_{\ell }\) is an ideal inside the Lie algebra \(C_{{\mathfrak {s}}}(P)\) for each integer \(\ell \ge 0\) . The quotient space \(C_{{\mathfrak {s}}_{m_0}}(P) = C_{{\mathfrak {s}}}(P)/{\mathscr {I}}_{m_0}\) inherits the structure of a Lie algebra because \({\mathscr {I}}_{m_0}\) is an ideal. The Lie bracket is given by Poisson bracket mod \({\mathscr {I}}_{m_0}\) . That is, if \(s_1+{\mathscr {I}}_{m_0},s_2 + {\mathscr {I}}_{m_0}\in C_{{\mathfrak {s}}_{m_0}}(P)\) then the Lie bracket is $$\begin{aligned}{}[s_1+{\mathscr {I}}_{m_0},s_2 + {\mathscr {I}}_{m_0}] = \{s_1,s_2\} + {\mathscr {I}}_{m_0}. \end{aligned}$$ There is a canonical isomorphism that sends each equivalence class in \(C_{{\mathfrak {s}}_m}(P)\) to its unique representative that is a momentum space polynomial with degree between 1 and \(m_0\) . Equivalently, \(C_{{\mathfrak {s}}_{m_0}}(P)\approx C_1^{m_0}(P)\) . Therefore \(C_{1}^{m_0}(P)\) is a Lie algebra with Lie bracket given by $$\begin{aligned}{}[c_1,c_2] = \{c_1,c_2\} \text { mod }p^{m+1},\quad c_1,c_2\in C_1^{m_0}(P). \end{aligned}$$ Here \(\text { mod }p^{m+1}\) denotes setting all polynomial coefficients with degree greater than \(m_0\) equal to 0. In particular, if \(c_1\in C_1^{m_0}(P)\) is homogeneous of degree \(k_1\le m_0\) and \(c_2\in C_1^{m_0}(P)\) is homogeneous of degree \(k_2\le m_0\) , $$\begin{aligned} c_1(q,p) = p_{i_1}\dots p_{i_{k_1}}C_1^{i_1\dots i_{k_1}},\quad c_2(q,p) = p_{i_1}\dots p_{i_{k_2}}C_2^{i_1\dots i_{k_2}}, \end{aligned}$$ the Lie bracket \([c_1,c_2]\) is given by $$\begin{aligned}{}[c_1,c_2] = {\left\{ \begin{array}{ll} 0\text { if }k_1 + k_2 - 1>m_0 \\ \bigg (k_2\,\partial _{q^I}C_1^{(i_1\dots i_{k_1}}C_2^{i_{k_1 + 1}\dots i_{k_1+k_2-1})I}-k_1\,\partial _{q^I}C_2^{(i_1\dots i_{k_2}}C_1^{i_{k_2 + 1}\dots i_{k_1+k_2-1})I}\bigg )p_{i_1}\dots p_{i_{k_1+k_2-1}} \text { otherwise.}\end{array}\right. } \end{aligned}$$ (8) Here round braces around a grouping of indices denotes averaging over all permutations of that grouping. Finally, since \({\mathscr {C}}_{1}^{m_0}\) is isomorphic to \(C_1^{m_0}(P)\) , there is a unique Lie algebra structure on comoment vectors \({\mathscr {C}}_1^{m_0}\) that makes \(I_1^{m_0}\) an isomorphism of Lie algebras. In symbols, the bracket is \([\varvec{C}_1,\varvec{C}_2]_{m_0} = (I_1^{m_0})^{-1}[I_1^{m_0}(\varvec{C}_1),I_1^{m_0}(\varvec{C}_2)]\) . Directly computing the right-hand-side of this formula with the aid of Eq. ( 8 ) reproduces Eq. ( 7 ), as claimed. \(\square\) The Lie algebra structure on the comoment vectors \({\mathscr {C}}_1^{m_0}\) with degree between 1 and \(m_0\) implies that the dual space \(({\mathscr {C}}_1^{m_0})^*\) is a Poisson manifold with a Lie–Poisson bracket. But this dual space coincides with the space of moment vectors with degree between 1 and \(m_0\) , \(({\mathscr {C}}_1^{m_0})^* = {\mathscr {M}}_1^{m_0}\) . The corresponding Lie–Poisson bracket \(\{\cdot ,\cdot \}_1^{m_0}\) on \({\mathscr {M}}_1^{m_0}\) comes very close to providing the sought-after Poisson structure on \(P_{m_0}\) . However, the degree-0 moments, those that correspond to density, are conspicuously missing from \({\mathscr {M}}_1^{m_0}\) . The scalar field \(\psi \in C(Q)\) that specifies the distribution center is also not contained in \({\mathscr {M}}_1^{m_0}\) . This shortcoming of the bracket on \({\mathscr {M}}_1^{m_0}\) , as well as the analogous bracket on phase space moments with degree between 2 and \(m_0\) , has been recognized previously 25 , 36 . Further progress comes upon noticing that the space of fluid densities \(n\in C^*(Q)\) is dual to the space of scalars \(\psi \in C(Q)\) . This means there is a natural Poisson bracket \(\{\cdot ,\cdot \}_0\) on the space \(C(Q)\times C^*(Q)\) given on pairs of functionals F , G by $$\begin{aligned} \{F,G\}_0 = \left\langle \frac{\delta F}{\delta \psi },\frac{\delta G}{\delta n} \right\rangle -\left\langle \frac{\delta G}{\delta \psi },\frac{\delta F}{\delta n} \right\rangle . \end{aligned}$$ It follows that there is a natural Poisson bracket on each of the factors in \(P_{m_0} = \bigg (C(Q)\times C^*(Q)\bigg )\times {\mathscr {M}}_1^{m_0}\) . The simplest Poisson bracket on \(P_{m_0}\) that incorporates the Lie Poisson bracket on \({\mathscr {M}}_1^{m_0}\) is therefore the direct sum $$\begin{aligned} \{F,G\}_{m_0}&= \{F,G\}_0 + \{F,G\}_{1}^{m_0}\nonumber \\&= \left\langle \frac{\delta F}{\delta \psi },\frac{\delta G}{\delta n} \right\rangle -\left\langle \frac{\delta G}{\delta \psi },\frac{\delta F}{\delta n} \right\rangle + \left\langle \varvec{\mu },\left[ \frac{\delta F}{\delta \varvec{\mu }},\frac{\delta G}{\delta \varvec{\mu }}\right] \right\rangle . \end{aligned}$$ (9) The Jacobi identity for this bracket is automatic since the direct sum of Poisson manifolds is again a Poisson manifold. Equation ( 9 ) provides the Poisson bracket for the Hamiltonian fluid moment closures presented in this Article. Its relevance to moment dynamics will be established in " Hamiltonian dynamics of localized momentum distributions ", where it will become clear that this bracket naturally addresses the shortcoming of the Lie–Poisson bracket on \({\mathscr {M}}_1^{m_0}\) in isolation. Note that, for each \(m_0\) , this bracket accommodates all fluid moments with degree less than \(m_0\) , including the density moment . Also note that there is no restriction on the dimension of configuration space N . When \(m_0=0\) , the bracket \(\{\cdot ,\cdot \}_{m_0}\) is given by $$\begin{aligned} \{F,G\}_0&= \left\langle \frac{\delta F}{\delta \psi },\frac{\delta G}{\delta n} \right\rangle -\left\langle \frac{\delta G}{\delta \psi },\frac{\delta F}{\delta n} \right\rangle , \end{aligned}$$ (10) which provides the appropriate Poisson bracket for Hamiltonian fluid closures involving \(\psi\) and n only. This is also the bracket for the Madelung transform of the Schrodinger equation. When \(m_0=1\) , with \(\mu ^1= \varvec{P}_0\) , the bracket \(\{\cdot ,\cdot \}_{m_0}\) is given by $$\begin{aligned} \{F,G\}_1&= \left\langle \frac{\delta F}{\delta \psi },\frac{\delta G}{\delta n} \right\rangle -\left\langle \frac{\delta G}{\delta \psi },\frac{\delta F}{\delta n} \right\rangle -\int \varvec{P}_0\cdot \bigg (\frac{\delta F}{\delta \varvec{P}_0}\cdot \nabla \frac{\delta G}{\delta \varvec{P}_0} -\frac{\delta G}{\delta \varvec{P}_0}\cdot \nabla \frac{\delta F}{\delta \varvec{P}_0} \bigg )\,dq, \end{aligned}$$ (11) which provides the appropriate Poisson bracket for Hamiltonian fluid closures involving \(\psi\) and fluid moments with degree \(k<2\) . Changing variables from \(\varvec{P}_0\) to \(\varvec{P} = \varvec{P}_0 - n\nabla \psi\) , the bracket is instead $$\begin{aligned} \{F,G\}_1&= \left\langle \frac{\delta F}{\delta \psi },\frac{\delta G}{\delta n} - \frac{\delta G}{\delta \varvec{P}}\cdot \nabla \psi \right\rangle -\left\langle \frac{\delta G}{\delta \psi },\frac{\delta F}{\delta n} - \frac{\delta F}{\delta \varvec{P}}\cdot \nabla \psi \right\rangle - \int \bigg (\frac{\delta F}{\delta \varvec{P}}\cdot \nabla \frac{\delta G}{\delta n} -\frac{\delta G}{\delta \varvec{P}}\cdot \nabla \frac{\delta F}{\delta n} \bigg )\,n\,dq\\&\quad -\int \varvec{P}\cdot \bigg (\frac{\delta F}{\delta \varvec{P}}\cdot \nabla \frac{\delta G}{\delta \varvec{P}} -\frac{\delta G}{\delta \varvec{P}}\cdot \nabla \frac{\delta F}{\delta \varvec{P}} \bigg )\,dq. \end{aligned}$$ Note that in this case the moment phase space is \(P_{1} = (C(Q)\times C^*(Q))\times {\mathscr {M}}_1^1\) , and that \({\mathscr {M}}_1^1\) is dual to the Lie algebra of vector fields on Q . The Lie group underlying \({\mathscr {M}}_1^1\) comprises diffeomorphisms of Q . This group acts symplectically on \(C(Q)\times C^*(Q)\) by pushforward and on \({\mathscr {M}}_1^1\) by the coadjoint action. The momentum map associated with the action on \(C(Q)\times C^*(Q)\) is \(n\,d\psi\) . The relationship between the formulas for bracket ( 11 ) expressed in terms of \(\varvec{P}_0\) and \(\varvec{P}\) may therefore be understood as a consequence of a Theorem 43 due to Krishnaprasad and Marsden. When \(m_0=2\) , with \(\mu ^2 = {\mathbb {S}}_0\) , the bracket \(\{\cdot ,\cdot \}_{m_0}\) is given by $$\begin{aligned} \{F,G\}_2&= \left\langle \frac{\delta F}{\delta \psi },\frac{\delta G}{\delta n} \right\rangle -\left\langle \frac{\delta G}{\delta \psi },\frac{\delta F}{\delta n} \right\rangle -\int \varvec{P}_0\cdot \bigg (\frac{\delta F}{\delta \varvec{P}_0}\cdot \nabla \frac{\delta G}{\delta \varvec{P}_0} -\frac{\delta G}{\delta \varvec{P}_0}\cdot \nabla \frac{\delta F}{\delta \varvec{P}_0} \bigg )\,dq\nonumber \\&\quad -\int {\mathbb {S}}_0:\bigg ( \frac{\delta F}{\delta \varvec{P}_0}\cdot \nabla \frac{\delta G}{\delta {\mathbb {S}}_0} -\frac{\delta G}{\delta \varvec{P}_0}\cdot \nabla \frac{\delta F}{\delta {\mathbb {S}}_0} \bigg )\, dq - \int {\mathbb {S}}_0:\bigg (\frac{\delta F}{\delta {\mathbb {S}}_0}\cdot \nabla \frac{\delta G}{\delta \varvec{P}_0} -\frac{\delta G}{\delta {\mathbb {S}}_0}\cdot \nabla \frac{\delta F}{\delta \varvec{P}_0} \bigg )_s\,dq, \end{aligned}$$ (12) where \(A_s = A + A^T\) for a dyad A . Changing variables from \(\varvec{P}_0\) to \(\varvec{P}\) , the bracket is instead $$\begin{aligned} \{F,G\}_2&= \left\langle \frac{\delta F}{\delta \psi },\frac{\delta G}{\delta n} - \frac{\delta G}{\delta \varvec{P}}\cdot \nabla \psi \right\rangle -\left\langle \frac{\delta G}{\delta \psi },\frac{\delta F}{\delta n} - \frac{\delta F}{\delta \varvec{P}}\cdot \nabla \psi \right\rangle - \int \bigg (\frac{\delta F}{\delta \varvec{P}}\cdot \nabla \frac{\delta G}{\delta n} -\frac{\delta G}{\delta \varvec{P}}\cdot \nabla \frac{\delta F}{\delta n} \bigg )\,n\,dq\\&\quad -\int \varvec{P}\cdot \bigg (\frac{\delta F}{\delta \varvec{P}}\cdot \nabla \frac{\delta G}{\delta \varvec{P}} -\frac{\delta G}{\delta \varvec{P}}\cdot \nabla \frac{\delta F}{\delta \varvec{P}} \bigg )\,dq\\&\quad -\int {\mathbb {S}}_0:\bigg ( \frac{\delta F}{\delta \varvec{P}}\cdot \nabla \frac{\delta G}{\delta {\mathbb {S}}_0} -\frac{\delta G}{\delta \varvec{P}}\cdot \nabla \frac{\delta F}{\delta {\mathbb {S}}_0} \bigg )\, dq - \int {\mathbb {S}}_0:\bigg (\frac{\delta F}{\delta {\mathbb {S}}_0}\cdot \nabla \frac{\delta G}{\delta \varvec{P}} -\frac{\delta G}{\delta {\mathbb {S}}_0}\cdot \nabla \frac{\delta F}{\delta \varvec{P}} \bigg )_s\,dq. \end{aligned}$$ Hamiltonian dynamics of localized momentum distributions Extending the observations of Channell 36 , Scovel–Weinstein 35 provide a technical device that can be used to relate the product Poisson bracket on \(P_{m_0} = C(Q)\times C^*(Q)\times {\mathscr {M}}_1^{m_0}\) described in " Poisson bracket on the space of truncated fluid moment vectors " to the Lie–Poisson bracket on \(C^*(P)\) that underlies the Vlasov–Poisson system. The following Theorem represents an application of that device, which was originally developed for treating phase space moments, to fluid moments. Theorem 3 Let \(\{\cdot ,\cdot \}_0\) denote the canonical Poisson bracket on the space \(C(Q)\times C^*(Q)\) . Let \(\{\cdot ,\cdot \}_1^{m_0}\) denote the Lie–Poisson bracket on \({\mathscr {M}}_{1}^{m_0}\) provided by Theorem 2 . Equip the space \(\bigg (C(Q)\times C^*(Q)\bigg )\times {\mathscr {M}}_{1}^{m_0}\) with the product Poisson bracket \(\{\cdot ,\cdot \}_{m} = \{\cdot ,\cdot \}_0 + \{\cdot ,\cdot \}_1^{m_0}\) . The mapping \(\Gamma _{m_0}:C(Q)\times C^*(Q)\times {\mathscr {M}}_{1}^{m_0}\rightarrow C^*(P)\) given by $$\begin{aligned} \Gamma _{m_0}(\psi ,n,\varvec{\mu })(q,p)&=n(q)\,\delta (p+d\psi (q)) - \mu _{i_1}(q)\,\partial _{p_{i_1}}\delta (p+d\psi (q))\nonumber \\&+ \frac{1}{2}\,\mu _{i_1\,i_2}(q)\,\partial ^2_{p_{i_1\,i_2}}\delta (p+d\psi (q)) + \dots + \frac{(-1)^{m_0}}{m!}\mu _{i_1\dots i_{m_0}}(q)\,\partial ^{m_0}_{p_{i_1}\dots p_{i_{m_0}}}\delta (p+d\psi (q)). \end{aligned}$$ (13) is a Poisson map. Remark 2 The right-hand-side of Eq. ( 13 ) recovers the ansatz ( 6 ) for the novel exact reduction of Vlasov–Poisson dynamics mentioned in the introduction. The fact that the map ( 13 ) is Poisson justifies the claim from " Poisson bracket on the space of truncated fluid moment vectors " that the bracket \(\{\cdot ,\cdot \}_{m_0}\) repairs the shortcoming of the Hamiltonian fluid moment closures due to Holm and Tronci 25 that do not include the density moment. It is interesting to note that Chong 44 previously constructed a Poisson map that sends phase space distributions into fluid-like quantities; that Poisson map appears to be unrelated to this one. Proof Let G be a Lie group with Lie subgroups \(B,S\subset G\) such that the multiplication map \(B\times S\rightarrow G:(b,s)\mapsto bs\) is a diffeomorphism. As summarized in " Scovel–Weinstein theory ", Scovel–Weinstein proved that $$\begin{aligned} \Gamma (b,b_0^*,s_0^*)= \text {Ad}^*_b(b_0^* + s_0^*), \end{aligned}$$ defines a Poisson map from the product Poisson manifold \((B\times {\mathfrak {b}}^*)\times ({\mathfrak {s}}^*)\) to the Lie–Poisson space \({\mathfrak {g}}^*\) . Here \(\text {Ad}^*_g\) denotes the (left) coadjoint action of G on \({\mathfrak {g}}^*\) . Let G be the contactomorphism group, \(B\subset G\) the fiber translations, and \(S\subset G\) the isostatic contactomorphisms, as defined in " Lie theory for the contactomorphism group ". Identify the fiber translations B with the Abelian group of scalar functions \(\psi \in C(Q)\) . Identify the Lie algebras \({\mathfrak {b}},{\mathfrak {s}},{\mathfrak {g}}\) , with configuration space scalars \(\sigma \in C(Q)\approx {\mathfrak {b}}\) , phase space functions \(s\in C_{{\mathfrak {s}}}(P)\approx {\mathfrak {s}}\) that vanish when \(p=0\) , and general phase space functions \(h\in C(P)\approx {\mathfrak {g}}\) . The dual spaces are then (distributional) configuration space functions \(n\in C^*(Q)\approx {\mathfrak {b}}^*\) , (distributional) phase space functions \({\tilde{f}}_0\in C^*_{{\mathfrak {s}}}(P)\) with zero fluid density, and general (distributional) phase space functions \(f\in C^*(P)\approx {\mathfrak {g}}^*\) . The corresponding duality pairings are the usual \(L^2\) integration pairings. Under these identifications, the Poisson map \(\Gamma : C(Q)\times C^*(Q)\times C^*_{{\mathfrak {s}}}(P)\rightarrow C^*(P)\) becomes $$\begin{aligned} \Gamma (\psi ,n,{\tilde{f}}_0)(q,p)&= \tau _{\psi *}(\pi ^*n\,\delta (p) + {\tilde{f}}_0)(q,p)= n(q)\,\delta (p + d\psi (q)) + {\tilde{f}}_0(q,p+d\psi (q)). \end{aligned}$$ Note that \(C(Q)\times C^*(Q)\times C^*_{{\mathfrak {s}}}(P)\) is endowed with the product Poisson structure corresponding to the canonical poisson bracket on \(C(Q)\times C^*(Q)\) and the Lie Poisson bracket on \(C^*_{{\mathfrak {s}}}(P)\) . As shown in the proof of Theorem 2 , the phase space functions \(r\in {\mathscr {I}}_{m_0}\) that vanish along with their first \(m_0\) momentum derivatives when \(p=0\) form an ideal in the Lie algebra \(C_{{\mathfrak {s}}}(P)\) . Therefore the quotient space \(C_{{\mathfrak {s}}}(P)/{\mathscr {I}}_{m_0} = C_{{\mathfrak {s}}_{m_0}}(P)\) has a natural Lie algebra structure and the quotient map \(\Pi _{m_0}:C_{{\mathfrak {s}}}(P) \rightarrow C_{{\mathfrak {s}}_{m_0}}(P)\) is a Lie algebra homomorphism. Also from the proof of Theorem 2 , the quotient space \(C_{{\mathfrak {s}}_{m_0}}(P)\) is naturally isomorphic as a Lie algebra to the space of comoment vectors \({\mathscr {C}}_1^{m_0}\) with degree between 1 and \(m_0\) . (The Lie algebra structure on \({\mathscr {C}}_1^{m_0}\) is the one provided by Theorem 2 .) Under this identification, \(\Pi _{m_0}:C_{{\mathfrak {s}}}(P)\rightarrow {\mathscr {C}}_1^{m_0}\) is the map that assigns to each \(s\in C_{{\mathfrak {s}}}(P)\) its weighted momentum Taylor series coefficients with degrees between 1 and \(m_0\) : $$\begin{aligned} \Pi _{m_0}(s) = \bigg (\partial _{p_{i_1}}s(q,0)\,e_{i_1},\frac{1}{2}\partial ^2_{p_{i_1}\,p_{i_2}}s(q,0)\,e_{i_1}\otimes e_{i_2},\dots , \frac{1}{m!}\partial ^{m_0}_{p_{i_1}\dots p_{i_{m_0}}}s(q,0)\,e_{i_1}\otimes \dots \otimes e_{i_{m_0}}\bigg ). \end{aligned}$$ Since \(\Pi _{m_0}\) is a Lie algebra homomorphism, the adjoint \(\Pi _{m_0}^*:{\mathscr {M}}_1^{m_0}\rightarrow C^*_{{\mathfrak {s}}}(P)\) is a Poisson mapping between Lie–Poisson spaces. A simple direct calculation leads to the explicit formula $$\begin{aligned} \Pi _{m_0}^*(\varvec{\mu })(q,p) = - \mu _{i_1}(q)\,\partial _{p_{i_1}}\delta (p) + \frac{1}{2}\,\mu _{i_1\,i_2}(q)\,\partial ^2_{p_{i_1\,i_2}}\delta (p) + \dots + \frac{(-1)^{m_0}}{m_0!}\mu _{i_1\dots i_{m_0}}(q)\,\partial ^{m_0}_{p_{i_1}\dots p_{i_{m_0}}}\delta (p). \end{aligned}$$ Since \(\Pi _{m_0}^*\) and \(\Gamma\) are Poisson maps, the composition $$\begin{aligned} \Gamma _{m_0}:C(Q)\times C^*(Q)\times {\mathscr {M}}_1^{m_0}\xrightarrow {\text {id}_{C(Q)\times C^*(Q)}\times \Pi _{m_0}^*} C(Q)\times C^*(Q)\times C^*_{{\mathfrak {s}}}(P)\xrightarrow {\Gamma } C^*(P), \end{aligned}$$ is a Poisson map as well. Evaluating the composition using the above formulas shows that \(\Gamma _{m_0}\) is the map given in the Theorem statement. \(\square\) Theorem 3 is quite powerful due to a construction 45 known as “collectivisation.” Given a Poisson mapping \(\Gamma :\Lambda \rightarrow Z\) between Poisson manifolds \(\Lambda ,Z\) , every Hamiltonian function h on Z gives rise to a corresponding Hamiltonian function \(H =\Gamma ^*h\) on \(\Lambda\) known as the “collective” Hamiltonian. Remarkably, if \(\lambda (t)\) is any integral curve for the collective Hamiltonian vector field \(X_H\) then the image curve \(z(t)=\Gamma (\lambda (t))\) is an integral curve for the Hamiltonian vector field \(X_h\) . This follows from the simple chain of identities for arbitrary \(q\in C(Z)\) : $$\begin{aligned} \frac{d}{dt}q(z(t)) = \frac{d}{dt}q(\Gamma (\lambda (t))) = \frac{d}{dt}(\Gamma ^*q)(\lambda (t)) = \{\Gamma ^*q,\Gamma ^*h\}_{\Lambda }(\lambda (t)) = (\Gamma ^*\{q,h\}_Z)(\lambda (t)) = \{q,h\}_Z(z(t)). \end{aligned}$$ In the context of fluid moments, the collectivisation construction and Theorem 3 have the following implication. Let $$\begin{aligned} {\mathscr {H}}(f) = \int \frac{1}{2m}|p|^2f\,dq\,dp + \int \frac{1}{2}e\,{\hat{V}}(n)\,n\,dq \end{aligned}$$ (14) denote the Hamiltonian for the Vlasov–Poisson system. Here \({\hat{V}}:C^*(Q)\rightarrow C(Q)\) is the self-adjoint linear operator that sends a density n to the corresponding solution V of Poisson’s equation, \(-\Delta V = 4\pi e\,{\widetilde{n}}\) , where \({\widetilde{n}}\) denotes the number density less its average. Note that \({\hat{V}} = \Delta ^{-1}\Pi\) , where \(\Pi\) denotes the projection operator that subtracts mean density. Pulling back \({\mathscr {H}}\) along the Poisson map \(\Gamma _{m_0}\) produces a collective Hamiltonian \({\mathscr {H}}_{m_0}\) on \(P_{m_0} = C(Q)\times C^*(Q)\times {\mathscr {M}}_1^{m_0}\) . If \((\psi (t),n(t),\varvec{\mu }(t))\) is any solution of the Hamiltonian system on \(P_{m_0}\) defined by \({\mathscr {H}}_{m_0}\) then \(f(t) = \Gamma _{m_0}(\psi (t),n(t),\varvec{\mu }(t))\) is an exact solution of the Vlasov–Poisson system. In other words, Theorem 3 produces exact solutions of Vlasov–Poisson with any finite number \(m_0\) of fluid moments! Moreover, the same process applies with \({\mathscr {H}}\) replaced by \({\mathscr {H}} + {\mathscr {C}}\) , where \({\mathscr {C}}\) is any Casimir for the Vlasov–Poisson system. Since the collectivisation of a Casimir need not be a Casimir, even more exact solutions can be constructed in this manner. When \(m_0=0\) , the space \(P_{m_0}\) is just \(P_0 = C(Q)\times C^*(Q)\ni (\psi ,n)\) , with the standard canonical Poisson bracket ( 10 ). Pulling back the physical Hamiltonian \({\mathscr {H}}(f)\) along \(\Gamma _0\) leads to the collective Hamiltonian $$\begin{aligned} {\mathscr {H}}_{0}(\psi ,n) = \frac{1}{2m}\int |\nabla \psi |^2\,n\,dq + \frac{1}{2}\int e\,{\hat{V}}(n)\,n\,dq. \end{aligned}$$ The functional derivatives of the collective Hamiltonian are given by $$\begin{aligned} \frac{\delta {\mathscr {H}}_{0}}{\delta \psi } = -m^{-1}\nabla \cdot (n\,\nabla \psi ),\quad \frac{\delta {\mathscr {H}}_{0}}{\delta n} = \frac{1}{2m}|\nabla \psi |^2 + e {\hat{V}}(n). \end{aligned}$$ The corresponding equations of motion are therefore $$\begin{aligned} \partial _tn&= m^{-1}\nabla \cdot (n\,\nabla \psi )\\ \partial _t\psi&= \frac{1}{2m}|\nabla \psi |^2 +e{\hat{V}}(n), \end{aligned}$$ which comprise a continuity equation coupled to a Hamilton–Jacobi equation. Solutions of the Hamilton-equation will become singular when support of the distribution function develops folds, leading to multiple streaming. While this effect is physical in cold plasma models 46 , continuing this exact closure, as well as the ones that follow in this Section, past caustic formulation will require special care. At least this lowest-degree closure may be continued past caustic formation by replacing the graph of \(\nabla \psi\) with a Lagrangian submanifold 47 , 48 , 49 , 50 . Upon introducing the velocity variable \(\varvec{v} = -m^{-1}\nabla \psi\) , these equations may be re-written as $$\begin{aligned} \partial _t(m\,n\,\varvec{v}) + \nabla \cdot (m\,n\,\varvec{v}\,\varvec{v}) = -e\,n\,\nabla {\hat{V}}(n),\quad \partial _tn + \nabla \cdot (n\,\varvec{v})=0,\quad m\,\varvec{v} = -\nabla \psi , \end{aligned}$$ which reveals equivalence with Euler’s equations for a cold, irrotational fluid. It is a well-known fact 46 that such irrotational flows correspond to exact solutions of the Vlasov–Poisson system. When \(m_0=1\) , with \(\mu ^1 = \varvec{P}_0\) , the space \(P_{m_0}\) becomes \(P_1 = C(Q)\times C^*(Q)\times {\mathscr {M}}_1^1\) equipped with the Poisson bracket in Eq. ( 11 ). Pulling back the physical Hamiltonian along \(\Gamma _1\) leads to the collective Hamiltonian $$\begin{aligned} {\mathscr {H}}_1(\psi ,n,\varvec{P}_0) =\int \frac{1}{2m n}|\varvec{P}_0 - n\nabla \psi |^2\,dq -\int \frac{1}{2mn}|\varvec{P}_0|^2\,dq + \frac{1}{2}\int e\,{\hat{V}}(n)\,n\,dq. \end{aligned}$$ The functional derivatives of the collective Hamiltonian are $$\begin{aligned} \frac{\delta {\mathscr {H}}_1}{\delta \psi } = m^{-1}\nabla \cdot (\varvec{P}_0 - n\nabla \psi ),\quad \frac{\delta {\mathscr {H}}_1}{\delta n} =\frac{1}{2m}|\nabla \psi |^2 + e{\hat{V}}(n),\quad \frac{\delta {\mathscr {H}}_1}{\delta \varvec{P}_0} = -m^{-1}\nabla \psi . \end{aligned}$$ The corresponding equations of motion are therefore $$\begin{aligned} \partial _tn&= -m^{-1}\nabla \cdot (\varvec{P}_0 - n\,\nabla \psi )\\ \partial _t\psi&= \frac{1}{2m}|\nabla \psi |^2 + e{\hat{V}}(n)\\ \partial _t\varvec{P}_0&= m^{-1}\varvec{P}_0\cdot \nabla (\nabla \psi ) + m^{-1}(\nabla \psi )\cdot \nabla \varvec{P}_0 + m^{-1}\nabla \cdot (\nabla \psi )\,\varvec{P}_0. \end{aligned}$$ Distributions in the image of \(\Gamma _1\) have momentum density \(\varvec{P} = \int p\,f\,dp = \varvec{P}_0 - n\,\nabla \psi\) and momentum flux $$\begin{aligned} {\mathbb {S}} = m^{-1}\int p\,p\,f\,dp= -m^{-1}\,\nabla \psi \,\varvec{P}_0 - m^{-1}\,\varvec{P}_0\nabla \psi + m^{-1}\,n\,\nabla \psi \nabla \psi = -m^{-1}\,\nabla \psi \,\varvec{P} - m^{-1}\,\varvec{P}\nabla \psi - m^{-1}\,n\,\nabla \psi \nabla \psi . \end{aligned}$$ In terms of these variables, the equations of motion are instead $$\begin{aligned} \partial _t(mn) +\nabla \cdot \varvec{P}=0,\quad \partial _t\varvec{P} + \nabla \cdot {\mathbb {S}} = -e\,n\,\nabla {\hat{V}}(n),\quad \partial _t\psi&= \frac{1}{2m}|\nabla \psi |^2 + e{\hat{V}}(n). \end{aligned}$$ These equations reveal that the exact reduction with \(m_0=1\) again recovers familiar hydrodynamic equations, but now with a non-trivial closure relation for the momentum flux tensor \({\mathbb {S}}\) . This Hamiltonian moment closure appears to be new, but it would be interesting to compare it with previously-derived Hamiltonian moment closures that include moments with degree \(k<2\) . When \(m_0=2\) , with \(\mu ^2 = {\mathbb {S}}_0\) , the space \(P_{m_0} = C(Q)\times C^*(Q)\times {\mathscr {M}}_1^2\) is equipped with the Poisson bracket ( 12 ). The collective Hamiltonian is $$\begin{aligned} {\mathscr {H}}_2(\psi ,n,\varvec{P}_0,{\mathbb {S}}_0)&= \frac{1}{2m}\int \text {Tr}({\mathbb {S}}_0)\,dq -\frac{1}{m}\int \varvec{P}_0\cdot \nabla \psi \,dq + \frac{1}{2m}\int |\nabla \psi |^2\,n + \frac{1}{2}\int e\,{\hat{V}}(n)\,n\,dq. \end{aligned}$$ The corresponding functional derivatives are $$\begin{aligned} \frac{\delta {\mathscr {H}}_2}{\delta \psi } = \frac{1}{m}\nabla \cdot (\varvec{P}_0 - n\nabla \psi ),\quad \frac{\delta {\mathscr {H}}_2}{\delta n} = \frac{1}{2m}|\nabla \psi |^2 + e\,{\hat{V}}(n),\quad \frac{\delta {\mathscr {H}}_2}{\delta \varvec{P}_0} =-\frac{1}{m}\nabla \psi ,\quad \frac{\delta {\mathscr {H}}_2}{\delta {\mathbb {S}}_0} = \frac{1}{2m}\eta = \frac{1}{2m}\delta ^{i_1\,i_2}\,e_{i_1}\otimes e_{i_2}. \end{aligned}$$ The equations of motion are therefore given by $$\begin{aligned} \partial _t\psi&= \frac{1}{2}m|\varvec{v}|^2 + e\,{\hat{V}},\quad \varvec{v} = -m^{-1}\nabla \psi \\ \partial _tn&= -m^{-1}\nabla \cdot (\varvec{P}_0 + m\,n\varvec{v})\\ \partial _t\varvec{P}_0&= -\varvec{v}\cdot \nabla \varvec{P}_0 - \nabla \varvec{v}\cdot \varvec{P}_0 - (\nabla \cdot \varvec{v})\varvec{P}_0 - m^{-1}\nabla \cdot {\mathbb {S}}_0\\ \partial _t\varvec{S}_0&=-\varvec{v}\cdot \nabla {\mathbb {S}}_0 - \nabla \varvec{v}\cdot {\mathbb {S}}_0 - {\mathbb {S}}_0\cdot \nabla \varvec{v} - (\nabla \cdot \varvec{v}){\mathbb {S}}_0. \end{aligned}$$ Note that these equations imply \(\partial _t\varvec{v} + \varvec{v}\cdot \nabla \varvec{v} = -\frac{e}{m}\nabla {\hat{V}}\) . Also note that the evolution equation for \({\mathbb {S}}_0\) implies \({\mathbb {S}}_0\) is Lie-transported by \(\varvec{v}\) as a degree-2 symmetric covariant tensor density. Upon introducing the conventional (non-centered) moments, $$\begin{aligned} \varvec{P}&= \varvec{P}_0 + m\,n\,\varvec{v}\\ {\mathbb {S}}&= {\mathbb {S}}_0 + m\,(\varvec{v}\,\varvec{P}_0 + \varvec{P}_0\,\varvec{v}) + m^2\,n\,\varvec{v}\,\varvec{v}, \end{aligned}$$ and performing a tedious explicit calculation, the evolution equations for \((\psi ,n,\varvec{P}_0,{\mathbb {S}}_0)\) may be re-written as $$\begin{aligned} \partial _t\psi&= \frac{1}{2}m|\varvec{v}|^2 + e\,{\hat{V}},\quad \varvec{v} = -m^{-1}\nabla \psi \end{aligned}$$ (15) $$\begin{aligned} \partial _tn&= - m^{-1}\nabla \cdot \varvec{P}\end{aligned}$$ (16) $$\begin{aligned} \partial _t\varvec{P}&= - m^{-1}\nabla \cdot {\mathbb {S}} -e\,n\,\nabla {\hat{V}}\end{aligned}$$ (17) $$\begin{aligned} \partial _t{\mathbb {S}}&= -m^{-1}\nabla \cdot {\mathscr {T}} - e\,(\nabla {\hat{V}}\varvec{P} + \varvec{P}\nabla {\hat{V}}). \end{aligned}$$ (18) These evolution equations for \((n,\varvec{P},{\mathbb {S}})\) exactly recover the first three equations in the moment hierarchy ( 5 ) with a novel closure for the third-degree fluid moment \({\mathscr {T}} = \int p\,p\,p\,f\,dp\) given by $$\begin{aligned} {\mathscr {T}}&= 3m\,\varvec{v} \odot {\mathbb {S}}_0 + 3m^2\,\varvec{v}\varvec{v}\odot \varvec{P}_0 + m^3\,n\,\varvec{v}\varvec{v}\varvec{v}\nonumber \\&= 3m\,\varvec{v}\odot {\mathbb {S}} - 3m^2\,\varvec{v}\varvec{v}\odot \varvec{P} + m^3\,n\,\varvec{v}\varvec{v}\varvec{v}. \end{aligned}$$ (19) Here \(\odot\) denotes the symmetrized tensor product, e.g. \(3(\varvec{v} \odot {\mathbb {S}}_0)_{i_1\,i_2\,i_3} = v_{i_1}\,S_{i_2\,i_3} + v_{i_2}\,S_{i_1\,i_3} + v_{i_3}\,S_{i_1\,i_2}\) . The system ( 15 )–( 18 ) admits stationary homogeneous equilibria of the form \(\psi =0\) , \(n=n_0=\text {const.}\) , \(\varvec{P}=0\) , \({\mathbb {S}} = {\mathbb {S}}_0=\text {const.}\) When \(N=1\) and \({\mathbb {S}}_0\ge 0\) , these equilibria are stable if and only if \({\mathbb {S}}_0 = 0\) . When \({\mathbb {S}}_0 > 0\) the linearized spectrum for Fourier mode k contains a pair of imaginary eigenvalues corresponding to oscillations at the Bohm-Gross frequency, $$\begin{aligned} \omega ^2 = \omega _p^2\bigg (\frac{1}{2} + \frac{1}{2}\sqrt{1 + 4 v_{\text {th}}^2\,k^2/\omega _p^2}\bigg ),\quad \omega _p^2 = \frac{4\pi \,e^2n_0}{m},\quad v_{\text {th}}^2 = \frac{{\mathbb {S}}_0}{m^2\,n_0}, \end{aligned}$$ and a pair of real eigenvalues corresponding to exponential growth and decay with rates \(\gamma\) given by $$\begin{aligned} \gamma ^2 = -\omega _p^2\bigg (\frac{1}{2} - \frac{1}{2}\sqrt{1 + 4 v_{\text {th}}^2\,k^2/\omega _p^2}\bigg )\bigg ). \end{aligned}$$ (Curiously, equilibria with \({\mathbb {S}}_0 < 0\) are linearly stable!) So the exact closure with \(m_0=2\) already begins to reflect the well-known fact that only certain homogeneous equilibria for the Vlasov–Poisson system, e.g. monotone-decreasing distributions 51 , are linearly stable. Note that the condition \({\mathbb {S}}_0 > 0\) does not imply a stable distribution; there are many linearly-unstable homogeneous Vlasov–Poisson equilibria with positive second moment. Also note that the growth rate \(\gamma =O(\sqrt{|k|})\) for large k , implying ill-posedness of the initial value problem. Physical solutions must therefore be found within the center manifolds 5 , 7 , 52 attached to these homogeneous equilibria, much as physical solutions of the Abraham–Lorentz–Dirac equation for individual electrons are contained in a center manifold 53 . Further work is needed to determine linear stability properties of homogeneous equilibria with \(N>1\) , \(m_0>2\) . It is unclear whether the data-driven Hamiltonians described in " A closure scheme for general distributions " will also require reduction to a center manifold to describe physical dynamics. Ill-posedness of the \(m_0=2\) exact reduction arises due to the short-range structure of Coulomb interactions. This can be seen by noting the large- k growth rate \(\gamma\) is proportional to the electric charge e . Regularizing short-scale Coulomb interactions therefore represents an alternative cure for the ill-posedness problem that avoids center manifolds. To regularize the Vlasov–Poisson system, first introduce a translation-invariant reproducing kernel \(K_\alpha :Q\rightarrow {\mathbb {R}}\) , where \(\alpha > 0\) is proportional to the kernel width, such as the Gaussian radial basis function $$\begin{aligned} K_\alpha (q) = (2\pi \alpha ^2)^{-N/2}\,\exp \left( -\frac{|q|^2}{2\alpha ^2}\right) . \end{aligned}$$ Now replace the usual Poisson equation \(-\Delta V = 4\pi e {\widetilde{n}}\) with the \(\alpha\) -regularized Poisson equation $$\begin{aligned} -\Delta V_\alpha = 4\pi e K_\alpha * {\widetilde{n}},\quad K_\alpha * {\widetilde{n}}(q) = \int K_\alpha ({\overline{q}})\,{\widetilde{n}}(q-{\overline{q}})\,dq, \end{aligned}$$ and use the regularized potential \(V_\alpha\) in place of V in the kinetic equation ( 1 ). This regularization corresponds to replacing point particles with extended charge distributions of diameter \(\alpha\) . Physically, this regularization is justified provided \(\alpha\) is smaller than the Debye length. The regularized system has the same Poisson bracket as the unregularized Vlasov–Poisson equation, but the Hamiltonian functional becomes $$\begin{aligned} {\mathscr {H}}^\alpha (f) = \int \frac{1}{2m}|p|^2f\,dq\,dp + \int \frac{1}{2}e\,{\hat{V}}_\alpha (n)\,n\,dq, \end{aligned}$$ where \({\hat{V}}_\alpha\) denotes the solution operator for the \(\alpha\) -regularized Poisson equation. Collectivizing \({\mathscr {H}}^{\alpha }\) along the Poisson map \(\Gamma _2\) produces an exact reduction of the regularized Vlasov–Poisson system given by Eqs. ( 15 )-( 18 ), but with \({\hat{V}}_\alpha\) in place of \({\hat{V}}\) . This structure-preserving regularization strategy should be compared with the multipole vortex blob formalism introduced by Holm and Jacobs 54 , which uses derivative-of- \(\delta\) representations for vorticity in planar ideal hydrodynamics. Linearized stability analysis of stationary homogeneous equilibria proceeds as in the unregularized case, but with the replacement $$\begin{aligned} e^2\rightarrow e^2\,{\hat{K}}_\alpha (k), \end{aligned}$$ where \({\hat{K}}_\alpha (k)\) denotes the Fourier transform of \(K_\alpha\) . Therefore, if the Fourier transform \({\hat{K}}_\alpha (k)\) decays sufficiently fast, the problematic growth of \(\gamma\) as \(k\rightarrow \infty\) disappears. For example, if \(K_\alpha\) is Gaussian then \({\hat{K}}_\alpha (k)\) decays faster than any rational function of k . The large- k behavior of the instability growth rate therefore satisfies $$\begin{aligned} \gamma ^2 = O\left( |k|\sqrt{{\hat{K}}_\alpha (k)}\right) \text { as }k\rightarrow \infty . \end{aligned}$$ In particular, \(\lim _{k\rightarrow \infty }\gamma ^2 = 0\) , as required for a well-posed problem. A closure scheme for general distributions The theory developed so far leads to a framework for constructing data-driven fluid closures of the Vlasov–Poisson system with Hamiltonian structure. This framework assumes availability of a legacy simulation code for the Vlasov–Poisson system; either particle-in-cell (PIC) codes or continuum codes will suffice. The framework presented here should be contrasted with the structure-preserving reduced-order modeling techniques developed by Hesthaven, Pagliantini, and Ripamonti 55 , 56 , 57 . Those reduced-order models assume the reduced, data-driven dependent variables admit constant symplectic or Poisson structures, or else rely on transformations to such variables. In contrast, the method presented here assumes the reduced dependent variables admit the non-constant Poisson structure provided by Scovel–Weinstein theory. In addition, the reduced dependent variables used here may either be simply related to physical quantities of interest, namely the fluid moments, or allowed to have a more flexible interpretation determined implicitly during training. Developing a closure that includes fluid moments up to degree- \(m_0\) requires a parametric energy function $$\begin{aligned} {\mathscr {H}}_W : C(Q)\times {\mathscr {M}}_0^{m_0} \rightarrow {\mathbb {R}}:(\psi ,\varvec{\mu })\mapsto {\mathscr {H}}_W(\psi ,\varvec{\mu }), \end{aligned}$$ and a model $$\begin{aligned} {\mathscr {F}}_0:{\mathscr {M}}_0^{m_0}\rightarrow C^*(P) \end{aligned}$$ that assigns a centered distribution \(f_0 = {\mathscr {F}}_0(\varvec{\mu })\) to each centered moment vector \(\varvec{\mu }\in {\mathscr {M}}_0^{m_0}\) . This terminology has been borrowed from Scovel–Weinstein 35 , who introduced the notion of a model for phase space moments. If it is deemed desireable for the variables \(\varvec{\mu }\) to be interpretable physically as centered moments, the model distribution function \({\mathscr {F}}_0(\varvec{\mu })\) must have moments compatible with \(\varvec{\mu }\) : $$\begin{aligned} \mu ^k_{i_1\,\dots \,i_k} = \int p_{i_1}\,\dots \,p_{i_k}{\mathscr {F}}_0(\varvec{\mu })\,dq,\quad k=0,1,\dots ,m_0. \end{aligned}$$ But if simple interpretability of \(\varvec{\mu }\) is not deemed a top priority then the above compatibility need not be imposed on the model; in fact one could allow the model itself to trainable. Given a field \(\psi \in C(Q)\) , the ordinary distribtion function f associated with \({\mathscr {F}}_0(\varvec{\mu })\) is \(f = \tau _{\psi *}{\mathscr {F}}_0(\varvec{\mu })\) . To fully specify the closure, the variable W that parameterizes the energy must be adjusted to an optimal value \(W^*\) . The closure itself will then comprise a Hamiltonian system on \(C(Q)\times {\mathscr {M}}_0^{m_0}\) with Hamiltonian \({\mathscr {H}}_{W^*}\) and Poisson bracket given by Eq. ( 9 ). Finding the optimal parameter value \(W^*\) proceeds as follows. Start by selecting a finite collection \({\mathscr {D}}\) of samples \((\psi ,\varvec{\mu })\in {\mathscr {D}}\) from the space \(C(Q)\times {\mathscr {M}}_0^{m_0}\) , together with a timestep parameter \(\Delta t\in {\mathbb {R}}\) . For each sample \((\psi ,\varvec{\mu })\in {\mathscr {D}}\) perform two computations. (1) Approximately evolve \((\psi ,\varvec{\mu })\) along the Hamiltonian vector field \(X_{{\mathscr {H}}_W} = ({\dot{\psi }}_{{\mathscr {H}}_W},\dot{\varvec{\mu }}_{{\mathscr {H}}_W})\) for \(\Delta t\) seconds using the forward-Euler formula $$\begin{aligned} \psi (\Delta t) = \psi + \Delta t\,{\dot{\psi }}_{{\mathscr {H}}_W}(\psi ,\varvec{\mu }),\quad \varvec{\mu }(\Delta t) = \varvec{\mu } +\Delta t\, \dot{\varvec{\mu }}_{{\mathscr {H}}_W}(\psi ,\varvec{\mu }). \end{aligned}$$ Then compute the corresponding candidate evolved moment vector \(\overline{\varvec{M}}(\Delta t) = ({\overline{M}}^0(\Delta t),\dots ,{\overline{M}}^{m_0}(\Delta t))\) , where the degree- k candidate moment is given by $$\begin{aligned} {\overline{M}}(\Delta t)_{i_1\,\dots \,i_k} = \int p_{i_1}\dots p_{i_k}\tau _{\psi (\Delta t) *}{\mathscr {F}}_0(\varvec{\mu }(\Delta t))\,dp. \end{aligned}$$ (20) Note that \({\overline{M}}^k(\Delta t)\) depends explicitly on W . (2) Reconstruct the distribution function \(f = \tau _{\psi *}{\mathscr {F}}_0(\varvec{\mu })\) . Use the legacy simulation code to find the time evolution \(f(\Delta t)\) of f . Then compute the corresponding “ground-truth” evolved moment vector \(\varvec{M}(\Delta t)\) , where the degree- k ground-truth evolved moment is given by $$\begin{aligned} {M}_{i_1\,\dots \,i_k} = \int p_{i_1}\dots p_{i_k}f(\Delta t)\,dp. \end{aligned}$$ (21) With each sample \((\psi ,\varvec{\mu })\in {\mathscr {D}}\) now processed, construct the mean-squared loss $$\begin{aligned} S(W) = \frac{1}{|{\mathscr {D}}|}\sum _{(\psi ,\varvec{\mu })\in {\mathscr {D}}} \Vert \varvec{M}(\Delta t) - \overline{\varvec{M}}(\Delta t) \Vert ^2, \end{aligned}$$ and find \(W^*\) by solving the optimization problem $$\begin{aligned} W^* = \text {argmin}\,S(W). \end{aligned}$$ In this way, the energy parameters W are chosen in order to maximize agreement between moment evolution predicted by the Vlasov–Poisson system and moment evolution predicted by the Hamiltonian hydrodynamic model for the field \(\psi\) and the centered moments \(\varvec{\mu }\) . Through application of the binomial formula for the degree- k candidate evolved moment $$\begin{aligned} {\overline{M}}^k(\Delta t) = \sum _{\ell =0}^k (-1)^\ell \begin{pmatrix} k\\ \ell \end{pmatrix} (\nabla \psi (\Delta t))^\ell \odot \mu ^{k-\ell }(\Delta t), \end{aligned}$$ (22) the W -dependence of the loss S ( W ) can be made more explicit. For example, when \(m_0=1\) , with \(\mu ^0 = n\) , \(\mu ^1 \equiv \varvec{P}_0\) , the general Hamiltonian vector field \(X_{{\mathscr {H}}} = ({\dot{\psi }}_{{\mathscr {H}}},{\dot{n}}_{{\mathscr {H}}},\dot{\varvec{P}}_{0\,{\mathscr {H}}})\) is given by $$\begin{aligned} {\dot{\psi }}_{{\mathscr {H}}}&= \frac{\delta {\mathscr {H}}}{\delta n}\\ {\dot{n}}_{{\mathscr {H}}}&= -\frac{\delta {\mathscr {H}}}{\delta \psi }\\ \dot{\varvec{P}}_{0\,{\mathscr {H}}}&= -\frac{\delta {\mathscr {H}}}{\delta \varvec{P}_0}\cdot \nabla \varvec{P}_0 - \bigg (\nabla \frac{\delta {\mathscr {H}}}{\delta \varvec{P}_0}\bigg )\cdot \varvec{P}_0 - \bigg (\nabla \cdot \frac{\delta {\mathscr {H}}}{\delta \varvec{P}_0}\bigg )\varvec{P}_0. \end{aligned}$$ The loss S ( W ) with \(m=1\) may therefore be written explicitly as $$\begin{aligned} S(W)&= \frac{1}{|{\mathscr {D}}|}\sum _{(\psi ,\varvec{\mu })\in {\mathscr {D}}} \int \left| n - \Delta t\frac{\delta {\mathscr {H}}_{W}}{\delta \psi } - \int f(\Delta t)\,dp \right| ^2\,dq\\&\quad +\frac{1}{|{\mathscr {D}}|}\sum _{(\psi ,\varvec{\mu })\in {\mathscr {D}}}\int \bigg | \varvec{P}_0 - \Delta t\frac{\delta {\mathscr {H}}_W}{\delta \varvec{P}_0}\cdot \nabla \varvec{P}_0 - \Delta t\,\bigg (\nabla \frac{\delta {\mathscr {H}}_W}{\delta \varvec{P}_0}\bigg )\cdot \varvec{P}_0 - \Delta t\bigg (\nabla \cdot \frac{\delta {\mathscr {H}}_W}{\delta \varvec{P}_0}\bigg )\varvec{P}_0\\&\quad - \left( n - \Delta t\frac{\delta {\mathscr {H}}_W}{\delta \psi }\right) \nabla \left( \psi + \Delta t\frac{\delta {\mathscr {H}}_W}{\delta n}\right) - \int p\,f(\Delta t)\,dp\bigg |^2\,dq. \end{aligned}$$ Discussion This Article has described a new method for developing fluid moment closures of the Vlasov–Poisson system with Hamiltonian structure. These closures apply in any number of space dimensions, and allow for collections of fluid moments with degree between 0 and \(m_0\) , where \(m_0\) is any non-negative integer. The closures work by introducing an irrotational velocity field \(\varvec{v}\) that specifies the “center” of the distribution function in moment space. The theory presented here leads to both novel exact solutions of the Vlasov–Poisson system parameterized by arbitrarily-large collections of fluid moments, as well as a general framework for finding data-driven fluid closures with Hamiltonian structure. Variable-moment data-driven fluid closures garner increasing attention in the machine learning community. Recent results 11 , 12 , 13 indicate that it is possible to construct such closures while strictly enforcing hyperbolicity. The results presented in the present Article therefore suggest investigation of the following intriguing question. Is it possible to develop expressive variable-moment data-driven fluid closures that strictly enforce both hyperbolicity and Hamiltonian structure? Within the closure framework presented here, such a constraint would limit the allowable forms of the closure Hamiltonian \({\mathscr {H}}_W(\psi ,n,\varvec{\mu })\) . The fluid closures presented here always include all fluid moments up to and including some maximum degree \(m_0\) . It would be interesting to determine whether these closures can be specialized to only include a subset of these moments. For example, are there subclosures with scalar pressure? This Article has treated the electrostatic limit of collisionless plasma kinetic theory. Variable-moment fluid closures with Hamiltonian structure would also be interesting to develop for the electromagnetic problem, as embodied by the Vlasov–Maxwell system 17 , 18 . Forthcoming publications will reveal that the Lie-theoretic methods used here transfer to the electromagnetic problem in a mathematically and physically appealing fashion. Other interesting applications of Scovel–Weinstein theory to fluid and phase space moments should be explored as well. For example, while the Lie algebra decomposition \({\mathfrak {g}} = {\mathfrak {b}} + {\mathfrak {s}}\) underlying the present work defines \({\mathfrak {b}}\) so it accounts for the degree-0 fluid moment, it is also possible to define \({\mathfrak {b}}\) so it accounts for fluid moments with degrees between 0 and 1. Proceeding in this manner will lead to yet another family of Hamiltonian variable-moment fluid closures, likely with interesting Casimir invariants. Similar flexibility in how the subalgebra \({\mathfrak {b}}\) is defined applies to the phase-space moment closures developed in Scovel–Weinstein’s original work, and to the electromagnetic fluid moment theory mentioned earlier. Each of the fluid closures developed here is associated with a certain direct-sum Poisson bracket \(\{\cdot ,\cdot \}_{m_0}\) . (See Eq. ( 9 ).) It would be useful to identify Casimir functions for this bracket and use them to study stability of solutions using the energy-Casimir method 58 . Finding the Casimirs would also be a necessary step when including dissipation in the fluid closures presented here using a metriplectic 20 bracket. As mentioned in the introduction, Tassi 22 , 23 , 24 has found variable-moment fluid closures for slab drift-kinetic systems. But the methods used by Tassi to find closures are seemingly unrelated to the Lie-theoretic methods of Scovel–Weinstein. Is it possible to find Tassi’s drift kinetic closures using Scovel–Weinstein theory 35 as was done for the closures presented here? An affirmative result might suggest a path toward variable-moment gyrofluid closures for more intricate gyroaveraged kinetic theories such as full- f gyrokinetics 59 , 60 , 61 . In a similar vein, it would be interesting to determine whether the closures presented here can be understood as limits of the multiple waterbag reductions described by Perin et al. 33 . More broadly, this Article suggests that the methods developed by Scovel–Weinstein 35 in the context of beam dynamics apply to a wider class of dissipation-free statistical closure problems than originally envisioned. There are many possible extensions. For example, consider the problem of solving the functional Vlasov equation for a variational weakly-nonlinear wave equation with random initial data. The algebra of functionals on the field-theoretic phase space enjoys a canonical Poisson bracket. By decomposing this algebra into affine functionals and functionals that vanish together with their first functional derivatives for the vacuum state, Scovel–Weinstein theory may be applied. The result will be Hamiltonian evolution equations for a finite collection of field correlation functions. These non-dissipative correlation dynamics do not seem to have been studied previously. In fact any dynamical system with an underlying Lie–Poisson Hamiltonian structure stands to benefit from the Scovel–Weinstein reduction method. Interestingly, combining Scovel–Weinstein with an analogue of phase space moments for the ideal compressible Euler equations appears to produce an extended theory of smoothed-particle hydrodynamics 62 .