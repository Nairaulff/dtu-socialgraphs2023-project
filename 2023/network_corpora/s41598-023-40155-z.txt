introduction genome wide association study traditionally carried using cross-sectional data one outcome time advent global biobanks direct-to-consumer genomic testing longitudinal health data recorded diverse clinical aspect individual opened door statistically rigorous genome-wide association modeling availability data make possible discover novel genetic variant associated trajectory trait change disease progression within individual well pleiotropic variant impacting multiple phenotype mixed model approach choice analysis longitudinal data account variability measurement across multiple time point one phenotype well variability among measurement multiple phenotype mixed model commonly used approach handling relatedness conventional gwas e.g implemented emma gemma saige mixed model may also used model multiple-traits longitudinal phenotype computational efficiency may difficult achieve analysis large-scale cohort due fact mixed model approach require complex task estimating variance component setting solving large system equation requires inversion large matrix associated random component mixed model sikorska introduced computationally efficient approach utilize mixed model longitudinal gwas approximate approach shown precise estimating cross-sectional longitudinal effect snp cross-sectional effect comparable conventional gwas longitudinal effect define snp may impact change trait time effort simplify computation longitudinal gwas researcher often collapsed multiple measurement one rate change earliest latest measurement individual rate change fed conventional gwas workflow association phenotype investigated independently collapsing approach historically discussed found theoretically problematic due loss information individual assessed multiple correlated phenotype multivariate approach jointly evaluate phenotype shown statistically rigorous addition availability repeated measurement phenotype individual affords opportunity ass genetic effect change disease trait biomarkers time despite advantage longitudinal multiple-trait approach provides identifying genetic determinant disease disease progression implementation method also known computationally burdensome current study extend mixed model approach gallop longitudinal phenotype multiple-trait setting approach efficiently model multiple correlated phenotype well multiple measurement recorded time evaluate computational efficiency approach well ability identify variant association would otherwise missed conventional gwas framework quantitative trait repeated measure 16,622 biobank participant assessed method obtain inverse large matrix also introduced effort maximize computational efficiency multiple-trait longitudinal gwas material method standard gwas test association variant risk disease extreme value quantitative trait high cholesterol longitudinal gwas test association genetic variant progression disease change quantitative biomarker disease time single-trait longitudinal gwas fit genetic variant one-by-one mixed model includes genetic effect variant interaction time interval baseline addition model may include time-dependent covariates age weight time-independent covariates sex following equation model single phenotype individual time point =\mu +\sum_ cov ij\tau +\sum_ cov i\gamma common effect time point genetic variant cross-sectional longitudinal effect representing genotype dosage individual time-dependent covariates time-independent covariates and\ individual random intercept slope effect cov ij\tau value covariate associated individual time point age bmi cov i\gamma value covariate associated observation individual genetic sex following standard gwas single longitudinal phenotype multiple-trait longitudinal gwas explored shown improve statistical power discovery type analysis multiple correlated trait jointly modeled missing record implicitly inferred based covariance trait multiple-trait longitudinal gwas typically performed step estimating variance component constructing component mixed-model equation performing association analysis first genetic environmental variance covariance estimated using null model without genotype utilized transformed version henderson mixed model equation used minor modification hypothesis testing variant separately following multiple-trait evaluation framework outlined ref single- multiple-trait mixed model written solution obtained solving linear system difference single- multiple-trait model specification fixed random incidence matrix genetic residual variance matrix respectively starting modeling single trait using following mixed model vector fixed random effect respectively vector random residual mvn\left mvn estimate prediction obtained solving following system mixed model equation array array array array =\left array array accommodate trait following change made component array cccc array k\in k\right\ -dimensional vector phenotype number measurement per trait =\left array cccc 0\\ 0\\ 0\\ array sometimes denoted fixed effect incidence matrix trait identity matrix order operator defines kronecker product matrix different number column trait different covariates fixed effect may also set missing measurement zero number row maximum number record trait =\left array cccc 0\\ 0\\ 0\\ array corresponding trait block diagonal matrix block number time point individual =n\ number record per trait make matrix dimension number individual study block constructed first column adjust individual-level cross sectional random effect time interval second column adjust individual-level longitudinal random slope value second column difference time baseline every subsequent observation individual thus top time interval corresponding baseline observation always number row block match number time point data available individual row inserted missing measurement exist one trait matrix large square matrix order 2nk\ nk\ respectively instead directly inverting employed following identity inverse kronecker product k\times residual covariance matrix trait identity matrix order =\left array cccc array identity matrix order kk^ kk^ covariance block genetic covariance matrix cross-sectional longitudinal effect trait fig matrix estimated pairwise fashion every trait generating k\times k-1 bi-trait analysis variance component estimation figure inverse genetic variance covariance matrix among trait kk^ submatrix corresponds block pairwise covariance cross-sectional longitudinal effect trait full size image computationally efficient average information restricted maximum likelihood ai-reml utilized estimating variance component single covariance effect every trait k-1 variance effect trait generated inverting recursive partitioning simplify computation single-trait case sikorska used eigen decomposition block diagonal matrix transform linear system large lower right submatrix becomes identity matrix decomposition suitable multiple-trait case longer block diagonal matrix arrived similar system transformed pre-multiplying system array 0\\ array trivial construct approach inversion recursive partitioning developed matrix partitioned recursively along block-diagonal submatrices inverse carried swiftly matrix =\left array array block-diagonal submatrices denoted square submatrices inverse obtained using identity =\boldsymbol array array block identity applied recursively moving one row column submatrices round inverse current round stored used inverse growing submatrix next round shown fig started inverting lower-right corner submatrices round used inverse larger submatrix round i.e process continued entire matrix inverted save computing storage inverse obtained current round substituted submatrix next round note matrix needed next round figure schematic inversion recursive partitioning inverse lower-right corner submatrices integrated next round inverse greater etc note round e.g replaced submatrix needed round +1\ full size image current multiple-trait model inverse obtained using proposed recursive partitioning computing time resource direct sparse inverse technique see result following reason first index nonzero element matrix inverse significantly improved efficiency sparse storage second block diagonal structure algebraic combination preserved throughout recursive process including intermediate step make necessary invert block within submatrix combination thus block diagonal round inverse obtained inverting diagonal block within submatrix finally matrix inverse symmetric one off-diagonal combination need computed i.e. one needed association analysis association analysis performed process slightly different ref principle linear system solved variant including equation variant first set equation i.e bordering system inverse calculated using recursive approach described pre-multiplied linear system transform equivalent system identity matrix place large submatrix shown equivalent system solved solution vector array array stored identity matrix inverting left-hand side partitioning fast array 0\\ array array array array array =\left array array array array =\left array array non-symmetric left-hand side matrix system denoted array array right-hand side array array note inverting dense matrix still trivial small order equivalent number trait multiplied number fixed-factor equation let construct solve system equation one snp added null model bordering system shown array c|cc array array snp array =\left array array structure snp equation multiple-trait longitudinal gwas straightforward extension single-trait structure matrix expressed identity matrix order matrix cross-sectional longitudinal effect corresponding trait first column simply vector genotype element individual repeated time second column equal first column multiplied time system solved element snp standard error extracted diagonal element coefficient matrix inverse expressed array array array snp array =\left array array following snp standard error snp obtained =\sqrt diag clearly include cumbersome expression particularly inverse large matrix however following similar approach ref simply solution system discussed earlier need calculated stored solution replacing right-hand side therefore inverse never calculated explicitly finally p-values associated element snp obtained double area standard normal density integration limit snp simulation study power type error multiple-trait longitudinal gwas individual cross-sectional component simulated =\sum_ longitudinal component simulated =\sum_ cross-sectional longitudinal effect respectively snp genotype individual snp jth time point individual time point considered interval year baseline phenotype value individual time constructed cov overall mean regression coefficient scaled time time-independent covariate cov finally random residual component corresponding individual time point three correlated trait considered current simulation effect snp use vector =\left array cccccc array denote effect snp simulated trait cross-sectional longitudinal genetic effect respectively snp trait k\in 3\right\ genetic effect sampled multivariate normal distribution mvn\left =e\left =\mathrm var e\left set 10.0 e\left e\left l\ge scalar used simulate longitudinal effect smaller equal cross-sectional effect represented array array =\left array ccc array array ccc array var array ccc -7\\ -1\\ 18\end array var var covar array ccc 0.5 0.4 -0.35\\ 0.4 0.6 -0.05\\ -0.35 -0.05 0.9\end array finally residual covariance matrix simulated equal value covariance matrix cross-sectional effect resulted heritability value slightly baseline heritability exceeded simulation due addition longitudinal genetic component simulation strategy chose reduce covariance cross-sectional longitudinal effect tested multiple ratio cross-sectional longitudinal effect setting value study effect power type error 10,000 snp genotype simulated individual causal snp drawn random simulate background genetic effect infinitely small effect drawn mvn non-causal snp studied effect sample size 1,000 10,000 multiple trait longitudinal gwas power type error variant allele count within genotype time category tested i.e minimum allele frequency vector constructed multiplying available genotype dosage variant time interval required exceed divided number individual sample allele frequency sampled beta distribution shape parameter =10\ minimum allele frequency threshold set 0.01 adding 0.01 frequency generated finally genotype dosage randomly independently sampled genetic variant hardy–weinberg probability analysis blood biomarkers biobank data biobank prospective cohort study rich genetic health data half million participant biobank study carried accordance relevant guideline regulation approved national research ethic service approval letter dated 17th june ref 11/nw/0382 participant study gave full informed signed consent first second measurement blood biomarker trait biobank participant european ancestry evaluated cross-sectional longitudinal association imputed array genotype phenotype assessed biobank field table field excluded due low sample size participant sample size individual measurement field remaining biomarkers ranged 12,203 16,622 participant age ranged year interval baseline first repeat measurement ranged year median year imputed array genotype biobank filtered retaining binary non-monomorphic snp minor allele frequency greater hardy–weinberg equilibrium phenotype transformed using rank-based inverse normal transformation clinical demographic covariates time interval principal component ancestry scaled mean variance trait clustered cluster according magnitude direction correlation trait simple hierarchical clustering correlation matrix using ward method performed cluster size ranged trait within cluster analyzed jointly using gamut comparison data also analyzed using single-trait approach gallop addition first principal component ancestry covariates included time sex year birth year birth squared year birth sex interaction assessment center whether individual taking cholesterol-lowering medication time blood sampling covariates differed across measurement trait example assessment center time different first second measurement whereas cholesterol-lowering medication considered cholesterol ldl direct apolipoprotein addition statin list medication cholesterol-lowering drug considered included inhibit cholesterol absorption intestine pcsk9 inhibitor patient heterozygous familial hypercholesterolemia hefh heart disease may need statin compare gallop gamut approach evaluates snp association rate change single value per individual derived difference two measurement divided time interval measurement gwas model rate change include time included baseline measurement scaled covariate covariates across method studied model rate change included without baseline time well addition baseline time triglyceride primary care biobank data test impact comorbidity number repeated measure longitudinal gwas outcome triglyceride extracted primary care data referred general practice data measure participant european ancestry diagnosed coronary artery disease cad age using available clinical history information extracted biobank data dataset included nearly 99,000 observation individual measure per participant average period year comparable group individual 3–35 repeated measure per individual randomly selected biobank cohort purpose comparison objective evaluate reliability benefit controlling disease interfering biomarker measure quality longitudinal effect onset disease trait trajectory might perturbed way impairs detection true genome-wide longitudinal signal single trait longitudinal gwas run dataset impact comorbidity quality estimate reported mixed model two datasets adjusted cholesterol-lowering drug might lower triglyceride well result power type error simulation four sample size one two three ten thousand individual simulated addition longitudinal cross-sectional ratio ratio scenario simulated replicated time ratio scenario simulated individual sample size scenario simulated effect effect ratio 1:5 data set simulated analyzed gamut gallop shown fig power detect causal effect consistently smaller effect fact sample size 10,000 power analysis exceed left panel fig due fact effect simulated much smaller effect likely common scenario seen real world data right panel fig validates impact lt/cs ratio longitudinal gwas power figure statistical power identifying causal variant using gamut power shown sample size left panel longitudinal cross-sectional ratio right panel power shown calculated average phenotype replicates per scenario power detecting causal longitudinal effect smaller cross-sectional effect particularly relatively smaller longitudinal effect sample size simulation left panel based 1:5 ratio resulted consistently lower longitudinal curve full size image bonferroni-corrected significance threshold calculated 0.05 divided total number variant scanned type error realized simulation taken proportion non-causal variant p-values bonferroni-corrected significance threshold table show average type error effect estimated gamut sample size ratio scenario type error sufficiently small similar genome-wide value table gamut average type error associated sample-size lt-ratio scenario full size table study statistical power multiple- versus single-trait approach standard error variant two simulation run compared first run value assigned randomly missing one three phenotype second run randomly selected record set missing phenotype standard error consistently smaller multiple trait analysis especially greater proportion data missing addition fig show gamut particularly useful testing effect seen greater standard error gallop fig relative corresponding effect fig result shown fig phenotype missing record phenotype non-missing data impacted figure standard error multiple-trait gamut versus single-trait gallop two scenario one missing record another missing record simulated phenotype gamut consistently reduced standard error genetic variant scanned phenotype missing record dotted line slope gamut std error equivalent value full size image standard error shown reduced variant causal noncausal power type error associated multiple- vs. single-trait approach studied scenario individual missing baseline second record figure show multiple trait advantage proportion individual data partially measured one phenotype completely measured two single-trait case directly impacted sample size partially measured phenotype analysis run without individual missing record multiple-trait case analysis run individual long measured least phenotype boosted statistical power note fig show performance two approach using phenotype missing record type error shown controlled simulation ranged 5.97e-06 1.82e-05 versus theoretical average 7.34e-06 figure cross-sectional longitudinal statistical power estimate simulated scenario individual missing single-trait approach missing individual directly impacted sample size significantly reduced power phenotype missing data relative multiple-trait approach utilized correlation trait compensate reduction sample size simulation sample size missing record ratio set 1:5 full size image benchmarking gamut biobank data performance gamut vs. approach context real-world data shown next gamut result compared single-trait longitudinal approach using gallop single-trait conventional gwas phenotype rate change using regenie variant detected approach reported following section benchmarking data included blood biomarkers biobank individual measurement least one biomarker utilized analysis system setup association time inversion recursive partitioning highly efficient greatly reduced system setup time trait inversion recursive partitioning took vs. 21.6 min using direct sparse inversion trait inversion recursive partitioning took 2.2 min vs. extrapolated min consumed direct sparse inversion fig direct sparse inversion possible carry machine inversion recursive partitioning greatly improved efficiency setting mixed model system equation figure actual time direct sparse inversion inversion recursive partitioning -–1 trait runtime direct sparse invasion extrapolated min vs. 2.2 min actual runtime inversion recursive partitioning direct inversion highly exponential versus recursive inversion nearly linear number trait full size image cluster trait gamut efficient gallop fig extrapolation run-time cost gamut exceeded run-time cost gallop trait fig trait modeled independently single-trait approach jointly multiple-trait approach run-time cost linear gallop exponential gamut developed implemented method high performance computing environment cpu core ram inversion system setup ram scanning genetic variant difference performance reported inversion recursive partitioning vs. direct sparse inversion large enough observed hardware figure total system setup association time single- multiple-trait run modeled trait largest cluster multiple-trait analysis far run-time efficient vs. single-trait despite following exponential curve extrapolated time trait analysis multiple-trait cost exceeded single-trait trait full size image variance component estimation blood biomarker data running gamut total pair-wise variance component set estimate obtained using ai-reml although variance trait estimated multiple time paired trait covariance estimated unique variance biomarker trait genetic variance–covariance matrix order averaged across trait pairwise covariance unique residual variance covariance trait similarly summarized variance averaged pairwise covariance unique although variance estimated multiple time consistent especially component boxplots fig show trait study variance significantly smaller variance reflected expected number significant longitudinal association found i.e reduced power discover longitudinal association also validated simulation current study cross-sectional longitudinal heritability estimate obtained proportion total variance attributed polygenic variance respectively fig cross-sectional heritability value shown fig calculated var var var var residual longitudinal heritability value plotted fig calculated var var var var residual note polygenic heritability obtained using null model without snp effect block diagonal covariance matrix genetic relationship matrix grm figure polygenic cross-sectional variance estimated trait pairwise fashion lipoprotein produced highest variance testosterone showed least genetic variance longitudinal variance variance estimated alongside variance using ai-reml ldl direct cholesterol apolipoprotein glucose greatest variance testosterone near-zero longitudinal variance cross-sectional polygenic heritability estimate longitudinal polygenic heritability estimate polygenic variance heritability estimate generally much greater indicating cross-sectional association expected identified polygenic variance heritability estimate relatively consistent compared lt. full size image weakest variance component estimated testosterone measured sex figure show covariance correlation testosterone every trait cross-sectional longitudinal residual component despite low variance component estimated trait correlation biologically sound shown strong genetic correlation testosterone sex hormone binding globulin shbg protein produced liver attache sex hormone men woman figure polygenic residual covariance correlation testosterone biomarker trait sorted covariance cross sectional variance component estimate showing shbg circled point scatter plot trait strongest correlation shbg protein made liver bind sex hormone sex longitudinal variance component estimate showing shbg among top correlated trait indicating parallel progression genetic level two trait show residual variance component estimate high shbg correlation strong genetic correlation full size image similarly genetic residual correlation positive strong among ldl direct apolipoprotein cholesterol cluster-4 fig result indicate significant pleiotropy exists variant associated level biomarkers well progression trait also share large common environmental component indicated strong residual correlation figure cross-sectional genetic longitudinal genetic residual correlation cluster biomarker trait genetic residual correlation positive strong among ldl direct apolipoprotein cholesterol correlation plot thin line reflect strong correlation thick line toward oval circular shape indicate weaker correlation toward full size image longitudinal gwas result longitudinal genome-wide association scan performed biomarker phenotype multiple-trait longitudinal run using gamut single-trait longitudinal run using gallop conventional run using conventional gwas biomarker rate change first second measurement presented table clumping performed outcome approach studied using 0.4 window p-value threshold 5e-8 number significant snp table taken number clump found across genome summed biomarkers table number significant p-value 5e-8 variant associated cross-sectional longitudinal biomarker trait using multiple-trait single-trait longitudinal gwas well conventional rate change gwas full size table collectively gamut resulted total significant cross-sectional longitudinal association whereas single-trait longitudinal gwas resulted cross-sectional longitudinal association conventional gwas rate change yielded significant longitudinal association across biomarker phenotype agreement gamut gallop consistent i.e cross-sectional longitudinal variant identified gallop subset identified gamut little overlap conventional gwas two method variant identified rate change gwas observed cross-sectional association two approach example variant associated rate change direct total bilirubin fact identified cross-sectional longitudinal association trait using gallop gamut additionally variant identified rate change gwas generally significant cross-sectional association uncovered two approach fig suggests approach fitting rate change effective method identifying true longitudinal association additional association revealed gallop gamut highlight effectiveness approach identifying variant association trait level change trait time independent variant revealed gamut gallop conventional gwas rate change provided supplementary table respectively figure cross-sectional p-values biomarker trait variant clumping significant variant conventional rate change gwas variant clumping indicated red triangle significant cross-sectional variant captured conventional gwas rate change full size image cholesterol apolipoprotein ldl direct identified genetically correlated trait based polygenic variance component fig log-transformed p-values cross-sectional effect three trait shown fig notice great similarity trait term signal chromosomal location number independent pleotropic variant shared cholesterol apolipoprotein cholesterol ldl direct apolipoprotein ldl direct respectively figure manhattan plot cross-sectional variant genetically correlated trait analyzed jointly using multiple-trait longitudinal gwas full size image cross-sectional effect well powered consistent biomarker gwas literature e.g ref longitudinal progression effect hand difficult validate still provided multiple clinical insight particular variant chromosome rs117268014 captured gamut cross-sectionally longitudinally associated direct total bilirubin variant vicinity gremlin1 gene grem1 shown qtlbase blood expression qtl rho gtpase activating protein 11a arhgap11a gene positioned near grem1 methylation qtl eukaryotic translation initiation factor 5a2 eif5a2 gene whose overexpression correlate multiple cancer including colorectal gastric esophageal cancer overexpression gene reported correlate cancer progression poor survival note also role grem1 well established onset prognosis colorectal gastric cancer particular role promoting colorectal cancer cell metastasis motility invasion longitudinal gwas triglyceride cad-diagnosed patient vs. random sample unlike single trait outcome across random biobank sample cross-sectional longitudinal genetic signal table limiting longitudinal gwas cad-diagnosed patient many repeated triglyceride measure time resulted identification multiple genome-wide significant cross-sectional longitudinal signal seen manhattan plot fig cad-diagnosed patient sampled across time restricted diagnosed blood sample taken biomarker measure using random group across disease inflation observed particularly longitudinal effect seen bottom panel fig multiple signal identified compared blood biomarkers study table highlight importance utilizing many repeated measure per individual increase power control inflation mixture healthy individual patient included longitudinal gwas disease-related trait recommend adding blocking fixed factor model adjust comorbidity given group restricted cad patient diagnosed point lifetime reduced noise longitudinal gwas signal triglyceride level polygenic risk score cad case could serve stratifying factor include longitudinal gwas model enhance outcome control inflation absence disease diagnosis data figure manhattan plot cross-sectional longitudinal variant primary care triglyceride repeated measure cad-diagnosed patient multiple genome-wide significant hit identified two effect type full size image figure manhattan plot cross-sectional longitudinal variant chromosome primary care triglyceride repeated measure cad-diagnosed patient top panel vs. randomly selected sample bottom panel homogeneous sample cad show much inflation random sample full size image discussion current study efficient powerful approach identify genetic variant associated cross-sectional longitudinal effect developed approach capitalizes availability broad phenotyping individual assessed multiple clinical trait well deep phenotyping characterized multiple measurement trait time gamut successfully modeled multiple-trait longitudinal aspect data maximizing computational efficiency outperforming single-trait longitudinal analysis trait examined imperative emphasize multivariate analysis inherently computationally costly cumulative cost equivalent univariate analysis computational advantage multivariate approach trait explained first algorithmic difference gamut gallop transforming major random effect matrix mixed model equation identity second build transform coefficient matrix trait approach particularly useful joint analysis strongly correlated trait measured real-world data collected time handling missing value longitudinal data cumbersome gamut provides framework missing record one trait implicitly estimated based genetic environmental covariance trait complete data longitudinal effect likely much smaller cross-sectional effect seen biobank blood biomarker data sample size required detect genetic variant associated disease progression expected manyfold greater required cross-sectional disease association shown simulation order current approach useful essential sufficient data multiple time point per individual e.g primary care data repeated measure extended large-scale clinical trial addition biobank continues ass participant two time point thousand trait repeat mri imaging study brain heart abdomen although simulation suggest multiple-trait approach offer limited advantage single-trait analysis presence complete data missing observation scenario unlikely exist either observational real-world data collection prospective clinical trial current biomarker analysis longitudinal variant association genome-wide significance suffered inflation possible reason first longitudinal effect order magnitude smaller cross-sectional counterpart second number individual repeated measurement limited finally time point within individual visit current biobank phenotypic data inflation shown controlled sample participant similar clinical history many repeated measure extracted biobank primary care data utilized longitudinal gwas paper demonstrate gamut computationally efficient framework account genetic environmental co-variability multiple longitudinally assessed quantitative trait although univariate modeling approach successfully used identify important disease association also miss novel insight fail leverage correlation among pathophysiological process lead disease onset progression shown case analysis real-world data biobank multiple cross-sectional longitudinal insight would remained undetected using standard statistical method assert approach broad applicability large-scale collection data available global biobanks prospective clinical study today