introduction river common basic source water many organism play important role domestic water use agricultural irrigation industrial development due interaction river surrounding environment well exchange urban industrial agricultural pollutant along way problem river pollution becoming serious water quality prediction assessment essential protection human environmental health effective sustainable water resource management although water quality testing performed using traditional technique method method usually time-consuming expensive accurate recent year technology water quality modeling prediction based machine learning deep learning method widely used achieved better prediction result traditional model based statistical analysis method mainly include multiple linear regression mlr autoregressive autoregressive integrated moving average arima sarima model etc jiang proposed water quality prediction method combining arima clustering model taking water quality monitoring data basin sample total phosphorus index water quality selected prediction object water quality change basin successfully predicted mohamed elhag used adjusted arima sarima model predict water quality parameter verified sarima model could effectively predict water quality parameter seasonal characteristic however model capture nonlinear characteristic data resulting low prediction accuracy poor applicability model machine learning regression analysis method mainly include support vector regression svr random forest regression rfr bayesian network decision tree artificial neural network ann neural network etc theyazn carried water quality prediction research based machine learning algorithm support vector machine svm k-nearest neighbor k-nn naive bayes ayesha jasmin developed dissolved oxygen prediction model using three popular machine learning algorithm including random forest adaboost deep neural network model deal nonlinear feature data certain extent prediction ability model limited application deep learning model water quality prediction mainly focus recurrent neural network rnn lstm bi-lstm gru cnn model etc development technology hybrid deep learning model developed applied cnn-lstm attention-bi-lstm model etc sakshi khullar used deep learning bi-lstm method predict water quality yamuna river india yurong yang proposed water quality prediction model combining convolutional neural network cnn long short-term memory network lstm attention mechanism strong ability solve nonlinear time series prediction problem although feature extraction ability long-term memory ability model improved integrating cnn attention model problem gradient disappearance long training time still effectively solved order solve problem existing model improve accuracy water quality prediction first used filter eliminate noise original water quality data decomposed water quality data trend seasonal residual series based stl time series decomposition method decomposed trend residual series separately used model training prediction better realize extraction feature bai proposed tcn model introduces causal convolution dilated convolution residual block compared rnn model tcn doe gradient vanishing problem longer memory capacity tcn support parallel computation mean weight layer updated simultaneously time step significantly improving model computational efficiency tcn model integrates feature convolution processing capability cnn model time series information mining capability recurrent neural network widely studied applied variety time series forecasting problem load forecasting wind speed forecasting current research demonstrated superiority tcn model traditional machine learning algorithm well lstm gru model variety task datasets therefore model tcn used extract long-term dependency sequence time order improve performance tcn model solve problem local information loss tcn model combine self-attention mechanism tcn model model pay attention feature contribute output stronger feature extraction ability paper contribution summarized follows use filter smooth time series river water quality thereby eliminating strong noise data enhancing availability data based characteristic river water quality data use stl decomposition technology decompose original water quality data three sub-series trend seasonality residual better retains seasonality series improves prediction accuracy model tcn model improved self-attention mechanism added residual block structure tcn improve feature extraction ability model proposed river water quality prediction model tested two real river water quality data set compared commonly used water quality prediction model verifies method achieve best prediction effect methodology overall structure workflow model shown fig proposed model structure collected water quality time series firstly smoothed filter eliminate strong noise data smoothed data decomposed stl decomposition technology obtain three sub-series seasonality trend residual trend series residual series obtained decomposition input improved tcn model feature extraction trend series prediction value residual series prediction value retained seasonal series fused obtain final prediction result model finally predicted value compared real value model evaluated series evaluation criterion figure overall structure workflow model full size image savitzky-golay filter smoothing denoising original time series data effectively improve accuracy prediction therefore study used filter remove noise original water quality time series filter filtering method based local polynomial least square fitting time domain biggest feature filter ensure shape width signal unchanged filtering noise subsequence window size w=2m+1\ expressed s-m s+m s\in m+1 t-m\right polynomial p\left i\right order used fit data point window defined follows p\left i\right =\sum_ v=0 i\in m\right denotes v-th coefficient filter use least square method minimize error =\sum_ i=-m p\left i\right s+i find best fit p\left 0\right window center point computing sliding window point series become center point window value series smoothed finally get smoothed sequence stl time series decomposition method order better extract trend characteristic nonlinear characteristic river water quality time series retain seasonal trend characteristic series used stl decomposition technology decompose original water quality time series seasonal trend decomposition using loess stl general robust decomposition method time series loess method estimating nonlinear relationship stl aim decompose time series data certain time trend season residual denoted algorithm consists outer loop inner loop outer loop mainly used assign robust weight data point residual reduce influence outlier inner loop nested outer loop mainly doe trend fitting periodic component calculation process k-th epoch inner loop follows detrending remove trending component original series get cycle-subseries smoothing cyclic-subseries obtained step smoothed loess resulting preliminary seasonal series denoted k+1 low-pass filtering sequence k+1 obtained step processed moving average loess regression obtain result sequence k+1 equivalent extracting low-pass periodic subsequence detrending smoothed cycle-subseries calculate seasonal trend k+1 k+1 k+1 deseasonalizing subtract periodic component k+1 trend smoothing loess regression performed cycled series obtained step obtain trend component k+1 inner loop reach accuracy requirement outer loop start residual component k+1 calculated estimated trend seasonal component outer loop calculation method follows k+1 k+1\right k+1 improved tcn model temporal convolutional network tcn based traditional one-dimensional fully convolutional neural network model combine causal convolution dilated convolution residual block structure model ability extract feature time series achieve prediction effectively solve performance degradation problem deep network process network training figure show standard tcn residual block structure including dilated causal convolution weight norm relu activation function dropout regularization dilated causal convolution used feature extraction weight norm regulate input hidden layer counteract gradient explosion problem network relu activation function introduces nonlinearity model dropout regularization operation randomly drop neuron according certain probability prevent overfitting accelerate model training speed input residual block output residual block expressed follows o=activation\left x+f\left x\right activation\ activation function residual since residual practice stacked layer deep learning network always learn new feature learning performance deep network degrade figure standard tcn residual block structure improved tcn residual block structure tcn network structure adopted full size image casual convolution originally proposed wavenets network since traditional cnn model directly deal sequence problem causal convolution abstract sequence according t-1 predict make close actual value compared recurrent neural network rnns model using causal convolution use recurrent connection thus allowing time series data input parallel make network training faster greater advantage amount data large however order expand receptive field neural network neuron standard causal convolution many network layer need stacked large convolution kernel need used order solve problem limited receptive field standard causal convolution tcn combine dilated convolution causal convolution dilated casual convolution dcc increase receptive field neuron without causing significant increase computational cost one-dimensional dilated causal convolution operation expressed follows f\left s\right i=0 k-1 s-di input sequence filter also known convolution kernel dilation factor size convolution kernel s-di\ ensures past input convolved figure show dilated causal convolution structure dilation factor d=\mathrm 1,2 ,4\ well convolution kernel k=2\ figure dilated causal convolution dilation factor 1,2,4 kernel full size image attention mechanism mainly simulation form human brain attention allocation essence assign weight different feature hidden layer highlight influence important feature self-attention mechanism improvement attention mechanism aim capture internal correlation data improve prediction ability model structure self-attention mechanism shown fig consists query key value vector obtained multiplying input data three matrix proposed model transformation water quality data attention matrix used determine feature attention calculated attention\left v\right =softmax\left refers matrix transpose refers dimension figure self-attention structure diagram full size image add self-attention convolutional unit tcn residual block structure improved tcn residual block structure shown fig based improved residual block structure basic structure deep tcn model adopted paper shown fig model consists input layer improved residual block output layer input layer mainly receives decomposed water quality time series data two stacked residual block structure used increase depth model make model training adequate output layer fully connected layer receives output vector tcn model calculates predicted value empirical analysis dataset model evaluation criterion opensource dataset environmental estuary water quality monitoring data burnett river queensland australia obtained queensland government open data portal raw data contains measurement temperature dissolved oxygen electrical conductivity turbidity chlorophyll concentration water measured 30-min interval experiment mainly predict dissolved oxygen concentration value extracted dissolved oxygen concentration data original data separately resampled data daily basis however missing data data resampling used mean value fill missing data private data set used experiment liao river automatic monitoring station china data set contains dissolved oxygen concentration measurement recorded every january august similarly original data set resampled daily basis missing value data filled mean value effectively evaluate model root mean square error rmse mean absolute error mae mean absolute percentage error mape used measure difference predicted value true value smaller error value closer predicted value true value higher prediction accuracy model calculation formula follows rmse=\sqrt t=1 mae=\frac t=1 mape=100\times t=1 represents sequence length represent true predicted value model time respectively data smoothing use filter smooth noise present water quality data two important parameter filter determine ability filter remove noisy data window size value noted value must positive odd integer value set large remove temporal feature sequence small used reduce noise sequence value indicates point window fitted k-order polynomial value large lead least square overfitting small lead underfitting therefore order get better filter set variety different parameter combination determine best parameter combination according rmse result shown table table result different parameter combination filter full size table according table window size set value set filter obtains smallest rmse value datasets determine best parameter combination experiment stl data decomposition decompose smoothed data using stl technique decompose original time series trend seasonal residual series experiment decomposition time series realized calling stl method statsmodels class library decomposition result water quality data burnett river shown fig decomposition result water quality data liao river shown fig figure decomposition result water quality data burnett river decomposition result water quality data liao river full size image order verify used correct time series decomposition method observed residual distribution mean value time series according fig residual value two water quality data show approximate normal distribution mean value shown decomposition method adopted correct figure residual distribution burnett river water quality data residual distribution liao river water quality data full size image model training prediction next train proposed model based trend series residual series obtained decomposition make prediction take data set training set test set data set normalized min–max normalization method experiment take water quality data first day input model output predicted value next day sliding window size prediction step size order prove prediction ability proposed model set baseline model compare model including support vector regression svr long short-term memory network lstm temporal convolutional network tcn tcn self-attention model model tested environment evaluation criterion adopted comparative analysis main parameter setting model test shown table table parameter setting model full size table result analysis prediction result burnett river water quality data various prediction model shown table according table result proposed model best among various evaluation indicator prof model higher prediction accuracy better prediction ability order show gap predicted result various model real monitoring value intuitively show predicted value real value curve comparison prediction result curve various prediction model data set shown fig table prediction result water quality data burnett river full size table figure prediction curve water quality data burnett river various model full size image table show prediction result various comparison model liao river water quality data according table prediction result svr model worst prediction result tcn model better lstm prediction ability tcn model addition self-attention greatly improved prediction result model data set still best indicating model stronger generalization ability model good application prospect field river water quality prediction comparison prediction curve various prediction model data set shown fig table prediction result water quality data liao river full size table figure prediction curve water quality data liao river various model full size image conclusion water quality prediction model important water environment management however due complex variable characteristic water environment periodicity nonlinearity water quality data great challenge accurately predict water quality therefore study propose hybrid improved temporal convolutional network model combine filter stl time series decomposition method tcn model self-attention mechanism use filter remove noise water quality data use stl decomposition method decompose water data trend seasonal residual series improve residual block structure standard tcn model add self-attention mechanism improve prediction ability tcn model finally use opensource water quality data private water quality data conduct experimental verification result show proposed model higher prediction accuracy several commonly used benchmark model water quality prediction model proposed present study predict water quality change river future period accurately thus helping manager make early warning water pollution take necessary measure advance deal water pollution problem better protect water environment limitation study model take historical water quality data model input doe consider influence relevant feature data therefore next step analyze influence different external factor water quality change consider feature input model improve practicability model real scenario addition continue use water quality data different river different pollutant evaluate prediction ability model optimize model structure explore larger prediction step carry in-depth research long-term series prediction