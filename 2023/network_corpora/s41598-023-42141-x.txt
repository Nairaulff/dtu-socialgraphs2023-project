introduction electricity consumption forecasting essential numerous activity managing electricity network investment production planning trading electricity market reducing power wastage suit activity forecast performed different horizon short-term hour day long-term year different scale individual national new variability electricity load recently emerged due several factor new decentralized production unit like solar panel new actor opening french electricity market new like electric mobility covid-19 pandemic bring essential change electricity consumption forecasting model must updated take account numerous forecasting approach proposed forecast electricity consumption global energy forecasting competition gefcom provides overview method include classical time series approach auto-regressive integrated moving-average arima exponential smoothing used forecast very-short term hours-ahead statistical machine learning approach gradient boosting neural network provide better forecast using exogeneous variable especially larger horizon indeed judging electricity demand human activity predicted using explanatory variable important one weather calendar data particular generalized additive model gam widely applied forecast electricity consumption yielding good result recently state-space approach investigated adapt gam time online model allows gam adapt new variability covid-19 pandemic improve forecast finally variety model motivates predicting demand combination forecaster yielding better final prediction individual model aggregation expert also shown good result load forecasting aggregation expert online method combine prediction given expert weighed sum weight evolve time paper investigates day-ahead electricity load forecasting distribution network france electricity consumption measured 2,200 substation located frontier high voltage grid distribution network precisely data accessible enabling local level forecasting forecasting multiple time series important task many industry like retail car sharing electricity management several competition tackled problem ashrae competition forecasting multiple building energy consumption makridakis competition leading interesting finding among one important importance cross-learning multiple time-series improve accuracy underlined finding competition forecasting multiple time series usually tackled using two kind approach local method estimate one model independently time series global method fit unique model jointly local method used problem past global approach shown perform well especially increasing model complexity particular extensive comparison two approach tested forecasting building consumption computationally two approach face different cost issue local approach require time train model easily parallelized however cost producing forecast trained model requires saving maintaining updating large number model hindrance hand global approach harder parallelize easier maintain since one model required end global approach added advantage useful forecasting new time series data available paper builds-up local approach aiming alleviate computational maintenance constraint associated end trade-off must found accuracy amount parameter computational complexity computational efficiency longstanding research issue optimization objective get desired estimation shortest amount time get best estimation fixed amount time interesting subfield online optimization objective use streaming data update model recursive efficient manner computational time cost remain important incentive efficient machine learning method motivation gained attention recent year energy consumption environmental goal sparsity improve interpretability use data respect privacy avoid costly data collection transmission trade-off performance efficiency previously referred frugal machine learning case study paper original forecasting method learns individual model time series therefore computational time energy consumption grow linearly number time series considered reducing time learning process operational advantage also pave way application even local consumption extreme individual household leading numerous time series case learning process would become infeasible reduce computational burden paper adopts transfer learning point view represented diagram fig individual model trained time series relying gam adaptive variant based state-space model model learned small fraction time series transferred instead training individual model time series using aggregation expert transfer tool precisely base model applied time series even trained aggregating weak forecaster yield procedure able scale large number time series several aggregation built involving different kind model transfer learning occurs multiple level figure transfer learning aggregation expert two step individual model trained time series small compared number time series forecast time series model m_1\ m_2\ ... m_e\ applied resulting forecast combined using aggregation expert full size image paper discus computational cost aggregation type focus frugal nature indeed optimization individual model large number time series costly aggregation expert shown presented method compete individual gam even first french lockdown due covid-19 achieving low computational cost transfer learning aggregation expert also studied hierarchical setting using regional load data source national load data target contribution may summarized follows building local gam model propose use adaptive state-space model transfer learning based aggregation expert alleviate constraint associated local approach mainly term maintenance computing cost leading frugal model performs better individual model added benefit usable new time series minimal historical depth end first propose different way transfer model learned time series others introduce way use several model learned several time series combine forecast time series finally apply approach electricity load french substation distribution network following introduction methodology section establishes method used paper data model presentation section introduces data model applied result forecasting task analysed experiment section finally conclusion section summarises paper proposes future work methodology section first characterises forecasting problem transfer learning framework principle aggregation expert detailed along use transfer learning finally different model considered paper resulting aggregation method introduced transfer learning context transfer learning approach taken paper expressed using definition vocabulary used transfer learning method first essential provide definition domain task domain composed feature space marginal distribution instance set x_i task composed label space decision function given m_s ^+\ source domain task target domain task transfer learning use knowledge within source domain task improve performance target decision function substation represents one target whose decision function varies substation decision function thus m_t 1344\ transfer learning task corresponding one forecasting task result multi-task transfer learning situation hand several source used transfer m_s resulting multi-source transfer learning method investigated forecasting problem may characterised homogeneous inductive transfer learning terminology indeed homogeneous transfer learning scenario occurs source target feature space equal well source target label space explanatory variable calendar meteorological variable past electricity load equally available substation range thus feature space mutual label space _+\ corresponding electricity measurement range concerning inductive transfer learning happens labeled data available target domain induce target decision function present case transfer learning using aggregation expert natural idea apply transfer learning context could determine subsample m_s\ data set build one individual model per data set select best among m_s\ model m_t\ substation forecast information best model unavailable one way estimate aggregation expert aggregation expert context aim predict bounded sequence observation y_1 y_n unknown using forecasting model called expert time step provide forecast _t^e e=1 ^e\ observation y_t\ aggregation e=1 _t^e\ computed weight e=1 ^e\ updated online according past performance expert forecast error measured convex loss function y_t goal minimise so-called regret r_t t=1 y_t t=1 y_t _t^\star _t^\star given oracle model use unavailable information build forecast difficult beat regret difference error suffered aggregation error oracle latter best-fixed convex combination expert best-fixed expert constant time used algorithm present work ml-poly algorithm successfully applied electricity load forecasting implemented package opera algorithm track best expert best convex combination expert giving weight expert generate low regret make algorithm particularly interesting parameter tuning needed transfer learning aggregation expert considered parameter-based transfer learning method indeed aim produce multiple source learner model introduced next section combining create specific target learner adaptive expert paragraph detail individual model aggregated gam adapted kalman filtering proposed section considers forecasting one time series generalized additive model generalized additive model gam assumes response variable y_t\ expressed following sum aligned y_t f_d aligned _0\ intercept _t\ model error time d=1 ^d\ explanatory variable available time f_d d=1 ^d\ linear nonlinear smooth function called gam effect effect f_d\ expressed projection aligned f_d k=1 m_d aligned k=1 m_d spline basis dimension m_d\ k=1 m_d corresponding coefficient estimated ridge regression following criterion minimized aligned t=1 y_t d=1 f_d d=1 f_d aligned penalty term control second derivative f_d force effect smooth c_1\ denotes computational cost gam estimation adaptation kalman filter adapt gam multiplicative correction following gam effect vector x_t t,1 ^\top applied _j\ normalized version f_j\ obtained subtracting mean train set dividing standard deviation adaptation obtained assuming state-space property satisfied precisely vector _t\ called state estimated assumption aligned y_t _t^\top x_t _t\ aligned aligned t+1 _t\ aligned gaussian white noise respective variance covariance ^2\ starting gaussian prior assuming variance ^2\ known kalman filter achieves estimation state _t\ bayesian method step state posterior distribution obtained gaussian distribution _t\mid x_s y_s p_t kalman filter depends initial parameter p_1\ prior variance ^2\ hyper-parameters chosen maximizing likelihood training set using iterative greedy procedure described chapter choice hyper-parameters referred dynamic setting computational cost noted c_2\ large detailed experimental study thanks transfer learning costly estimation hyper-parameters avoided time series another interesting setting called static ^2=1\ p_1 case state equation becomes t+1 =\theta _t\ estimate _t\ equivalent ridge forecaster aligned arg min s=1 t-1 y_s ^\top x_s aligned model considered previously mentioned estimation gam kalman variance computationally costly applied time series hand computational time due kalman update neglected proposed method reduces number gam kalman variance estimated hybrid expert thus defined different part forecaster trained different time series gam trained data set kalman variance optimized dynamic setting data set resulting adapted model applied data set range m_t\ particular denotes non-adapted gam i,0 adapted gam static setting variance optimized three basic model without transfer learning model optimized substation data forecast k,0 scenario traditional machine learning three model involving transfer learning considered simple transfer gam transfer source data set used train gam resulting gam applied different target data set corresponds model immediate improvement previous model adaptation transferred gam kalman filter optimized data set used train gam result model adaptation step help gam transfer improves basic gam finally kalman filter transfer case data set forecast used train gam adapted kalman filter optimized another data set model aggregation model previously said estimation kalman variance dynamic setting computationally costly e.g training model goal avoid individual training time series moreover although computational cost gam effect estimation smaller desirable train reduce cost number model parameter three aggregation method built based three previous model transfer learning occurs provided model considered section agg gam obtained aggregation n_1~ model agg gam-kalman n_2~ model agg kalman n_3~ model data set used train gam kalman filter aggregation method randomly chosen among data set table detail three aggregation method two individual adapted gam specifies transfer involved type model used computational cost corresponding gam kalman variance estimation judging gam kalman filter aggregation application computationally cheap overlooked aggregation method parameter n_i\ unique hyper-parameter method corresponds number source m_s\ must small possible compared m_t 1344\ force frugality method table description individual adapted model aggregation method considered case study c_1\ c_2\ correspond computational cost gam kalman variance estimation respectively m_t\ number target transfer learning context n_i\ number expert three aggregation method give order magnitude application parameter n_i\ inferior m_t 1344\ full size table data model presentation firstly french local electricity consumption explanatory variable introduced model detailed practical point view definition gam formula training kalman filter construction aggregation method guarantee data confidentiality substation identity provided electricity load represented different figure normalized average load presentation data electricity load data data provided enedis operator charge electric power distribution france data composed time series electricity consumption one substation represented blue fig figure location substation blue weather station red map created thanks package ggplot2 version 3.4.2 http map version 3.4.1 http full size image cover metropolitan france reflect thus local electricity consumption forecasting substation consumption involves m_t 1344\ forecasting task data available june 1st december 31st 30-minute temporal resolution although time series present classical temporal meteorological pattern counter-intuitive contrary variation figure comparison one substation basic behavior two substation unusual behavior operational constraint data availability fixed load previous day labeled d-1\ becomes available day forecasting day d+1\ given temporal resolution data forecast made instant day forecast instant made load instant previous day available independently instant word forecasting strategy sequential online choice forecasting context crucial impact quality forecast figure electricity load march three substation averaged daily load averaged weekly load substation expected daily weekly pattern load ordinarily high daylight especially people home low night similar weekday drop weekend hand substation opposed daily behavior night load increasing week maximal weekend substation show high load mid-afternoon load still important night concerning weekly load drop friday addition weekend full size image explanatory variable explanatory variable meteorological calendar variable chosen common practice electricity load forecasting weather variable obtained météo-france french public institution meteorology climatology composed temperature cloudiness wind measurement weather station temperature represented degree celsius cloudiness amount cloud cover measured octas wind measured meter ground expressed meter per second weather station unequally spread metropolitan france represented red fig weather data available range electricity consumption hour temporal resolution data transformed minute temporal resolution thanks linear interpolation temperature highly correlated electricity load different impact cold hot region shown fig two pattern due use electrical heating air-conditioning system france highly electric consuming generate localized datasets substation nearest weather station paired creating substation-specific datasets local weather data aspect consider within forecasting context availability weather variable prediction process operational condition weather variable used model forecasted since future weather yet available hand article operates assumption day weather variable day d+1\ already available setup clearly unfeasible operationally hold significance two main reason first context day-ahead forecasting weather input would weather forecast next day assumed accurate thus close actual weather next day second objective disentangle forecasting error induced quality weather forecast external factor beyond control error linked forecasting model similar setting weather data availability discussed highlight importance good temperature forecast operational condition concerning calendar variable gather indicator school holiday region bank holiday working day well instant day time year day week french region divided three zone zone calendar school holiday factor taken consideration constructing model figure dependence electricity consumption time year temperature blue value substation north france red value one south france full size image time segmentation data range june december training validation model performed data december 31st test done afterwards test set includes covid-19 observation three lockdown period france second third lockdown considered normal period electricity consumption strongly varies first lockdown see fig three validation period thus chosen first lockdown first lockdown march 16th may 11th figure weekly moving average electricity load one substation full size image generalized additive model formula build gam one must determine formula explanatory variable spline base use used test period different test achieved forward-backward heuristic assumption made single gam formula could used target forecasting task indeed although substation behavior different explained explanatory variable finally gam applied instant day gam optimized forecasting task unique following gam formula obtained aligned aligned y_t i=1 daytype_t i=1 bankholiday_t i=1 f_i toy_t workingday=i f_3 trend_t f_4 temp_t f_5 temp95_t f_6 temp99_t f_7 tempmin_t tempmax_t load2d_t load1w_t aligned aligned time step y_t\ electricity load considered instant daytype_t\ categorical variable indicating type day five category monday tuesday thursday friday saturday sunday bankholiday_t\ binary variable indicating whether day bank holiday school holiday depending region relevant substation toy_t\ time year whose value grow linearly 1st january midnight 31st december 23h30 workingday_t\ binary variable indicating whether day working day i.e. weekend day bank holiday trend_t\ number current observation temp_t\ measured temperature closest weather station temp95_t\ temp99_t\ exponentially smoothed temp_t\ variable factor 0.95\ 0.99 e.g 0.95\ given time step temp95_t temp95_ t-1 temp_t\ tempmin_t\ tempmax_t\ minimal maximal value temp_t\ current day load2d_t\ load1w_t\ load day load week _t\ gaussian noise mean constant variance model short-term model term electricity past consumption availability thus called gam model called gam also considered model without load2d_t\ load1w_t\ effect case _t\ auto-correlated error term also examined case arima autoregressive integrated moving average model chosen selecting best model aic criterion family arima correcting residual mid short-term gam arima model achieves performance therefore straightforward mid-term formula chosen explained redundancy correcting auto-correlated residual arima model linear lag term short-term gam following model called gam arima thin plate spline basis low dimension represent effect except f_1\ f_2\ indeed time year cyclic impact see fig therefore cyclic cubic spline basis dimension employed gam effect estimation done using generalized cross validation criterion take ten second practice thus computationally reasonable train individual gam many forecasting task finally gam trained using package mgcv kalman filtering section examines kalman filtering adaptation previous short-term gam static setting one apply one individual adapted gam forecasting task kalman variance estimation necessary called gam kalman static traditional machine learning context model optimized data set forecasted execution time essential dynamic setting unavoidable operational constraint decision made calculate kalman variance subsample substation subsample chosen represent variety difficulty forecasting first substation sorted according performance nmae see section experiment short-term gam prediction substation corresponding worst performance put aside provide interesting expert allows dividing substation group substation sample substation randomly drawn group ultimately subsample representative substation obtained reflecting forecasting difficulty parallel computing corresponding set kalman variance 36-core virtual machine 2014–2018 data take 1.6 day computation individual kalman variance would thus last day similar setting parameter sampling method optimized two reason first would require significant amount computational time associated emission contradicts frugal philosophy article second assumed sampling method low impact final quality forecast compared model parameter like number expert used aggregation two set kalman variance calculated substation subsample one 2014–2018 data 2014–2019 data first set used set aggregation hyper-parameters n_i\ validation set second set used forecast 2020–2021 test set thus gam adapted individual kalman variance case corresponding model called gam kalman dynamic shown experiment section aggregation method achieve equivalent performance kalman filter estimation application achieved using package viking aggregation reminder three aggregation method found aggregation model section table section focus application aggregation method unique hyper-parameter n_i\ number expert aggregation also number source transfer learning task said previously m_s\ smallest possible compared m_t 1344\ grid search performed data validation set forecast representative substation carried different value n_i\ corresponding median computed representative substation obtained way substation used optimize kalman variance result presented fig aggregation becomes gradually robust increase number expert randomness substation selection compute gam effect kalman variance moreover elbow phenomenon n_1 n_2 agg gam agg gam-kalman n_3 agg kalman value n_i\ little compared m_t 1344\ figure grid search number expert n_1\ agg gam n_2\ agg gam-kalman n_3\ agg kalman full size image experiment section model analysis provided thanks visualization plot performance substation data set compared using comparative metric model dynamic aggregation method first analyzed expert scale gam effect scale expert scale one might want know expert important mixture distribution weight expert studied forecast produced substation indeed higher weight important corresponding expert forecast one expert important forecast specific observation others give example fig represents boxplots weight agg gam-kalman aggregation three interesting instant day consumption behavior different representation deduced expert essential three instant day median near uniform weight 1/9 hand expert weight vary according instant day instant expert low importance least weight close great importance least weight close 0.5 bigger figure boxplot representation weight agg gam-kalman aggregation three instant day target forecasting task full size image another way analysing importance expert focusing forecast see expert used aggregation figure display evolution weight agg gam-kalman aggregation two specific substation midday previous conclusion observed expert little impact aggregation others important new information figure provide evolution expert importance aggregation example fig exp4 weight increase becomes paramount importance weight superior 1/2 last observation fig exp7 vanishes rapidly impact exp1 increase exp5 exp9 contribute little first observation quickly absent aggregation figure weight associated expert agg gam-kalman aggregation midday substation substation expert denoted exp forecasting period first lockdown full size image gam effect scale visualization evolution state coefficient kalman filtering done precisely plotting curve corresponding gam effect figure provides example evolution state coefficient adapted gam first lockdown observed coefficient associated bias f_2 toy effect modeling time year working day significant compared others evolve rapidly concerning bias coefficient evolve balance gap source load used train gam target load different scale finally state coefficient evolve significantly like bankholiday daytype others seem time-invariant extend visual diagnosis tool case agg kalman one express aggregation gam adapted hybrid state coefficient d=1 ^d\ aligned k=1 e=1 d=1 f_d d=1 k=1 f_d d=1 f_d aligned time e=1 denotes hybrid state coefficient number expert number gam effect weight associated expert adaptation coefficient associated gam effect f_d\ expert new expression allows gathering information adaptation aggregation improving interpretation whole model figure represents evolution hybrid state coefficient first lockdown target forecasting task fig one therefore compare kalman coefficient d=1 ^d\ individual model hybrid state coefficient d=1 ^d\ calculated n_3 model coefficient type coefficient differ amplitude dynamic bias coefficient still important compared others evolve rapidly case f_2\ coefficient considering aggregation method entire mixture expressed gam using linear combination gam effect new coefficient spline basis composed basic coefficient spline basis adaptation coefficient aggregation weight figure evolution state coefficient kalman model d=1 ^d\ hybrid state coefficient agg kalman aggregation d=1 ^d\ first lockdown target forecasting task full size image numerical result compute numerical performance model normalized mean absolute error nmae used defined time series y_t _t\ forecast _t\ test set aligned nmae =\frac t\in _t| t\in aligned mean absolute error ground truth forecast normalized absolute mean time series metric allows compare forecast different scale necessary case study individual nmae computed time series nmae chosen rather mean absolute percentage error time series sometimes close precisely percentage nmae examined multiplying table numerical performance forecasting task normalized mean absolute error nmae mean first quartile median third quartile full size table performance individual aggregation model displayed table first compared improvement performance referenced respect three respective validation period noted information past electricity load added gam formula great importance significant improvement gam gam 1.84 2.83 3.13 median also gain gam residual modeled arima model improvement gam gam arima 0.77 1.46 1.70 median gam kalman static provides slightly weaker performance gam arima latter thus individual benchmark beat concerning aggregation method agg gam show worst performance however model still interesting performance close gam performance computational cost much lower hand two aggregation method show excellent close performance agg kalman better agg gam-kalman outside first lockdown improvement median 0.03 0.07 opposite first lockdown decrease 0.16 gap two last model significant agg gam-kalman complex agg kalman considered best compromise forecasting performance computational cost compared gam arima best individual model median performance improve 0.62 1.54 0.84 figure show evolution median error month three model considered initial model best individual model best aggregation indicates except month january final model consistently better benchmark figure median percentage nmae month three model gam gam arima agg gam-kalman full size image explained transfer learning using aggregation expert section aggregation algorithm aim beating two oracle best-fixed expert best-fixed convex combination expert called expert oracle convex oracle respectively performance computed agg gam-kalman displayed table aggregation competes best-fixed expert approach best-fixed combination expert said two aggregation method concerning test period one see forecast worsen first french lockdown downgrade 2.18 two gam arima median performance agg gam-kalman agg kalman present lower downgrade 1.26 1.45 median respectively online nature kalman filtering aggregation expert allow adaptation extreme change electricity consumption hand gam gam performance worsen model updated consumption behavior evolves downgrade significant 1.37 2.36 median respectively performance gap first lockdown tighter adaptative model especially two best aggregation method 0.22 0.18 median respectively show aggregation method adapt well data distribution evolution table numerical performance representative forecasting task normalized mean absolute error nmae mean first quartile median third quartile full size table figure analysis agg gam-kalman performance forecasting task show sorted percentage nmae represents spatial distribution dot correspond substation location four category legend correspond first quartile 4.44 median 5.33 third quartile 6.96 map created thanks package ggplot2 version 3.4.2 http map version 3.4.1 http full size image table provides performance forecasting task precisely correspond substation used optimize set kalman variance reduced substation providing expert involved three aggregation allows comparison aggregation method gam kalman dynamic previously said gam kalman dynamic achieves great performance forecasting national electricity load thus competitive model best one among individual model however requires large amount time estimate remarkable agg gam-kalman agg kalman perform similarly much computationally costly finally distribution nmae score depicted fig geographical distribution fig interesting notice best forecasted substation close urban area like paris marseille lille bordeaux whereas worst forecasted located rural area conclusion paper frugal method proposed forecast multiple electricity load estimation individual model per time series avoided resulting scalable methodology based aggregation expert limited computational resource chosen expert gam adapted kalman filtering performed well electricity consumption forecasting aggregation method allow transfer gam kalman filter separately simultaneously paper demonstrates provide good forecast compared competitive model especially first french lockdown moreover need human intervention expertise thus simple use method frugal term parameter estimation computational cost discussed extensively finally benefit interpretability gam aggregation expert various way extend work presented paper first random selection time series used train gam kalman variance improved cluster substation may identified according characteristic geographic weather type consumer one representative selected per cluster second way improvement inclusion new explanatory variable local scale geo-tracking communication data reflect human behavior therefore helpful electric consumption forecasting paper focused learning model single time series transferring one may possible transfer model trained several substation one could easily train gam jointly several time series concatenating data set however trivial learn kalman hyper-parameters using several substation due sequential structure state-space model finally computational complexity method introduced essentially depends estimation fixed number model objective obtain scalable forecasting method therefore one could apply method larger data set instance electrical consumption finer granularity