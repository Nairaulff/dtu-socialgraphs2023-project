introduction intracranial hemorrhage cause bleeding within brain tissue life-threatening cerebral disease high incidence mortality rate non-contrast computed tomography scan first imaging modality diagnose intracranial hemorrhage ich due rapidity convenience sensitivity blood location volume hemorrhage derived crucial neurosurgeon make operation plan volume ich predictor mortality secondary hemorrhage expansion automatic intracranial hemorrhage segmentation fundamental task assist radiologist quantification hemorrhage volume shape analysis recent development show deep convolutional neural network cnn powerful medical image analysis existing method pay attention following related problem ich normal detection ich sub-types detection hemorrhage region segmentation cnn model significantly improved performance providing framework end-to-end representation learning large amount data training validation test data set used evaluate generalization performance method benefit powerful feature extraction ability convolution neural network achieve promising performance however existing cnn-based method tend suffer performance degradation due lack spatial relationship large amount data beyond cnn capsule network extends using vector matrix representative unit instead scalar cnn vector preserve equivariance whole capsule network length orientation represent probability property entity evidence capsule network powerful representative ability cnn shown initial experiment sharing weight improving dynamic routing algorithm method remain high computational overhead reduce amount computation maintaining segmentation performance capsule network still open problem paper propose effective approach referred groupcapsnet intracranial hemorrhage segmentation firstly inspired group convolution widely used reduce convolution calculation introduce group concept accelerate capsule network reduce memory consumption immediate vote capsule capsule forwarding procedure output capsule receives group input capsule proportion whole input propose modify squashing function faster computing speed without diminishing performance contribution paper contribution summarized follows propose group capsule accelerate capsule network reduce memory consumption immediate vote capsule modified squashing function also suggests replace original one groupcapsnet achieves comparable result existing method intracerebral hemorrhage segmentation task comprehensive experiment conducted show superior performance group capsule network compared non-group counterpart convolutional neural network related work section briefly highlight recent related work including ich region segmentation capsule network group concept used cnn ich region segmentation either segmentation dense prediction voxel level ich required calculate volume ich grad-cam used employed produce highlighted map ich map coarse adopted guidance interpretation neural network radiologist accurate ich segmentation map obtained training full convolution network fcn supervised learning manner chilamkurthy used u-net based approach segment ich intraparenchymal iph intraventricular ivh subdural sdh extradural edh subarachnoid sah hemorrhage manvel explored variant u-net method test time augmentation ensembling strategy segment ich three projection i.e. axial coronal sagittal islam proposed ichnet facilitating hypercolumn feature dilated convolutional layer incorporating conditional random field smoothen segmentation prediction ironside evaluated deeper variant u-net ich volumetric analysis method based cnn especially u-net although inherent shortcoming cnn capsule network capsule feature stored vector matrix preserve equivariance length orientation vector represent probability property entity presented input forwarding capsule next layer input capsule produce vote capsule capsule next layer matrix transformation procedure requires additional computational cost large memory consumption resulting inability apply larger deeper capsule network tackle drawback capsule trainable weight matrix within local spatial kernel type capsule reasonably shared addition capsule-pooling layer proposed generalizing capsule higher dimensional input variant dynamic routing expectation-maximum routing based weighted kernel density estimation came faster effective procedure method enable capsule network maintain performance reducing computational cost capsule also extended studied segmentation task researcher however heavy memory consumption immediate vote capsule expansive computation dynamic routing algorithm capsule network hard become deep large cnn conquer issue apply large data set explore potential many researcher focus accelerating simplifying capsule network sharing weight introducing special capsule layer improving dynamic routing algorithm etc particularly segcaps extend vector capsule object segmentation including intracranial hemorrhage segmentation task despite accuracy capsule efficient large computing overhead maintain accuracy improving computational efficiency capsule network still open problem method section introduce capsule network named groupcapsnet used ich segmentation first briefly revisit basic capsule concept second grouped capsule groupcapsnet built illustrated discussed finally whole groupcapsnet described including special layer loss function ethical approval study approved ethic committee west china hospital sichuan university study performed accordance relevant guideline regulation compliance declaration helsinki image case system informed consent obtained participant data treated anonymously recap capsule capsule novel form feature representation make use vector matrix unit instead scalar neural network clarity use vector capsule default forwarding propagation similar manner capsule neural network next layer capsule produced next three step voting clustering nonlinear mapping let v^l_t denote type capsule layer voting step capsule v^l_t\ produce vote capsule t'|t l+1 type t'\ capsule layer l+1\ matrix transformation follows aligned t'|t l+1 t'|t v_t^l aligned t'|t trainable weight matrix clustering step vote capsule t'|t l+1 aggregatd weighted summation produce dominant capsule l+1 follows aligned l+1 t'|t l+1 t'|t l+1 aligned t'|t l+1 weight derived routing algorithm nonlinear mapping step dominant capsule l+1 mapping squashing function obtain final output capsule l+1 squashing function formulated follows aligned l+1 l+1 1+\left\| l+1 l+1 l+1 aligned convolutional capsule input like image capsule take advantage local receptive field weight sharing like convolutional neural network cnn convolutional capsule obtained different type capsule within spatial local kernel previous layer additionally trainable weight matrix type capsule reasonably shared different spatial location reduce computational cost grouped capsule different type capsule distinguishing feature different entity part produce capsule doe need type capsule previous layer input distinguishing feature requires relevant type capsule rather many possible type capsule therefore reasonable divide different type capsule group addition grouped computation convolutional neural network widely studied recently empirically demonstrated potential improving accuracy reducing computational cost based assumption relevant type capsule automatically gathered one group training procedure equally divide type capsule non-overlapping group group capsule independently produce capsule next layer fig figure demonstration capsule forwarding layer input capsule produce vote capsule output capsule trainable weight matric shared within local spatial kernel type capsule thus capsule type produce one capsule output capsule grouped capsule full size image formally grouped capsule type capsule one layer divided i.e group denoted g_1 g_2 g_g g_i g_i g_j g_i g_j every i\ne next layer capsule type t'\ also divided g'_1 g'_2 g'_g satisfying constraint g'_i t'\ ^n\ capsule type g'_i\ related type g_i\ capsule previous layer therefore becomes follows aligned l+1 t\in g_i t'|t l+1 t'|t l+1 aligned g'_i\ hand capsule type produce vote capsule type g'_i\ portion type end significant reduction trainable weight matrix immediate vote capsule theoretically increase computational cost reduces roughly original without grouped capsule force grouped capsule learn compact representative feature grouped capsule easily generalize convolutional version case image-like input capsule connection previous layer capsule within specific kernel furthermore grouped capsule seamlessly added existing capsule network network architecture whole network architecture named groupcapsnet based symmetrical u-shape design following u-net groupcapsnet contains encoder decoder part encoder part extract high-level semantic feature decoder part restores feature high spatial resolution encoder part two normal convolutional layer channel kernel stride firstly applied regard 16-channels convolutional output 2-types 8-dimensions capsule non-linear mapping employed output convolutional layer form initial capsule forwarding next step initial capsule processed four stage design stage follows three rule capsule stage number type dimension capsule next stage double number type dimension halve spatial resolution stride number grouped capsule layer double next stage decoder part also exist four stage stage deconvolutional capsule firstly applied double spatial resolution output previous stage final stage encoder part type capsule output deconvolutional capsule corresponding stage encoder part collected subsequent processing stage also satisfied similar rule mentioned encoder part capsule stage number type dimension number grouped capsule layer half next stage segmentation header layer added output decoder segmentation header one capsule layer kernel stride employed produce final 1-type 8-dimension segmentation capsule hemorrhage region background determined length segmentation capsule thresholding non-linear mapping non-linear mapping designed enhance non-linear representation ability network squashing function normalizes length capsule right part squashing make capsule become unit vector left part take non-linear mapping length groupcapsnet propose use modified squashing function follows aligned l+1 l+1 1+\left\| l+1 l+1 l+1 l+1 1+\left\| l+1 aligned slightly different left part squashing function result section conduct comprehensive experiment evaluate groupcapsnet ich segmentation first describe experimental setting including data set collection preprocessing metric involved experiment second ablation study groupcapsnet conducted demonstrate effectivness group number modified squashing function finally discus comparison groupcapsnet existing method ich segmentation experimental setting implementation detail implement proposed method pytorch nvidia tesla v100 gpus perform random flip rotation data augmentation gaussian additive noise 0,0.01 data perturbation method trained adam optimizer initial learning rate 5e-4\ epoch learning rate reduced factor 0.97 epoch batch size half labeled image rest unlabeled image set =0.99\ exponential moving average ema dataset dataset used experiment non-public dataset came cooperative hospital consists total non-contrast scan patient brain cooperative hospital january december named ich210 slice scan traced hemorrhage brain tissue master degree student major neurosurgery tracing result checked emergency medicine specialist working hospital size non-contrast scan employ 5-fold cross validation technology evaluate proposed method preprocessing brain tissue hemorrhage concerned value smaller hounsfield unit clip scan value range 0–90 normalize 0–1 split scan slice z-axial slice image resized data augmentation flip rotate slice randomly evaluation metric quantitatively evaluate method ich segmentation calculate four type metric dice coefficient dice intersection union iou sensitivity specificity formulated follows aligned dice= tp+fn+fp aligned aligned iou= tp+fn+fp aligned aligned sensitivity= aligned aligned specificity= aligned number true-positive false-positive true-negative false-negative respectively due common data imbalance problem invovled ich segmentation performance segmentation mainly depends dice coefficient ablation study modified squashing vs. squashing difference modified squashing squashing function take non-linear mapping capsule length rewriting non-linear mapping function similar property curve shown fig however modified squashing greater advantage squashing term forward running time evaluate 16-dimension capsule forward execution time shown fig result obtained averaging time experiment pytorch platform forward time modified squashing lower squashing 0.0001 0.00007 modified squashing reduces number floating point operation experiment backward running time modified squashing also reduced figure different type non-linear mapping function curve full size image conduct experiment compare impact different non-linear mapping function performance train two type groupcapsnet epoch ich210 dataset shown table comparing squashing modified squashing reduce slightly improve performance groupcapsnet table performance comparison different non-linear mapping function full size table grouped vs. non-grouped investigate impact grouped capsule non-grouped capsule term computational speed performance number group crucial factor groupcapsnet group number increase number immediate vote capsule significantly reduces beneficial computational speed forward backward procedure capsule note non-grouped capsule network seen special case grouped capsule network i.e g=1\ empirically show impact number group computational speed study four type grouped capsule different group number i.e g=1\ g=2\ g=4\ g=8\ different type grouped capsule dimension input output capsule respectively dimension capsule spatial resolution different grouped capsule 64\ iteration number routing algorithm experiment result shown fig forward execution time g=2\ g=4\ g=8\ grouped capsule non-grouped capsule show grouped capsule significantly reduce computational cost note number execute time reduces theoretical value i.e reason may inefficient operation concatenating capsule group form output capsule increase proportion operation time increase figure execution time different group number full size image investigate impact group number performance design four type groupcapsnets different group number grouped capsule layer number initial capsule type dimension determined following architecture groupcapsnet automatically configurated due highly modular design denote four type groupcapsnets groupcapsnet-g1 groupcapsnet-g2 groupcapsnet-g4 groupcapsnet-g8 group number respectively set number initial capsule type dimension groupcapsnet-g 16/\ respectively train type groupcapsnets epoch ich210 dataset experiment result shown table groupcapsnet-g2 achieves best performance outperforms non-grouped groupcapsnet term dice coefficient result also show performance decrease g=4 one hand think many group capsule divided depends specific dataset force split relevant type capsule independent group effect groupcapsnet decline hand g=4,8\ couterpart groupcapsnet fewer weight capture pattern capsule fewer dimension may sufficient representation capacity table performance comparison groupcapsnets different group number full size table compare existing method demonstrate effectiveness groupcapsnet compare existing method ich segmentation dpn92-unet ichnet recently proposed focus ich segmentation achieve promising result model based deep convolutional nerual network unfortunately datasets code public u-net mature medical image segmentation method simple effective still state-of-the-art application recently evaluate smaller version u-net named u-net-2m ich210 1/4 trainable weight parameter layer comparing original u-net u-net-2m designed similar parameter groupcapsnet segcaps also evaluated ich210 similar non-group counterpart groupcapsnet u-net-2m segcaps groupcapsnet trained using bce loss optimizer adam 0.001 learning rate learning rate decayed factor 0.9 epoch method trained epoch table show result 5-folds cross validation different method also conduct ensemble groupcapsnets table performance comparison groupcapsnet existing method intracranial hemorrhage segmentation dpn92-unet ensemble groupcapsnet ensemble method mean training model averaging prediction result full size table groupcapsnet outperforms u-net term dice case similar number parameter groupcapsnet show potential feature representation segcaps one kind non-group capsule network experiment show effectiveness grouped capsule addition groupcapsnet show comparable performance comparing ichnet ich segmentation ensembling training model averaging prediction result groupcapsnet achieve best dice 0.8901 ich segmentation quantitative output ich segmentation shown fig figure sample ich segmentation prediction groupcapsnet label hemorrhage region best viewed color zoom full size image conclusion paper aim reduce burden computational cost memory consuming capsule network employ ich segmentation task solve shortcoming capsule design capsule network named groupcapsnet comprising grouped capsule layer comprehensive experiment conducted show effectivness grouped capsule modified squashing function ich segmentation groupcapsnet achieve comparable performence comparing existing approach