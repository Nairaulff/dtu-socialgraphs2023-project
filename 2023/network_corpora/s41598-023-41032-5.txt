introduction important basis traffic planning traffic management control traffic flow prediction one critical problem intelligent transportation system research widespread deployment intelligent data acquisition terminal radar gps device large amount data reflecting state road network accumulated massive traffic data provides good foundation traffic flow prediction therefore improve prediction efficiency accuracy optimizing prediction method become key issue traffic flow prediction mainly predict traffic flow parameter certain region future period based historical traffic data reason early effort predict mostly predict based time series prediction model xingwei compared arima lstm traffic flow prediction kumar proposed short-term traffic flow prediction method based sarima overcome availability problem since traffic flow affected many factor general parameter method adapt complex random characteristic traffic flow therefore machine learning method applied traffic flow prediction example castro-neto proposed online regression support vector machine model ol-svr highway typical atypical condition research result show model better performance atypical traffic condition wang assume expected interval traffic flow related traffic flow previous interval propose new bayesian method traffic flow prediction based grey relational analysis method entropy acquisition high-fine-grained spatiotemporal data road traffic flow becoming convenient traditional machine learning method perform poorly dealing high-dimensional complex spatiotemporal data deep learning certain advantage mining high-dimensional feature data many deep learning model convolutional neural network cnn recurrent neural network rnn generative adversarial network gan powerful feature processing capability good prediction effect traffic prediction task addition variant recurrent neural network long short-term memory lstm gated recurrent unit gru also widely used due powerful time series data processing ability better extract data feature give full play advantage model researcher enhance performance model stacking different network example proposed use convolutional neural network cnn extract daytime intra-day traffic flow pattern extracted feature input long short-term memory lstm unit learn intra-day time evolution process traffic flow method capture temporal correlation traffic flow well ignores spatial correlation traffic flow fang proposed long short-term memory network attention mechanism considering long-term dependence traffic flow evolution experiment proved effectiveness model capturing subtle fluctuation traffic flow still shortcoming capturing long-term dependence attention mechanism help network model focus key information ignore small fluctuation jian-xi used multi-scale convolution kernel capture multi-factor nonlinear correlation spatial correlation road network node extracted time feature gated recurrent unit proposed multi-periodic component spatiotemporal neural network model considered periodic characteristic traffic flow wang considered road traffic flow data weather condition introduced attention mechanism enable model focus learning important data feature proposed short-term traffic flow prediction model based attention mechanism 1dcnn-lstm network experiment show introduction multiple traffic environment parameter play important role improving performance model jia proposed grouping residual network model based self-attention mechanism predict urban traffic flow experiment show prediction effect model good using cnn extract spatial relationship euclidean space however certain limitation feature extraction non-euclidean space recent year graph neural network widely used spatial information extraction road network due powerful performance capturing structural feature graph network guo proposed new attention-based spatiotemporal graph convolutional network astgcn model solve traffic flow prediction problem based three time characteristic traffic flow namely recent daily weekly cycle dependency experiment show model well capture spatiotemporal correlation characteristic traffic flow considers direct link road segment ignores indirect link ignores correlation upstream road segment effectively learned hidden spatiotemporal dependency basis temporal graph proposed spatiotemporal fusion graph neural network stfgnn traffic flow prediction wang constructed attention-based spatiotemporal graph attention network astgat model using attention mechanism dilated gated convolution graph attention network result prof model effectively extract in-depth spatiotemporal information prediction effect significant excelled algorithm existing research achieved abundant achievement still following shortcoming traffic flow prediction task simply regarded time series prediction task ignoring spatial correlation characteristic make good use traffic information upstream downstream traffic flow simply defining neighbor matrix based geographical location distance node describe spatial correlation non-adjacent section potential similar traffic flow ignored feature extraction time series mostly based data location different time impact research current prediction period insufficient neglecting feature extraction influence unexpected traffic incident gcn suitable processing static undirected graph traffic flow time-varying usually difficult deal dynamic adjacency matrix main contribution paper follows traffic flow prediction model based dynamic spatiotemporal graph attention network dstgat proposed experiment show prediction accuracy model high considering indirect link non-adjacent section pearson correlation coefficient used extract correlation feature traffic sequence non-adjacent node dstgat used effectively learn hidden spatiotemporal relationship traffic flow attention mechanism introduced enhance performance model capture impact microscopic traffic incident according traffic flow fluctuation characteristic adjacent period prediction effect model improved rest paper organized follows matrix construction problem description section mainly construct adjacency matrix introduces problem definition traffic flow prediction method section describes model structure model detail detail experiment section mainly experimental verification mainly includes introducing data set data preprocessing parameter setting compare evaluation indicator baseline model analyzes result discussion conclusion section conclusion outlook paper matrix construction problem description traffic flow prediction process forecasting traffic condition future period based historical traffic information define road network graph denoted graph represent topological structure road network set road node represented represents number node represents set edge adjacency matrix primarily describes connectivity road segment array 1pt or\ otherwise array 1pt or\ represents node pair composed node node road network necessarily adjacent road section associated target road section time step different road section show similar flow characteristic considering linkage characteristic traffic flow paper pearson correlation coefficient time step different section explore spatial correlation non-adjacent section due excessive connection relationship calculation parameter define pearson correlation coefficient two road segment greater threshold implicit connection relationship two road segment paper threshold set 0.9 according data experiment spatiotemporal adjacency matrix fusing implicit connection relationship expressed shown array 1pt or\ e|pearson 0.9 otherwise array feature matrix defined traffic information road network taken attribute feature network node represents number attribute feature therefore traffic flow prediction problem expressed mapping function predicts flow time future using direct indirect association relationship road section flow characteristic shown represents set road section flow predicted time future traffic flow denotes length historical time series denotes adjacent time daily cycle time weekly cycle time respectively method architecture dstgat architecture dstgat model proposed paper shown fig framework composed three interconnecting space–time block considering periodic characteristic traffic flow paper train model according traffic flow data three different cycle adjacency daily weekly cycle time space–time block composed two graph attention network gated recurrent unit used extract spatial temporal characteristic road traffic flow respectively adding residual connection prevent gradient disappearing traffic flow data adjacent time main reference attention mechanism used assign weight daily weekly cycle time output finally output result three component fused feature predicted value output linear layer main model framework paper shown fig figure dstgat model framework mgat multi-head graph attention network residual network layer fully connected layer full size image spatial feature extraction previous study spatial dependence relationship usually assumed constant road topology calculated dynamic change process traffic flow ignored graph attention network gat spatial domain convolutional network self-attention mechanism learn neighbor relative weight aggregate neighbor spatial feature attention weight change change data adding dynamic spatial correlation network model structure shown fig input feature calculates attention value adjacent node according node attribute feature shown calculating attention value adjacent node node softmax function used normalize attention weight shown finally output feature shown aggregated attention value neighbor leakyrelu\left softmax represents attention score node layer represents learnable weight vector layer represents weight matrix represents set neighbor node node nonlinear activation function figure mgat model structure full size image stabilize self-attention learning process enhance learning ability multi-head attention mechanism used concatenate calculation result shown average shown better capture spatial correlation superimposed two layer multi-layer graph attention network mgat time step flow t,1 t,2 input first layer new feature t,1 t,2 output output feature different attention head spliced together input second layer second layer output new feature set t,1 t,2 average output feature different attention head avoid gradient disappearance residual connection added final output indicates feature operated series number multiple attention head represents attention coefficient attention head time feature extraction fusion addition spatial correlation traffic flow show periodic characteristic time traffic volume day similar traffic flow previous day considering influence social fixed event weekly holiday traffic flow paper construct three kind time series along time axis extract feature denote adjacent time daily cycle time weekly cycle time respectively assuming flow time step predicted adjacent time series composed sample step current step daily cycle time series represents sequence time one day earlier cycle time series represents sequence time one week ago present recurrent neural network widely used processing sequence data traditional recurrent neural network defect gradient explosion gradient disappearance due influence prediction length therefore solve problem paper adopts gated recurrent unit extract time feature gated recurrent unit gru similar long short-term memory network lstm use gating mechanism control input memory compared lstm gru fewer parameter simpler network structure efficient lstm three gate namely input door forgotten door output door gru two gate namely updated door reset door update door used control much hidden layer state previous moment updated current hidden layer state reset gate used control much hidden layer state previous moment updated current candidate hidden layer state model structure diagram shown fig calculation process follows reset gate update gate input sample current moment hidden state previous moment intermediate state gate sigmoid activation function weight bias figure gru structure diagram full size image node adjacent time series daily periodic time series weekly periodic time series input gru extract time feature order reduce influence redundant information prediction result adaptability model neighboring time affected traffic incident increased therefore attention mechanism introduced capture importance different periodic time series data taking nearby time traffic flow main reference model nearby time query matrix cycle time key matrix model adjacent time query matrix cycle time key matrix score function model shown attention weight shown finally attention vector daily cycle sequence obtained shown attention vector weekly cycle sequence obtained similarly sigmoid training parameter neighboring time series output sequence diurnal time series output sequence finally adjacent time output sequence fused daily periodic sequence attention vector weekly periodic sequence attention vector final output obtained fully connected layer mapping experiment datasets preprocessing order verify prediction performance model pemsd4 used experimental verification data includes detection point data sampling time day january march data sampling interval min road contains 16,992 traffic flow data data mainly consists three traffic parameter including flow average speed average density treat detection point road segment construct link relationship according road network topology experimental dataset divided training set validation set test set according 6:2:2 ratio order eliminate influence different dimension data normalized normalization formula shown mean std mean represents mean sequence data std represents standard deviation sequence data baseline order evaluate model performance following model selected comparative analysis historical traffic data used mean value taken prediction arima time series fitting parameter model used traffic prediction need endogenous variable sensitive capturing linear relationship svr mining nonlinear relationship historical data achieve purpose prediction kernel function used map high-dimensional data gru model variant lstm simpler structure fewer parameter reduce risk overfitting stgcn traffic flow prediction constructing spatiotemporal block road network topology structure used construct graph extract spatial feature convolutional neural network used extract temporal feature complete traffic prediction astgcn considers periodic characteristic traffic using temporal attention mechanism spatial attention capture dynamic correlation time space graph convolutional network traffic prediction experimental parameter setting implemented dstgat model based pytorch framework prediction step 12\ paper predict traffic within 12\ chosen construct time series recent daily weekly period respectively number attention head gat set according performance validation set model trained adam optimizer learning rate 0.0001 batch size set dropout dropout rate 0.5 used prevent model overfitting l2loss used loss function model baseline model parameter shown table table baseline model parameter full size table evaluation metric paper mean absolute error mae root mean square error rmse mean absolute percentage error mape selected evaluate effectiveness model calculation process follows mae rmse mape represents number node graph actual value predicted value result analysis proposed model baseline model used predict traffic next hour data set performance pair shown table seen table proposed model outperforms baseline model three-evaluation metric statistical model time series model poor prediction performance compared deep learning model reason statistical model time series model road section considered flow change characteristic road section near target section considered random fluctuation characteristic road section traffic model respond well model performance low model benefit high deep learning network compared stgcn astgcn perform better baseline model proposed model performs better mae rmse mape indicating considering time series correlation non-adjacent road segment considering spatiotemporal attention feature play important role improving accuracy model table performance comparison different model full size table order verify prediction performance proposed model different time length four model baseline model gru stgcn astgcn proposed model selected predict traffic flow next min min min min result shown fig seen figure three indicator proposed model better three baseline model different time step prediction accuracy model decrease increase time step shorter step smaller prediction error higher accuracy figure performance comparison different prediction step model mae rmse mape full size image verified impact proposed model component prediction accuracy result shown table used adjacency matrix adjacent road segment original model considered adjacency matrix non-adjacent road segment time added attention mechanism capturing temporal correlation feature determined pearson coefficient 0.9 indirect correlation feature seen table component model contributes model performance among introduction attention mechanism reduces mean absolute error model 7.56 mean absolute percentage error 8.56 indicating component significant effect improving accuracy model choice correlation coefficient show model doe improve prediction accuracy higher correlation coefficient course model improve efficiency model small correlation coefficient inclusion data node information table comparison ablation experimental performance full size table discussion conclusion aiming problem traffic flow prediction dynamic spatiotemporal graph attention network traffic flow prediction model based attention mechanism proposed pemsd4 used experimental verification comparison analysis multiple baseline model following conclusion obtained upstream downstream traffic flow important influence road section certain correlation adjacent road section related traffic flow target road section affected geographical location factor non-adjacent road section necessarily unrelated target road section therefore paper pearson correlation coefficient evaluate similarity traffic flow series certain time granularity construct adjacency matrix accordingly ablation experimental result show discussing indirect correlation non-adjacent section certain effect improving accuracy model traffic flow periodic characteristic macroscopic fluctuation traffic flow large due influence microcosmic traffic event short-term traffic flow extremely vulnerable affected fluctuated feature extracted periodic historical data adapt fluctuation current traffic flow caused traffic event therefore paper introduces attention mechanism assign weight periodic data concerning current neighboring time experiment show micro fluctuation important impact prediction effect prediction accuracy model affected prediction step size longer prediction step size lower accuracy paper periodic characteristic traffic flow modeling combine gru model based historical periodic data better capture long-term dependence characteristic traffic flow experimental result show model better benefit medium-long step size prediction experimental result show according traffic flow data near time spatiotemporal similarity link constructed daily cycle time weekly cycle time traffic data combined influence traffic event near time traffic flow fully considered evaluation effect model enhanced based existing research result future plan enrich expand traffic flow prediction framework integrating multi-source external data weather holiday regional poi feature enhance capture ability geospatial semantic information model time new arriving data processed real-time effective prediction system explored field dynamic training optimize design traffic flow prediction model improve generalization ability