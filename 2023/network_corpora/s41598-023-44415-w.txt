introduction tuberculosis caused mycobacterium tuberculosis major global health problem responsible 10.6 million case 1.6 million associated death alone whilst treatable disease resistance anti-tb drug especially first-line rifampicin rr-tb isoniazid hr-tb together called multi-drug resistance mdr-tb making infection control difficult acquire resistance anti-tb drug tuberculosis drug target activating protein often mutated including single nucleotide polymorphism snp insertion deletion indels process involving vertical horizontal gene transfer increasingly recognised within-host mixed strain infection msis contributing drug resistance heteroresistance involving co-existence susceptible resistant strain msis arise due reinfection infected host new strain tuberculosis often observed relapse patient well emerge distinct clonal evolution within infected host msis may driven inadequate treatment scheme diagnosed patient receive combination therapy sometimes toxic drug minimum month non-compliance treatment failure arise heteroresistance responsible higher rate treatment failure thereby limiting treatment option patient often without proper strain drug resistance profiling treatment msi patient may involve second/third-line drug efficacy serious adverse drug reaction prolonged treatment period therefore identifying complete pathogen diversity within host useful achieving favourable clinical treatment outcome phylogeny tuberculosis consists major lineage l1–l4 consist different strain type may vary propensity transmit cause severe disease msis tuberculosis identified high-depth whole genome sequencing wgs data presence heterozygous genotype strain snp high number heterozygous site typically removed analysis often thought effect contamination sequencing error deconvolution different lineage within msis determined data estimating ratio allele coverage different lineage-specific snp however heteroresistance challenge lie determining lineage resistance-linked snp belongs thereby obtaining information lineage-specific drug resistance profiling msi infer often rely overlap lineage-specific drug resistance snp straightforward using short-read sequencing data often lead many orphan drug resistance snp unassigned strain however problem resolved using data long-sequencing platform possible profile drug resistance lineage wgs data inform clinical infection control example using tb-profiler tool however whilst possible call mixed genotype software typically lack mean disentangling different snp specific different strain within msi could enhance profiling previous work mixed infection provided mean identifying specific lineage involved msi sample sample drug resistance nonetheless connection identified lineage sample drug resistance still undetermined built statistical tool based gaussian mixture model gmms distinguish different strain lineage fraction msi assign drug resistance lineage without need detecting drug resistance lineage-specific snp sequencing read general gmm probabilistic model representing multiple gaussian distribution within population algorithm determines number mixing proportion amongst many application gmms used successfully identify protein family cell type omics data classify cancer apply gmm model deconvolute msi sample detected large tuberculosis wgs 50k dataset 50,723 tb-profiler software fig test accuracy gmm algorithm simulation study estimate number msis heteroresistance across different lineage ultimately disentanglement strain drug resistance involved msis could assist optimisation treatment decision potentially prevent emergence resistance figure world map 50k tuberculosis dataset sample size region drug resistance world health organization region map coloured according region hr-tb isoniazid mono-resistance mdr-tb multi-drug resistance rr-tb rifampicin resistance xdr extensively drug-resistant mono- poly-resistance covered resistance class proportion heteroresistance country data coloured map light grey full size image result global clinical result total 50,723 tuberculosis isolates wgs drug susceptibility test data country analysed encompassed major lineage 48.3 27.6 11.8 9.1 table fig lineage 2.2.1 beijing strain-type prevalent four six world health organization region especially southeast asia 34.5 western pacific 51.0 africa 15.6 europe 15.9 genotypic resistance prediction using tb-profiler software inferred 29.2 24.4 16.5 sample resistant isoniazid hr-tb rifampicin rr-tb least mdr-tb respectively table fig across 18,637 sample dst data 21.3 5.6 44.9 hr-tb rr-tb least mdr-tb respectively highest level genotypic drug resistance eastern mediterranean region 80.7 predominantly strain 47.4 strain type globally prevalent strain found largest majority america 75.6 globally 48.3 l4.3.3 prevalent sub-lineage 15.6 table tuberculosis isolates world health organization region full size table multiple strain infection using tb-profiler software 1.1 sample revealed co-existence two tuberculosis sub- lineage table fig country isolates msi colombia malawi turkmenistan russia brazil algeria india fig vast majority tb-profiler determined msis could conferred using quant-tb software 513/531 96.6 lineage strain frequent strain-types msis function sample size prevalent involved l2.2 la1.1 caprae fig common combination involving 31.3 strain table table fig prevalent drug resistance form msis involve isoniazid 170/531 32.0 streptomycin 130/531 24.5 ethambutol 73/531 13.7 table table tuberculosis isolates putative evidence mixed strain infection full size table figure lineage involved mixed strain infection msis full size image figure tuberculosis isolates putative evidence mixed strain infection measured drug resistance type full size image performance gmms artificial mix predictive power gmm approach first assessed using wgs data sample known mix dna varying major proportion 0.95 0.9 0.7 obtained clinical malawi tuberculosis strain table gmm model tb-profiler achieved low mean squared error sample predominant strain consistently low overall gmm 0.006 tb-profiler 0.006 quant-tb appears perform better sample major mixing proportion 0.7 obtained higher overall mse value 0.020 method limitation mixed dna sample malawi none drug resistant ratio close parity 50:50 explore ability gmm predict heteroresistance wider range lineage ratio larger sample size silico artificial mixture known drug resistance mixing proportion generated table simulation suggest gmm approach achieves high accuracy prediction drug resistance across minor proportion 0.05 0.50 accuracy median 0.93 range 0.89–0.97 level mse gmm low consistent across mixing proportion overall mse 0.012 comparison overall mse value tb-profiler slightly lower 0.009 quant-tb greater 0.013 application gmm clinical isolate data shown gmm estimate mixture accurately applied approach mixed clinical sample global dataset median number mixture range 2–4 median major mixing component 77.6 range 50.0–93.7 assuming tb-profiler mixing prediction gold standard gmm mse 0.007 msis 35.4 188/531 sample consist one drug resistant one sensitive lineage 21.5 114/531 consist lineage drug resistance mutation 43.1 229/531 consist two lineage pan-susceptible present three example msis represent complexity heteroresistance table err4796347 categorised pre-xdr-tb confirmed using accompanying dst data sequencing coverage tb-profiler software found sample mix l4.4.3 l2.2.1 beijing strain sub-lineages gmm model confirmed similar mixing proportion addition model reveals lineage 2.2.1 responsible drug resistance mutation l4.3.3 pre-xdr driven mutation gene including gyra rpob rrs fabg1 katg pnca embb another sample err4829977 categorised mdr-tb mixture profiler gmm l2.2.1.1 tb-profiler gmm strain type estimated mixing proportion reflected frequency drug resistance snp containing mutation rifampicin streptomycin resistance whilst l2.2.1.1 contains resistance streptomycin ethambutol sample err4797884 categorised pre-xdr-tb presence l3.1.2.1 tb-profiler gmm l2.2.1 tb-profiler gmm gmm analysis revealed major l3.1.2.1 strain isoniazid streptomycin resistant katg s315t gid g170 mutation respectively l2.2.1 also common katg mutation confers resistance conferring xdr analysis demonstrates potential differentiating mixed lineage resistance involving mutation table example clinical mixed strain infection disentangled drug resistance mutation established strain using gmm full size table discussion mixed-strain infection msis tuberculosis present wgs data heterozygous genotype typically removed analysis however informative heteroresistance de-rail treatment effectiveness degree msis may historically underestimated various colony sampling technique leading culture clonal tuberculosis well bioinformatic analysis excluded sample many heterozygous genotype recently found short-term culture method direct wgs sputum lung tissue lead accurate representation within-host tuberculosis diversity patient relatedly study lung tissue reveal infection may complex previously thought compared sputum typically predominant biological sample used shown magnitude msis high-burden setting underestimated testing sputum sample setting diversity complexity reduced underestimated tuberculosis culture colony selection context malaria degree multiplicity infection may surrogate transmission intensity previous study identified msis high transmission region pakistan confirm example complex sample err4829977 work observe higher involvement lineage msis may reflect convenience nature confounding effect sampling strain type found previously transmissible virulent sample lineage thought transmissible slower growth conventional diagnostic medium may influence phenotypic testing result genotypic-based modelling approach could detect msis overall result appear reveal decreased involvement transmissive lineage lineage consistent study may also due lower sequencing rate irrespective none msi sample found seemed present transmission cluster may indicative re-infection incomplete treatment poor adherence typically issue msis disentangled linked component namely identifying presence followed estimation minimum number clone deconvoluting genotype clone applied gmm method determine clonal drug-resistant genotype msis tuberculosis wgs data identified initially tb-profiler flexibility using different informative mutation list genotypic profiling found signal alternative haplotype frequency sufficient differentiate strain supported analysis mixture artificially generated mixed sample similarly quant-tb tb-profiler software used confirm mixing proportion gmm offered lower comparable error rate simulated data sample overall gmm approach appears provide rapid non-culture-based method assign drug resistance profile lineage thereby providing insight lineage-specific drug resistance inform clinical decision making specifically disentanglement drug resistance lineage msi assist diagnosis optimise personalisation treatment also help prevent development drug resistance including avoiding use ineffective drug study therefore provides additional proof concept evidence use wgs-based diagnostics gmm approach used monitor within person evolution strain detection drug resistance mutation transmission related outbreak population level tracking source spread strain challenging detect dissect susceptible sample patient similar identical sub-lineages thereby potentially inferring reinfections sample msi identical genome approach would work directly detection heteroresistant infection within sub-lineage difficult also analysed input file contain proportion alternative allele coverage snp used detecting mixed gene sequencing read approach tested using convenience sampled collection isolate data sourced mostly clinical sample collected across many different study using varying individual collection laboratory culture method e.g. mgit may influenced estimated prevalence msis drug resistance growing application whole genome amplicon-based sequencing platform including using portable oxford nanopore technology lead increasing amount genomic data surveillance clinical application including accurate estimation extent msis improvement gmm approach made using tuberculosis phylogenetic tree structure extend approach member mtbc well exploit intrinsic linkage disequilibrium pattern increase strain lineage identification drug resistance snp addition shown strain tuberculosis preferentially associated resistance certain drug mixed resistance accuracy could improved including association alternative extension gmms variational gmm also implemented improve level performance lieu effort presented gmm-based tool wgs data disentangle lineage drug resistance genotype used inform clinical surveillance decision-making control method clinical isolates sequence analysis tuberculosis isolates 50,723 publicly available wgs drug susceptibility test dst data analysed sequencing read data generated using illumina next-generation sequencing technology sample genome-wide coverage sequencing read depth 30-fold higher accepted isolates covered main lineage table raw read sequence trimmed trimmomatic software bwa-mem software v0.7.17-r1188 used process align trimmed read h37rv reference sequence genbank 000962.3 bcftools v1.14 gatk software v4.1.3.0 using haplotypecaller function parameter -erc gvcf used identify snp monomorphic snp highly variable pe/ppe gene removed tb-profiler software used infer genotypic drug resistance detect msis specifically sub-lineages supported read coverage within sample quant-tb software default parameter run confirm msis found tb-profiler gaussian mixture model gmm built sample using scikit-learn applied ratio alternative total allele count across snp contained variant calling file vcf format flexible format used detecting mixed gene read identify msis potentially within sub-lineages approach summarised figure gmms could contain number mixture component multi option applied output sample include number mixture component parameter mean standard deviation confidence mixture −/+ mean mixing proportion snp placed within gaussian distribution allowing inference assigned strain component associated confidence e.g. probability leading delineation individual strain drug resistance pattern assessing performance gmm performance gmm approach assessed simulating artificial mixture empirical data artificial mixture created using seqtk software v1.3-r106 http across mixture simulation obtained combination clinical sample majority/minority strain proportion ranging 0.50/0.50 0.95/0.05 0.05 increment covering within mix variant calling generating sample-specific vcf file generation performed using freebayes software v1.3.5 measure performance included mean square error mse calculated predicted actual lineage ratio using scikit-learn package accuracy drug resistance profiling compared tb-profiler prediction gmm performance also assessed using wgs data set mixed tuberculosis dna sample generated vitro clinical culture malawi patient known mixing proportion comparison used quant-tb software default setting estimate mixing proportion