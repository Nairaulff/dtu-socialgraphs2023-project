introduction indispensable contributor national development metal material enjoys various type vast application scenario however due factor machine environment involving production process wide variety surface defect unavoidable crack inclusion blister like defect recognized time would bring potential risk product quality safety therefore great significance improve metal surface defect detection avoid economic loss staff casualty effective detection metal surface defect key step ensure production process safety product quality thus people looking efficient reliable method detect metal surface defect practical production traditional method include visual inspection manual operation however method problem low accuracy efficiency easily affected subjective factor advancement science technology various new metal surface detection technique appeared recent year instance digital image processing technique deep learning algorithm applied enable automate metal surface defect detection thus significantly improving detection accuracy efficiency moreover nondestructive detection technique including ultrasound x-ray infrared ray also contributable detection inner metal defect effectively guaranteeing quality safety product research metal surface defect detection based deep-learning technology zhao introduced rdd-yolo model designed double feature pyramid network dfpn enhance neck generate enriched representation deepen whole network make special use low-level feature model achieved obvious effect term steel surface defect detection xie proposed surface defect detection algorithm based feature enhanced yolo suitable practical industrial application improved feature pyramid network designed enhance spatial location correlation multi-scale detection layer achieve high precision cheng introduced new deep neural network dnn better recognition performance detect steel surface defect namely retinanet difference channel attention adaptively spatial feature fusion dea-retinanet liu put forward new haar-weibull variance model detect steel surface defect unsupervised manner method detect type defect even texture realize average detection rate 96.2 term dataset introduced new deep-learning detection network channel attention bidirectional feature fusion fully convolutional one-stage cabf-fcos network realize quick efficient defect detection steel strip however still many problem regarding method small target defect detection metal surface instance yolov5 algorithm designed many data enhancement technique taken account possible practical application robustness model still insufficient come complicated scenario image high noise resulting false missing detection yolov5 adopts cross stage partial network backbone network extract enriched feature information however dealing small target network make full use low-level feature information giant down-sampling step cspnet thus causing insufficient feature extraction several small target overlap area yolo algorithm may able detect correctly despite fact measure improvement introduced deal problem mentioned including special convolutional structure like sppnet sam ssd srm-fpn pan asff nas-fpn improved loss function data augmentation problem regarding detection accuracy speed still remain improve measure introduce upgraded defect detection model based yolov5s model model training data augmentation technique including random rotation brightness adjustment sensor noise addition glass blur applied conduct metal surface detection result finally verified gc10-det augmentation dataset csplayer module introduced promote detection small target maintaining light-weighting model module yolov5s structure replaced csplayer module model adaptively adjust channel weight deepen model layer improve model capability comparison c3module csplayer achieve better training reasoning speed ensuring accuracy splitting large convolution kernel small one model lower video memory consumption thus becoming suitable training reasoning condition limited memory gamattention module combine channel attention spatial attention introduced augment feature expression improve detection small target better capture complicated feature image attention weight modeled gamattention module attention weight dimension represented independent nonlinear function compared attention mechanism gamattention superior flexibility interpretability handle different type sequence data efficiently related work small target detection research visual detection algorithm based deep-learning especially yolo series algorithm small target defect detection accurately handled term accuracy speed small target featured low resolution blurred image insufficient information much noise measure introduced resolve problem example data augmentation strategy fix problem insufficient information small target texture increase computing cost guo introduced new deep-learning model named small target centernet applies selective small target replication algorithm sstra increase number small target selective over-sampling although conducive feature extraction small target increase additional computation easily affected noise wang proposed small target detection method c-ssd based improved ssd realize feature fusion compact block quick connection introduction prediction layer residual diou-nms improve detection accuracy zhang introduced network model structure based yolov5 added detection head generated low-level feature layer high-resolution feature combination image detect small object however method higher requirement training dataset significantly conducive improving detection small target put forward small target prediction head combine yolov5 gbh-yolov5 detect defect panel bottleneckcsp module introduced ensure better accuracy regarding multi-scale target ghost convolution applied improve reasoning speed model reduce number parameter measure mentioned demonstrate well performance term accuracy speed problem still exist instance feature small target fully extracted thus causing large error insufficient detection small target furthermore performance gain empowered measure limited computation cost therefore paper intended find way achieve highly accurate metal surface defect detection improving feature expression reducing computation attention mechanism model recent year many researcher introduced attention mechanism convolutional neural network improve target detection capability various attention mechanism gained progress research small target detection due complicated background small target spatial attention introduced target detection weighing feature targeted area feature extraction network selectively focus targeted area contains important information suppress unrelated information thus decreasing impact background detection result promoting detection performance model channel attention enables network focus crucial feature channel ignore unimportant one thus improving accuracy robustness model reducing computation overfitting huang introduced improved yolov3 algorithm spatial attention based gated channel transformation adaptive up-sampling module mainly focus feature reaction different location image thereby improving model detection performance target seat-yolo proposed kumar detect small shadow area high accuracy integrating channel attention spatial attention channel spatial mixed attention better focus target relatively pixel promote accuracy small target detection deng introduced method detect small target optical remote sensing combine hybrid domain attention unit hdaus channel attention spatial attention thereby improving feature extraction ability suppress background noise self-attention principally focus dependence relation input sequence pick modelling capacity sequence data xue integrated self-attention acmix yolov5 reduced resource consumption model increased detection accuracy small target combining global context network multi-head attention primarily coordinate various type attention mechanism order boost expression capacity robustness model liu introduced improved yolo model based cross-attention strategy transformer ensuring better robustness model noise input sum small target detection challenging problem yolo series algorithm different attention mechanism model enhance detection accuracy small target however problem still exist including make model better understand significance various area image interrelation different area improve detection accuracy small target better improve model performance real-time extensibility method review yolov5 yolov5s cspdarknet53 convolutional neural network extracted darknet framework cspdarknet53 reduces number parameter improves model performance using cross stage part csp module neck based backbone network yolov5s applies feature pyramid network fpn technology construct feature pyramid feature pyramid made multiple feature map different scale capture object different size provide information detector head detection head yolov5s consists three convolution layer output layer output layer sigmoid activation function process detection result output information detection box class confidence classification probability improved network architecture model structure proposed paper shown fig main improvement yolov5s follows yolov5s take cspdarknet multi-scale feature extraction network includes convolution block step kernel three group conv structure spatial pyramid pool-fast module improve model performance replace layer csplayer maintaining original model structure new characteristic technology utilized increase speed reduce model size precision guaranteed facilitate detection small defect metal surface introduction gamattention enables model focus object area reduce computation improve detection speed accuracy possibility background interference metal surface defect image acquisition relatively high function gamattention adaptively learn much dimension contributes output well interpretable figure structure improved network architecture full size image csplayer module highly accurate detection result real-time performance computing resource need taken account minimize redundant expression reduce computation paper introduces csplayer module give full play advantage achieve goal better feature expression ability computation structure shown fig module consists three convmodules cspnext block one channel attention module convmodule consists layer conv2d batchnorm silu activation function figure csplayer structure csplayer module cspnextblock convmodule full size image yolov5s cspdarknet53 adopts multi-branch structure similar resnext branch separately process portion input splice part together thus reducing computation memory occupation improving ability feature representation yolov5s structure module help model better capture multi-level feature information object extract detail context information object time employing multiple different convolution kernel size channel number idea csp followed csplayer darknet fig basic block convolution add depthwise convolution large kernel fig structure convolution achieve fewer parameter bring receptive field csplayer connects output feature previous layer input next layer maximize cardinality based idea gradient information combination let high cardinality sparse connectivity enhance learning ability network replacing pointwise convolution depthwise separable convolution decomposed two smaller operation firstly depthwise convolution employed convolution different input channel respectively pointwise convolution used combine output way overall effect similar pointwise convolution computation model parameter greatly reduced figure convolution structure basic block cspnextblock full size image enhanced backbone gamattention small target usually small number pixel make difficult detector recognize gamattention introduced paper make model focus small target location rather background information improve detection small target also adaptively learn size location information small target improve accuracy small target detection gamattention global attention mechanism overall structure fig channel attention mechanism spatial attention mechanism input feature map gamattention first performs dimension conversion adjusting dimension feature map purpose reduce computational complexity number parameter feature map dimension conversion input multi-layer perceptron mlp process feature map fig processed feature map transformed back original dimension finally output processed sigmoid function compared spatial attention module sam gamattention mainly convolutional operation handle channel attention fig first reduce number channel computation applying convolution operation kernel size increase number channel applying another convolution operation kernel size maintain consistency number channel finally apply sigmoid function output weight channel attention formula indicate given input feature mapping intermediate state output defined array array array array figure overview gam channel attention submodule spatial attention submodule full size image channel attention graph space attention graph respectively represents multiplication element-wise overall process illustrated fig transfer information multi-layer convolutional feature graph enhance expression target learning feature representation different level input data projected multiple fully connected layer attention weight dimension calculated using nonlinear function finally weighted average attention weight dimension taken output mechanism help model ignore area important thus improving robustness model change scene lighting gamattention model adaptively learn scale location information target maintain good detection effect even case scale change translation transformation training gamattention suppress feature unrelated target focus feature relevant target thus reducing noise interference overfitting risk way model better understand target information improve detection accuracy small target experiment dataset dataset adopted experiment gc10-det dataset contains ten type metal defect namely punching hole welding line crescent gap water spot oil spot silk spot inclusion rolled pit crease waist folding order restore possible complexity metal defect detection augmented dataset random rotation brightness adjustment adding sensor noise glass blurring etc augmented image shown fig total number image expanded dataset dataset divided train set validation set test set ratio 8:1:1 training set image test set validation set image figure ten type surface defect gc10-det dataset punching hole welding line crescent gap water spot oil spot silk spot inclusion rolled pit crease waist folding full size image experimental environment training parameter configuration host computer used experiment includes graphic card rtx cpu intel core i5-12400f window operating system pytorch 1.12.1 python 3.8 cuda12 employed experiment training parameter used experiment shown table table training parameter full size table evaluation metric variety metric used research evaluate performance model include precision recall mean average precision map frame per second fps model size metric provide comprehensive picture model performance classification task precision proportion number sample correctly predicted true positive number sample predicted true positive model formula computation follows array precision array recall share number sample model correctly predicts true positive number sample actually true positive calculated formula array recall array f1-score metric comprehensively combine precision recall formula computation given array recall precision precision recall precision recall array map metric used evaluation multi-category classification problem map average value category calculated separately category calculated shown array array array map array formula denotes total number category fps refers number frame model process per second model size indicates amount storage space occupied model metric great significance evaluation performance adaptability model experimental result order verify effectiveness various module introduced paper ablation experiment designed shown table scheme model original yolov5s model scheme module replaced csplayer module network structure scheme iii gamattention introduced scheme csplayer gamattention introduced basis original yolov5s following argument improvement based experimental result influence csplayer result scheme table show recall map 0.5 map 0.5:0.95 improve 0.7 0.1 1.3 respectively accordingly small target defect detected model higher confidence indicates detailed information localization information small target effectively extracted csplayer module reducing missing detection target influence gamattention result scheme iii table demonstrate metric gained increase extent except slight drop recall however decrease recall may attributed introduction local interaction mechanism gamattention module may occasionally overlook small target resulting slight decrease recall trade-off need fine-tuned optimized specific task meet performance requirement meanwhile comparison original model model added gamattention module achieved progress term detection accuracy small target performance improvement observed may attributed gamattention help reduce model sensitivity local error image mean even target small model locate accurately thereby improving accuracy object detection influence csplayer gamattention result scheme table show precision map 0.5 map 0.5 0.95 improve 5.3 1.4 1.7 respectively therefore using csplayer gamattention improve yolov5s model enhance performance small object detection high accuracy computational efficiency great significance practical application small object detection task table ablation experiment full size table result comparison different attention mechanism comparative experiment carried introducing different attention mechanism according experimental result table found among attention mechanism shuffleattention performs better dealing large-scale target welding line comparative experiment map 0.5 reached 96.5 achieving highest detection accuracy compared attention mechanism fig seen shuffleattention better performance water spot detection missed inclusion shuffleattention may sensitive target scale small object detection characteristic small object may make difficult shuffleattention capture enough relevant information thereby reducing performance however welding line target may larger scale making easier capture relevant information skattention module attention mechanism combine group convolution spatial attention channel attention design goal improve object detection performance reducing computational complexity however although skattention module performs well water spot detection task achieving map 0.5 84.5 performs poorly detecting small object different position fig different object usually low contrast model need spatial context information accurately detect namattention contribution factor weight enhance effectiveness attention performs well crescent gap detection generally performs poorly rolled pit crease detection namattention may perform better task noise simpler task performing worse complex high-noise environment may also influenced scale shape target crescent gap may certain shape characteristic make easier namattention capture relevant information rolled pit crease shape characteristic target may match well resulting poor performance according result attention mechanism comparison experiment table heatmap fig seen water spot oil spot inclusion punching hole higher defect detection accuracy indicating gamattention higher attention small target better capture local information image improve detection rate small target gamattention reduces number channel convolution reducing computational complexity improving detection speed therefore based experimental result concluded introducing gamattention attention mechanism suitable small target detection improve accuracy model faster detection speed compared attention mechanism table attention mechanism comparative experiment full size table figure heatmaps attention mechanism comparison full size image comparison experiment validate performance network model proposed paper small target detection conducted extensive experiment compared existing detection model faster r-cnn yolov5s yolov5l yolov5m yolov5x separately used detection augmented gc10-det dataset according result comparison experiment table faster r-cnn present poor performance gc10-det augmented dataset lower confidence compared detection result algorithm indicating faster r-cnn doe work well term small target detection compared several algorithm model proposed model effectively improves detection accuracy various defect detection accuracy value silk spot contains large number small target reach 90.1 detection accuracy value punching hole welding line crescent gap reach 95.7 95.8 98.9 respectively superior algorithm model table algorithm model comparative experiment full size table performance improved model map 0.5 map 0.5:0.95 proposed model reached 82.8 55.5 respectively 1.4 1.7 higher compared original yolov5s term detection speed model achieves 79.4 fps show improvement made paper feature small target effective addition algorithm confronted missing detection model proposed paper correctly detected targeted defect detection result fig found improved model accurate localization target defect improves accuracy model word network model propose show high accuracy reliability come small target detection promotes detection speed metal surface small target better meet industrial need high-speed automate metal surface detection offering support assistance practical application figure detection result full size image conclusion detection model introduced paper specifically intended improve detection accuracy speed small target defect gc10-det augmented dataset model improves yolov5s network structure mainly includes following aspect first module yolov5s replaced csplayer module enables model adaptively adjust channel weight needed thus improving flexibility adaptability second gamattention introduced help reduce computation improving detection accuracy speed experimental result show comparison detection model model performs better gc10-det augmented dataset effectively reduce false missing detection addition also meet demand lightweight deployment suitable industrial scenario metal material surface defect detection however also found still room improvement detection accuracy defect like rolled pit relatively large size optimization algorithm design needed resolve problem