introduction ongoing spread sars cov-2 creates urgent need rapid detection sars cov-2 virus aid development effective decision making contain transmission communities—particularly high density congregate living university campus campus-wide surveillance system capable rapid detection new infection remain important public health priority wastewater surveillance demonstrated cost-effective approach monitoring viral spread virtue ability detect individual infection early stage setting identify variant concern provide biased assessment population infection dynamics–particularly setting infection underreported health department part return learn rtl program university california san diego ucsd campus-wide geographic information system -enabled wastewater surveillance system implemented detection sars cov-2 since fall currently program sampler collecting daily building residential non-residential previous study ucsd showed wastewater surveillance system highly sensitive detecting individual infection building residential student diagnosed sars-cov-2 positive wastewater signal prior individual identification additionally notification building resident building positive signal doubled testing rate among resident even period routine asymptomatic testing information wastewater result provided ucsd public daily dashboard targeted email notification sent living working building concerning signal key question challenging program using wastewater early detection targeted notification including email notification issued population risk order increase testing enhance mitigation effort contain potential transmission crucial answering question quantitative assessment relationship risk individual covid-19 infection wastewater test result associated sampler recognized need real-time analysis wastewater result inform decision making result correlative study demonstrated significant relationship viral load wastewater individual covid-19 pcr-based test result vallejo used linear model relationship covid test case viral load detected wastewater coruña spain bar-or also applied linear model concluded concentration virus rna bnei brak sewage correlate number covid-19 positive individual city agrawal found significant correlation covid-19 incidence viral load observed wastewater frankfurt metropolitan area performed meta-analysis multi-national wastewater data compared three different model multiple linear regression artificial neural network adaptive neuro fuzzy inference system predicting covid-19 community prevalence infection per 100,000 people based wastewater-based quantity including sars-cov-2 rna concentration several study utilized wastewater result single time point also longitudinal time series wastewater data krivoňáková found high correlation number viral particle wastewater number individual case tested week later data bratislava cao analyzed time series wastewater result using vector autoregression model model weekly variation sars-cov-2 wastewater concentration covid-19 case borough indiana pa. compared different time-series non-time-series machine learning deep learning model including linear model gradient-boosting decision tree feed-forward deep neural network facebook prophet long short-term memory predictive performance covid-19 case central ohio result indicated time-series model outperformed non-time-series model study also compared advanced neural network predict covid-19 case however existing study focused extracting interpretable predicting feature time series wastewater result using predict individual test result crucial facilitating transparent informed community-level decision making well evaluation reliability robustness decision comparing black-box type model model identify importance feature particularly advantageous provide decision maker clear understanding factor contribute model prediction allowing targeted intervention informed decision making study propose new pipeline feature extraction longitudinal wastewater-based testing result predicting individual covid-19 infection feature discus wastewater testing one example pooled testing different setting standard pooling investigator control standardize many sample pooled much sample person contributed setting factor impacted design wastewater system depend process experimenter control principle remain analysis example evaluation diagnostic tests—in case wastewater tests—based property sensitivity specificity positive negative predictive value wastewater test result used predict outcome level set residence building associated manhole sampler installed outcome seek predict whether least one person infected set building associated given sampler use machine learning make use longitudinal time series wastewater test develop optimal rule notification based test property specifically develop hierarchical classification/decision tree model select important feature longitudinal series test trigger notification—that make likely least one resident positive analysis data wastewater test infection among resident ucsd derive information collected period nov. nov. covering approximately whole academic year result indicate leveraging single-day long-term short-term feature extracted time series wastewater result classification tree model predict presence positive resident high sensitivity satisfactory specificity important wastewater feature identified hierarchical manner important feature positive wastewater test least past day fewer past day positive wastewater test result next important feature whether past day positive wastewater test applying model set-apart testing set prediction accuracy 72.3 also compare performance proposed model random forest model benchmark commonly used statistical machine learning model result indicate proposed model predict outcome equal better accuracy maintaining high level interpretability finding derived proposed approach used evaluate refine current notification system ucsd system sends timely email notification alert resident positive wastewater sample associated residence building recommend individual covid-19 test contain transmission early stage result study ucsd modified email notification system notify day positive signal however omicron surge email notification issued positive day due short viral kinetics indicating need ongoing analysis virus epidemiology change study address urgent need real-time analysis data wastewater surveillance system predictive model using wastewater feature predict covid-19 infection result study facilitate informed decision making community-level recommendation policy intended contain prevent transmission covid-19 approach proposed provides accurate prediction individual covid-19 infection interpretable feature engineering readily implemented applied similar system data processing model pre-processing wastewater test result part ucsd return-to-learn program total number commercial auto-samplers deployed manhole across ucsd campus covering teaching administrative residence building including four isolation building student test positive covid-19 study focus data manhole covering residence building resident figure show structure manhole associated residence building twenty-four-hour composite wastewater sample collected daily manhole analyzed laboratory viral concentration sars-cov-2 signature screened via real-time quantitative pcr rt-qpcr gene result integrated campus database traceback manhole associated upstream residence building identify potential source positive sars-cov-2 signal figure location autosamplers installed manhole orange circle connected ucsd building grey block full size image mentioned wastewater test used estimate sensitivity specificity different rule predicting least one person test positive among resident set building associated given sampler requires tracing source positive signal back building way account upstream/downstream structure sewer network building contribute wastewater matched given manhole shown fig structure manhole connecting residence building however set building associated sampler depend result wastewater test example wastewater sampler test positive upstream sampler test negative building contributing wastewater sewer sampler considered relevant analysis signal sampler contrast sampler positive building associated either included analysis spatially enabled sewer network subsequent trace sampler building stored performed arcgis pro 2.7 esri detail sewer network tracing sampler found interactive web interface http analysis focus time period 11/23/20–11/13/21 cover majority academic year 2020–2021 first quarter year 2021–2022 total 23,282 wastewater daily sample collected period cutoff quantification cycle value used categorize sample positive vs. negative among sample positive 19,794 negative ascertainment individual test result covid-19 covid-19 pandemic ucsd student resident required take individual covid-19 test weekly reduced bi-weekly spring addition effort alert individual potential infection building encourage tested one on-campus diagnostic testing site self-administered test-kit vending machine targeted email notification sent resident associated source building positive wastewater sars-cov-2 signal detected manhole notice also sent ucsd campus potentially positive building contained common access area open public test sent san diego health lab processing result saved electronic health record ehr system result individual test available within one day testing daily individual diagnostic covid-19 test result resident building aggregated merged daily wastewater result manhole associated building excluding missing observation total daily wastewater test record merged data positive negative corresponding covid-19 individual diagnostic test result among student residing campus housing indicate positive negative covid-19 individual diagnostic positive test result among student residing campus housing 54.7 tested-positive wastewater sample associated manhole day individual test indicating using daily wastewater test result alone achieve satisfactory prediction individual infection covid-19 associated building potential reason observed discrepancy individual test wastewater result include delay tested getting result among become infected example among infected resident could delay manifestation symptom absence symptom reason others individual test may take place day actual onset infection also false negative wastewater test result arising low viral concentration even one resident associated building become infected addition possibility false positive wastewater result understand implication wastewater sample optimize utility wastewater surveillance system detecting individual infection definition outcome individual infection account potential lag wastewater individual test result needed propose 3-day time window approach define outcome individual infection using date wastewater test anchor point manhole examine individual diagnostic test result resident associated building 3-day window including date wastewater test day wastewater test outcome defined positive individual-level test exists least one positive individual covid-19 test result among resident associated building time window proposed time window address time lag wastewater individual test including positive individual test interval one day one day detection positive wastewater test sensitivity analysis using longer window day also conducted result described appendi choice window lead similar model doe analysis 3-day window model predicting individual covid-19 infection using wastewater result detect individual covid-19 infection use multiple interpretable feature extracted wastewater time series data include single-day test result short-term/long-term trend provide comprehensive characterization different aspect wastewater test result feature integrated model list feature includes single-day wastewater result five day day question count positive signal among past day including whether least past day past day past day past day contains positive wastewater signal feature characterizing trend past day whether wastewater result positive past consecutive day adopt machine learning approach–classification trees– predict individual covid-19 infection defined using 3-day window feature extracted wastewater signal classification tree derives hierarchical model predicts outcome recursive binary partition based ordering importance predictor node/leaf classification tree feature capable reducing maximal amount gini impurity criterion measure mixture different class outcome selected partition data predictor appear earlier node considered important predicting outcome ordering importance predictor crucial study aim accurately predict presence infection residence building reveal important interpretable feature wastewater test result aid decision making campus-wide recommendation mandate avoid overfitting improve interpretability apply constraint model complexity using penalty parameter addition classification tree mitigates collinearity among predictor result variable selection mechanism based feature importance also incorporate re-weighting mechanism model address important issue imbalance outcome many negative positive individual test result data represents typical imbalance outcome individual testing covid-19 similar community model optimizing prediction accuracy trained data without adjustment tend classify outcome negative due over-representation negative outcome address issue re-weight data allocating larger weight positive negative outcome training classification tree model approach similar over-sampling minority class under-sampling majority class shown achieve good classifier performance evaluate performance proposed approach partition data 11/23/20 11/13/21 training testing set training set includes data 11/23/20 04/30/21 testing set includes data 06/30/21 11/13/21 partition dataset random preserve chronological ordering date test result definition feature extracted wastewater sample rely chronological ordering date addition result period expected behave similarly policy circulating variant pandemic condition vary chronologic time measurement comparing model performance training testing set also provides insight influence factor effectiveness wastewater surveillance system exclude sample may june due potential data quality issue investigation wastewater result period needed appendix present sensitivity analysis includes data period obtain model described following section analysis serf demonstrate robustness result result classification tree trained training set figure show result classification tree trained training set top root bottom leaf tree show feature selected predict outcome feature closer root considered important branch node visualized arrow describe feature two possible condition used binary partitioning data according condition satisfied color node indicates predicted outcome record partitioned category corresponding node red indicates positive predicted outcome least one infection associated building blue negative predicted outcome value circle node indicates percentage partitioned data record whole data figure classification tree model trained training set wastewater time series feature used predict individual covid-19 test result red node mean positive predicted outcome blue node mean negative predicted outcome value inside node denotes percentage total data record fall category node mean number positive wastewater result example last day mean day positive wastewater result last day wastewater testing full size image model fig indicates important feature predicting outcome whether fewer day last positive wastewater test result outcome predicted positive wastewater result positive least past day negative otherwise given positive wastewater result fewer past day second important feature whether none past day positive wastewater result yes outcome predicted negative otherwise positive classification/decision tree fig fitted weight positive outcome equal positive class weight negative outcome equal 1/number negative class note weight standardized total number positive negative outcome respectively multiplied scaler based importance placed correctly predicting positive negative outcome choice weight reflects priority sensitivity true positive rate specificity true negative rate predicting positive individual infection sensitivity analysis using weight equal reciprocal class size class performed appendix value penalty parameter model complexity 0.02 chosen balance optimal performance training set suggested cross-validation maintaining small number node tree model interpretability sensitivity analysis using 0.001 train model available appendix investigate influence model complexity prediction performance trade-off model complexity interpretability table show confusion matrix prediction applying model training set sensitivity true positive rate tpr tp/ 83.7 specificity true negative rate tnr tn/ 58.5 note calculation sensitivity specificity unaffected weight allocated positive negative outcome class weight appear numerator denominator cancel overall weighted prediction accuracy 75.3 calculated i\left predict positive positive i\left predict\ negative negative denotes weight sample i\left predict positive positive denotes indicator function sample positive outcome predicted positive i\left predict negative negative denotes indicator function sample negative outcome predicted negative expected observe higher estimated sensitivity specificity over-sampling positive outcome class compared negative class table confusion matrix result obtained applying model trained training set training set full size table evaluate prediction performance classification tree apply model set-apart testing set period 06/30/21–11/13/21 confusion matrix provided table testing set sensitivity decreased 83.7 77.1 specificity increased 58.5 62.8 overall weighted prediction accuracy 72.3 testing set contains period student resident already received vaccination wave highly infectious sars-cov-2 omicron variant yet arrived therefore fewer infected case observed thus underrepresented total population despite evolving nature pandemic model performed well able predict individual infection satisfactory accuracy high sensitivity also trained model testing set alone compared model trained training set comparison result available appendix table confusion matrix result obtained applying model trained training set testing set full size table influence weight section investigate role relative weight positive negative outcome prediction simplicity notation denote relative weight positive class negative class positive vs. negative outcome example model fig trained weight 2:1 weighting place double amount emphasis record positive outcome compared negative outcome standardizing total number positive negative outcome trained classification tree model relative weight 1:1 available appendix sensitivity analysis figure display receiver operating characteristic roc curve demonstrates trade-off sensitivity specificity -axis indicates one minus specificity -axis indicates sensitivity curve permit comparison performance model trained varying weight detailed result provided table relative weight positive class small 0.2:1 outcome predicted negative hence sensitivity specificity weight positive class increase sensitivity also increase specificity decrease relative weight 4:1 greater outcome predicted positive yielding sensitivity specificity figure roc receiver operating characteristic curve model trained different relative weight positive negative outcome class using data training set left panel show result obtained applying model training data right panel show result applying model trained training set testing set full size image table detailed value sensitivity 1−specificity roc curve fig full size table table summarizes importance feature model trained different weight given order node appearing classification tree result comparable value 0.02 used training model different weight approach lead different number node different weight setting model root node defined whether fewer past day positive wastewater signal consistently predictive wastewater feature predicting individual covid-19 infection model lower level node/leaf next important feature whether none previous day positive wastewater signal combined result root node predictive model robust choice weight consistently includes dichotomous feature day wastewater positive yes/no previous day wastewater positive day model leverage feature characterizing wastewater result long-term trend day shorter period day table importance feature extracted wastewater time series given model trained different relative weight full size table prediction random forest model benchmark evaluate prediction performance proposed classification tree model apply weighted random forest model consisting ensemble individual weighted classification tree classification tree model weight applied oversampling positive individual case random forest known high prediction accuracy lack interpretability classification tree comparing performance proposed model random forest enables ass proposed model reliable benchmark understand trade-off interpretability prediction accuracy model detailed result provided table proposed classification tree model generally outperform random forest model weight setting especially relative weight positive vs. negative outcome high random forest approach choice weight ratio lead high sensitivity relatively high specificity 3:1 case sensitivity equal 72.9 specificity equal 68.5 leading 71.7 prediction accuracy proposed classification tree model prediction accuracy 73.5 3:1 weight ratio one possible reason random forest under-perform compared proposed classification tree random forest based bootstrap subsampling data break chronological structure time series data thereby potentially affect prediction performance another possible reason given relatively small feature space limited number positive covid infection data increased complexity random forest model introduces risk overfitting likely contributed decreased accuracy applied unseen test data furthermore random forest model preferred choice study due reduced interpretability transparency particularly purpose guiding campus-wide policy table tpr sensitivity fpr 1−specificity different machine learning model different relative weight calculated applying model trained training set testing set full size table table weighted prediction accuracy different machine learning model different relative weight calculated applying model trained training set testing set full size table comparison statistical machine learning model besides random forest model also ass proposed classification tree model various commonly used statistical machine learning model thoroughly evaluating predictive performance interpretability model fitted using identical feature extracted wastewater signal training testing data partitioning weight ratio positive vs. negative outcome classification tree model ensuring fair comparison result listed section focus model performance weight ratio 2:1 proposed classification tree model complete result variety weight ratio found table first apply logistic regression model logistic regression lasso regularization variable selection preprocessed data ten-fold cross-validation used determine value penalty parameter lambda lasso threshold 0.5 predicted probability positive individual infection used determine binary predicted outcome logistic regression without variable selection produce relatively low prediction accuracy 67.7 sensitivity 66.7 specificity 69.8 applying model fitted using training set set-aside test set observed under-performance prediction test set may due higher model complexity lead overfitting logistic regression lasso yield improved accuracy 72.3 sensitivity 77.1 specificity 62.8 test set variable selected using lasso include indicator positive wastewater signal least day past day least day past day least day past day largely overlapping important feature selected classification tree model hence similar result although lasso selects one additional variable compared decision tree method similar prediction performance exactly decimal digit variable whether wastewater signal positive least day past day regression coefficient close despite exactly equal popular variable selection method lasso considered comparable approach decision tree study intuitive term ranking variable importance prediction critical factor consider policy making process also apply several machine learning model including support vector machine svm linear kernel feedforward neural network fnn single hidden layer traditional svm fnn support variable selection limited interpretability furthermore prediction performance two method fall short classification tree method test set svm accuracy 71.1 sensitivity 72.9 specificity 67.4 fnn accuracy 69.0 sensitivity 70.8 specificity 67.5 notably fnn exhibit impressive performance training set achieving accuracy 78.1 underscore complex machine learning method excel fitting training data may encounter overfitting issue applied unseen testing dataset furthermore weight ratio positive vs. negative increase 3:1 svm loses effectiveness resulting specificity predicting outcome positive table include detailed result sensitivity vs. 1-specificity applying training-set-fitted model different weight ratio test data using model comparison classification tree method logistic regression lasso two approach strike good balance interpretability high sensitivity particularly using weight ratio 2:1 and/or 3:1 overall proposed classification tree model still posse best prediction accuracy given good prediction performance interpretability result logistic regression lasso serve viable alternative classification tree model nevertheless perspective policy maker classification tree may still hold advantage due intuitive feature importance ranking detail prediction accuracy sensitivity specificity training model found appendix positive predictive value ppv negative predictive value npv examine positive predictive value ppv negative predictive value npv prediction individual infection defined aligned positive predictive value ppv wastewater test sensitivity test prevalence sensitivity prevalence specificity prevalence aligned aligned negative predictive value npv test specificity test prevalence specificity prevalence sensitivity prevalence aligned number true false positive number true false negative prediction prevalence proportion true positive among tested unit observation could example building individual level quantity particularly useful developing policy regarding control covid-19 epidemic case pooled test result help using testing resource efficiently—by focusing intensive testing case likely reside addition test provide early warning potential least one resident building unit infected make best use wastewater test estimate probability least one infected person residence given positive wastewater test estimate aid evaluating cost–benefit different strategy testing resident addition knowledge relationship timing positive wastewater test positive individual-level test inform when—or schedule—it best offer latter resident testing setting little complex usual wastewater test pooled test aggregate result building associated manhole hence number contribute pool varies across tests—which done residence level furthermore prevalence interest residence level noted define residence true positive least infected resident residence like wastewater definition residence building level prevalence residence building level estimated prevalence individual level given number resident assumption independence across infection event across prob infected resident 1−p individual-level prevalence detected infection event observed single person believe violation assumption little effect estimate prevalence covid-19 number resident vary date estimate ppv npv vary date well also possible dilution effect could affect estimation example detectability sars cov-2 genetic material may depend total number resident living upstream manhole provide approximate building-level estimate ppv npv demonstrate affected number resident building associated manhole focus period week fall quarter begin student resident process moving back onto campus week required take individual-level test soon move residence curve ppv npv function number people residence building shown fig note ppv npv quite sensitive number resident usefulness wastewater test must considered context negative test reassuring number climb near whereas ppv approach number resident near figure ppv npv curve function number resident building associated manhole full size image sensitivity analysis furthermore conduct comprehensive sensitivity analysis designed ass model performance systematically vary sampling setting model parameter compare proposed approach model method evaluate result specifically sensitivity analysis includes altering time-window length defining outcome individual covid-19 infection applying different weight ratio positive vs. negative outcome fitting model varying model complexity including number predictive feature selected fitting separate classification tree model using test set examining data may june training proposed model data including fall vaccine still publicly available varying sampling frequency wastewater signal conducting comparative analysis proposed classification tree model statistical machine learning model detail sensitivity analysis result available appendix based result sensitivity analysis conclude proposed model method stand overall best choice context study applying model recommend researcher leverage model study carry similar sensitivity analysis refine parameter setting tailored specific individual model concluding remark paper proposes innovative approach predicting presence infection residence building using result wastewater surveillance system goal study make use wastewater test result inform decision making regarding notification wastewater result guide public health strategy intended control spread individual covid-19 infection community end extract feature characterize wastewater test result time develop classification/decision tree model select important feature use predict probability least one individual infection residence finally optimize covid-19 test notification strategy used classification tree analyze data wastewater surveillance system individual-level covid-19 test resident ucsd campus nov nov result reveal best predictor positive individual level test residence building whether wastewater result positive least past day using set-apart testing set demonstrate accuracy prediction result suggest proposed analysis approach useful using wastewater guide policy around notification building resident seek individual-level testing feature included model robust change weight positive negative individual test result feature discovered important consistent across different weight setting balancing positive negative outcome data study contributes ucsd wastewater surveillance system introducing streamlined effective methodology utilizing wastewater test data inform campus-wide decision-making effort aimed reducing virus transmission preventing outbreak leverage advanced statistical machine learning technique identify key feature time series wastewater test result optimizing cost-effective utilization surveillance system capability discovery analysis useful assisting decision making ucsd campus-wide return-to-learn program incorporated ucsd email notification system although approach motivated developed ucsd return-to-learn program readily applied similar wastewater surveillance system predict individual covid-19 infection community facilitate decision making process making community-wide guideline mandate policy containing transmission virus applying proposed approach several aspect model may need adjusted researcher and/or policymakers according pandemic condition time analysis detailed discussion regarding potential limitation proposed approach applied scenario presented following section discussion study potential limitation may affect effectiveness proposed approach applied scenario discus limitation provide direction possible solution first defining outcome individual covid-19 infection introduced time window day account potential lag onset infection testing mismatch individual infection wastewater result required test frequency change optimal performance wastewater test may require time window adjusted accordingly second condition pandemic vary time regular appearance new variant change people behavior responding masking mandate mitigation strategy furthermore coverage rate vaccination may improve time community effectiveness older vaccine constantly wane external factor influence effectiveness model using wastewater test result possible solution ensure model reflects adapts changing factor use online learning approach continuously update model training new data becomes available time sensitivity analysis also conducted examine influence importance factor third important consideration trade-off cost benefit different wastewater testing strategy may vary different application study utilized available daily wastewater data however scenario collecting daily wastewater signal costly one possible solution adjust data collection frequency strike balance cost benefit presented sensitivity analysis appendix ass impact different sampling frequency however important note working data sampled different frequency adjustment must made feature engineering method feature derived daily wastewater measurement may applicable frequent data collection trade-off sampling cost prediction accuracy model also examined carefully another aspect cost–benefit trade-off choice wastewater epidemiology individual clinical covid test ucsd test cost approximately wastewater sample clinical sample though technical cost higher wastewater due additional concentration step labor cost higher clinical due need licensed personnel resulting rough balance sampler roughly evenly distributed residential non-residential area approximately sampler serving 10,000 resident clinically testing 10,000 people twice week result 20,000 test per week contrast utilizing daily wastewater surveillance group individual week total test per week illustrating substantial cost saving scale additionally one could argue antigen test expensive qpcr essential consider data capture cost notably high primarily automated method individual report test result generally trade-off cost benefit topic included potential future direction research area aim provide useful discussion recommend researcher conduct cost–benefit analysis and/or explore long-term sustainability wastewater surveillance covid-19 within context situation finally ethical privacy concern need addressed applying proposed approach scenario ethical privacy concern minimal application wastewater collected building level doe contain identifiable information trace back specific individual therefore wastewater testing component helped improve timeliness email notification introduce additional data element could jeopardize privacy however measure may universally applicable researcher seeking replicate approach carefully consider ethical implication specific context adhere relevant privacy regulation ethic declaration institutional review board irb university california san diego provided approval human subject protection oversight data obtained excite laboratory campus clinical sample informed consent obtained participant included study appropriate institutional form archived sample identifier included de-identified wastewater component project discussed irb deemed human subject research record personally identifiable information method carried accordance relevant guideline regulation