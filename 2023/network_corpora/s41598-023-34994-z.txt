introduction many human clinical condition corresponding animal model result abnormal motion measuring motion requisite step studying health subject animal subject researcher typically conduct measurement manually high cost limited resolution high stress animal work present low-cost non-invasive computer-vision based approach continuously measuring motion pose laboratory mouse study animal model movement disorder parkinson disease tremor even generally measure behavior researcher rely manual tool rotarod static horizontal bar open field test human scoring increasingly complex automated tool study gait locomotion developed computer vision machine learning creating new measurement opportunity home cage environment tracking behavior whereas open field arena without feature home cage enclosure furnished familiar bedding food water well enrichment item allow animal exhibit wide range movement behavior far study measure motion home cage coarse resolution number joint requiring multiple camera nevertheless new measurement tool offering compelling opportunity new analysis parallel computer vision machine learning leading great improvement determining human pose image model optimizing kinematic model fit image data paired improvement estimating pose combining method library human shape human pose human pose estimate grounded real kinematic model realistic motion ongoing research improving spatial temporal coherence work adapts technique originally developed infer human pose mouse predict keypoints mouse optimize pose subject prior learned data infer human pose database human shape pose keypoints keypoints readily available none available mouse lack data presented unique challenge accurately infer pose overcome challenge collecting new data adapting needed design algorithm collect data achieve two goal scalability algorithm able monitor mouse home cage continuously prolonged duration large number cage time although open field assay one commonly used assay research induces stress animal variance study outcome home cage provide subject natural setting facilitate unbiased physiological behavior study measurement activity multitude home cage pose fresh challenge call robust algorithm robustness occlusion animal object cage main obstacle reconstructing pose accurately approach problem employing full set anatomically significant keypoints fig observed model trained keypoints generalizes occluded body part compared keypoints use data large scale datasets provide fewer keypoints example calms21 dataset keypoints mar dataset pair-r24m dataset rat dataset although capturing marker keypoints animal body support reproducibility encourage future research make annotated training evaluation data pose reconstruction model code publicly available mouse pose analysis dataset released following feature high resolution scan mouse wide weight distribution sex video clip mouse activity home cage light dark cycle keypoint label mouse behavior label ground truth keypoint label capture rig multiple camera kinect device validate method demonstrating metric accuracy inferred pose predictive accuracy health related attribute correlation direct measurement gait case inferred pose useful detailed measurement study reported accordance arrive guideline http related work pose estimation development deep learning based animal pose estimation deeply influenced human pose algorithm see recent survey deeplabcut employ transfer learning achieves human accuracy small number labeled sample spurred many development leap speed annotation process even iteratively fine tuning model providing initial guess new training sample deepposekit eliminates preprocessing step leap claim increase robustness factor rotation lighting change three method work open field setting however clear perform home cage image another line improvement utilize spatio-temporal consistency adjacent video frame optiflex computes optical flow information keypoint heat map generated base model show improvement accuracy robustness openpifpaf composite field including intensity association temporal association field detect track keypoints instead adding composite field end network deepgraphpose encodes spatio-temporal structure graphical model advantage model ability infer occluded keypoints pose estimation pose sufficient many biological question movement kinematics indispensable understanding connection neural motor system pose obtain triangulating keypoints multiple camera and/or using depth sensor construct multi-view capture rig includes kinect device detailed multiview pose reconstruction section evaluate single view reconstruction algorithm added complexity limit scalability system feasible install extra device monitor dozen cage recent advance machine learning seen method reconstruct pose single camera view liftpose3d estimate joint location single view training network lift function 3-d ground truth data training data augmented different camera angle bone length enables network solve camera parameter implicitly cope variation animal size comparison estimate camera parameter build shape distribution explicitly dunn regress volumetric representation animal pose calculated different end-to-end learning algorithm cast pose estimation optimization problem mouse skeleton model encoding joint angle explicitly model output readily interpretable importantly skeleton model imposes strong prior see kinematic chain pose prediction section overcomes missing observation occlusion serf regularization over-parameterized joint space mouse pose analysis dataset mouse pose analysis dataset includes video clip c57bl/6n diversity outbred mouse image c57bl/6n mouse goal support diverse research problem animal physiology behavior providing dataset cover lab mouse typical genotype sex weight activity home cage study performed compliance abbvie institutional animal care use committee national institute health guide care use laboratory animal guideline facility accredited association assessment accreditation laboratory animal care video-capture-related research performed part calico life science llc aaalac-accredited animal care use program research animal use study approved calico institutional animal care use committee iacuc data collection scan male female wild-type c57bl/6n mouse obtained charles river lab wilmington animal acclimated animal facility period approximately one week prior commencement experiment animal tested light phase 12-h light/12-h dark schedule anesthesia induced using isoflurane isoflurane level maintained 2.5 vol oxygen data acquired using siemens inveon micropet/ct knoxville animal underwent scan following setting total rotation 220^\circ 1^\circ step dark/light calibration transaxial axial field view 58.44 92.04 respectively exposure time binning factor effective pixel size 45.65 voltage current setting respectively total scan time per animal estimated image used common cone-beam reconstruction method included houndsfield unit calibration bilinear interpolation hamming reconstruction filter reconstructed image converted dicom using vivoquant software invicro konica minolta company video frame diversity outbred mouse obtained jackson laboratory strain bar harbor c57bl/6n obtained charles river lab wilmington build general purpose visual pipeline acquired video diversity outbred strain mouse range weight approximately 20–60 sex female male age 1–3 year coat color albino black agouti mouse placed monitoring cage outfitted single camera vium time mouse housed singly provided running wheel nesting enrichment cotton nestlets video recorded frame per second dark cycle infrared illumination used diverse collection video manually selected video clip animal perform one following behavior standing drinking eating grooming sleeping walking running wheel since activity happen dark cycle majority clip infrared image clip 0.5 long sampled activity manually labeled researcher watching clip surrounding context another distinct subset clip manually selected diverse pose researcher pose mouse frame clip annotated trained animal technician yielding annotated frame pose annotation pipeline described keypoints behavior annotation section hope data set useful community train evaluate similar system release pose behavior annotation along corresponding frame collected three set experimental video data used evaluation continuous multiview gait continuous video data day cage eight animal 1-year old homozygous eif2b5r191h/r191h knockout mouse c57bl/6n background eight 1-year old heterozygous knockout control eight 1-year old c57bl/6n mouse eight 2-months old c57bl/6n mouse knockout mouse deletion cause motor deficit knockout mouse heterozygous control littermates c57bl/6n background inbred several generation mouse three attribute age either month old knockout either full knockout background either littermate knockout c57bl/6n multiview video data consecutive multiview frame single c57bl/6n mouse custom capture rig described note depth information kinect sensor noisy use ground truth instead use rgb value multiple-view set gait video data single c57bl/6n mouse walking treadmill camera installed corresponding commercial analysis tool digigait additional camera mounted gopro use analysis multiview gait video data captured frame per second experimental video set used demonstrating utility method released experiment approved institutional animal care use committee worth noting large body literature speed frequency mouse locomotion though stride length frequency dependent speed observed multiple study stride frequency fall mean nyquist rate typical mouse movement camera therefore sufficient record many behavior including locomotion faster motion beyond scope study e.g whisker dynamic faster camera could used algorithm depend camera frame rate figure left keypoint name corresponding color-coded marker shown labeling interface center labeled image mouse keypoint legend left right high resolution scan segmented bone light color segmented skin darker color corresponding keypoint location neutral pose full size image keypoints behavior annotation ten scientist technician participated keypoint behavior annotation asked view video clip label clip behavior label see table list instructed draw bounding box around animal label keypoints corresponding skeleton joint fig non-joint keypoints defined follows lower spine point mid point two hip joint spine upper spine similarly defined two shoulder joint middle spine half way upper lower spine point spine annotator asked mark best guess keypoints occluded objective obtain possibly noisy label expert rather label dataset statistic image include mouse different age weight mouse grouped based weight sex per group group female weighed 15.7 0.74\ male weighed 18.4 0.98\ group female weighed 24.9 1.8\ male weighed 23.2 1.36\ group female weighed 28.0 2.52\ male weighed 27.3 0.97g group female weighed 35.3 6.11\ male weighed 38.7 3.00\ video frame consist c57bl/6n subject rest diversity outbred table show distribution behavior label among video frame figure show aggregated location mouse given nocturnal nature mouse video frame night cycle since emphasize pose analysis mouse movement half annotation mouse running wheel table percentage human-labeled mouse behavior video frame full size table figure heatmap annotated mouse keypoints displayed home cage dot represents one keypoint majority activity happen wheel near feeder full size image data availability data used training evaluating pose estimation released part publication data demonstrating utility biologically relevant task released specific paper larger easily shareable believe limit ability reproduce method evaluate performance pose estimation specifically release annotated frame video annotated training evaluating pose ct-scans used construct shape prior request access data via link http related datasets mouse rat datasets comparable size publicly available mit mouse behavior dataset contains 10.6 continuously labeled side-view video day video night video eight behavior interest drink eat groom hang micro-movement rear rest walk mouse singly housed home cage keypoint label caltech mouse social interaction calms21 dataset consists million frame unlabeled tracked pose interacting mouse home cage well million frame tracked pose corresponding frame-level behavior annotation seven keypoints nose ear base neck hip tail labeled rat dataset contains 10.8 video across different rat camera view totaling million frame across wide range rat pose frame captured marker attached animal using array camera pair-r24m dataset contains 24.3 million frame rgb video ground-truth motion capture dyadic interaction laboratory rat distinct pair rat different viewpoint frame provides position body landmark associated one behavioral category inter-animal interaction category first two datasets labeled keypoints latter two labeled keypoints contain open field image rather home cage image mouse pose analysis dataset first large scale dataset lab mouse home cage full set keypoint behavior annotation method mouse pose prediction feature extraction pipeline shown fig includes three stage bounding box detection pose prediction pose optimization stage shown effective human pose estimation release machine learning model code pipeline http figure top pipeline diagram rectangular box algorithm process ellipsis intermediate final result pipeline bottom pictorial depiction pipeline operates frame video left panel frame run object detector trained detect mouse second panel box indicating detection apply pose model detect mouse keypoints detected location third panel colored heatmap indicating joint location arbitrary color finally optimize pose mouse right panel blue point peak keypoint heatmaps previous stage red point projected keypoints optimized pose grey mesh overlaid image full size image detection pose prediction adapt single-shot detector detect mouse stacked hourglass network infer mouse pose similar work adapting human pose model laboratory animal detection pose model require training data generate labeling joint position along body take minimal box encompassing point bounding box model pretrained coco prediction head human keypoints replaced mouse keypoints continuous video data label image training set test set gait video data fine-tune continuous video model additional labeled image training set test image frame selected manually annotated cover diversity input image across cage time evaluate pose model object keypoint similarity score used coco -\textbf _i^2 2\textbf _i^2\textbf 20\ _i\ euclidean distance prediction ground truth object scale square root bounding box area per-keypoint falloff k_i\ set human median 0.08 keypoints see http keypoints-evalforfurtheroksdetails setting equivalent measuring proportion predicted keypoints certain radius ground truth point proportional bounding box size radius decrease requiring accurate prediction higher threshold smaller bounding box size accuracy computed percentage predicted keypoints greater threshold score/pixel radius table table pose accuracy proportion keypoints score specified threshold different joint across different data set radius pixel region corresponding threshold average bounding box size full size table kinematic chain pose prediction adapt human pose optimization strategy mouse similar optimization strategy successful inferred pose relatively little ground truth data pose defined kinematic chain consisting joint fig ear excluded joint modeled spherical leading total number joint angle since camera lens fixed cage pre-calibrate intrinsic extrinsic parameter available dataset website iteratively update joint angle bone length kinematic chain represented minimize distance input keypoint location projected joint location aligned =\sigma _i\vert proj k_i ^2+\lambda p_p +\lambda p_s aligned improve stability convergence pose optimization using shape prior p_s\ pose prior p_p\ prior constructed similar smpl model build pose prior multiple-view reconstruction pose see augmented hand-posed model joint angle set modeling software match apparent mouse pose set image cover pose may appear multiple-view video pose align scale pose vector base neck middle spine defined x-axis unit length fit gaussian mixture model component data _p\ set small value pose prior weak effect similar keeping foot towards ground constraining recovered pose small mixture distribution build shape prior collect bone length scan dataset cover mouse different gender age weight fit 7-component gaussian mixture model length form shape prior optimization over-parameterized overall size distance camera confounded result arbitrary scale physically implausible rotation solve complication constraining animal fixed distance camera similar scene constraint common approach reconstructing physically meaningful pose multiview pose reconstruction generate ground truth pose data validation constructing pose prior build custom multiview capture rig top-down rgb+depth camera kinect two side rgb camera synchronized timing calibrated overlapping field view mouse cage label joint position synchronized frame field view triangulate location joint position minimizes reprojection error multiview reconstruction used evaluate single-view reconstruction quality separate larger set used construct pose prior biological attribute prediction mouse description eif2b5r191h/r191h knock-in mutant mouse model used study generated background strain c57bl/6j eif2b mutant known motor defect increased slip balance beam decreased inverted grid hanging time decreased rotarod duration different stride study compared r191h homozygous mutant heterozygous litermates het demonstrate detect locomotor deficit known mouse model genetically similar sibling mouse measured month month also measured set c57bl/6j mouse compare het group age het mouse backcrossed sufficient number time control genetic drift result comparison het group distinguish difference drift mutation-caused phenotype observed difference point sensitivity method attribute prediction ass representation preserve information motion dynamic train black-box artificial neural network model predict biological attribute continuous video data want study gait factor limit analysis sequence animal near wheel night cycle mouse active train predict label interval evaluate performance across aggregated prediction score animal normalize amount time wheel data split training segment test segment set disjoint set mouse data representation test train convolutional neural network kernel size predict label independently trained model using adam optimizer sum binary cross-entropy loss per attribute epoch perform hyperparameter sweep number layer network number hidden unit layer learning rate 0.0001 0.00001 0.000001 using half training set validation report best accuracy representation test set gait measurement direct measurement gait parameter obtained via commercial system digigait use aggregated stride length posture plot report well individual stride length measurement commercial system calculate similar measurement method computing duration stride reconstructed pose multiplying known treadmill speed calculate stride length aggregate duration stride calculated wavelength fourier spectrum peak magnitude individual stride duration calculated peak-to-peak time result inferred pose figure comparison multi-view single-view reconstruction error bar top three panel show three view mouse time point red dot reconstruction triangulation cyan dot single-view reconstruction four joint shown example tail noise left paw right paw full size image quantitatively evaluate quality pose multiview video data set determining ground truth pose multiple view see method section calculate well reconstruct pose top view alone inferred pose registered ground truth pose quantify error inferred pose millimeter fig show rmse measurement per joint error bar standard error error tail shoulder head smaller ankle hip wrist whose pose noisier due occlusion average error joint average body length mouse approximately represents relative error find another monocular pose reference list number compare although number allow room improvement demonstrate result accuracy sufficient enable health prediction extraction gait parameter biological attribute prediction pose inferring pose show extracted representation sufficient infer subtle difference age genetic background heterozygous versus homozygous knockout use continuous video data attribute ass easily model predict biological attribute different feature bounding box keypoints keypoints joint angle train range artificial neural network representation present best result feature held set animal table joint angle outperform others able perfectly classify animal test set others make one three mistake test set animal table table classification accuracy mean standard\ error training run input representation held-out set animal three attribute whether animal month old age whether animal litter mate knockout bkgrd whether animal knockout full size table accurate gait measurement pose validate method compare measurement stride system measurement digigait system directly image foot infer pose viewed using method estimate stride compare output direct stride measurement digigait system fig find recapitulate multiple direct measurement figure top left example time series foot position arbitrary unit periodic structure gait clearly visible red dot indicate peak used computing stride length top right peak frequency foot position reconstruction belt speed blue solid digigait posture plot stride length orange dashed bottom left distribution stride length pose reconstruction dark blue digigait light orange dashed black vertical line indicate outlier threshold statistical modeling bottom right stride length treadmill speed reconstructed pose blue solid digigait orange dashed error bar indicate sem full size image stride length estimated magnitude fourier spectrum foot position several second match aggregated posture plot stride length well spectrum analysis aggregate time accurate single stride analysis avoids sampling noise due limited frame rate use fps however compute statistic aggregated number also compared noisier individual stride estimate measure peak-to-peak time estimate individual stride length compare distribution direct measurement excluding asymmetric outlier beyond 2.3 mean measurement system significantly different direct measurement 2-way anova main effect measurement system =-\ 0.8 p=0.424\ statistic prove distribution identical claim measurement similar commercial system except digigait outlier short stride long stride behavior classification learn evaluate inferring behavior mouse manually labeled set training video validation video test video intentionally use small data set mimic common need biological research reuse component solve new task limited labeled data available behavior often inferred single frame compare convolutional neural network addition low-dimensional extracted feature extract resnet embeddings consecutive frame average feature time predict behavior 2-layer mlp used convolutional network described biological attribute prediction section infer behavior low-dimensional extracted feature trained adam optimizer epoch find table bounding box output pose pipeline infer behavior better adapting deep convolutional neural network keypoint representation also nearly well model often confuse class similar pose different amount motion classifying walking/running cage standing/background sleeping scratching/grooming seen fig one hypothesis restricting input bounding box location help model avoid over-fitting irrelevant detail better detect small change position benefit using method different stage pipeline offer different level granularity avoid computational cost running multiple convolutional expensive neural network pixel alone task may better detailed joint angle representation small behavior classification task use bounding box location motion classification fewer dimension table table classification accuracy input representation held-out set test video clip six behavior standing/background sleeping wheel running walking/running cage grooming/scratching eating full size table figure representative confusion matrix behavior classification row represents predicted classification given true positive label column different output prediction particular confusion matrix image model pattern consistent across input type full size image conclusion present method infers pose mouse single view video describing component analytical pipeline overall performance evaluated performance method term accuracy primary output keypoints e.g table however keypoints meaningful phenotype evaluated ability output capture biologically-relevant change mouse behavior two biological perturbation known affect gait age mutation eif2b output multiple stage method bounding box keypoints keypoints joint angle able predict biological status table importantly little advantage converting keypoints keypoints considerable advantage converting keypoints joint angle beyond demonstrating efficacy particular method result added insight aspect pose data best capture biology demonstrate joint angle enable predicting health related attribute mouse easily feature method offer compelling opportunity continuous non-invasive monitoring addition utility pose estimate consolidated input black-box classification biological attribute system also provides alternative solution custom hardware determining gait parameter stride length fig future work includes improving accuracy pose extending method animal social interaction model pipeline trained evaluated across video mouse limited diversity visual context though potentially robust new environment model may require retraining additional data matching new visual environment case enable extension approach similar approach provide image single mouse annotated keypoints labelled video multi-mouse tracking anatomical scan used construct shape prior data availability section hope mouse pose analysis dataset accompanying model code serve valuable community resource enable new research