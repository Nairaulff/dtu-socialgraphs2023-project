introduction schizophrenia chronic debilitating mental illness affecting million individual worldwide diagnosis management condition take account significant heterogeneity neurobiology clinical presentation actively investigated across site clinical setting examination discovery biological factor including neuroimaging biomarkers generalisable across site would promote better understanding disorder potentially allow better predictive model novel treatment target prognostication condition one way extract neuroimaging biomarkers e.g. fmri datasets fit machine learning model datasets identify important feature contributed model decision notably deep neural network used model functional connectivity datasets shown better performance conventional machine learning algorithm support vector machine model suggests non-linear relationship exist warrant use complex model better elucidation however actual implementation algorithm complicated high dimensionality fmri datasets coupled often smaller datasets available concern potential issue model overfitting datasets address overfitting principal component analysis recursive feature elimination used reduce data dimensionality training disease classification model recently gupta suggested address overfitting deep learning model removing accessory node irrelevant prediction hidden layer neural network feasible dataset size larger e.g. hundred feature selection pruning approach eventually reach limit applied even smaller datasets single site another way address overfitting find open-source datasets use along smaller locally collected dataset pooling data collaborative consortium across multiple site regard various approach pooling datasets together aggregation without protocol standardisation i.e gathering multi-site data uniform file format folder structure e.g autism brain imaging data exchange adhd-200 schizconnect aggregation protocol standardisation i.e carefully designed enforced data collection protocol observed site minimise site difference e.g human connectome project ukbiobank latter ideal since minimises site difference labelling inconsistency process laborious need solution better utilise datasets fall former category consisting datasets collected time different site different protocol regard shred short semi-supervised learning data harmonisation via encoder-decoder-classifier address issue site difference labelling inconsistency incorporating semi-supervised learning ssl data harmonisation architecture allows much data possible used model training furthermore harmonisation approach—based generalisation ordinary least squares—makes possible sieve site-invariant biomarkers easily opposed extant domain adaptation method produce site-invariant biomarkers map source domain target domain existing domain generalisation method consider effect labelling inconsistency thus shred make possible disambiguate biomarkers separating site-invariant biomarkers site-specific feature site-specific salient feature may indicate neuroimaging feature associated certain subpopulation subtypes site-invariant salient feature could point neuroimaging biomarkers generalisable across wider population study sought better identify neuroimaging biomarkers schizophrenia resting state functional mri assessment combining dataset openly available datasets schizconnect ucla consortium neuropsychiatric phenomics la5c study view need better data harmonisation across four site differing sample used deep neural network approach based shred determine site-specific unique local population salient feature site-invariant biomarkers generalisable wider population schizophrenia method local clinical sample external data set recruited local subject patient schizophrenia age gender matched healthy control institute mental health singapore community respectively full explanation study procedure provision informed consent participant inclusion criterion dsm-iv diagnosis schizophrenia age 21–65 year old english speaking subject exclusion criterion consisted history significant head injury neurological disease epilepsy cerebrovascular accident dsm alcohol substance use dependence contraindication mri e.g pacemaker orbital foreign body recent surgery/procedure metallic devices/implants deployed pregnancy study approved institution review board institute mental health national healthcare group dsrb reference 2012/01,116 method performed accordance relevant guideline regulation local dataset single session mri scan acquired state-of-the-art clinical 3-tesla system achieva philip medical system netherlands subject instructed remain still keep eye open fixed centre cross screen whole brain high resolution mp-rage magnetisation-prepared rapid acquisition gradient echo volumetric scan tr/te/ti/flip angle 8.4/3.8/3000/8 matrix fov axial orientation reformatted coronal covering whole brain structural-anatomic detail acquired addition data set separate source used i.e ucla consortium neuropsychiatric phenomics la5c study http collaborative informatics neuroimaging suite data exchange tool coin http neuromorphometry computer algorithm chicago nmorphch dataset http summarised detail datasets found supplementary note resting state fmri scan pre-processed via fmriprep 21.0.1 detail pre-processing step found supplementary note brief pre-processing step included motion correction slice timing correction band-pass filtering pre-processing matrix generated applying power atlas derive region interest roi computing mean time series taking average voxels within 2.5 radius roi iii calculating pearson correlation score every roi pair produce correlation matrix every subject since matrix symmetrical bottom triangular used input feature shred-iii flattening vector vanilla deep neural network take vector input shred architecture section harmonising encoder input biomarker generation introduce shred architecture along additional improvement outperformed previous version shred model named updated version shred-iii source code architecture available http illustrated fig shred composed part encoder-decoder-classifier edc module permit semi-supervised learning ssl pair harmonisation module one side edc performs data harmonisation figure illustration shred consisting set harmonisation grey trapezoid module implemented via linear layer edc module implemented via variational auto-encoder full size image shred-iii introduces two key change shred covariates interest design matrix added back i.e site effect confounders removed loss function specifically formulation reconstruction loss improved better approximate site effect additionally shred-iii trained end-to-end manner unlike shred-ii combat first applied harmonised data passed edc two-stage approach harmonising encoder input following notation chan let x\in represent dataset subject functional connectivity feature gathered site subject made set labelled subject single site set unlabelled subject site single subject j\in let v\in denote corresponding vector subject scanned site let ijv value feature model ijv ijv ijv denotes approximation mean value across subject feature denotes design matrix consisting covariates interest e.g age gender denotes vector coefficient corresponding denotes additive location parameter multiplicative scale parameter site effect site feature respectively ijv denotes residual term arises normal distribution zero mean variance breakdown ijv similar formulation combat note optimisation process differs explained section end-to-end training clear way integrate bayesian-based approach parameter fitting deep neural network architecture furthermore approach removing site difference allows biomarkers easily derived via computing saliency score since implementation simply based linear layer first initialised vector zero length feature vector gradually learnt network model training covariates design matrix commonly represented continuous categorical feature similarly mapped length vector applies site effect term initially one-hot encoded projected set learnable weight linear layer weight trained along rest model detailed section end-to-end training broken ijv constituent part output harmonisation module formed removing site effect covariates resulting ijv emphasise rather adopting common interpretation ijv encodes noise expected ijv capture idiosyncrasy feature subject captured overall harmonisation step reduces site effect allowing feature obtained multiple site used simultaneously encoder-decoder-classifier architecture edc module performs ssl consists variational auto-encoder vae vanilla deep neural network dnn classifier attached bottleneck layer vae perform disease classification vae take output harmonisation module input produce reconstruction output dnn branch produce output compared actual label improve model vae component edc module made two encoders encode input learning normal distribution mean standard deviation followed sampling procedure produce learnt representation edc module also decoder take learns produce reconstruction input data producing allows incorporation reconstruction loss guide model training even case label inconsistency make possible utilise label available dataset dnn component edc module take latent representation vae input performs disease classification using letting denote dnn mapping classification output denoted soft max h\left z\right provides mean supervised learning occur model whilst model produce prediction data sample sum vae dnn component edc module used together help model generalise better i.e besides making accurate classification also learn representation useful enough allow accurate reconstruction input harmonising decoder output vae edc module produced reconstruction input reconstructed original input yet evidently still step remaining link reconstruction original input entire architecture i.e data harmonisation since harmonisation module used produce producing requires step taken harmonisation module reversed ijv like ijv decomposed ijv ijv ijv obtained via ijv demonstrates produced completing reconstruction end-to-end training shred-iii trained end-to-end via single multi-objective loss function weight learnt simultaneously remove site effect maximise classification performance like edc module presented component loss function grouped two category dnn component vae component dnn component edc module make use cross-entropy loss compare output classifier ground truth disease label computed labelled data provided model =\frac j\in c=1 log vae component edc module hand make use labelled unlabelled data consists three part first likelihood loss introduced maximise log likelihood input sampled gaussian distribution standard deviation =nll\left =\frac j=1 v=1 log 2\pi +\frac 2\sigma second vae also minimizes kullback–leibler divergence distribution latent representation learnt shred-iii gaussian prior p\left z\right =n\left 0,1 used form evidence lower bound elbo =\frac j=1 v=1 log -1\right third accurate reconstruction input data vae reconstruction loss used objective maximize log likelihood input ijv sampled gaussian distribution n\left represents variance feature across subject also maximise log likelihood ijv sampled another gaussian distribution n\left newly proposed change shred originally minimised difference mean feature vector designed provide closer approximation optimisation process used combat site effect estimated via empirical bayes shred consider denoting ijv ijv =\frac j=1 v=1 log 2\pi +\frac ijv 2\sigma +log 2\pi +\frac ijv 2\delta loss term combined forming joint loss hyperparameters tuned model training minimised using adam optimiser biomarker generation model trained feature attribution score computed output layer input layer work use integrated gradient generate score many feature attribution method equivalent especially model simple i.e. close linear amongst integrated gradient remains usable wider variety situation along clear choice baseline use average normal control input data reason explain rationale behind choice using integrated gradient let represent model decoded feature attribution score computed using integrated gradient via following expression =\left -\overline -a\left -\overline represents baseline represents feature attribution score feature given input data baseline computed taking mean normal control training dataset score provide quantitative measure feature contribution task notably computed individual sample mean feature attribution score computed sample used generate individualised biomarker heatmaps allowing personalised treatment designed group-level study case–control performed aggregating feature attribution score =\frac j\in =1\ represents group-level feature attribution score obtained taking average feature attribution score test subject score used produce biomarker heatmaps presented fig experiment setup study interested elucidate site-invariant biomarkers site-specific salient feature thus two set experiment conducted whole dataset arrive site-invariant biomarkers data multiple site used simultaneously aim demonstrate shred-iii capable producing site-invariant biomarkers even whole dataset used contrast existing approach use supervised learning model whole dataset hypothesise produce biomarkers biased towards larger site shred-iii involves data harmonisation ssl used simultaneously study component shred-iii contributes model performance ablation study conducted involves dnn harmonisation ssl dnn harmonisation ssl edc ssl harmonisation shred-iii harmonisation ssl since whole dataset used ssl doe incorporate idea using unlabelled data setting—rather use reconstruction loss analysed also conducted experiment shred shred-ii compare approach proposed previous study individual site arrive site-specific salient feature model fitted individual site separately involved four experiment setting supervised learning data harmonisation iii ssl ssl data harmonisation two architecture used vanilla dnn edc without unlabelled data ssl edc unlabelled data shred variant shred shred-ii shred-iii used hyperparameters used architecture tuned following approach mentioned chan brief tuning performed subset abide dataset used main set experiment several reason supporting decision given relatively small dataset size work around compared 700–800 used previously want tune overfit dataset datasets based data obtained hyperparameters already shown generalise well adhd-200 dataset previous work thus reasonable expect work schizophrenia datasets well iii tuning specifically schizophrenia dataset leave little data model testing want run model multiple seed fold cross-validation approach demonstrate robustness obtained biomarkers following parameter tuned edc number hidden layer dnn branch 0,1 ,2\ size hidden layer vae branch 32,64,128 size latent representation vae 16,32,64 dropout 0.0 0.1 0.2 0.3\right\ learning rate 0.00025 0.0005 0.001 0.002 0.004\ shred variant tuned tuned iteration bayesian optimization used tuning final architecture edc includes single dense layer classifier two output neuron binary disease classification hidden neuron encoders well decoder neuron latent representation vae dropout 0.2 hyperparameters set shred-i set shred-iii set respectively adam optimizer learning rate 0.002 weight decay 0.001 used train model dnn number neuron controlled number parameter used similar architecture resulted neural network hidden layer hidden node respectively result section provide detail datasets used present result term model performance biomarkers obtained via shred-iii datasets four relevant resting state fmri datasets included study including local dataset imh table present summary demographic feature seen datasets table demographic feature datasets included study full size table overall resting state fmri scan comprising normal control schizophrenia patient included site pan score available local dataset note patient relatively low positive negative syndrome scale pan score indicating mild symptom pan score ranging site difference datasets shown fig plot generated computing average fisher-transformed functional connectivity score revealed significant distribution difference pair datasets except nmorphch imh overall evident despite sharing similarity use clinical classification dsm-iv significant difference term data distribution well criterion used determining class label subject suggests need method shred-iii address figure provides quantitative measure via hellinger distance visualisation data harmonisation technique like combat shred reduced site difference however unclear harmonisation technique affect biomarker discovery following sub-sections detail experiment conducted investigate impact addressing site difference labelling inconsistency figure kernel distribution estimation plot dataset distribution site full size image comparison performance existing baseline experiment performed fivefold cross-validation repeated across seed table show classification accuracy tested model configuration individual site whole dataset respectively -values reported computed based welch t-test two-sample t-test unequal variance table classification accuracy standard deviation model architecture individual site full size table table classification accuracy standard deviation model architecture whole dataset i.e full size table data harmonisation introduced vanilla dnn table change classification accuracy individual site largely significant p=.04\ ucla .05\ site similar finding observed comparing edc shred-ii equivalent edc difference accuracy significant except imh accuracy dropped significantly p=5\times hand whole dataset setting table statistically significant decrease model performance happened data harmonisation introduced dnn comparison dnn dnn p=1\times edc comparison edc shred-ii 6\times notably shred-iii experience much decrease shred significant change performance respect edc p=.12 dnn p=.12\ introduction ssl brought statistically significant increase model performance .005\ site seen table dnn edc ssl increase could due two possible factor use reconstruction loss improve latent representation learnt model introduction additional unlabelled data also contributes via reconstruction loss former data site used result supplementary table edc combine cross entropy loss reconstruction loss doe use additional unlabelled data site suggest improvement seen table largely stem introduction reconstruction loss furthermore difference edc edc ssl largely statistically insignificant .49\ except case imh p=.059\ one possible explanation imh dataset smallest stand gain unlabelled data time larger compared site finally combination data harmonisation ssl studied analysing result variant shred comparing edc shred-ii table show addition combat much effect model performance except case imh data p=5\times performance decreased experiment whole dataset model performance dnn edc shred-iii similar difference statistically significant .1\ dnn/edc shred-iii table seems main statistically significant improvement classification accuracy occurred ssl introduced harmonisation seem cause significant change model performance especially individual site however sensitivity specificity value shown supplementary table s2–s5 provide clearer picture effect data harmonisation individual site supplementary table data harmonisation clearly led decrease specificity especially smaller site imh nmorphch dnn edc also led increase sensitivity individual site exception imh edc hand experiment whole dataset supplementary table revealed opposite pattern data harmonisation increased specificity decreased sensitivity extent decrease larger increase specificity suggesting decrease accuracy seen table could due fewer true positive predicted result data harmonisation additionally table provide insight ssl helped model performance individual site specificity value exceptionally low imh nmorphch smaller datasets dnn used got much higher ssl introduced sensitivity generally reduced except ucla—this could explained ucla relatively imbalanced compared site finally note shred-iii generally highest specificity individual site except cobre difference edc significant whole dataset also experienced smaller decrease specificity individual site sensitivity whole dataset due data harmonisation compared shred model overall model able perform disease classification rather well give greater confidence biomarker heatmaps illustrated next section analysis salient feature ensure salient feature generated via approach robust saliency score averaged across trained model seed fold standardised since atlas power doe provide anatomical label roi mapped label crossley matching closest roi crossley atlas power atlas closeness computed based euclidean distance feature generated two scenario individual site whole dataset feature generated individual site using model trained via represent site-specific salient feature feature generated whole dataset require examination hypothesised whole dataset setting model used produce salient feature biased towards larger datasets shred-iii used site-invariant biomarkers produced since site effect labelling inconsistency removed site-invariant salient feature figure show salient feature various model configuration whole dataset shown table ease comparison across heatmaps score upper triangular set since matrix symmetric remaining score lower triangular top feature kept score threshold set visualisation unfiltered heatmaps presented fig supplementary material figure filtered heatmaps top feature saliency score generated various model whole dataset full size image fig heatmap produced vanilla dnn model highlighted potential biomarkers schizophrenia transverse temporal gyrus—paracentral lobule transverse temporal gyrus—posterior cingulate uncus—fusiform gyrus salient feature also present fig generated edc model two notable difference slight decrease saliency score biomarker uncus-fusiform gyrus decrease saliency score across roi seen supplementary fig s3b except transverse temporal gyrus combat introduced edc i.e. shred-ii corresponding heatmap fig show another three notable difference another overall decrease saliency score relative edc i.e even greater decrease dnn compared edc increase saliency score across multiple roi connection thalamus notably thalamus-superior temporal gyrus iii connection within uncus also emerged potential biomarker notably finding also observed comparing dnn fig heatmap dnn combat supplementary fig figure show heatmap produced shred-iii notable change reduction saliency score uncus-fusiform gyrus feature site-specific salient feature model edc used gave high model performance across site seen supplementary table figure show site-specific salient feature generated edc unfiltered heatmaps presented fig supplementary material figure show feature obtained training cobre dataset compared case edc used whole dataset i.e. fig transverse temporal gyrus emerges even salient feature notable change include reduction saliency score connection paracentral lobule eclipsed posterior cingulate along salient connection new roi superior parietal lobule lingual gyrus superior occipital gyrus especially precuneus cuneus additionally uncus—fusiform gyrus previously highlighted salient feature fig longer salient fig figure filtered heatmaps top feature saliency score generated edc individual site full size image figure show salient feature obtained imh dataset quite different salient feature fig transverse temporal gyrus—paracentral lobule remains also salient feature site additionally paracentral lobule noticeably greater contribution several new salient feature stem connection paracentral lobule inferior occipital gyrus subgyral postcentral gyrus superior parietal lobule additionally connection culmen subgyral well transverse temporal gyrus highlighted along superior occipital gyrus—superior temporal gyrus salient feature nmorphch bear similarity subset salient feature found cobre imh doe seem significant salient feature specific nmorphch salient feature edc whole dataset remained transverse temporal gyrus—paracentral lobule transverse temporal gyrus—posterior cingulate latter lower saliency score notably transverse temporal gyrus—posterior cingulate present cobre imh nmorphch also share common salient feature imh paracentral lobule—inferior occipital gyrus finally salient feature ucla shown fig comparing fig transverse temporal gyrus—paracentral lobule salient feature uncus-fusiform gyrus noticeably prominent site two salient feature connection transverse temporal gyrus postcentral gyrus unique ucla along superior parietal lobule shared cobre overall observed fig despite site difference neuroimaging region transverse temporal gyrus—paracentral lobule found present across site nmorphch share small subset salient feature imh comparison group difference saliency heatmaps presented fig highlighted several salient feature understand exactly value change presence schizophrenia original value salient feature visualised separately group saliency score generated shred-iii model whole dataset setting used analysis figure illustrates majority feature patient lower value group especially feature highest saliency score including feature previously highlighted uncus—fusiform gyrus figure provides alternative visualisation salient feature via chord diagram implemented via nichord showing brain module belong figure connectome plot top 0.05 salient feature saliency score top row original group-level fisher-transformed value middle row bottom row full size image association study pan score value salient feature also correlated measure symptom severity disorder pan schizophrenia study association value top salient roi pair correlated total pan score well score subdomain positive negative psychopathology correction multiple comparison via benjaminini-yekutieli false discovery rate control procedure found connection inferior parietal lobule parahippocampal gyrus significantly strong negative correlation total pan score spearman correlation 0.701 p=6\times general psychopathology scale spearman correlation 0.74 p=2\times figure illustrates relationship via scatterplots value pan score however major caveat analysis small dataset used—only local dataset pan score available thus serf proof concept study bigger fmri datasets pan score required validate association figure scatter plot regression line value connection inferior parietal lobule parahippocampal gyrus plotted pan score full size image summary salient feature roi table summarises salient feature found study presented along module associated suggested power evident majority roi involve auditory visual sensory/somatomotor network table summary salient feature across site full size table notably feature large positive saliency score generated integrated gradient although absolute value score taken explained section biomarker generation found positive saliency score always larger magnitude negative saliency score implies value corresponding roi pair shift away baseline average value roi pair healthy subject model likely predict schizophrenia present discussion several main finding study first reconstruction loss ssl key driver improvement model performance data harmonisation led reduced model performance mitigated shred-iii used second feature transverse temporal gyrus-paracentral lobule found site-invariant biomarker marked highest saliency score given within shred-iii third site posse site-specific salient feature would captured existing approach work pooled datasets example paracentral lobule salient site-specific feature within local imh dataset term model performance experiment revealed ssl specifically reconstruction loss clearly main contributor improvement model performance suggests possible train deep learning model individual site small datasets sample produce site-specific salient feature however edc-based architecture used instead vanilla dnn i.e reconstruction loss used since specificity vanilla dnn small site relatively low also evident data harmonisation caused slight decrease model accuracy notably one trend recent work pool datasets multiple site together i.e whole dataset setting followed analysis harmonised data result suggested model trained datasets could poorer generalisability attributed large decrease model sensitivity outweighed increase specificity i.e model seemed classify better healthy control data harmonisation made even fewer correct prediction case illness thus data harmonisation used care result suggested shred-iii susceptible problem much shred still room improvement reduce extent sensitivity lowered data harmonisation another example scenario data harmonisation used care seen local dataset result level individual site result table showed data harmonisation led lower performance imh dataset table c.1 supported finding across set comparison dnn edc edc ssl one reason could combat tendency imposing greater penalty smaller site large dataset size difference across site another possible explanation could derived observing heatmap imh site fig evident site many site-specific salient feature linked paracentral lobule sub-gyral site thus use data harmonisation remove site difference led greater impact site site furthermore discovery site-specific salient feature done datasets harmonised edc shown best approach use case method analysed study overall combining data harmonisation ssl via shred variant generally led better performance baseline dnn model however combination provide much improvement seen early study chan abide adhd-200 datasets thus result smaller dataset suggested might necessary collate adequate data multiple site around subject based size adhd-200 dataset benefit term model performance combining data harmonisation ssl could fully observed one notable phenomenon training vae model small high dimensional datasets possibility loss exploding infinity study resolved introducing gradient clipping noted performed study chan whereby datasets larger despite issue proposed shred-iii model still retained utility term accurately discovering site-invariant biomarkers figure demonstrated shred-iii correctly reduced emphasis uncus—fusiform gyrus biomarker specific ucla model showed high salience score term biomarker discovery study revealed site-invariant biomarkers transverse temporal gyrus-paracentral lobule well several site-specific salient feature analysis provide granular insight existing evaluation furthermore highlighted issue current approach biomarker discovery represented dnn fig via deep learning model without data harmonisation site-invariant biomarkers fig showed heatmap generated vanilla dnn model trained whole dataset vanilla dnn model highlighted transverse temporal gyrus—paracentral lobule site-invariant biomarker fig verified present salient across site however also picked several feature notably uncus—fusiform gyrus hypothesis section analysis salient feature posited feature fact biased towards largest site schizophrenia datasets largest site ucla represented entire aggregated dataset finding section discussion found salient feature uncus—fusiform gyrus predominantly found ucla likely site-specific feature however shred variant significantly reduced saliency score assigned feature pointed fact shred-iii correctly exclude site-specific feature still highlighting site-invariant one transverse temporal gyrus—paracentral lobule site-specific salient feature cobre dataset transverse temporal gyrus noted prominent feature salient connection six roi transverse temporal gyrus also known heschl gyrus responsible processing incoming auditory information demonstrated increase blood oxygen level–dependent occurs heschl gyrus episode auditory hallucination resting state fmri found implicated patient study showing patient auditory hallucination higher left heschl gyrus functional connectivity left frontoparietal region among roi salient connection heschl gyrus unique cobre included cuneus also found higher patient imh dataset paracentral lobule salient connection five roi paracentral lobule influence motor function lower limb noted component motor abnormality could caused paracentral deficit useful predicting 1-year outcome first-episode schizophrenia furthermore meta-analysis resting state fmri study schizophrenia noted patient significantly lower local density paracentral lobule ucla dataset two notable site-specific salient feature connection uncus fusiform gyrus transverse temporal gyrus postcentral gyrus fusiform gyrus long associated ability recognise face interpret facial expression past study using traditional machine learning method also implicated fusiform gyrus schizophrenia hand uncus involved olfaction emotion memory formation postcentral gyrus involved receiving sensory input role neural basis schizophrenia need evaluation overall existing literature demonstrated schizophrenia patient significant impairment connection various brain network including auditory salience default mode executive control sensorimotor network study salient connection involved roi auditory visual sensorimotor network particular strong site-invariant biomarker transverse temporal gyrus—paracentral lobule involves auditory sensorimotor network site-specific salient feature shown involve unique pair brain network site-specific feature cobre involving across-network connection auditory visual network reported previous study albeit exact match roi one key limitation study uncertainty regard salient feature neither unique enough site-specific widespread enough considered site-invariant example connection transverse temporal gyrus posterior cingulate highlighted salient feature cobre also nmorphch relatively lower score shred-iii assigned score transverse temporal gyrus—paracentral lobule clearly site-invariant uncus—fusiform gyrus site-specific ucla clear interpret salient feature e.g. dark orange/red colour heatmaps laid extreme future work could involve design algorithm identify threshold separate site-invariant biomarkers site-specific salient feature based saliency score heatmaps seen fig one potential area future work extend shred work federated learning setting although numerous data consortium formed recent year often still case datasets allowed shared outside site due data privacy concern current version shred still require pooling datasets multiple site together produce site-invariant biomarkers future work could explore site-invariant biomarkers could arrived without need pool datasets together another possible future work would extend shred term data modality task study limited static dynamic shown effective distinguishing patient healthy subject revealing subtypes allow dynamic data modelled framework architecture enhanced adding recurrent neural network transformer capture spatial temporal relationship allow subtypes captured clustering module could introduced auto-encoder summary neural network architecture proposed work shred-iii could perform data harmonisation semi-supervised learning simultaneously via encoder-decoder-classifier architecture deal site difference labelling inconsistency even smaller datasets thus potentially offer scalable approach discovering site-invariant disease biomarkers help isolate site-specific salient feature without need scour site manually increasingly unfeasible pooled datasets data consortium get larger examination schizophrenia datasets revealed transverse temporal gyrus-paracentral lobule site-invariant biomarker example site-specific salient feature observed local site include multiple roi linked paracentral lobule seen site