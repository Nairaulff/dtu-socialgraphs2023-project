introduction cancer pain common patient particularly advanced stage disease prevalence estimated contributes poor physical emotional state patient prolonged survival followed advancement diagnosis treatment cancer result increase number patient experiencing persistent pain trend also documented hematology patient time diagnosis therapy last month life per estimate globocan incidence cancer increasing million thus cancer-related pain would major issue global healthcare system acute exacerbation cancer pain challenging clinical problem managing cancer pain negatively impacting patient daily life guideline suggest occurrence three four cancer pain exacerbation cpe episode per day acceptable however frequent cpe could also affect patient daily quality life addition interval pain onset time drug effect time could worsen patient quality life particular hospitalized patient avail short-acting opioids upon informing nurse thereafter nurse must inform doctor decision patient would likely left severe pain processing time point view accurate prediction cpe could alleviate frequency interval cpe improve patient daily life well-being recently time series model based deep learning algorithm gained popularity based remarkable performance cancer pain may reflect status cancer invasiveness exposure cancer treatment pharmacodynamics opioids patient lifestyle health care system hospital including management doctor nurse therefore hypothesized exacerbation cancer pain repeated according patient previous pattern could thus predictable study aimed investigate clinical relevance deep learning model predict time breakthrough pain onset cancer patient patient method patient data collection single-center retrospective study aimed evaluate efficacy deep learning model predicting onset cpe cancer patient study conducted accordance declaration helsinki approved institutional review board irb samsung medical center approval number 2020–09-073 samsung medical center irb waived need informed consent retrospective nature study pain record pertaining 34,304 patient retrospectively collected admitted department hematology oncology samsung medical center korea july february clinical data obtained medical record using de-identified clinical data warehouse patient excluded 2,697 patient underwent surgery hospitalization 28,173 patient non-zero numerical rating scale nrs score record selected 3,431 patient included pain log data 4,870 admission split 80–20 training/test 2,745/686 patient 3,896/974 admission set fig figure study cohort full size image pre-processing nurse rounding occurs every day 5:00 13:00 21:00 nurse rounding nurse usually record patient self-reported pain score using nrs scale ordinal range pain severe unbearable pain patient could also ask nurse management time case sudden pain herein nurse record additional pain score notifies doctor quantitative consensus definition cpe defined cpe nrs score commonly used indication opioid intervention cancer pain management guideline pre-processing consists binning transformation step mentioned figure explains entire process figure data processing modeling evaluation scheme full size image binning originally pain score recorded according time minute however considering highly sparse signal data binned entire nrs record arbitrary -length time-bins multiple record within bin highest nrs score considered record period transformation cpe could different among patient inter-patient could also different specific situation patient intra-patient intra-patient pain pattern refers patient unique pain pattern depending patient medical status inter-patient pain pattern refers pattern medical practice including rounding time clinician management pain record processed 24-h increment reflect characteristic zero padding used set start end pain record 0:00 recording time point nrs observation episode patient considered pain-free imputed zero accordingly pain record day -length time-bins transformed shape 1\times 24/\tau vector form 24/\tau matrix form modeling explored six deep learning-based time series forecasting architecture prediction cpe according various input length time-bin size pain record time-bin size investigated grid search divisor suited transformation excluding considering clinical application comparison conducted recurrent neural network rnn long short-term memory lstm gated recurrent unit gru bidirectional long short-term memory bi-lstm hybrid convolutional neural network long short-term memory cnn-lstm transformer prediction model cpe implemented according respective basic recipe model constructed non-autoregressive prediction structure followed dense layer stacking three basic block fig make fair comparison number hyperparameters model set minimize difference within 3,000 parameter model trained epoch batch size balanced cross entropy loss ensured system optimized stochastic weight averaging initial learning rate 1e-4 start averaging average period model programmed python 3.7 tensorflow 2.4.1 experimented using nvidia geforce rtx evaluation prediction cpe could regarded binary classification independent next fig number true depends time-bin size show class imbalance dominant therefore evaluated performance model based matthew correlation coefficient mcc reliable statistical proportion produced high score proportional size positive negative element dataset possible prediction yield good result four category confusion matrix true positive false positive true negative false negative range mcc value indicates opposite prediction true indicates correct addition mcc performance model also evaluated area receiver operating characteristic curve auroc area precision-recall curve auprc ethic approval patient consent statement ethical review board samsung medical center approved study protocol per regulation korea review board waived requirement informed consent study retrospective analysis result baseline characteristic patient baseline characteristic 3,431 patient 4,870 admission shown supplementary table median age year range 15–89 2,047 59.7 male common type cancer lung cancer 21.7 followed lymphoma 14.3 median hospitalization duration 14.96 day range 5.46–195.40 patient aplastic anemia hospitalized longest duration 29.50 day range 7.79–93.10 median frequency record nrs cpe per day 2.74 range 0.17–12.22 1.01 range 0–1.31 respectively patient head neck cancer present cpe frequently 1.57 per day range 0–7.85 characteristic pain record pain score mostly recorded 8:00–10:00 16:00–18:00 regular rounding time ward fig among 1-h time binned record 1,311,240 78,376 6.0 cpe frequent cpe noted larger time binned record showing 44.5 48,663 cpe 12-h time binned record 109,270 supplementary table figure described correlation daily pain record forecast day previous day pearson coefficient score increased closer forecast period increase time binning setting hour time binned record nrs record interval forecast day showed coefficient 0.08 score improved closer forecast date showed coefficient 0.20 record made forecast date pearson coefficient score increased larger time bin record presenting coefficient 0.53 12-h time binned nrs record previous day correlation analysis matched time nrs score forecast day day prior forecast period indicated interval 11:00 12:00 coefficient 0.17 18:00 19:00 showed relatively high correlation coefficient 0.18 compared others fig figure characteristic pain record heatmap daily pain pattern patient correlation analysis nrs score forecast date prior record used pearson correlation coefficient evaluate correlation pain record according day correlation analysis time-matched nrs score forecast date previous day full size image comparison performance table present mcc value deep learning model across various range input length time-bins setting significant difference cpe prediction performance according structural variation model average difference highest lowest performance model experimental condition 0.0182 standard deviation 0.0087 nevertheless lstm-based model showed good performance displayed best performance nine occasion second-best performance recorded eight time among experiment setting model based gru simplified version lstm also showed good performance herein eight best performance seven second-best performance recorded exploratory investigation selected lstm block backbone structure representative cpe prediction mode meanwhile deep learning-based model consistently better mcc base model make prediction average score time interval previous day window period table performance comparison various model according input time-bin length full size table investigate efficacy transformation investigated performance lstm-based model input nrs transformation supplementary table setting input time bin lstm based model using transformed data showed mcc 0.1721 better performance input original nrs record mcc 0.1686 model performance consistently improved transformation various input time-bin length also performance significantly improved larger input length particular model input nrs record show significantly better performance model input nrs record various time bin length setting instead performance greatly improved larger-sized time binning study best performance mcc 0.4927 derived lstm-based model using input length time bin set showing auroc 0.8080 auprc 0.7340 fig model showed best performance patient aplastic anemia mcc 0.663 followed head neck cancer mcc 0.594 supplementary table figure auroc auprc lstm-based model different size time binning input length time bin size full size image case prediction onset timing breakthrough pain figure depicts case 76-year-old male patient bladder cancer retroperitoneal lymph node metastasis admitted supportive care patient showed good performance mcc 0.3452 auroc 0.9051 auprc 0.2067 pert lstm-based model hour time binning 5-day input data hospitalization complained back pain administered 12.5 mcg/h fentanyl patch received morphine intravenous presented breakthrough pain tenth day patient complained back pain 10:00 22:00 lstm-based model predicted onset time breakthrough pain 11:00–13:00 18:00–23:00 value consistently close actual patient complaint tenth day hospitalization addition lstm-based model tested patient hematologic malignancy figure show case 53-year-old female patient aplastic anemia displayed relatively accurate prediction hospitalization mcc 0.1843 auroc 0.2015 auprc 0.1767 admitted allogeneic peripheral blood stem cell transplant allo-pbsct patient received conditioning chemotherapy first hospital day followed allo-pbsct day later 14th hospital day patient complained fibromyalgia 13:00 21:00 lstm-based model predicted onset time 11:00 20:00 figure representative case predicting onset time cancer pain exacerbation using serial pain record derived patient case patient bladder cancer complained back pain blue dot line indicated nrs pain score window period yellow dot line prediction result presence cpe derived lstm-based model 5-day input length 1-h time binned data setting green dot line indicated real-world record existence cpe according time yellow dot line black-colored box showed probability cpe forecast day case patient aplastic anemia underwent allo-pbsct full size image supplementary figure show case capturing breakthrough pain incorrectly patient renal cell carcinoma bone pleural metastasis administered pleural effusion back pain management lstm-based model incorrectly predicted cpe hospitalization mcc 0.0417 auroc 0.5843 auprc 0.1767 complained back pain frequently fifth sixth hospital day day second thoracentesis seventh hospital day model predicted cpe similar pattern sixth day hospital however patient complained cpe often doctor escalated dose long-acting oxycodone long-acting oxycodone sixth hospital day supplementary figure depicts patient stomach cancer peritoneal seeding patient complained severe abdominal pain hospitalized management afferent loop syndrome underwent percutaneous transhepatic biliary drainage ptbd l-tube insertion however ptbd tube removed accidentally fourth hospital day first pain related ptbd tube alleviated however afferent loop syndrome aggravated sixth hospital day patient complained abdominal pain frequently day lstm-based model underestimate frequency cpe compared real-world pain record performance lstm-based model hospitalization mcc 0.0467 auroc 0.4691 auprc 0.1379 discussion study explored feasibility deep learning method predict onset time cpe cancer patient time hospitalization nrs pain record showed circadian pattern correlated nrs pain pattern previous day particular nrs score positively correlated closeness forecast date size time binning lstm-based model showed good performance achieving best performance experiment input length 1-h time bin mcc 0.1721 performance improved experiment extended input data larger binning size showed best performance input length bin length mcc 0.4927 considering model performance significantly better base model performance table study showed nrs pain could predictable using deep learning-based model nrs pain record showed circadian pain pattern mostly recorded 8:00–10:00 16:00–18:00 near rounding time fig recorded pain episode pre-processed 24-h increment make data reflect circadian pattern zero padding performed set start end cpe episode 0:00 pre-processing performance significantly improved supplementary table meanwhile input record obtained one day prediction highest correlation similarity forecast period compared record day fig pain pattern may affected pain management hospital including elevation dose frequency opioids intervention data characteristic could reason unidirectional rnn model including lstm gru showed competitive performance compared others although unidirectional rnn model well known vulnerable case long-term dependence meanwhile described supplementary figure pain pattern could related various factor including acute event treatment pattern current model could predict pain pattern reflecting acute change time series data reflecting factor could make model perform better pérez-hernández investigated breakthrough pain characteristic pattern using alberta breakthrough pain assessment tool study showed 42.6 patient could correctly predict occurrence breakthrough pain another 20.5 patient could accurately estimate breakthrough pain certain occasion mostly cpe associated pose movement patient earlier study per answer 81.5 patient duration onset time peak intensity breakthrough pain min considering interval breakthrough pain twice much onset peak time first tried make predictive model inputting serial pain log data divided hour however used zero-input method missing value data high sparsity 1-h binning cpe 6.0 total dataset therefore performed ablation study larger interval binning least clinically available sparsity cpe improved cpe 44.5 total dataset supplementary table meanwhile length input record also affected model performance however extent significant compared change time binning length necessary reflect data characteristic optimize according clinical setting study certain limitation prominent limitation single center-based design might limit generalizability data addition used nrs record divided hour simply defined breakthrough pain time interval record nrs following protocol excluded many characteristic cancer pain might limit interpretation additionally study investigated univariable model simple structure goal explore feasibility pain pattern nevertheless model showed adequate performance even though input data type subsequent validation study including detailed data sophisticated model structure would make model perform better applicable conclusion study showed cancer pain could predictive using deep learning model though exploratory study limitation research could improve model performance verification study could make model applicable real-world practice