introduction last decade computer vision extensive research academic industrial application transportation surveillance smart city sport analysis object detection foundation various computer vision task including object tracking action recognition image captioning object detection consists two sub-problems location bounding box object classification object box previous traditional object detector based sliding-window paradigm hand-crafted feature however traditional object detector suffer huge computational resource redundant anchor box poor robustness recent year effectiveness convolutional neural network cnns verified various field computer vision cnn-based object detector roughly divided two-stage detector r-cnn variant one-stage detector ssd yolo two-stage detector firstly identifying potential region may contain object classify region one one scenario two-stage detector achieve excellent accuracy slow detection speed conversely one-stage detector provide slightly poor detection accuracy fast speed merging identification region classification one step specific one-stage detector aim mapping image pixel coordinate bounding box directly although detection speed significantly enhanced detection accuracy several scene insufficient detecting tiny object image highly challenging ambiguous boundary complex background changing illumination address problem paper proposes efficient wffa-ssd weighted-based feature fusion block context attention block based original single-shot detector weight-based feature fusion block several multi-scale feature map fused self-adaptive weight meanwhile context attention block employed reinforce local feature feature map therefore two feature pyramid fused make prediction comprehensive experiment conducted carpk pascal voc datasets experimental result demonstrate proposed wffa-ssd outperforms compared state-of-the-art one-stage object detector contribution paper summarized follows weight-based feature fusion block designed adaptively fuse information several multi-scale feature map feature map large resolution obtain contextual information context attention block applied reinforce local region feature map pyramid aggregation block employed combine two feature pyramid classify locate target object extensive experiment carpk pascal voc dataset demonstrate proposed wffa-ssd superior state-of-the-art one-stage detector consistently rest paper organized follows related work section related work object detector multi-scale feature fusion attention mechanism introduced proposed method section elaborates structure proposed wffa-ssd component experimental result analysis section conduct experiment analyzes experimental result conclusion future work section present conclusion future work related work section comprehensive review related work provided firstly deep learning-based object detector described multi-scale feature fusion introduced moreover attention mechanism object detector discussed object detector based excellent achievement deep cnn field computer vision various deep learning-based object detector perform superior performance compared conventional approach r-cnn two-stage scheme region proposal designed region proposal mainly employed filter potential region high probability involve object region provided cnn prediction procedure hand-crafted approach replaced two-stage deep learning-based object detector high accuracy speed based r-cnn fast r-cnn introduced multi-task loss train classification bounding box regression simultaneously faster r-cnn designed learning-based region proposal network rpn alleviate computational cost proposal generation procedure however detection speed two-stage detector insufficient several scene compared two-stage object detector one-stage object detector abandon proposal extraction accelerate inference yolo first one-stage detector performs classification box regression directly pre-defined image grid unfortunately drop region proposal result low accuracy speed accelerated improved version yolo improve detection accuracy high detection speed wog-yolo whale optimization algorithm employed optimize hyper-parameters yolov5 another popular branch one-stage detector ssd predicts multi-reference multi-scale feature map retinanet focal loss proposed address imbalance positive negative category retinanet achieves trade-off accuracy detection speed efficientdet weighted bi-directional feature pyramid network bifpn composite scale expansion method designed accuracy object detection improved however detection accuracy one-stage detector especially small object slightly poor compared two-stage detector desirable design one-stage object detector fast detection speed small object distinct feature small object image important make full use information feature map enhance performance object detector multi-scale feature fusion object detection task low-level feature map high resolution contain location detail information however low-level feature map lack semantic information high-level feature map semantic information based convolution operator local information high-level feature map poor therefore multi-scale feature fusion efficient improve performance object detector multi-scale feature fusion consists early fusion late fusion strategy early fusion strategy feature map fused first fused feature employed make prediction example addition operation resnet concatenation operation u-net typical early fusion strategy late feature fusion strategy detection result several layer combined enhance performance detector previous literature several approach independently make prediction based multi-scale feature fusion result prediction processed comprehensively ssd multi-scale cnn etc line applies feature pyramid network reference predict fusing feature yolov3 fssd etc feature fusion strategy widely applied object detection refine feature extracted vgg-net discrimination correlation analysis dca -based feature fusion strategy proposed enhance performance detector small computational cost fssd feature fusion module designed generate novel feature map constructed feature pyramid feature fusion module multi-scale feature map combined concatenation operator based fssd fs-ssd extra scaling branch spatial context analysis proposed scaling branch de-convolution module average pooling operation employed form feature pyramid two feature pyramid applied make prediction together nlfftnet attention different position calculated capture long-distance dependency dynamic data augment method employed balance different class mfaba multi-scale feature aggregation module applied integrate adjacent hierarchical feature multi-scale feature map combined balance semantic feature information csff feature pyramid network employed obtain multi-scale feature map csff applied obtain discriminative multi-level feature representation fps-net multiple channel image grouped different modality obtain modality-specific feature map feature high-dimensional feature space pixel-level fusion learning libra r-cnn multi-scale feature map combined obtain balanced semantic feature information comparison faster r-cnn retinanet demonstrates detection performance coco dataset significantly improved neural architecture search feature pyramid network nas-fpn neural architecture search algorithm employed customize feature pyramid network merges feature across range nas-fpn produced significant improvement many object detection network besides adaptive spatial feature fusion asff strategy proposed combine multi-scale feature map learning weight parameter adaptively experimental result indicate asff outperforms concatenation element-wise addition analyzing weakness using deep learning method new fusion logic combine advantage knowledge used traditional method proposed improve performance object detector accelerate inference speed feature pyramid querydet applies query mechanism first step querydet coarse location small object predicted low-resolution feature second step accurate detection result computed high-resolution feature sparsely guided coarse position es-net five module designed address information loss tiny object mismatch receptive field detection head scale object module aggregated feature guidance module afgm split aggregation enhancement module sae multi-receptive field fusion mff efficient stair pyramid esp dynamic scale-aware head dsh so-yolo expanding feature fusion shallow feature module designed effectively utilize shallow feature besides k-means++ clustering applied optimize number size anchor box redundant yolo head network branch removed attention mechanism general human visual system quickly identify useful information external environment based idea various attention mechanism designed non-local neural network one important work attention mechanism non-local operation calculate response position weighted sum feature position calculated remote dependency established self-attention module applied various task improve accuracy model squeeze-and-excitation network senet focus channel-level dependency model designed senet characteristic response value channel adjusted adaptively moreover convolutional block attention module cbam proposed cbam combine channel attention spatial attention pay attention foreground object selective kernel network sknet selection kernel unit proposed adaptively adjust size receptive field based input information spatial channel squeeze-and-excitation scse proposed semantic segmentation besides channel squeeze-and-excitation cse spatial squeeze-and-excitation sse designed simultaneously based combination non-local neural network senet global context network gcnet utilizes small number calculation optimize global context modeling capability proposed criss-cross network ccnet proposed based non-local neural network criss-cross attention module applied capture contextual information remote dependency effective way dual attention network danet proposed two attention module dilated fully convolutional network model semantic dependency spatial channel dimension experimental result demonstrate proposed model achieve excellent performance cityscape dataset various multi-scale feature fusion attention mechanism previous literature however previous feature fusion mechanism assumed weight multi-scale feature map due small object usually appear part feature map helpful detect small object assigning specific weight feature map therefore paper proposed weight-based feature fusion module besides pyramid aggregation block also designed transform pyramid final pyramid proposed method ssd benchmark model baseline ssd feature pyramid provided detect multi-scale object specific two layer conv4\_3\ conv backbone network four newly added layer conv8\_2\ conv9\_2\ conv10\_2\ conv11\_2\ employed construct feature pyramid therefore six feature map size 38\times 38\ 19\times 19\ 10\times 10\ 5\times 3\times 1\times obtained feature map responsible detecting specific scale object based feature pyramid ssd achieves excellent performance detecting multi-scale object let p=\ p_1 p_2 p_3 p_4 p_5 p_6\ denote feature map p_1\ represents feature map largest resolution p_2\ mean feature map smallest resolution therefore feature map p_6\ capture global information detecting large-scale object however information small-scale object gradually discarded shallow deep layer desirable effectively multi-scale feature map enhance detection accuracy ssd wffa-ssd architecture address problem scale variation ssd paper proposes weighted-based feature fusion attention-based single-shot detector wffa-ssd proposed method two branch constructed generate two feature pyramid first one employ context attention block obtain enhanced feature pyramid another branch combine several feature map multiple scale based self-adaptive feature fusion block second branch also generate feature pyramid next two feature pyramid merged construct new feature pyramid make prediction architecture wffa-ssd depicted fig detail proposed wffa-ssd described following subsection figure structure wffa-ssd network full size image context attention block shape texture small object ambiguous image however contextual relationship small-scale object object therefore desirable focus surrounding region employ context information model representation therefore paper design context attention block cab capture local scale context feature encoding proposed cab implemented using following operation suppose output layer network feature map c\times h\times mean number channel denotes height width respectively used input cab first convolution operator 3\times kernel attached dilation r=2\ employed acquire larger receptive field considering dilate convolution operator reduce continuity context information 1\times convolution employed smooth information feature avoid over-fitting accelerate convergence training model convolution operator followed relu activation function batch normalization aligned =bn conv_2 conv_1 aligned moreover softmax function employed normalize feature map aligned =\frac i=1 j=1 k=1 aligned element-wise multiplication operator applied generate new feature map aligned aligned output cab diagram cab structure shown fig figure structure context attention block full size image weight-based feature fusion block feature pyramid information spatial location multi-scale feature map may inconsistent therefore feature fusion block directly element-wise addition concatenation effectively take advantage feature map multiple pyramid based idea asff paper design weight-based feature fusion block wfb make full use information several feature map improve detection accuracy structure wfb depicted fig figure structure weight-based feature fusion block full size image suppose three feature map f_1\in c_1\times h_1\times w_1 f_2\in c_2\times h_2\times w_2 f_3\in c_3\times h_3\times w_3 input wfb resolution well channel f_1\ f_2\ f_3\ different 1\times convolution operator up-sampling operator employed obtain three feature map f_1^ f_2^ f_3^ scale 1\times convolution operator used extract weight position feature map weight feature map concatenated along channel dimension 1\times convolution operator introduced reduce channel dimension three weight feature map w_1\ w_2\ w_3\ obtained based softmax function finally fused feature map obtained follows aligned f=w_1\times f_1 +w_2\times f_2 +w_3\times f_3 aligned paper wfb used obtain fused feature map based 38\times 38\ 19\times 19\ 10\times 10\ feature map fused feature map employed generate new feature pyramid pyramid aggregation block proposed wffa-ssd two feature pyramid generated based cab wfb pyramid aggregation block pab devised transform pyramid final detection pyramid module illustrated fig figure structure pyramid aggregation block full size image pab consists two step first scale feature different pyramid concatenated along channel dimension 1\times convolution operator relu activation function batch normalization employed smooth feature map reduce dimension experimental result analysis experimental setup dataset description paper carpk dataset employed experiment caprk dataset mainly focus car detection perspective unmanned aerial vehicle car small object nearly 90,000 car captured four parking lot carpk resolution image set training validation includes image moreover test dataset contains image carpk dataset available http pascal voc dataset popular dataset object detection pascal voc consists voc2007 voc specific category airplane bicycle bird boat bottle bus car cat chair cow dining table dog horse motorbike person potted plant sheep sofa train monitor pascal voc paper 22,136 image voc2007 voc2012 employed training validation image voc2007 used testing pascal voc dataset available http evaluation metric paper mean average precision map used measure detection accuracy indicator related iou threshold experiment popular threshold iou =0.5\ applied multi-class objection detection problem map average value aps multiple category furthermore computes area precision-recall curve therefore calculation procedure precision recall given follows aligned precision= tp+fp aligned aligned recall= tp+fn aligned represent true positive false positive false negative respectively furthermore frame per second fps adopted criterion detection speed mean number image detection model process per second specified hardware paper fps detector tested single gpu device implementation detail experimental platform 3.80ghz 32gb ram window operating system method implemented python 3.7 based pytorch framework accelerating nvidia geforce rtx 3080ti gpu device 12gb gpu memory cuda 11.4 cudnn 7.4 experiment data augmentation ssd also done related parameter equal ssd furthermore input image resized training procedure detector pre-trained combination coco pascal voc pascal voc datasets detector fine-tuned carpk dataset batch size set number epoch set initial learning rate set 1e-5 decreased loss reduced three consecutive epoch adam algorithm employed optimize loss function training objective minimize weighted sum smooth loss function loc localization softmax loss conf classification confidence follows aligned =\frac conf +\alpha loc aligned represents number matched default box random object mean class confidence score indicates predicted bounding box represents ground-truth bounding box hyper-parameter set cross-validation ablation analysis verify effectiveness block wffa-ssd construct two variant wffa-ssd test performance variant carpk dataset variant ssd-cab ssd-wfb result reported table first effect context attention block tested observed map ssd-cab 84.93 2.21 higher ssd model test effect weight-based feature fusion block ssd-wfb constructed based ssd wfb ssd-wfb obtains 85.82 map 3.1 higher ssd comparing wffa-ssd variant 86.96 map wffa-ssd higher variant therefore concluded block wffa-ssd effective detection performance table comparison proposed wffa-ssd variant carpk dataset full size table comparison state-of-the-art approach pascal voc benchmark experiment proposed wffa-ssd model compared baseline method state-of-the-art detector pascal voc benchmark since proposed method mainly modified based ssd300 ssd300 chosen baseline method following experiment object detector including two-stage detector faster r-cnn r-fcn one-stage detector ssd300 ssd512 dssd513 fssd512 yolov3 yolov4 result baseline except yolov4 reported literature result yolov4 obtained running code provided original literature machine table comparison proposed wffa-ssd state-of-the-art detector pascal voc test full size table table observed proposed wffa-ssd model achieves highest map 88.89 among model compared series ssd map obtained wffa-ssd 7.39 higher dssd513 11.69 higher ssd300 baseline compared series yolo map obtained wffa-ssd 9.28 higher yolov3 1.69 higher yolov4 meanwhile detection speed detector also reported table compared series r-cnn detection speed wffa-ssd faster faster r-cnn r-fcn besides detection speed wffa-ssd also faster dssd513 however detection speed wffa-ssd much slower yolov3 yolov4 figure speed accuracy comparison proposed method state-of-the-art method voc dataset full size image figure show speed accuracy comparison model observed detection accuracy far satisfactory although detection speed slower one-stage detector although detection speed slower one-stage detector result cited reported literature fig observed proposed wffa-ssd achieves map kind object obtains lower map bottle figure map object pascal voc dataset full size image comparison state-of-the-art approach carpk dataset experiment effectiveness proposed wffa-ssd verified carpk dataset wffa-ssd trained based pre-trained ssd model pascal voc pascal voc coco datasets compared baseline faster r-cnn r-fcn ssd300 yolov3 yolov4 table observed proposed wffa-ssd achieves highest 86.96 map specific map proposed wffa-ssd 0.39 higher yolov4 0.95 higher yolov3 compared two-stage detector map wffa-ssd 2.16 higher faster r-cnn 0.83 higher r-fcn meanwhile map wffa-ssd 4.24 higher baseline ssd300 furthermore detection speed wffa-ssd 28.41 fps tightly shower 35.25 ssd300 however detection speed wffa-ssd also acceptable real-time detection result baseline except yolov4 reported literature table comparison proposed wffa-ssd state-of-the-art detector carpk test full size table speed accuracy comparison wffa-ssd compared model carpk dataset shown fig wffa-ssd achieve trade-off performance carpk dataset figure speed accuracy comparison proposed method state-of-the-art method carpk dataset full size image figure detection result carpk dataset full size image paper three experiment conducted validate effectiveness proposed wffa-ssd ablation analysis effectiveness three block wffa-ssd analyzed table complete wffa-ssd outperforms variant component wffa-ssd enhance accuracy wffa-ssd comparison wffa-ssd state-of-the-art baseline pascal voc dataset wffa-ssd achieves highest map among compared model reason summarized follows weighted-based feature fusion survive useful information different feature map besides context attention block enhance accuracy localization based large receptive field comparison wffa-ssd baseline carpk dataset proposed wffa-ssd outperforms compared model object detection result shown fig indicates proposed wffa-ssd effective carpk dataset conclusion future work work dedicated developing small object detector present effective strategy small object detection feature fusion attention mechanism therefore structure proposed detector previous detector similar however compared previous work work applies weight-based feature fusion adaptively adjust weight feature map multiple pyramid aggregated final detection pyramid according ablation analysis observed block effort performance wffa-ssd moreover experimental result pascal voc dataset demonstrate wffa-ssd outperforms compared model based novel block meanwhile result carpk dataset indicate wffa-ssd effectively detect small object carpk dataset future work improve proposed block embed block advanced baseline algorithm achieve superior detection performance small object addition necessary explore real-time detection lightweight backbone network therefore detector used scene limited computational resource besides better training method also worth investigating