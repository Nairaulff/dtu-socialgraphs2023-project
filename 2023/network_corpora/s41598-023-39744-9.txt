introduction insufficient compensation irregular organ motion image-guided intervention significant problem lead inaccuracy instrument navigation compromised treatment outcome real-time mri imaging mri-guided procedure hold potential address issue however acquiring real-time mri large target region intervention currently feasible due need significant amount reference data beforehand although recent study demonstrated promising result using deep learning approach min training data timeframe still impractical routine clinical setting time crucial additionally limit specific absorption rate sar allowed mri imaging limit likely exceeded prolonged imaging consequently effective application mri intervention room remains challenging could soon change advance deep learning show work related work mri method classified either respiratory phase-resolved time-resolved see table former reconstruct fixed number phase single breathing cycle usually fewer phase account arbitrary/irregular breathing mainly based sequence programming unique k-space sampling design acquisition usually take around min cai retrospectively sort axial slice respiratory phase using body area image-based internal respiratory surrogate use single-shot acquisition parallel imaging partial k-space imaging improve acquisition speed reconstruct four respiratory state one breathing cycle tryggestad acquire sagittal coronal slice retrospectively stack two-pass approach ten respiratory phase volume paganelli removed need navigator frame directly comparing neighboring slice using mutual information reconstruct one breathing cycle deng implemented continuous spoiled gradient echo sequence radial trajectory self-gating respiratory motion detection retrospectively sort data different respiratory phase han repeatedly sample k-space center line self-gated motion surrogate retrospectively bin k-space data different respiratory phase lind acquire coronal slice extract image-based self-sorting signal performing rigid registration diaphragm sort image data ten respiratory phase retrospectively meschini cluster data slice without using navigator slice comparing different surrogate signal yang2020 use diaphragm sagittal slice anatomic feature sort axial slice ten breathing phase eldeniz train deep learning network without ground truth remove reconstruction artifact under-sampled phase-resolved mri mri method class reconstruct arbitrary/irregular breathing mainly based clinically available mri sequence downside method long beforehand acquisition time min real-time capable due long reconstruction time ten second siebenthal proposed mri reconstruction framework liver mri arbitrary breathing motion acquired series mri alternating spatially fixed navigator spatially moving data slice using search strategy multiple dynamic mri used reconstruct corresponding mri reference navigator way reconstructed time-resolved mri dynamic navigator sequence could used precursor motion model shortcoming method long acquisition time needed establish data set search performed time-expensive search reconstruction several work adapted idea siebenthal tried address long acquisition time within framework applied machine-learning method interpolate navigator data slice effectively reducing acquisition time approach one tanner similar based learning relation navigator data slice main difference method end-to-end learnable formulation requires time-expensive search similar data slice within prior acquisition making method suited retrospective reconstruction karani train convolutional neural network temporally interpolate navigator use effectively half number navigator acquisition zhang expanded idea proposed temporal interpolation using prediction motion field intermediate step reducing problem blurry prediction missing structure yuan proposed time-resolved large fov mri reconstruction technique based sequence programming shorten mri acquisition time drastically attains high temporal 615\ moderate spatial resolution 2.7\times 2.7\times 4.0\ however real-time capable volume reconstruction take around also huge amount captured data images/s risk filling scanner memory longer imaging session gulamhussene improved reconstruction speed robustness out-of-plane motion navigator applying template update method group mentioned reconstruct mri retrospectively reconstruct prospectively real-time confused prospective retrospective gating proposed novel near-real-time time-resolved mri framework end-to-end dl-formulation based acquisition scheme proposed siebenthal remove active search data slice learning relation navigator data slice speed reconstruction sub-seconds unlike related work performs extrapolation instead interpolation thus used real-time intervention yield large fov high temporal resolution high isotropic spatial resolution 1.8 ^3\ still approach required half hour beforehand acquisition training essence using previous work one choose long acquisition time limited breathing phase support i.e. irregular breathing none clinically acceptable contribution work solve shortcoming previously proposed method long acquisition time predicted time-resolved mri first identify domain shift major issue dl-based mri prediction get severe smaller amount available target domain data fit observation recent survey guan second show beforehand acquisition time substantially reduced min using transfer learning technique without losing support irregular breathing third combining multiple model ensemble strategy able mitigate negative impact reduced training data improve accuracy reliability prediction table comparison related work regarding whether reconstruction done pro-/retrospectively p/r matrix size voxel resolution whether time-resolved many phase breathing cycle resolved breath cycle sampling volume per second vps pro- retrospective reconstruction p/r beforehand acquisition time befacq reconstruction time rmse mdisp full size table material method data acquisition liver mri data healthy subject acquired magnetom skyra mri scanner siemens medical solution erlangen germany following protocol described earlier work data study information sequence protocol publicly available subject data comprises three part see gray box fig described following static volume static liver volume used anatomical reference training inference acquired star vibe sequence 72â€“88 matrix size slice thickness 1.19 1.19 ^2\ in-plane resolution phase oversampling 44.4 slice oversampling fov read fov phase 2.83 1.48 ^\circ flip angle 7/8 slice partial fourier figure subject three kind data acquired static volume several alternating dynamic sequence bracket indicate pair navigator data slice dynamic reference sequence figure content based previous conceptual sketch fig gulamhussene full size image training sequence free breathing several dynamic sequence acquired navigator slice alternate data slice navigator data slice form pair used training sample name suggests training sequence used training navigator slice position fixed right liver lobe data slice position unique sequence equidistantly sampling liver right left navigator show several vessel cross-sections serf respiratory motion signal training sequence consists navigator data slice subject number training sequence ranged depending size subject liver overall acquisition time ranged min per subject reference sequence also free breathing dynamic sequence navigator slice acquired reference sequence dynamic time static position i.e. navigator fixed position training sequence reference sequence contains natural succession different breathing cycles/patterns like shallow/deep thoracic/abdominal breathing used inference respiratory reference i.e. breathing signal reference sequence comprises time point data covering second typically breathing cycle training well reference sequence acquired using trufi sequence 39.96 3.33 echo spacing 1.49 ^\circ flip angle hz/voxel readout bandwidth k_x\ base resolution phase resolution matrix size 1.8\times 1.8 ^2\ in-plane resolution plane resolution 255\times ^2\ fov faster measurement partial fourier used sampling 5/8 k-space asymmetrically phase-encoding direction i.e. roughly k_y\ line resulting acquired line resulted acquisition time ms/slice body array coil used ethic board otto-von-guericke-university magdeburg/germany approves study study healthy subject tesla methodological development mri experiment approval number 172/12 concluding ethical concern research performed accordance relevant guideline regulation verbal written informed consent obtained subject figure u-net architecture three-channel input blue box convolution grey arrow max pooling upsampling plus feature map concatenation ensembling model generation uncertainty map full size image deep learning prediction mri source code publicly available upon publication deep learning formulation deep network three input channel trained using training sequence together slice static volume training input corresponds specific subject however sample different subject used training input consists three channel see fig pair navigator data slice taken training sequence subject navigator fed first channel data slice serf ground truth label two slice sampled static volume subject one slice navigator position fed second channel one ground truth position slice predicted fed third last channel following explain rationale three channel navigator first channel dynamic time static position determines show breathing state volume slice navigator position second channel static time position act still reference dynamic navigator contains information relationship two different contrast trufi star vibe image volume slice label position third channel static time dynamic position act still reference dynamic output seek predict express position predicted inference first channel determines breathing state slice predicted third channel determines position thus reconstruct current breathing state time domain providing real-time navigator acquired intervention position space domain choosing proper position static volume acquired intervention simply inferring position one batch one forward pas total volume time point reconstructed geforce gtx take yielding real-time mri furthermore reconstruction done retrospectivelyâ€”and graphic card memory permitsâ€”a whole series fixed slice position even full reconstruction performed one batch network architecture training work propose new architecture use u-net demonstrate deep learning formulation however architecture used well requirement three input channel described three-channel input processed standard u-net encoding decoding path leaky rectified linear unit slope 0.1 follows convolutional layer convolution padded keep size feature map input constant second convolutional layer block double number feature increasing network capacity maxpooling operation follows first three block first convolutional layer filter process input network following architecture result feature map latent feature space decoding reconstructs image latent space end three block two transposed convolutional layer employed up-sample feature every two transposed convolutional layer dropout layer used up-sampling filter size halved final 1\times convolutional layer output reconstructed image network implemented kera total 6.8 million parameter trained adam optimizer learning rate 0.0004 trained epoch using mean squared error mse loss batch size checkpoint employed model best validation loss used applied z-score normalization also known whitening image intensity subject normalization process ensured intensity zero mean unit variance important note normalization reversed prediction stage specifically uncertainty map generation process case ensembling training data augmented physiologically plausible range described earlier work facilitate robustness random augmentation seeded reproducibility simplify processing image re-sampled 1.8 ^3\ voxels transfer learning show next section domain shift problem mri liver data result discrepancy model performance address issue fine-tuning pre-trained model new target subject fine-tuning simple use effective technique practicality effectiveness make particularly advantageous clinical context let source domain subject source domain likewise let target domain subject target domain use transfer learning form fine-tuning reduce discrepancy model performance specifically let pre pre-trained model trained data source domain subject denotes minute training data per subject pre fine-tuned minute training sample new subject using training parameter used training pre-trained model epoch mse loss batch size data augmentation resulting fine-tuned model pre+tl ensembling uncertainty map propose combine ensembling strategy together mit transfer learning strategy mri framework illustrated fig fine-tuning doe enhance prediction quality limited training sample available may completely mitigate decrease prediction quality caused smaller training data set ensembling play important role addressing issue combining multiple model ensembling significantly improves overall prediction quality help mitigate negative impact reduced training data set employ ensembling strategy model pre-trained starting random parameter initialisation model fine-tuned new subject following training described form final mri prediction individual model ensemble averaged uncertainty map generated computing coefficient variation prediction normalization reversed voxel wise standard deviation dividing voxel wise mean experiment result divided subject source domain containing subject target domain containing subject used first half training sequence training data second half validation data model performance quantitatively ass model performance statistical analysis use following three image-based error measure express similarity predicted slice ground truth rmse compute rmse two image i.e. predicted slice ground truth expressed computing voxel-wise intensity difference d_i\ taking root mean squared difference aligned rmse i=0 d_i^2 aligned width height image common practice report rmse evaluation mri method however comparability measure across work limited different image normalization might used moreover similarity measure doe differentiate appearance presence structure displacement structure mdisp compute mdisp first performing b-spline deformable registration using simpleitk obtain dense deformation field prediction label resulting dense deformation field sampled 16\times 16\ grid 8\times voxel spacing within liver obtain displacement vector compute average euclidean norm displacement vector manually segmented liver static volume used segmentation mask sample within liver parameterization deformable registration algorithm empirically determined follows antsneighborghoodcorrelation radius used similarity measure visually yielded better registration meansquarse mattesmutualinformation correlation pyramid scheme two level utilized first level image smoothed sigma 0.25 halving resolution using linear interpolation second level original image used smoothing grid size deformation mesh 4\times first level doubled 8\times second level gradient descent optimizer learning rate 0.25 number iteration convergence minimum value 1e^ convergence window size estimate learning rate true maximum step size physical unit 0.25 used mdisp better measure comparison across work rmse displacement structure independent image normalization however displacement field generated image ground truth always well defined example prediction contains structure present label vice versa structure missing extreme example empty prediction would lead mdisp zero course would reflect actual similarity dn_rmse alleviate shortcoming rmse mdisp propose new measure deformation-normalized root mean squared error dn_rmse computes rmse prediction deformably registered label thus dn_rmse measure similarity purely based appearance deformation displacement used interpret small mdisp value better like mdisp taken dn_rmse conclusive however combined mdisp aid better comparison generated image within one work figure navigator show considerable variance anatomy snr illustrated four source domain subject four target domain subject violin plot right show prediction error pre-trained model source domain target domain full size image domain shift study term domain shift used general way refers situation data distribution training set different test set lead decrease model performance argue clinical setting quantity available training data limited high likelihood new subject may adequately represented training set distribution inadequate representation new subject training set considered domain shift case small training distribution doe faithfully represent following variation liver shape size body height abdominal girth consequently snr signal-to-noise ratio body fat sex age list might exhaustive tabular comparison aspect source domain target domain found supplementary table ensure anonymity min max mean value reported liver shape approximated extend along three orthogonal direction superior inferior anterior posterior left right one see value wide range minimum maximum example body height range body weight liver volume ^3\ also liver extent wide range three orientation comparison different liver shape apparent snr source target domain given fig likely source subject represent distribution factor wide range faithfully remember pre model pre-trained subject source domain using min worth training sample per subject course would best could applied new subject directly without adaptation however requires domain shift present test compare domain two way first performance pre compared validation data test data using mdisp dn_rmse end randomly chose test sample first second second half training sequence i.e. subject slice position computed similarity measure prediction test sample second anatomical variance assessed visually using navigator frame visualize mdisp dn_rmse distribution violin plot see fig violin plot show non-normal distribution different mean shapiro-wilk test kolmogorov-smirnov test also showed distribution normally distributed 0.001 used wilcoxon rank sum test 12,352 test significance distribution shift null hypothesis shift error distribution rejected significance level 0.001 mean mdisp dn_rmse 0.30 1.29 0.49 2.06 quantify effect size cohen 12,352 find effect size large 2.01 1.834 visual comparison navigator show variability liver anatomy across subject concerning superiorâ€“inferior extent liver number arrangement vessel lead believe domain shift reason significant shift performance outcome pre figure top comparison adaptation different level source domain data middle comparison direct learning different level target domain data bottom comparison ensemble size full size image figure top row displacement field composite red label green prediction reference bottom row intensity difference image full size image table comparison method adaptation different availability source domain data full size table pre-trained vs. influence source domain data availability domain shift challenge deep learning-based mri prediction propose employ evaluate effect model comparing pre pre+tl regarding performance pre+tl result fine-tuning pre minute sample sample min acquisition time also analyze source data amount influence effect comparison use rmse mdisp dn_rmse top row box plot fig show result experiment two observation made first transfer learning improves model performance target domain tested measure tested measure show high significance level .001 significance level computed using wilcoxon rank sum test 12,352 confirming none normal distribution using shapiroâ€“wilk test kolmogorovâ€“smirnov test observe high effect size 1.6\ rmse dn_rmse medium effect size 0.7\ mdisp second amount source domain data beyond min subject little influence effect size also doe affect performance either pre pre+tl table report mean 95th percentile table comparison method direct learning full size table vs. direct learning influence target domain data availability evaluate whether beneficial compared directly learning model scratch target domain moreover evaluate target sample availability influence effect regarding effect size end directly train model scratch sample compare fine-tuned model let direct directly learned model let pre+tl model fine-tuned pre pre chosen base model showed virtually influence model performance furthermore acquiring sample train base model real-world scenario would economical model performance tested dependent availability target domain sample min see bottom row fig target data availability level target subject one model trained directly one total model target data availability min observe significant improvement 0.001 using concerning rmse mdisp dn_rmse visual assessment reveals detail gain see fig beyond level min improvement significant find effect size largest small medium minute target sample available become negligible large amount target sample available used wilcoxon rank sum test test significance checked distribution normally distributed using shapiroâ€“wilk test kolmogorovâ€“smirnov test effect size reported cohen table report mean 95th percentile figure illustrates image quality displacement field prediction increasing mdisp rmse value present visualization video http video visibility set public manuscript accepted review video provided supplementary material tl+ens vs. evaluate whether combination transfer learning ensembling strategy tl+ens enhances model performance compare ensemble fine-tuned model different ensemble size regard rmse mdisp dn_rmse ensemble size represents i.e ensembling one-factorial analysis variance anova performed test primary effect ensemble size reveled significant effect post-hoc pair-wise tukey test performed rmse mdisp dn_rmse independently using p-adjustment pair-wise effect size computed using cohen one see ensemble size perform significantly better tested metric although ensembling provides benefit effect size relatively small suggesting strategy reached saturation point term quantitative result quality however based subjective perspective senior radiologist extensive experience consistently preferred result tl+ens approach tl-only result tested case boxplots pairwise significance cohen presented fig mean 95th percentile reported table table comparison ensemble size full size table figure top left bottom right prediction pre direct pre+tl ensemble 10\times pre+tl arrow indicate place detail gain full size image discussion conclusion main advantage utilizing ensembling dl-based mri method dramatically reduces effect domain shift moreover amount target domain sample halved without hampering model performance compared direct learning clinical perspective make method economical beforehand acquisition therefore patient time mri machine needed method stand related work see table enables short pre-imaging time achieving high prediction quality concerning rmse mdisp dn_rmse comparable related work evaluated method different amount training data fine-tuning believe min yield good balance short acquisition time high prediction quality min method achieves mean mdisp voxel size 95th percentile two voxels unlike related work method extrapolation technique fast enough predict real-time mri intervention another unique strength noted comparing related work method regarding mdisp bit unfair interpolation used temporal context extend future easier extrapolation nonetheless method also used retrospectively still competitive noted although test showed high significance experiment main point especially effect size small case high significance level caused large statistical sample size overall effect size greater relevance shown effect greatest training sample available becomes negligible training sample size min beyond however match clinical need short acquisition time data set used study contains healthy subject new study needed conclude well mri model generalize patient data image guided liver intervention clinical setting chose fine-tuning simple yet effective way transfer learning exemplify novel combination transfer learning deep learning based mri method course advanced technique could help gain additional quality investigated future min worth training sample method requires fraction beforehand acquisition compared related work larger mdisp would interesting quantify benefit improving sub-millimeter precision context medical imaging voxel size typically range whether mean displacement voxel might sufficient see avenue improve method future work first case retrospective use would interesting increase amount training data incorporating navigator interpolation data interpolation double temporal resolution increasing prediction quality second would interesting investigate use coordconv layer place normal convolution improve prediction quality seems promising spatial component learning task dominant lastly architecture instead one might make easier learn spatial relation liver motion case training task could also reformulated directly predict motion field would beneficial use radiation therapy received positive feedback two senior radiologist extensive experience image-guided liver intervention confirmed presented result would offer significant benefit implemented clinical practice preferred tl+ensemble specifically translation work clinic could yield significant advantage interventional planning simulation would possible short pre-acquisition time significant reduction pre-acquisition time crucial two reason firstly time critical clinical resource reducing time required pre-acquisition allows efficient streamlined imaging procedure secondly strict limit specific absorption rate sar measure amount energy absorbed patient mri scan prolonged acquisition time could potentially exceed limit pose safety risk therefore ability shorten pre-acquisition time advantageous time management also ensuring compliance sar regulation future research would intriguing adapt method simulate breathing motion planning data patient conclusion work proposed utilize ensembling strategy substantially reduce beforehand acquisition time improve prediction quality dl-based mri prediction model approach training sample new subject although demonstrated liver used organ affected breathing motion method used real-time imaging image-guided intervention retrospectively create mri precursor respiratory motion model radiotherapy believe dl-based real-time mri high spatial temporal resolution potential impact image-guided intervention radiation therapy help solve problem organ motion without interfering clinical workflow