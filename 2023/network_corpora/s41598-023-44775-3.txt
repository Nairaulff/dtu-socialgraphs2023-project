introduction sleep quality important determinant human health performance poor sleep quality associated stress anxiety daytime sleepiness comorbidities obesity hypertension diabetes brain dysfunction sleep period two type sleep non-rapid eye movement light sleep deep sleep rapid eye movement rem sleep function alteration two type sleep fully understood however irregular sleeping pattern known associated sleep disorder sleep stage classification vital assessing sleep quality diagnosing sleep disorder currently diagnosis sleep disorder relies overnight polysomnography psg sleep laboratory although psg considered gold standard assessing sleep quality based stage requires multiple physiological signal including electroencephalography eeg electrooculography eog chin leg electromyography emg electrocardiography ecg oxygen saturation spo airflow also complex obtrusive procedure expensive equipment fact make psg impractical general use nursing home community health center recent year machine learning technique gained significant traction potential enable automatic classification sleep stage multimodal physiological data without eeg recording practical use especially low-resource setting desirable use reduced set input parameter long contain information related cortical activity sleep cardiorespiratory signal obtrusive relatively easy acquire simplified equipment used prediction sleep stage sleep progression lighter stage deep stage accompanied gradual increase parasympathetic modulation lead lower heart rate increased vagally mediated heart rate variability hrv stable respiration rem sleep characterized sympathetic dominance suppression parasympathetic tone producing sudden abrupt change erratic irregular breathing several study demonstrated feasibility cardiorespiratory signal and/or hrv feature predicting sleep stage additional insight provided investigating mutual interaction cardiorespiratory oscillation study analyzing cardiorespiratory interaction sleep shown cardiorespiratory phase coupling strongly affected sleep apnea event temporal dynamic slow-wave cortical activity sleep correlated cardiorespiratory phase coupling finding suggest incorporating cardiorespiratory signal machine-learning model may improve classification accuracy sleep stage accordingly study aimed evaluate performance deep learning-based sleep stage classification smaller number physiological parameter derived cardiorespiratory signal body movement participant suspected sleep disorder method participant untreated participant suspected sleep disorder recruited local neighborhood tokorozawa city japan participant underwent overnight psg sleep laboratory tokorozawa respiratory clinic july december procedure protocol approved institutional review board kyushu university 21126-00 conformed declaration helsinki participant provided informed consent participate study receiving full written oral explanation procedure polysomnography psg measurement participant demographic including age sex height weight body mass index bmi obtained overnight psg performed using philip respironics sleep diagnostic system ambient temperature 22–24 external stimulus minimized psg-recorded signal comprising ecg eog anterior tibial emg airflow signal recorded pressure thermal sensor spo measured pulse oximetry stored edf file psg monitoring software sleepware g3. eeg eog emg airflow signal recorded sampling frequency ecg recorded sampling frequency recorded signal edf file transferred labchart analysis software adinstruments japan nagoya exported text file analysis psg recording metric ahi calculated number apnea hypopnea event divided tst apnea event identified using nasal cannula airflow signal period lasting flow pre-event baseline hypopnea event identified decrease airflow signal pre-event baseline duration association presence oxygen desaturation pre-event baseline data processing four parameters—hr respiratory rate cardiorespiratory coupling index body movement frequency bmf —were used input deep learning model inference sleep stage purpose ecg respiratory flow leg emg signal extracted recorded psgs beat-to-beat r-r interval rri ecg wave calculated duration successive peak ecg signal rris resampled using spline interpolation method obtain rris equidistant time step resampling calculated rris inspected visually outlier deleted computed inverse rri beats/min respiratory signal sampled frequency filtered second-order band-pass butterworth filter frequency range 0.05–0.6 power spectral density psd filtered respiratory signal obtained window using continuous wavelet transform cwt used complex morlet wavelet basis function obtain cwt respiratory signal respiratory frequency assessed determining dominant peak psd time breaths/min extract respiratory sinus arrhythmia rsa resampled rris filtered band-pass filter frequency range dominant frequency respiration cardiorespiratory coupling index obtained phase coherence rsa respiration detail calculation described elsewhere briefly instantaneous phase rsa respiration calculated using analytic signal approach complex plane angle real signal hilbert transform yield instantaneous phase phase coherence computed measuring invariance phase difference rsa respiration given time window per following equation i\psi denotes number consecutive data sample computation window phase difference rsa respiration discrete time emg signal anterior tibialis muscle chosen indicator body movement generally considered characteristic arousal sleep filtering band-pass butterworth filter frequency range 1–30 emg signal normalized onset timing body movement detected normalized emg signal exceeded preset threshold threshold set three time baseline emg amplitude body movement detected time window number body movement set one otherwise set zero parameter calculated time window sliding period moving averaged applying median filter window align time series data corresponding sleep stage label psg record therefore represent respective mean value six data point calculated every bmf represents mean number body movement duration unit example overnight parameter profile along sleep staging label scored human expert individual participant shown fig sleep stage classified according american academy sleep medicine follows wake rapid-eye-movement sleep rem non-rapid eye movement sleep although state getting bed included aasm annotation rule considered stage getting bed referred ecg emg airflow signal disappeared period epoch see fig around min done missing signal provide information deep learning model learn underlying physiological relationship input variable sleep stage additionally four epoch stage added beginning end analyzed dataset added zero data psg staging label added label done give model data point better predict minority outcome lv. different function sleep stage resulted variation bmf sleep progressively deepened stage became stable stabilized higher level bmf became frequent fig contrast rem stage fluctuated decreased fluctuating bmf tended frequent figure example input data profile analyzed 47-year-old man ahi 54.6 along sleep staging label top bottom annotated sleep stage human expert bmf parameter calculated every time window shifting step aligned interval correspond sleep staging label note sleep staging label indicates getting bed see data processing full size image machine learning model inference sleep stage done training deep neural network learn association multivariate time series bmf sequence sleep-staging label scored human expert used bilstm neural network classify sleep stage bilstm architecture learn sequence information backward forward direction considered bilstm model suitable predicting sleep staging transition sleep progression known temporal dependency overview model shown fig model composed sequential input layer three bilstm layer fully connected layer bi-lstm layer consisted hidden cell dropout layer rate 0.2 added bi-lstm layer reduce overfitting fully connected layer consisted six neuron corresponding six class probability light non-rem sleep deep non-rem sleep rem sleep rem softmax function used activation function output fully connected layer could used predict multinomial probability distribution finally classification layer classified epoch epoch sleep stage based probability distribution figure architecture bilstm deep learning neural network model classification closed circle denote dropout layer fully connected layer sequence input layer full size image training validation model trained validated using leave-one-out cross-validation scheme observation considered validation set remaining observation number observation considered training set process repeated number observation observation validation set training data split mini-batches shorter sequence zero-padded end sequence length reduce amount padding sequence training data sorted sequence length training model trained mini-batch size determined longest sequence among entire set input sequence adam training optimizer used minimize categorical cross-entropy loss function cel predicted class actual label computed cel p\left total number epoch represents sleep stage assigned sequential ordinal value fraction sequence scored psg measurement fraction sequence predicted model minimizing loss function model learns assign higher probability correct class reducing probability incorrect class initial learning rate set reduced one-hundredth previous rate every epoch norm-based gradient threshold method employed clip gradient value exceeded gradient threshold training process terminated improvement test data consecutive epoch validation accuracy loss function used stopping criterion avoid over-fitting hyperparameters used study summarized table value hyperparameters selected based several try-and-error trial trained model machine nvidia geforce rtx3060 gpu vram table range selected value hyperparameters deep learning full size table data analysis evaluation model performance recognizing imbalance problem sleep scoring data used metric balanced accuracy cohen score statistic epoch-per-epoch agreement sleep staging evaluate sleep stage classification performance model comparison ground truth multiclass confusion matrix generated analyze outcome construct confusion matrix class combined sleep stage rem sequentially assigned ordinal value overall performance metric balanced accuracy cohen score computed following equation accuracy tp_ tp_ fn_ tn_ fp_ tn_ cohen tp_ tp_ fn_ tn_ fp_ tn_ score tp_ tp_ fn_ tp_ tp_ fn_ tn_ fp_ tn_ true positive true negative false positive false negative categorical class respectively number categorical sleep stage i.e. performance also analyzed per-class basis using metric estimation sleep parameter investigated potential deep-learning-based sleep stage classification calculating sleep parameter following six sleep parameter chosen total sleep time tst defined total time non-wake stage sleep latency defined duration time bedtime onset sleep wake sleep onset waso calculated time bed tib -sl-tst percent time rem sleep tst rem percent time nrem sleep tst nrem sleep efficiency defined tst/tib parameter derived deep learning compared assessed psg measurement statistical analysis effect ahi age overall balanced accuracy cohen score examined using pearson correlation coefficient association ahi category performance metric also assessed using repeated-measures one-way anova bonferroni correction compare performance distribution sleep stage kruskal–wallis rank-sum test applied avoid assumption normality scheffé test used multiple comparison statistically significant difference observed sleep stage deming regression analysis bland–altman plot used describe relationship agreement sleep parameter predicted deep learning assessed psg measurement level agreement loa mean bias sleep parameter calculated spearman rank correlation analysis performed difference average sleep parameter assessed psg measurement derived deep learning test constant proportional bias bland–altman plot data presented mean statistical test 2-sided value 0.05 judged statistically significant data processing analysis performed matlab r2022b mathworks customized script machine learning toolbox wavelet toolbox signal processing toolbox result total number participant suspected sleep disorder including female participant demographic sleep statistic presented table systolic diastolic pressure measured psg examination mmhg respectively mean apnea–hypopnea index ahi 30.8 23.2 events/h range 2.6–127.9 participant 43.1 ahi participant 26.8 ahi 15–30 participant 23.6 ahi 5–15 participant 6.5 ahi significant correlation age ahi 0.059 0.515 see supplementary file table demographic sleep statistic participant full size table figure show example sleep stage predicted model low- ahi 3.2 fig high-ahi participant ahi 80.2 fig age confusion matrix generated evaluate performance model low-ahi case rem class achieved greater classification performance term balanced accuracy cohen score metric n1/n3 class fig however epoch-by-epoch class could correctly estimated model possibly insufficient duration fraction sleep stage tib prediction almost agreed ground truth shown pie chart fig table displayed fig low-ahi case performance balanced accuracy cohen score 0.88 0.75 0.87 respectively accuracy cohen score high-ahi participant 0.71 0.43 0.66 respectively fig lower low-ahi participant fig structure sleep-stage transition pattern captured well figure example overnight sleep stage prediction model low- high-ahi participant age sleep stage scored human expert predicted sleep stage model pie chart whose segment represent fraction sleep stage tib confusion matrix balanced accuracy cohen score sleep stage derived confusion matrix percentage time spent sleep stage tib ground truth true prediction predicted 37-year-old man ahi 3.2 37-year-old man ahi 80.2 sleep stage predicted sleep stage wake stage rem rapid eye movement sleep stage non-rem sleep stage non-rem sleep stage non-rem sleep stage full size image figure show box plot distribution performance metric reported balanced accuracy cohen score data average accuracy cohen score 0.712 0.058 0.425 0.115 0.650 0.083 respectively relationship metric ahi age shown fig shown fig metric significantly negatively correlated ahi accuracy 0.483 0.0001 cohen 0.482 0.0001 score 0.471 0.0001 although observe significant correlation age ahi significant weak negative correlation age accuracy 0.200 0.013 cohen 0.199 0.014 score 0.195 0.015 detected fig hand shown fig metric positively correlated accuracy 0.386 0.0001 cohen 0.387 0.0001 score 0.374 0.0001 ahi categorized using commonly used clinical cutoff point subject severe ahi group significantly lower performance metric compared normal mild ahi group 0.05 shown fig figure box plot showing distribution overall performance term balanced accuracy cohen score box plot display 25th percentile median 75th percentile whisker extend minimum maximum value black red open circle denote male female participant respectively full size image figure scatter plot overall performance term balanced accuracy cohen score ahi age participant black red open circle denote male female participant respectively regression line displayed solid line linear regression equation correlation coefficient relation indicated ahi apnea hypopnea index sleep efficiency full size image figure box plot showing distribution overall performance term balanced accuracy cohen score split across ahi category normal ahi mild ahi 5–15 moderate ahi 15–30 severe ahi box plot display 25th percentile median 75th percentile whisker extend minimum maximum value 0.05 vs. 0.05 vs. full size image understand whether classification performance differed among sleep stage per-class performance metric also assessed table difference metric sleep stage compared kruskal–wallis rank-sum test accuracy cohen found low compared sleep stage lowest score table detailed per-class performance metric balanced accuracy cohen score full size table pairwise comparison major sleep parameter tst waso rem nrem derived deep learning assessed psg measurement summarized table also result bland–altman analysis deming regression comparison shown fig among sleep parameter rem underestimated 3.1 nrem overestimated complementary 3.1 0.001 four parameter nonsignificant tst 0.063 0.145 waso 0.290 0.095 observed fig moderate significant correlation sleep parameter assessed psg measurement predicted deep learning 0.332–0.597 spearman rank correlation analysis difference mean bland–altman plot demonstrated proportional bias found throughout measurement range except tst 0.629 0.001 waso 0.468 rem 0.563 nrem 0.165 0.375 difference tends increase direction underestimation long small bias min tst although loa wide upper lower loa min respectively similar result obtained waso bias 5.8 min upper lower loa min respectively also small bias rem 3.0 nrem 3.2 1.4 loa around table comparison major sleep parameter derived psg predicted deep learning full size table figure bland–altman analysis deming regression comparison psg-derived- deep-learning-based sleep parameter deming regression plot illustrates fitted linear model solid line identity line dotted line linear regression equation correlation coefficient relation indicated bland–altman plot limit agreement loa bias displayed dashed dotted line respectively together numerical value upper ↑loa lower ↓loa loa presented 1.96 prefix sleep parameter mean predicted deep learning tst total sleep time sleep latency waso wake sleep onset rem percent time rem sleep tst nrem percent time nrem sleep tst sleep efficiency full size image discussion present study aimed evaluate performance five-class sleep stage classification bilstm model small number physiological parameter derived cardiorespiratory body movement activity using four physiological parameter bmf predicted sleep stage bilstm deep learning model showed substantial agreement ground truth average accuracy 71.2 cohen 0.43 score 0.65 result showed estimated major sleep parameter current model significantly correlated assessed psg measurement accuracy achieved proposed method equivalent previous study research group radha proposed lstm network model feature extracted hrv four-class sleep stage model achieved accuracy cohen 0.61 also classified four-class sleep stage large dataset using deep convolutional neural network model combined support vector machine cardiorespiratory coupling time–frequency domain feature sample entropy temporal hrv measure derived single ecg signal model achieved accuracy 75.4 cohen 0.54 compared previous model model showed lower performance cohen statistic approach combining one class previous model may explain improved performance thus evaluated performance combined light sleep category expected mean cohen statistic increased 0.60 0.10 combined comparable performance previous study accuracy score also increased accuracy 79.7 5.5 score 0.77 0.06 expected since total number class reduced five four another possible reason lower cohen statistic five-class sleep stage classification model small number healthy control enrolled present study eight participant categorized normal ahi lee proposed hidden-markov model several waveform feature extracted single frontal eeg four-sleep stage classifier observed poorer agreement time deep sleep obstructive sleep apnea osa patient non-osa participant presumed poor agreement patient osa due lower percentage deep sleep epoch training set therefore performance present model also examined determine whether depended ahi figure illustrate negative correlation performance metric ahi indicating decreasing performance increasing ahi cohen severe ahi group significantly lower normal mild ahi group shown fig analogous result also reported zhang classified five sleep stage inputting eeg data convolutional neural network model observed achieved performance term accuracy score gradually decreased increased ahi moreover study documented osa patient sympathetic hyperactivity cause repeated sympathetic arousal sleep therefore lower performance participant higher ahi may due current set parameter used adequately describe sleep-stage transition complexity caused repeated arousal sleep performance metric positively correlated fig expected known osa patient likely poor quality sleep observed significant weak negative correlation performance age fig age-related decrease performance probably independent ahi observe significant correlation age ahi consistently radha also reported decrease performance age likely pronounced result finding suggested decrease performance older participant might caused change autonomic function sleep architecture age finding confirmed future study distribution performance metric across sleep stage showed higher variability especially rem judging performance metric table average accuracy cohen lowest significantly different low performance indicates difficulty discriminating model previous study also pointed model tended misclassify period combined form light nrem sleep stage accuracy cohen almost five-class classification accuracy 0.68 0.07 cohen 0.36 0.14 average score lower sleep stage model probably due class imbalance stage average duration stage 3.9 tst training dataset table generally labeled data scarce deep learning prone overfitting learning algorithm becomes overly focused detail specific scarcely labeled training dataset factor lead incorrect classification stage new unseen data additionally noted inter-rater agreement scoring stage reported low disagreement scoring stage occurring due confusion stage thus potential bias human expert might affected classification performance also investigated potential clinical efficacy work comparing sleep parameter derived predicted sleep stage current model assessed psg measurement trend proportional bias found bias increase direction underestimation longer since defined elapsed time start bed first epoch scored sleep model make incorrect prediction instance predicting sleep individual remains awake start bed result shorter time take fall asleep present proposed model doe facilitate detection future research warranted investigate may reliably detected sleep parameter found modest correlation slope regression line around 0.80–0.94 absence proportional bias demonstrating capability current approach estimating sleep parameter sleep structure analysis present study cardiorespiratory coupling assessed phase coherence rsa respiration incorporated model input measure found preferentially reflect parasympathetic vagal activity autonomic profile sympathetic inhibition parasympathetic activation caused increase therefore expected would vary depending degree sleep depth correlation eeg power dynamic previously described clear association increasing slow wave activity increased observation suggests may exist neuronal pathway lead cortico-cardiorespiratory coupling however unclear extent follows distinct pattern depending sleep stage demonstrated representative input data profile fig stable increase observed also sleep stage change relate sleep stage warrant investigation similar index used thomas predict sleep structure single ecg signal however coupling index fourier-transform-based cross-power spectrum hrv ecg-derived respiration calculated 8.5 min temporal window computation cross-spectrum assumes signal stationary analyzed temporal window indicating spectral composition doe vary time whereas time domain calculated epoch-by-epoch basis without restriction therefore may advantage cross-spectral analysis especially used ass short-time-resolution data summary present study demonstrated bilstm deep learning model performed well five-class sleep stage classification using four physiological parameter derived cardiorespiratory body movement activity population suspected sleep disorder currently issue remain addressed particularly regarding limitation model performance participant high ahi score achieve accurate prediction high-ahi participant need investigate whether cardiorespiratory parameter could provide information sleep fragmentation associated repeated arousal sleep analyzing performance index sleep stage classification term arousal index periodic limb movement also future task additionally consider reducing class imbalance recruiting participant higher percentage epoch and/or healthy control participant considering relatively small sample size future study include larger sample size increase generalization ability deep learning model expect bilstm model better performance automated sleep staging balanced training data class model capture temporal dynamic sleep-stage transition attending feature parameter forward backward sequence predicting sleep stage cardiorespiratory body movement activity could simplify traditional manual scoring based psg health disease currently potential technique unobtrusively acquiring cardiorespiratory signal in-bed ballistocardiographic sensor result study contribute development daily sleep structure analysis home environment using unobtrusive modality thereby aiding clinician assessing prevalence sleep disorder outside sleep laboratory reducing burden patient attach various sensor electrode