introduction pairwise image registration technique designed spatially align image essential various task biomedical imaging goal registration determine spatial transformation maximizes similarity moving image target fixed image accurate image registration enables data comparison across subject imaging modality time example registration necessary neuroscience map individual brain image population based brain atlas space image registration method studied many year classic pair-wise image registration technique available advanced normalization tool ant niftyreg utilize handcrafted optimization algorithm determine deformation field traditional method used produce well-behaved deformation field follow imposed modelling assumption example transformation function affine rigid classic method also applied deformable image registration aim calculate dense nonlinear mapping two image unfortunately classic algorithm time consuming large image may underperform data violate field modeling assumption deep learning method based convolutional neural network gaining momentum image registration convolutional network voxelmorph used process pair input image output deformation field required image alignment various deep learning method based voxelmorph framework proposed improve image registration performance example transmorph replaces standard convolutional layer transformer block diffusemorph determines deformation field based conditioned diffusion process cyclemorph utilizes cycle consistency loss regularize deformation field however deep learning method based voxelmorph framework exhibit number limitation diminish practical applicability first neural network require large training set commonly underperform out-of-distribution data practice often difficult collect curate large dataset biomedical imaging data additionally utilizing convolutional network training large input image demand significant memory resource necessitating downsampling image predetermined geometry constraint complicates network application image deviate training geometry furthermore compared traditional method voxelmorph-like network serve off-the-shelf tool image registration especially neuroscience experimental data scarce commonly obtained using different acquisition protocol synthmorph proposed recently address several limitation voxelmorph synthmorph trained synthetic pair image random deformation transformation applied cause dis-similarity input image approach mitigates requirement collection curation biomedical data doe neither address problem related image geometry problem out-of-distribution image data especially case requiring deformation field different one used generate synthetic training data implicit neural representation inr recently used image registration magnetic resonance imaging mri computed tomography inr serve continuous coordinate-based approximation deformation field obtained multi-layer perceptron mlp setting single implicit network trained directly determine deformation field required register two image inr offer hybrid approach image registration present property neural network traditional per-case optimization technique unlike voxelmorph-like network inr based registration method require large training datasets implicit network trained scratch image pair moreover compared convolutional network require dense input e.g entire image defined coordinate grid predetermined size implicit network defined continuous coordinate space make suitable registration image differ geometry spatial resolution compared traditional registration method implicit network leverage complex objective loss function optimization wolterink presented implicit sinusoidal representation network siren used lung registration image author demonstrated siren outperform network utilizing rectified linear unit relu activation function perform registration author trained implicit network standard normalized cross-correlation loss randomly sampled image pixel coordinate similarly sun successfully applied standard siren model brain image registration mri author trained implicit network based local normalized cross-correlation loss using sampling strategy utilizes randomly extracted coordinate vector patch study demonstrated inr successfully used model deformation field deep learning library support gpu computation automatic differentiation technique highlighting potential implicit network versatile off-the-shelf tool paired image registration work explore use implicit network brain image registration main contribution follows investigate registration performance implicit network equipped activation function different oscillatory characteristic propose several novel activation function chirp function examine performance inr based registration method several way example investigate trade-off registration performance deformation field folding moreover investigate relationship registration performance oscillatory characteristic activation function result indicate several practical challenge application implicit network requirement hyper-parameter tuning propose novel inr based registration approach outperform standard technique based siren network example present registration performance implicit network improved incorporation cycle consistency loss also consider ensemble cascade implicit network furthermore show image registration combined image fusion inr framework implemented method compared ant registration algorithm voxelmorph convolutional network method preliminary goal pairwise image registration determine transformation spatially aligns moving image fixed image coordinate-based mlps serve network implicitly learn transformation approximating underlying deformation field represented ^3\ field determines displacement moving image spatially align fixed image normalize coordinate respect image dimension coordinate within -1,1 ^3\ setting single implicit network weight used process spatial coordinate -1,1 ^3\ moving image output displacement vector following calculation displacement vector deformation field determined interpolation algorithm applied obtain corresponding moved image inr based registration illustrated fig pairwise image registration following loss function commonly used determine deformation field aligned sim reg reg aligned sim loss function designed ass similarity fixed image moved image reg stand regularization loss function used smooth deformation field constrain spatial transformation physically plausible moreover reg indicates weighting term used balance similarity field regularization loss function figure scheme presenting pairwise brain image registration based implicit neural representation setting coordinate network used estimate displacement vector determine deformation field note change shape brain gyrus ventricle moved image compared moving image full size image activation function wolterink demonstrated siren mlps equipped sine activation function outperform relu network image registration work compare performance sine relu activation function detail addition investigate use several activation function frequency dependent component listed table relu relu became default activation function many deep neural network simplicity satisfactory performance defined aligned max aligned sine common network architecture modeling signal siren architecture utilizes sine activation function aligned sin aligned denotes input represents frequency-related hyper-parameter typically set application sine function address several problem associated relu function absence higher-order derivative bias towards low-frequency content hinder modeling fine detail underlying signal additionally network activation function posse periodic inductive bias better suited model function oscillating pattern snake ziyin introduced snake activation function alternative sine function demonstrating network using snake function easier optimize show superior performance classification sequence modeling task snake function combine identity mapping scaled cosine function aligned aligned sine+ sine+ another function proposed ziyin share similar advantage snake function compared sine function defined aligned sin aligned chirp explore chirp activation function alternative sine function sine function frequency constant controlled hyper-parameter whereas chirp function modulates respect frequency therefore potentially better suited oscillatory pattern varying frequency propose using following chirp function activation function aligned sin tanh aligned hyper-parameter related constrains rate change frequency respect output hyperbolic tangent function way frequency variable value around approach constant value otherwise morlet also explore potential morlet wavelet alternative sine function morlet wavelet windowed modulated sine function due locality spatial frequency domain may better adapt frequency based location within image simplicity use imaginary part morlet wavelet activation function aligned -\frac x^2 sin aligned -\frac 1+e^ -\omega -2e^ -\frac -\frac =e^ -\frac figure show chirp morlet activation function input around figure sine chirp morlet activation function around set chirp function hyper-parameter set full size image table investigated activation function full size table investigated method section describe several potential extension standard inr based approach image registration attention mechanism regular siren architecture hyper-parameter constant linear layer since related ability network represent local signal variation may beneficial express parameter function input coordinate allowing network adjust hyper-parameter according local field characteristic achieve propose simple attention mechanism modify sine activation function following way aligned sin sin aligned _0\ correspond center modulation parameter respectively function used relate hyper-parameter output linear layer following form aligned tanh i=1 aligned trainable parameter used scaling tanh hyperbolic tangent activation function summation unit corresponding linear layer use average absolute input value expect coordinate associated larger deformation produce higher output linear layer network set _0\ therefore possible range hyper-parameter equal ensemble implicit network model ensembling popular strategy used improve performance machine learning investigate whether ensemble three implicit network enhance registration performance create ensemble based three standard siren model hyper-parameters set respectively spanning wide frequency range thus ensemble model deformation field varying local variability generate deformation field averaging output three network train network jointly affine transformation coordinate-based mlps extended jointly optimized image registration objective present inr combine local deformable inr-based registration global image transformation jointly training affine transformation case deformation field expressed follows aligned aligned displacement vector calculated implicit network matrix 3\times translation vector represent trainable parameter global affine transformation training initialized identity transformation cascade implicit network cascading learning another strategy used enhance performance machine learning model cascade model trained scratch one another correct improve predecessor outcome due computational cost strategy often used deep learning model instead vos zhao employed small multi-stage convolutional network image registration trained jointly single training episode study investigate two-stage cascade implicit network image registration develop single implicit network registration train second network subsequently improve deformation field approach expressed follows aligned aligned deformation field calculated first network displacement vector estimated second network first network use standard implicit model second network examine two approach first train another regular model second train second model higher regularization loss weight locally smooth deformation field outputted first network cycling implicit network cycle consistency loss found application deep learning particularly task like image-to-image translation kim showcased used enhance performance voxelmorph deformation field regularization framework two convolutional network employed image registration first network register moving image fixed image second network doe reverse initial registration role network swapped previously transformed image registered result end two round registration image revert original space goal introducing cycle consistency loss enhance topological preservation idea symmetric normalization novel crucial component traditional image registration framework drawing inspiration study introduces analogous approach given implicit network operate coordinate use coordinate specific displacement vector define consistency loss let stand implicit network trained transform moving fixed image respectively proposed cycle consistency loss based following equation aligned aligned aligned aligned aligned cyc aligned promote correspondence displacement vector next add cycle consistency loss function cycle registration loss function aligned sim reg reg cyc cyc aligned cycle indicates loss weighting parameter registration guided image fusion computer vision implicit network used jointly perform several task example image reconstruction style transfer study demonstrate implicit network used connect brain image registration image fusion task proposed method illustrated fig various custom image processing algorithm designed improve image registration example application common utilize edge enhancing filter highlight tissue contour thereby guiding registration algorithm better match edge moving fixed image contrary image smoothing filter also applied improve registration example gaussian filter used process moving image remove local noise pattern confound similarity loss function designed ass alignment moving fixed image develop implicit network combine two image pre-processing approach namely edge enhancing filter image smoothing filter automatic registration guided way proposed method used fuse edge enhanced smoothed image coordinate-wise manner enhancing edge information particular region smoothing area formulate image fusion problem following way aligned s_m s_l m_l s_g m_g aligned m_l\ m_g\ stand moving image filtered laplacian gaussian filter respectively weight s_m s_l s_g used fuse corresponding image pixel-wise manner addition impose following condition weight constrain fusion aligned s_m s_l s_g aligned training deformation network jointly train separate fusion network fus output weight vector fusion network use standard siren model default parameter train network use fus loss function based standard registration similarity loss expressed following way aligned fus sim sim aligned sim stand standard image similarity loss function transformed moved fused image aim loss function jointly estimate deformation field provide mean image fusion mechanism region similarity score function underperform might uplifted second component fus loss function take account fused image general registration loss function modified following way aligned fus reg reg aligned figure scheme illustrating proposed registration guided image fusion technique fused image generated based weighted pixel-wise combination original image image processed laplacian gaussian filter weight used image fusion calculated using implicit network trained improve registration weight distribution s_m s_l s_g visualized parametric map pixel color intensity rgb space proportional component distribution instance first weight s_m 0,1 mapped red color channel parametric map indicates filtering operation used process particular image area full size image evaluation mindboggle dataset evaluate registration performance used mindboggle dataset consists labeled t1-weighted brain image five source dataset includes detailed manual segmentation cortical brain region region right left hemisphere used image pre-processed author dataset pre-processing included affine alignment standard mni template skull stripping re-sampling volume spacing addition cropped brain image dimension voxels excluded one brain scan skull-stripped version available next manually screened data found incorrectly aligned image re-run initial affine registration participant consisting male female ranged age year year mean age year two brain scan served fixed image remaining case divided training validation test set split respectively validation test set image sampled uniformly five mindboggle dataset subfolders mindboggle dataset subfolder equally represented validation test set remaining image included training set implementation except activation function used mlp architecture experiment network included five fully connected hidden layer neuron addition used fourier mapping six frequency encode input coordinate also concatenated encoded coordinate middle layer network form residual connection weight network initialized depending utilized activation function following original paper chirp morlet activation function initialized weight similar way siren model moreover initial weight last linear layer implicit network sampled uniformly -0.0001 0.0001 interval ensure small displacement vector outputted network first training epoch adamw optimizer learning rate 0.0001 used train network model trained single nvidia a100 gpu due large dimension image implicit network commonly trained using patch work trained network patch size epoch sampled patch random spatial location ass similarity moved fixed image used following loss function aligned sim ncc lncc aligned ncc indicates normalized cross-correlation loss ncc calculated based entire patch lncc averaged local normalized cross-correlation loss computed using window patch determined combine local global alignment information following previous study inr based registration used following loss condition deformation field aligned reg aligned jacobian determinant deformation field calculation done python using pytorch library implementation described method available http performance assessment validation set utilized determine better performing hyper-parameters siren model examined five different value three reg value 0.1 0.01 based validation set result also determined optimal number training epoch siren model compared mlps utilizing implemented activation function see table cyc weight related cycle consistency loss set chirp rate set ass registration performance calculated dice score manual segmentation brain region moved image fixed image mindboggle dataset consists annotated brain region first averaged dice score calculated region second evaluate performance poorly aligned region determined lowest dice score brain region next two dice score obtained brain averaged moving/fixed image pair ass deformation field folding calculated percentage non-positive jacobian determinant value benchmarked performance proposed method two established technique ant symmetric image normalization syn registration algorithm diffeomorphic voxelmorph convolutional network voxelmorph constructed two network using training dataset dedicating one fixed image network trained epoch using loss function implicit network regularization weight denoted reg set 0.1 syn method optimized parameter validation set objective maximize dice score optimal result achieved using cross-correlation loss function coupled three-level multi-resolution scheme allowed iteration first level iteration second level iteration full resolution result validation set experiment figure registration performance score obtained investigated implicit network validation set found siren model trained hyper-parameter reg 0.1 performed best compared siren network relu activation function required around ten training epoch reach performance plateu full size image figure present validation set result obtained investigated method siren model trained regularization weight reg set 0.1 found value hyper-parameter affected convergence characteristic deformation field property similar dice score around 0.57 obtained investigated value except siren reach plateau epoch deformation field folding positively correlated value hyper-parameter largest folding obtained equal moreover spearman rank correlation coefficient dice score percentage non-positive determinant value equal 0.92 siren network set overall fig suggests equal provides well-balanced result respect convergence speed deformation field folding setting equal also provided slightly better dice score validation set case dice score network plateaued approximately training epoch moreover also investigated relationship registration metric regularization weight reg obtained siren set found regularization weight important image registration performance deformation field characteristic reg equal 0.1 providing good performance reg equal field regularization dominated training resulted low dice score contrary reg 0.01 small address problem deformation field folding validation performance achieved implicit network equipped different activation function illustrated fig case hyper-parameters reg set 0.1 following result previous paragraph found network activation function oscillatory pattern sine sine+ chirp morlet yielded comparable result however network snake activation function resulted lower dice score due division cosine function parameter snake activation function identity mapping probably dominated activation function relu network reach plateau epoch therefore trained epoch additionally examining three regularization weight reg 0.1 0.01 see fig found network relu function required around training epoch reach plateau corresponding dice score around 0.53 activation function following validation set experiment compared test set performance implicit network trained epoch hyper-parameter set regularization weight reg set 0.1 result presented table addition also included result network relu function trained epoch found network utilizing relu snake activation function achieved worse performance score compared function presenting oscillatory pattern obtained similar result sine sine+ chirp morlet activation function confirming presence frequency component important performance table show regular siren model achieved highest dice score 0.576 table test set result mean±std mindboggle dataset obtained implicit network equipped different activation function full size table proposed method table test result mean±std mindboggle dataset obtained proposed inr based registration method full size table table compare performance standard method technique proposed improve inr based registration siren model parameter set used backbone proposed technique following validation set result regularization weight reg set 0.1 network trained epoch comparison also developed siren model trainable hyper-parameter initially set siren hyper-parameter modulated respect layer width latter case layer unit network linearly modified value method based implicit network achieved higher dice score ant syn optimization technique voxelmorph figure quantitatively compare registration performance selected technique addition fig illustrates dice score anatomical structure annotated mindboggle dataset siren model trainable parameter achieved comparable score siren model fixed frequency parameter suggesting value optimally selected investigated registration task similarly utilization proposed attention mechanism modulation mechanism improve performance compared siren optimized hyper-parameter suggests siren model trainable maintain performance best network fixed parameter without need extensive hyper-parameter tuning figure qualitative comparison registration performance implicit network diffeomorphic voxelmorph ant syn algorithm presented warp field correspond implicit network full size image figure boxplots illustrating dice score various anatomical structure image registration using ant syn algorithm diffeomorphic voxelmorph siren cascade siren structure ordered based average ant dice score obtained structure left hemisphere approach based cascade siren achieved better performance investigated method full size image method combining trainable affine layer siren model achieved similar score standalone siren model presumably due accurate initial pre-alignment brain image standard mni template space ensembling implicit network achieved higher dice score compared standard siren model found utilization cycle consistency loss improved deformation field characteristic decreasing number folding pixel cascade two identical siren model achieved highest dice score 0.594 cascade second network trained using reg equal resulted improvement deformation field method based image fusion achieved slightly better performance standard siren model sample result approach presented fig weight distribution map show automatic utilization image filtering operation found method utilized mainly original image pixel approximately pixel extracted image processed laplacian gaussian filter respectively figure sample result obtained implicit network based proposed registration guided image fusion weight distribution indicates utilization original image red laplacian green gaussian blue filtered image particular case average weight equal 0.57 original 0.15 laplacian 0.28 gaussian indicating operation utilized process brain image full size image discussion presented several novel approach inr-based image registration conducted extensive experiment show impact hyper-parameter selection design choice performance implicit network result demonstrated implicit network achieve superior performance traditional image registration method ant syn standard deep learning image registration framework voxelmorph biomedical image analysis traditional registration algorithm remain go-to tool due diversity complexity registration task however implicit network combine characteristic standard optimization technique modern deep learning methodology offer promising alternative unlike convolutional network often demand extensive training data defined fixed spatial grid inr-based method function efficiently without extensive datasets furthermore specific application implicit network optimized case-by-case basis potentially leveraging complex objective loss function optimization adaptability also provides solution out-of-distribution issue frequently encountered large convolutional network presented validation set result illustrated choice hyper-parameters regularization weight important brain image registration performance optimization model hyper-parameters based validation set usually difficult conduct convolutional network model must retrained entire training dataset set hyper-parameter value optimization multiple hyper-parameters may affect another may consume considerable time computing resource contrast small annotated validation set used quickly explore hyper-parameter space implicit network different combination hyper-parameters also utilized inference generate set registered image visual comparison therefore result suggest implicit network easier optimize method based convolutional network result better registration capability investigated image registration performance associated six activation function best knowledge study demonstrated first time chirp function morlet wavelet used activation function implicit network however achieved similar registration score two activation function compared standard sine function result indicated center frequency oscillation important performance four activation function namely sine sine+ chirp morlet function achieved comparable registration performance presented frequency hyper-parameter strictly related registration performance large value correlated deformation field folding moreover network activation function presenting low-frequency content relu suited produce variable deformation field network equipped relu function required many training epoch reach performance score plateau compared siren model however network relu require hyper-parameter tuning therefore might attractive application work examined several novel approach inr based registration finding demonstrated implicit network serve efficient flexible technique pairwise brain image registration first possible develop cascade implicit network subsequently improve deformation field consequently registration performance investigated cascade implicit network approach applied improve deformation field determined convolutional network traditional optimization algorithm moreover improvement deformation field restrained spatial region second implicit network easily used form ensemble example trained implicit network jointly affine transformation model third since implicit network trained back-propagation possible associate registration problem task presented inr based registration performed jointly image fusion based second implicit network proposed inr based fusion method provide interpretability registration model since used visualize image region require texture filtering registration utilized laplacian gaussian filter operation easily considered within proposed framework investigated inr based method also combined example would straightforward combine method based image fusion technique utilizing cycle consistency loss study presented several challenge associated inr based registration method first setting implicit network trained scratch image pair slowing inference time compared standard convolutional network address problem would like investigate method speed computation example may interesting utilize hyper-networks pre-initialize weight implicit network second study extensively explored usefulness inr registration experiment based single dataset although mindboggle dataset includes brain image multiple source detailed annotation would also interesting utilize additional datasets evaluation e.g computer tomography image ultrasound data third trained network loss function based cross-correlation function jacobian determinant deformation field reduce potential bias experiment used network architecture coordinate sampling procedure investigating network architecture training routine future study would interesting conclusion work explored implicit neural representation registration magnetic resonance brain image performed extensive experiment compare different activation function including two novel function proposed study chirp function morlet wavelet also developed several novel implicit network based approach registration outperformed previously proposed method presented result indicate implicit network well suited address problem pairwise image registration believe work important pre-liminary step wider adoption implicit network versatile off-the-shelf image registration tool future plan conduct additional experiment highlight usefulness implicit network image registration