introduction reflecting coronavirus disease covid-19 pandemic first wave particular brought unprecedented challenge healthcare system exponential surge case overwhelmed intensive care unit icu presenting scene never witnessed age modern medicine state emergency optimizing allocation hospital resource e.g. icu bed mechanical ventilator personnel becomes crucial essential aspect effective patient management correctly assessing treatment necessity potential outcome limited understanding previously unknown disease paired highly multimodal data case novel pandemic performing assessment prediction patient outcome challenging resulting sudden overload care facility combination high complexity obtained data structure motivates need assistance system fast outcome prediction triaging based available patient information start covid-19 pandemic upon patient hospital admittance multitude parameters—such sex age body weight symptom co-morbidities blood cell count inflammatory parameter biochemical value cytokine profile among others—were obtained documented parameters— tabular data following—and radiological image including radiograph x-ray computed tomography image available within first hour new patient arrived hospital deems two data source ideal early triaging outcome prediction traditional disease outcome prognosis performed clinician based however also anamnestic information clinical experience general logic physician decision-making process partly relies information embedded similar patient outcome connection information currently treated patient known population relationship particularly useful little disease-specific epidemiological information well deep medical expertise available might case potential upcoming health crisis following method reasoning propose decision support system performs multimodal data analysis create population graph cluster patient used graph neural network attention mechanism refine patient outcome prediction taking account similar patient used similarity metric attention mechanism generated pathology segmentation provide added insight decision-making process becomes possible weighting clinical feature influential patient used prediction process directly observed contribution follows introduce u-gat end-to-end graph-based method leveraging medical image extracted radiomics clinical data predicting patient outcome work use multimodal data predict covid-19 patient outcome namely icu admission need ventilation mortality method generalizable easily adapted different type anatomy modality clinical task model multitasking approach segmentation classification learned simultaneously u-net used segment healthy pathological region lung chest segmentation extract scalar value following called radiomics e.g. percentage healthy pathological lung tissue volume subsequently perform joint feature fusion image radiomic clinical feature combined feature vector refined graph attention network gat leveraging similar patient perform final outcome prediction present interpretable multimodal patient similarity metric graph construction effective batch selection introduce novel equidistant image sampling method allowing end-to-end training volumetric image feature extraction graph convolutional setting multiple patient per batch graph test time make use available slice thoroughly evaluate novel approach newly acquired dataset collected klinikum rechts der isar munich first covid-19 wave well external publicly available dataset showcase model ability predict patient-specific disease outcome dataset klinikum rechts der isar contains expert annotation diverse range covid-19 pathology available research purpose upon request validate method covid-19 disease-agnostic insight modeling multimodal data without prior experience patient trajectory easily adapted new context novel disease outbreak figure u-gat end-to-end model integrating learned image radiomic feature z_i\ clinical metadata x_c\ -such age sex vital sign blood levels-for disease outcome prediction disease-affected area segmentation seg image x_i\ aid extracting radiomic feature regularizes image feature z_i\ extraction feature coalesce multimodal vector via function test patient cluster training patient graph based radiomic clinical data feature distance graph attention network gat refines feature predict probable outcome utilizing learned linear transformation patient attention coefficient comparison outcome ground truth facilitated binary cross-entropy bce dice loss aid auxiliary segmentation task manual ground truth covid-19 context segment lung image pathology predict patient icu admission ventilation need survival kri dataset severity ictcf dataset shown full size image related work fusing imaging tabular data within field multi-modal learning within recent year different work published one interesting approach interweave feature multiple modality introduced perez visual reasoning task feature-wise linear modulation film layer affinely transformed output convolutional neural network cnn learned scaling shifting factor using text input question dynamic affine feature map transform daft extended film combine feature brain t1-weighted mri scan non-imaging biomarkers alzheimer prediction daft affinely transformed imaging feature extracted fully cnn learned scaling shifting factor using nine non-imaging feature age sex genetic factor multi-headed cross-attention block recently proposed fuse imaging tabular data skin lesion classification using transformer architecture showing marginal improvement joint fusion taleb introduced contig self-supervised pre-training approach trained 500k individual biobank combining retinal fundus image genetic information tested different classification segmentation downstream task contrastive loss based cosine similarity utilized decrease distance embeddings multimodal feature one patient moreover duanmu combined breast mri scan clinical biomarkers predict chemotherapy response network trained non-imaging data learned scalar weight multiplied intermediate result imaging network generate feature map containing interactive information imaging tabular data inspired holistic decision-making approach taken experienced physician medical board involves integrating knowledge diverse field expertise growing interest developing similar machine learning system huang outlined three method integrating feature deep learning model radiology merging extracted image feature non-imaging feature early fusion combining feature joint end-to-end image feature extraction joint fusion consolidating prediction made independent model late fusion method employ joint fusion contrast early late fusion joint fusion process different modality separately integrates intermediate stage allowing inter-modal interaction joint model training backpropagating loss function feature extraction allows model optimize feature extraction based final output prediction error ensuring synergistic learning process following review fusion method context covid-19 early fusion covid-19 detection prediction patient outcome proposed method integrating imaging non-imaging data apply early fusion feature chassagnon demonstrated importance combining wide range non-imaging extracted imaging feature outcome prognosis covid-19 patient ensemble machine-learning model shiri achieved best result covid-19 survival prediction combining lesion-specific radiomics clinical data gong improved result predicting severe covid-19 outcome adding blood value clinical feature extracted radiomics late fusion applying late fusion penalized logistic regression ning reported improvement covid-19 severity mortality outcome prediction compared stand-alone lung cnn non-imaging multilayer perceptron mlp model tariq explored different fusion method predicting need hospitalization covid-19 patient found early fusion different electronic medical record feature work best task joint fusion best knowledge first propose joint fusion method combining imaging non-imaging data predict icu admission ventilation mortality severity depending dataset used graph convolutional network medical application previous study showcased potential graph convolutional network gcns medical application particularly optimizing processing medical image information parisot pioneered using gcns population graph improve alzheimer autism spectrum disorder prediction also demonstrated varying patient information included graph setup significantly affect network performance later work sought diminish performance dependency graph generation anirudh suggesting bootstrapping strategy ensemble learning gcns cosmo introduced self-learning method graph construction integrating imaging non-imaging data optimized gcn learning behavior gcns also employed medical image segmentation graph attention network gat utilized patient diagnosis aforementioned work leveraged already extracted image feature however burwinkel proposed methodology used gcns image data directly showed end-to-end processing imaging clinical data within gcn improve performance due optimized feature learning time proposed approach allowed effective usage inter-class connection within graph expand upon concept within developed methodology explain implication detail section method gcns covid-19 context covid-19 diagnosis gcns mainly adapted disease detection wang built graph based similarity extracted image feature classified node presence infiltrates addition image feature song liang used acquisition site along feature improve covid-19 detection instead modeling patient population saha converted edge detected chest x-ray image graph leveraged detecting covid-19 huang used gcns refine segmentation covid-19 infection finally learned uncertainty-vertex hypergraph distinguish community-acquired pneumonia covid-19 best knowledge propose first graph-based end-to-end patient outcome prediction method leveraging population graph combining chest tabular patient data multitask learning covid-19 recent work radiological assessment covid-19 patient shown high correlation disease burden patient outcome e.g. probability icu admission several deep learning method proposed exploit correlation multitasking approach majority proposed multitask method focus joint detection covid-19 infection binary segmentation related pathology lung image concerning covid-19 patient outcome prediction another set work applied multitask learning joint estimation severity covid-19 various classification segmentation task similar approach nappi used bottleneck feature pretrained u-net predict covid-19 progression mortality however optimize end-to-end incorporate clinical patient data utilize graph-based approach classification method proposed method provides effective way process multimodal patient information image x_i\ combined clinical data x_c\ disease outcome prediction patient shown fig covid-19 patient admitted hospital three outcome predict need icu admission need mechanical ventilation survival patient in-house dataset predict severity ictcf dataset additionally use segmentation covid-19 pathology auxiliary target improve training segmentation output calculate radiomic feature represent relative burden lung pathology class effectively incorporate different modality introduce new framework combine segmentation capability u-net analytic strength gcns network population graph constructed similarity clinical patient data x_c\ radiomic feature refine image feature patient proposed method operates end-to-end perform ideal combination image feature representation learning u-net image segmentation graph data processing graph pre-computed training test time patient dynamically connected graph patient training set ensure data leaking training allow usage flexibility clinical setting graph-based image processing allow inference unseen data sample employ spatial graph convolution compared spectral method approach allows extension unseen sample requiring retraining every new patient explained section fusing imaging tabular data combining image data x_i\ modality essential holistic patient outcome prediction gcns image-based information usually first extracted either manually pretrained cnn extracted image feature second step processed within graph network strategy lessens memory demand imaging data precludes possibility end-to-end optimization burwinkel showed image feature extraction process potentially benefit underlying graph structure end-to-end feature extraction graph neural network since relevant graph information backpropagate learned extraction process leverage concept processing provided image information every image processed u-net perform segmentation individual image slice calculated bottleneck feature map u-net extracted description section segmentation image feature extraction processed receive corresponding representation usable within graph neural network equidistant subsampling utilizing gcns end-to-end feature extraction high-resolution image present major challenge due high memory demand restricts number patient instance per batch however gcns necessitate diversity single batch effective feature aggregation accommodate larger batch suggest equidistant subsampling slice per volume along axial view training main axis length volume divided z/s stack slice omitting z\mod slice side strategy enhances likelihood detecting disease-impacted area also mitigates overfitting distributing scarce volume data multiple patient sample test time complete stack slice used encompassing entire volume graph construction method figure initial patient clustering visualized kri dataset based clinical radiomic feature similarity top row display graph created linking node seven nearest neighbor based euclidean distance optimize graph construction task hand propose feature weighting distance calculation informed task-specific mutual information feature bottom row prioritizes essential feature clustering tailor graph specific task without needing feature selection prior knowledge full size image define binary directed graph vertex connecting edge every vertex v_i corresponds stack image x_i\ sampling process described section graph-based image processing vector radiomics feature r_i extraction process described detail section segmentation image feature extraction clinical data x_c\ building graph concatenate clinical data x_c\ radiomics feature one tabular feature calculate distance two vertex based feature vertex v_i\ connected nearest neighbor alternative feature selection propose weight feature based statistical analysis training data statistically important feature therefore bigger influence distance similarity calculation possible weighting include correlation coefficient e.g pearson correlation continuous feature estimated mutual information input feature target label like icu calculated training set motivation use mutual information discover non-linear association feature predicted label addition linear relationship distance calculated z-scores normalized feature fig k-nearest neighbor knn graph one training set visualized without weighting distance mutual information segmentation image feature extraction proposed method built joint image feature extraction segmentation backbone encoder-decoder-based architecture compressed bottleneck representation segmentation output used described detail section experiment choose original u-net architecture small adaption experiment equidistant slice forming input image see section graph-based image processing processed batch parallel hence slice segmentation healthy lung pathology generated image representation used classification task extracted global average pooling two-dimensional bottleneck feature slice reducing bottleneck size c\times d_1 d_2\ number channel spatial dimension d_1\ d_2\ vector length per slice resulting slice-wise image representation transformed single patient-wise representation achieve slice feature aggregated taking element-wise maximum along stacking dimension resulting single vector size vector passed final fully connected layer followed leaky relu activation obtain latent image representation based improved performance reported goncharov using final feature map u-net instead bottleneck evaluated approach initial result showed substantial drop performance investigate concept extraction radiomic feature inspired burian clinical data complemented radiomics feature automatically extracted segmentation output seg addition robust overfitting extracted image feature improves interpretability network providing intermediate result easily verified visualizing segmentation output instance case covid-19-related task one use quantification covid-19 pathology segmented lung multimodal feature fusion methodology harness multimodal data two-fold manner one hand radiomics extracted segmentation output clinical patient parameter employed form patient population graph hand synergistically fuse latent image feature extracted radiomics clinical data node feature graph integrated representation encapsulates salient attribute patient providing comprehensive patient characterization subsequent processing three input source provided image data x_i\ resulting extracted feature extracted radiomics feature r_i clinical data x_c\ constitute three separate modality used within graph network perform classification task individual patient node v_i\ within graph especially clinical data x_c\ provide valuable orthogonal information imaging-based two contribution incorporated latent bottleneck feature u-net allow end-to-end feature optimization facilitating image feature extraction beyond hand-crafted radiomics assure influence every modality equally considered processing using linear transformation every modality receive feature representation equal size representation processed within aggregation function receive corresponding fused representation used within graph network aligned r_i\right aligned non-linear activation function f_i f_f f_r f_f f_c f_f learnable linear transformation map incoming feature dimension onto dimension f_f\ possible approach concatenation averaging pooling attention mechanism concatenation experimentally chosen proposed method discussed later section experiment classification patient outcome graph processing proposed method based graph attention layer gat combine effective processing provided neighborhood possibility direct inference new unseen data sample maintaining filter localization low computational complexity attention-based graph processing allows incorporate clinical patient data x_c\ effectively learning process basing graph construction similarity tabular feature creating every attention mechanism allows intelligent learned weighting neighbor transformation representation doe rely representation receives weighted contribution process potential stabilize prediction patient uncharacteristic initial representation corresponding class localized within correct data cluster table backbone classifier used evaluation respective feature patient distance metric similarity full size table experiment datasets kri dataset kri dataset in-house dataset consists covid-19 patient expanding dataset patient described ass patient outcome different parameter collected admission icu necessity mechanical ventilation patient survival outcome presented immediately sometime general admission hospital complete dataset available request research purpose frame bfs project az-1429-20c volume total lung healthy lung tissue ground-glass opacification ggo consolidation pleural effusion area annotated expert radiologist 4-8 year experience combined pleural effusion consolidation single class named pathology since distinguishing two class highly challenging task even senior radiologist almost hounsfield unit range moreover pleural effusion present severe case 1.2 available patient see radiomics statistic dataset supplementary material ictcf dataset substantiate versatility method extended evaluation larger publicly available dataset ictcf dataset external dataset comprises 1,521 patient includes high-resolution image clinical data patient outcome main difference kri annotation lack image annotation different pathology lung since work focus triaging patient infected covid-19 exclude control group predict outcome severity pcr-positive covid-19 patient result patient mild type patient severe outcome type leading total patient since ictcf dataset doe contain annotation image employ u-net pretrained diverse dataset lung ct-slices hofmanninger generate lung mask nnu-net isensee pretrained covid-19 lung lesion segmentation challenge infer pathology annotation radiomic covid-19 burden extracted using annotation resembling percentage lung affected covid-19 pathology experimental setup first evaluate proposed method kri dataset using nested 5-fold cross-validation stratified icu label dataset split five equally sized fold containing similar amount icu patient nested cross-validation outer inner evaluation loop testing validation five outer loop one fold selected test set remaining four fold used training validation four inner loop three fold selected training one validation repeated every combination used testing validation resulting total repetition experiment presented following burian static lung image taken admission used combination following clinical feature blood test result age sex body temperature percutaneous oxygen saturation leukocyte lymphocyte c-reactive protein crp creatine d-dimer lactate dehydrogenase ldh creatine kinase troponin interleukin il-6 thrombocyte outcome included need mechanical ventilation admission icu patient survival mortality three task binary classification task focus evaluating main task icu prediction extend experiment ventilation mortality outcome task explore multitasking translation task experiment conducted ten equidistant sample z=10\ chest image producing nine subvolumes per patient training random subvolume chosen patient validation test time whole patient volume sampled since single test patient per batch pre-computed image feature radiomics patient used test phase batch graph consists one test node neighboring node training set serf context new patient experiment set modality aggregation function perform concatenation ictcf dataset following evaluation ning split data 10-fold cross-validation regime every run eight fold used training validation testing respectively given single radiomic covid-19 burden lung available concatenate extracted radiomic clinical data encode tabular data joint embedding vector size patient since dataset contains many feature low mutual information target outcome feature estimated mutual information higher 0.05 used graph construction available clinical feature used patient node feature stopped training improvement validation classification loss five epoch network parameter training conducted experiment pytorch 1.7.0 pytorch geometric 1.7.0 using adam optimizer base learning rate 10^ weight decay 3\times 10^ segmentation image feature extraction backbone choose classical u-net architecture proposed ronneberger following modification double convolution block added batch normalization layer activation faster convergence padding one pixel convolution layer align input output image size network final layer consisted one-dimensional convolution number output class followed softmax layer used dice loss introduced milletari segmentation binary cross-entropy bce loss classification training detail found supplementary material graph processing used two-layer gat graph construction employed knn graph construction method introduced section graph-based image processing using mutual information weighted distance metric following experiment comparing method validation set chose weighted euclidean distance minkowski distance second order p=2\ every feature dimension weighted approximate mutual information respective outcome label mutual information estimated using method proposed ross neighbor averaging result repetition compared weighting knn mutual information weighting pearson correlation understand impact weighting feature also compared weighted method unweighted knn unweighted setup evaluated different subset manually selected feature seen table number neighbor used graph construction set hyperparameter search validation set ablative testing comparison baseline investigate effect different component method show ablative result test set mainly evaluate two component image radiomics feature extraction u-net gat classification end-to-end u-gat feature extraction compared feature extracted simple frozen u-net trained annotation without multi-tasking end-to-end image feature resnet18 proposed important note radiomics used resnet18-gat architecture resnet18 doe produce segmentation evaluate contribution gat compare following classification method alternative weighted k-nearest neighbor knn default scikit-learn weighted k-nearest neighbor classifier using inverse euclidean distance feature similarity metric neighbor selection weighting neighbor label multilayer perceptron mlp classifier simple neural network hidden layer size followed leaky relu activation dropout graphsage replacing gat operator graphsage addition ablative testing compare unimodal vs. multimodal approach evaluating performance using mlp classifier using clinical data image feature extracted resnet18 overview type data used method given table u-gat ensemble comparison random forest random forest ensemble method effective classifier small datasets since prone overfitting due law large number provide additional benefit interpretability discussed section fusing imaging tabular data burian chao successfully deployed random forest use tabular radiomics clinical data icu prediction experiment focus task icu prediction explore ensemble proposed model improve performance due increased robustness overfitting compare well-established random forest classifier form ensemble average predicted probability model trained inner loop nested cross-validation evaluate test set outer loop nested cross-validation metric segmentation classification proposed method follows multitask approach including segmentation task icu ventilation mortality prediction individually evaluation criterion divided segmentation classification metric measure overlap segmented region ground truth use dice score main metric evaluating binary classification performance average precision area receiver operating characteristic curve auc independent selected classification threshold given task severe class imbalance score chosen main threshold-dependent metric ensemble experiment balanced accuracy score bacc sensitivity specificity additionally reported threshold-dependent metric optimal threshold set using validation result maximizing youden statistic sensitivity specificity classification metric binary calculated using scikit-learn 0.24.1 table top feature sorted mutual information task pearson correlation kri dataset full size table table evaluation edge feature weighting used distance calculation validation set kri dataset full size table result discussion population graph construction first phase experiment kri dataset optimized population graph construction method involved evaluating various feature selection distance weight improve knn-based graph construction found connecting node seven nearest neighbor provided optimal result based hyperparameter search using simple unweighted knn classifier two measure mutual information pearson correlation used weight feature distance calculation similarity metric used knn neighbor selection table show top average measure icu task pearson correlation 0.3\ mutual information 0.1\ observed icu ventilation task feature mortality showed significantly lower value indicating difficulty task hand see supplementary material percentage healthy lung highest mutual information task result shown table confirmed proposed weighting mutual information method yielded best outcome particularly icu task indicated 0.722 0.096\ auc 0.757 0.142\ comparison manual feature selection e.g. using clinical data showed using available feature effective mutual information estimation help identify relevant feature give higher weight similarity metric external dataset confirmed feature importance radiomic data covid-19 burden highest mutual information severity label see supplementary material key benefit using weighted distance knn graph construction graph adapt task without prior knowledge fig show graph task kri dataset without weighting distance measure mutual information besides improving classification effective similarity measure used identify relevant patient treated past support decision-making process physician enabling analyze disease progression similar patient u-gat evaluation table ablative testing comparison mlp using clinical data resnet18 using image data input task full size table table comparative analysis icu outcome prediction kri dataset u-gat cross-validation ensemble random forest model using clinical data another random forest model incorporating available tabular data including radiomics extracted pretrained u-net full size table next set experiment shown table evaluate different component proposed method compare result baseline method multimodal method outperforms unimodal mlp limited clinical data input picture present limiting model solely use imaging data case resnet18 method proposed method outperform resnet18 task experiment showcase benefit multimodal approach u-gat achieves higher method ablation replacing u-net resnet18 replacing gat mlp graphsage show leveraging similar patient training set useful refining feature test patient see similar result external dataset u-gat higher 0.593 0.106\ single modality model mlp resnet18 0.556 0.099\ 0.525 0.140\ respectively highlighting advantage multimodal learning result joint end-to-end training segmentation classification task seem improve slightly task datasets average dice score lower multitask setup segmentation single-task setup see supplementary material make segmentation task suitable auxiliary task improve classification result kri dataset icu ventilation prediction reached highest 0.699\pm 0.149\ 0.644\pm 0.142\ respectively multitasking segmentation mortality task generally achieves worse result one main explanation effect immense data imbalance present mortality task positive sample additionally observe low mutual information radiomics clinical feature mortality outcome supplementary material table indicates feature hand might sufficiently predictive specific task several relevant clinical aspect closely connected multiorgan failure heart kidney liver parameter available datasets evaluation external dataset show picture joint end-to-end training severity classification pathology segmentation u-gat increase 0.558 0.102\ 0.593 0.106\ compared u-gat segmentation frozen u-net trained annotation multitasking evaluation conducted additional experiment synergistic effect multitasking segmentation classification concurrent prediction different patient outcome since task interdependent result detailed supplementary material showed classification benefit joint segmentation supplementary table mortality prediction task improved simultaneous prediction outcome supplementary material table u-gat ensemble comparison random forest discussed section ablative testing comparison baseline also compare method random forest used previous work perform classification fused tabular radiomics clinical data comparison shown table illustrates enhancement u-gat average precision 0.699\pm 0.149\ 0.745 0.137\ elevating marginally outperform random forest stand 0.729 0.089\ result indicate ensembling method increase robustness method overfitting showing comparable result random forest figure kri dataset—left batch graph showing attention score single test patient line thickness corresponds respective neighbor attention score two hop right image segmentation ground truth predicted segmentation single axial coronal slice test patient neighbor maximum attention bottom important feature test patient neighbor maximum attention bracket radiomics predicted pretrained u-net shown full size image interpretability inter-patient graph attention addition performance boost graphsage using gat offer another important advantage attention mechanism model learns identify neighbor graph relevant prediction task providing insight decision process model analysis attention score could suggest patient model deems relevant individual outcome prediction connection within patient population graph help uncover new information disease still poorly understood provide valuable insight physician combined segmentation result attention mechanism allows clinician thoroughly evaluate model output decision-making process giving potentially higher confidence prediction two gat layer model assigns attention score neighbor node graph score define much node representation layer based representation different one-hop neighbor attention score thought weighted directed adjacency matrix a\in 0,1 n\times number node batch row add multiply attention matrix layer receive matrix show representation node based two-hop neighborhood i.e. node two edge away attention score visualized fig result test patient shown fig highlight attention mechanism succeeds assigning high importance neighbor class lower importance opposite class thus implicitly refining neighborhood constructed knn algorithm furthermore see attention mechanism doe necessarily assign high attention neighbor particularly similar radiomic clinical feature contrast simple knn classifier base prediction feature similarity method evidently identify relevant neighbor beyond simple correlation connected complex pattern thus introduces orthogonal information embedded knn graph challenge future outlook future iteration current model segmentation infrequent lung pathology pleural effusion could improved along prediction imbalanced outcome notably mortality approach enhance model involved constructing population graph based mutual information feature effectively improved graph structure importantly feature identified method consistent established radiological finding noted however mutual information display pronounced standard deviation notably lower mortality prediction task indicating inherent complexity specific prediction task potential sparsity highly informative feature given available parameter dataset subsequent study area addressed incorporating annotated data expanding patient cohort particularly clinical data conclusion work developed evaluated method effectively leverage multimodal information outcome prediction covid-19 patient said information form lung scan clinical data radiomics incorporated graph structure processed within gat stabilize support prediction based data similarity u-gat propose end-to-end methodology segment patient pathology medical image combination imaging non-imaging data predict clinical outcome explicitly incorporate automatically extracted lung radiomics architecture demonstrate increased performance show auxiliary segmentation covid-19 pathology indeed improves outcome prediction create patient population graph propose novel graph construction based feature weighting utilizing mutual information effectively clustering relevant patient attention analysis imparts additional layer transparency potentially increasing clinician confidence predictive approach added clarity assist identifying comparable patient previous case thus informing guiding treatment trajectory current patient consideration study underscore potential graph-based data-driven strategy improving patient care decision-making challenging clinical setting using multiple modality