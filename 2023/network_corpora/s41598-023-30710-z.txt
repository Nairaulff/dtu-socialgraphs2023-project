introduction understanding correlation crucial theoretical progress throughout science example psychology formal analysis social network often quantifies different kind interaction agent term correlation function e.g. journal zoology might interest study correlation behavior organism comprising ecosystem varies environmental characteristic rainfall epidemiology correlation often basis attempt understand causal driver change spread particular disease e.g. journal engineering correlation variable characterizing complex system temperature different component might shed light property system help troubleshooting economic theory positive correlation performance outcome might signal competition journal complex financial system studied term interaction mechanism ultimately based correlation hardly seems necessary motivate importance studying correlation structure across science yet hugely influential approach correlation physic far negligible impact rest science john bell developed arguably sophisticated framework correlation physic showing certain assumption structure causal relationship two pair variable produce distinctive signature observed correlation particular certain natural assumption cause physical phenomenon lead so-called bell inequality point bell analysis argue using causal analysis exclude classical influence observed correlation particular correlation pattern could explained something classical physical nature corresponding system essential argument bell test used evidence non-classical nature quantum structure physical world bell work inspired exciting experiment conducted aspect clauser zeilinger whose importance recognized recent nobel prize physic point offer disclaimer reader work intended general interest concerning situation need understand structure correlation however bulk work concerning bell framework conducted physic therefore much ensuing discussion inevitably borrows corresponding work physic extends work accordingly physic derivation inequality bell experiment rest assumption realism locality free choice observed violation show model insisting three assumption run contradiction physical reality bell experiment performed subjecting two space-time separated component entangled particle system certain measurement e.g spin measurement note different notion non-locality exist example based information retrieval local state discrimination whereas perspective taken based causal mechanism experimenter side choose regime freely one two possible spin direction result two measurement recorded respectively time series quadruplet result statistic four expectation value =\sum ab\ computed simplicity use compact notation ab\ ab|xy mean ab\ b|x combination four expectation value yield four -values aligned +\langle +\langle -\langle aligned aligned +\langle -\langle +\langle aligned aligned -\langle +\langle +\langle aligned aligned -\langle +\langle +\langle +\langle aligned note follow clauser-horne-shimony-holt chsh approach variant original bell inequality slightly simpler case better suited present purpose either way provides tool make testable distinction different causal model given dataset specifically bell seminal idea lead conclusion realist local hidden variable model experimenter freely chose satisfy following four inequality aligned i=1 aligned theoretical maximum value -values intuitive class classical model lead maximum value whereas quantum mechanic predicts violation maximum allows -values famous tsirelson bound 2\sqrt let call quantity equation -values depending experimental context causal model violation bell inequality sharply contrasting meaning realist model quantum physic may interpreted violation free choice violation bell locality even indication retrocausality general always challenge extending tool developed physic study system outside physic two difficulty extending bell framework study correlation outside physic first assumption locality free choice bell framework particular physic beyond question whether microscopic physical system quantum structure locality free choice extremely limited interest however difficulty doe pose serious problem putative extension since straightforward imagine analogous assumption could guide suitable causal analysis different situation amongst others pearl pioneered formal methodology aiming development theory causal counterfactual inference second perhaps seriously bell framework involves two system two pair binary variable characterizing system fact pair binary variable pair limit applicability outside physic least insofar study correlation concerned general interested association pair variable also practical consider pair outside study quantum mechanic relatively case whereby system naturally characterized pair variable let alone binary one indeed existing application bell inequality outside physic often involve somewhat artificial set-ups arrange variable bell test possible e.g. behavioral science general statistical measure inevitably simplifies situation probably complex correlation great example insofar association two variable reduced single linear index regardless information causal process linking two variable seeking apply bell idea outside physic aim develop association index sensitivity causal structure relevant two variable way domain general possible key assumption possible separate relatedness two variable two distinct part part due significant cause part due incidental noise two part distinguished term magnitude variable change different part variable range see shortly assumption developed quantitative precise framework remainder paper discus concrete application idea based association price change different security index three main reason chosen finance area first application framework first immediately available large data set index information construct variable corresponding price change different security within temporal window readily available offer 125,000 pair security test new proposal association standard correlation second finance correlation play important role correlation price change different security key creating optimal portfolio using markowitz mean-variance model correlation single security broad market index enter capital asset pricing model via market beta valuation company via discounted cash flow model understanding generative process leading correlation stock market clearly hugely involved task key objective whether use -values instead correlation affords advantage finally several proposal aimed capturing association structure detail important note even though model discus origin finance research general statistical model applied area need detailed understanding variable follows first describe -test physic translated something interesting area noted mathematical method follow bell literature physic however intend conclusion analytical tool applicable area need understand association structure detail finance chosen area application presently physic discipline physic experiment precise assumption structure system study enable detailed prediction concerning ensuing correlation outside physic detailed assumption prediction possible general term indeed precise causal origin observed correlation likely vary across different area application nonetheless generic approach developed partitioning relevant variable example finance price change different regime example weak strong part propose different regime understood term differing causal mechanism allows broad distinction correlation due significant cause two company incidental process may appear ambitious seek separate correlation due significant cause versus incidental process however current practice relying price correlation historic time series data doe take account possible causal mechanism responsible observed behaviour indeed mechanism may change time market subject structural change different regime may work time period used compile database aim show substantial progress made approach utilizing technical tool physic field causal inference specifically finance propose definition -values partitioning observed financial time series different regime end consider two security example apple inc. example broadcom inc. list different financial regime explained shortly respect security given day one one financial regime prevails measurement outcome generated simultaneous price change security particular outcome a=1\ security increased price given time period b=1\ security increased price time period similarly decrease price denoted a=-1\ b=-1\ respectively financial application available history consists public information information possibly private initially became public subsequently possible way determine financial regime value defined would using exogenous time series price security allows partitioning available data way analogous measurement setting standard bell setup restricting financial price data interesting choice regime distinction weak strong price change whereby assumed weak change due incidental process whereas strong change due ostensibly shared significant causal factor though essential subsequent analysis many way motivate causal factor starting known market mechanism example known classical correlation tend higher market crash investor may panic circumstance common cause driving correlation many security would de-risking requirement decreased collateral value obtain simple symmetrical description separate large price change small change defining x=1\ day time series price security gone fixed percentage r_a\ x=0\ price security changed larger amount day x=0\ called strong day security similarly 0,1\ defined function price change security time period using r_b\ threshold separate weak strong day think reasonable intuition strong price change due significant event market possibly unique pair stock considered weak change due residual incidental market process note analogous approach envisaged domain application think case variable fairly generically identify large vs. small change adopt definition analogous one exogenous variable could recruited separate measurement regime variable interest definition four -values computed importantly possible derive variant inequality particular causal model shown empirical data show violation inequality causal model excluded line leitmotiv field causal inference note physic literature discussion bell inequality usually accompanied careful consideration whether observed violation inequality due genuine contextuality versus signalling direct influence e.g however present purpose distinction irrelevant aim general statistical technique capable indicating violation certain causal mechanism described quantity s_i\ defined linear combination four conditional expectation interpreted correlation outcome different regime four -values s_1\ -value interesting s_1\ interpreted correlation strong change least one part system occurs seen directly correlation least one strong change i.e. regime 01\ added contribution weak change part system i.e 11\ subtracted s_1\ -values interpreted type correlation specific sense contribution involving strong change least one part separated contribution involving weak part consider two way utilize -values towards understanding correlation variable interest security price case assumption correlation structure tested comparing empirically measured -values theoretical -values derived basis specific model assumption first -value always empirically computed independently parametric distribution model examine general causal model characterizing interdependence two security provided make meaningful distinction strong weak change derive specific bound possible -values used eliminate certain class model application finance see bound may broken dependency two stock bound implied certain generative model like factor model bivariate gaussian model case model given specific parametric form apply framework acquire additional insight model develop simplified test applicability regarding factor model show -values computed conditionally precisely known value contributing factor may exceed result hold arbitrary functional relationship stock price return contributing factor one important surprising message case linear factor model invalidated finding conditional -values assuming complicated functional relationship stock price change based contributing factor also invalidated regarding bivariate gaussian distribution model show -values computed explicitly value exceed classical limit estimating -values function classical correlation empirically observed -value employed test adequacy gaussian model overall approach brings together generative model association assumption causal structure allowing test seamless framework bell test generic causal model bell analysis underwritten causal network encoding assumption putative source influence two component system physic two binary question system composed two part straightforward provide corresponding causal network consistent key assumption locality free choice finance case care needed since causal network additionally reflect way assumption measurement regime interact measurement outcome figure two competing causal model left-hand side two possible causal model stock price co-movements shown model inspired bell experiment quantum mechanic model extension model one additional causal arrow model may proposed describe stock price behavior regime weak versus strong price change right hand side show heatmap s_1\ -values daily closing price change p-500 stock time period 4.5.2016 3.5.2019 grouped sector according global industry classification standard gics ordered descending strength classical correlation within sector identical threshold r_a r_b used pair stock deep red indicates s_1\ -values two value falsify model full size image measurement regime categorized strong versus weak price change natural choice simple causal model would postulate one unknown cause u_1\ driving magnitude price change i.e different unknown cause u_2\ driving direction i.e u_1\ could interpreted market volatility factor reflecting general uncertainty u_2\ could regarded measure optimistic versus pessimistic market response new information however unique way even two simple idea translated causal model fig show two variant hypothetical causal mechanism herein u_1\ responsible determining whether trading day strong large price change either direction cause u_1\ thus responsible separating strong trading day weak trading day latter reflecting incidental correlation thus influence directly second cause u_2\ responsible determining price direction i.e whether stock therefore direct influence could decide model versus model one may suspect u_1\ also effect price direction case fig arrow u_1\ u_2\ needed hence model appropriate however one may also argue model simpler thus preferred interestingly possible test via -values whether simpler model provides feasible option simple model mathematically implies bell bound stated following proposition see supplementary information proof proposition causal model fig inequality hold i=1 ,4\ however empirical value s_1\ substantially model readily falsified shown heatmap right-hand side fig heatmap s_1\ -values also illustrates usefulness s_1\ -value show sectorial structure stock market diagonal black dividing line added show industry sector using company fundamental main operating business model application data s_1\ -value immediately falsified model term examining different causal model generally quantity provides testable opportunity falsify specific causal model violation bound occur one four quantity proposition given statistic ab\ one four inequality violated see supplementary information proof regarding causal model fig violation therefore implies i=2,3,4\ complex causal mechanism model ruled data example causal connection u_1\ u_2\ may assumed leading model fig could motivated financial area considering example nervous volatile market may tend interpret ambiguous news stock pessimistic way leading decline stock price formally lead link cause magnitude change i.e u_1\ cause direction change i.e u_2\ determines hence whether price change positive negative despite fact model one causal arrow model model fully general sense without restriction possible statistic four value generated following proposition show proposition let arbitrary joint probability distribution quadruplet let denote joint probability distribution generated model quadruplet model specified manner yield achieved defining u_1\ appropriately setting u_2 u_1\ one general cause suffices generate arbitrary distribution proof proposition given supplementary information show model achieves generality essentially causal connection one unkown cause observed value allowing arbitrary probability distribution unkown cause model general form provides generic class model generality applied directly next section therefore explore three pertinent special case restrict model bell test specific parametric causal model far identified causal model lends applicable description empirical data and/or application specific generative model want achieve exploring specific parametric special case generic model first start situation unknown cause simple parametric expression dichotomous uniformly distributed value second another special case model consider factor model i.e description stock price return linear combination different observable factor third examine bivariate gaussian distribution model generative model stock price change driven fundamental drift random overlay volatility modelled brownian motion generating model dichotomous cause outlined first consider implication allowing simple parametric distribution cause model shown first part following proposition distribution quadruplet generated special case model use one dichotomous unknown cause one uniformly distributed common error term driving behavior particular causal graph equivalent model specified causal arrow concerning weak vs. strong day parameter expressing example volatility separated causal arrow upward vs. downward price change parameter expressing example market direction simple addition uniformly distributed common error term model also easy generate full algebraically possible range s_1\ -values without restricted bound like tsirelson bound quantum mechanic fact two separate dichotomous cause specified one parameter sufficient achieve shown second part proposition give explicit corresponding parametrization proof proposition supplementary information amenable generalisation outline way model made practically useful parametric model observed statistic proposition assuming bivalued unknown cause model fig following hold true arbitrary joint probability distribution quadruplet identical bivalued cause u_1\ u_2\ defined joint probability distribution generated model equal independent uniformly distributed error term common explicit parametrization two separate cause u_1\ u_2\ one free parameter given s_1\ -value computed model attain every number interval prove second part proposition proceed directly parameterizing strength causal link model specifically different parameter concern strength link representing significant cause versus residual process approach allows compute s_1\ product s_1 1-2\gamma 1-2\epsilon see proof proposition appendix supplementary information definition parameter intuitively parameter thought quantifing strength link common cause u_1\ u_2\ model fig parameter corresponds pattern outcome i.e link u_2\ causal model model proof proposition seen illustrative example compromise small number parameter sufficient flexibility simple model possible s_1\ -values span entire algebraic range quantity s_2 s_3 s_4\ vanish extended situation non-zero s_2\ s_3\ s_4\ -values introducing additional free parameter despite simplicity specified model allows generate theoretically possible s_1\ -values parameter unrestricted note particular empirical domain application might allow specialize model reduced range thereby restricting possible range s_1\ well contrast prediction quantum mechanic approach generates general tsirelson bound s_1\ factor model factor model aim explain return single stock one observable common factor common factor may simply return broad market index like complex factor return diversified portfolio small stock minus return diversified portfolio large stock see formally linear factor model assumes return two stock r^a r^b\ given relationship aligned r^a= j=1 ^a_j f_j e^a aligned aligned r^b= j=1 ^b_j f_j e^b aligned f_1 f_m\ common factor observable trading day whereas ^b\ ^a_1 ^a_m ^b_1 ^b_m\ constant difference residual observed stock return r^a r^b\ linear prediction denoted e^a e^b\ assumed independent assumed linear relationship unrealistic factor model generalized aligned r^a= f_a f_1 f_m e^a aligned aligned r^b= f_b f_1 f_m e^b aligned using two arbitrary function f_a\ f_b\ model generate distribution quadruplet factor model seen special case model purpose analyzing -values however factor model provide specific causal story factor model connect well special way former pair derived r^a\ latter pair solely generated r^b\ illustrated causal diagram fig interestingly factor model allow bell bound conditional common factor following proposition show proposition given arbitrary function f_a f_b\ random variable f_1 f_m\ factor random variable e^a e^b\ residual define two stock return process r^a r^b\ variable computed let denote four -values computed conditionally value factor i|f residual stochastically independent obtain aligned i=1 aligned see supplementary information proof importantly derivation bell bound conditional -values hold even case non-linear factor model independent number factor used bell bound proposition hold conditionally factor value f_1 f_m interesting conundrum arises already seen many pair stock value s_1\ computed data exceeds value possible computing s_1\ -values conditionalised factor conditional s_1\ -values may exceed one possible answer specific factor model incorrect case however another subtler possibility fact analysis reveals instance simpson paradox show illustrative example appendix possible 1|f conditional different factor value computing s_1\ data s_1 aligned s_i aligned may hold figure factor model panel illustrates factor model described factor generate stock price return r^a\ r^b\ derived residual shown diagram appear noise term equation panel iii illustrate empirical test factor model panel based daily price change general p-500 market index explaining factor market price change time period 4.5.2016 3.5.2019 three panel show conditional probability four regime 11\ different pair stock threshold used distinguish day weak price change day strong price change compare value i.e probability day negative return p-500 i.e probability day positive return p-500 horizontal line panel show equal probability panel show stock pair eversource energy aee ameren corp conditional s_1\ -values 2.25\ 2.15\ panel show analysis pair stock eqr equity residential essex property trust righthand panel iii show analysis pair stock snps.o synopsys inc. cdns.o cadence design system inc. full size image proposition powerful result concerning implication applying factor model particular pair stock price link factor model framework via conditionalisation -values specific value assume want construct specific factor model two stock single observable factor general market index like exists instance variable 1|f hold conclude considered factor model invalid current practice concerning factor model typically involves linear regression assumption linear relationship price index single stock proposition restricted way proposition encompasses functional relationship price index additional variable 1|f indicates something missing function linking single stock price return particular factor residual corresponding would independent hold also true one factor used important implication one doe right factor setting linear model moving non-linear model complicated functional relationship would generally help value continuous distribution conditioning specific single point value practical apply proposition real data first step select appropriate interval factor measurement setting stable across interval i.e xy|f y|f stable probability distribution measurement setting i.e constant set factor value proposition hold shown appendix supplementary information practice would trade-off choosing small interval yielding constant probability versus interval contain reasonably large number data point present example used three different pair stock divided range value change single factor two interval distinguishing day positive return day negative return i.e look xy|f versus xy|f seen almost horizontal line fig assumption measurement setting independence approximately valid different pair stock observe conditional s_1\ -values positive negative interval indicates failure specific factor model observed price change two stock assuming coarse graining index distinguishing positive negative return therefore possible complete explanation observed bell statistic two stock consideration specific factor model based two-interval coarsening factor model two stock based whether different trading day fails figure gaussian model lefthand side show s_1^\text gauss -values computed via monte carlo simulation function gaussian correlation threshold taken alpha multiplied respective volatility i.e r_a _a\ r_b _b\ chosen range righthand side show heatmap positive excess s_1^\text emp s_1^\text gauss daily closing price change p-500 stock using time period gics sector classification ordering fig pair stock computed setting threshold separate strong weak day stock daily volatility observed entire time period equation used compute s_1^\text emp time series historic stock price s_1^\text gauss -value used based monte carlo simulation illustrated fig positive value set historic correlation daily return two stock consideration full size image general condition measurement setting independence fulfilled i.e constant conditional probability occur across different range factor value see proposition appendix supplementary information degree exceeds seen measure non-applicability factor model example fig use rough coarse graining factor partitioning range index value two interval finer partitioning course possible could yield stronger conclusion however fulfilling condition constant conditional probability becomes harder fine partition many sub-interval used important direction future work extending proposition situation probability vary across chosen interval also note analysis easily extended considering variable factor model e.g multi factor model like 5-factor model fama french gaussian model present approach utilized examine validity different generative model association security apart factor model particularly influential one bivariate gaussian model frequently used continuous time financial theory pricing hedging derivative security optimal consumption time see gaussian model expressed two stock aligned ds^a s^a dw^a aligned aligned ds^b s^b dw^b aligned two correlated brownian motion w^a w^b\ two positive number _b\ price volatility _b\ price drift simplification assuming zero risk free interest rate zero price drift three model parameter remain _b\ correlation two brownian motion density function joint distribution logarithmic return two stock short time interval aligned r^a s^a s^a t-1 r^b s^b s^b t-1 aligned given aligned p_\rho 1-\rho v^2 _a^2 +\frac w^2 _b^2 2\frac 2\pi 1-\rho aligned density function four expectation value make -value computed example aligned sign r^a sign r^b r^a r_a r^b r_b aligned threshold r_a\ r_b\ taken constant multiple volatility _a\ _b\ fomulae -values possible contain gaussian correlation free parameter see supplementary information proposition price two security follows bivariate gaussian model threshold separate weak strong day given r_a _a\ r_b _b\ positive constant -values computed via analytic expression hold example aligned ^\infty ^\infty -v^2 w^2 2\rho ^\infty ^\infty -v^2 w^2 2\rho n=0 ^\infty 2n+1 n+1 _x^2 n+1 _y^2 n=0 ^\infty n+1/2 _x^2 n+1/2 _y^2 aligned _x^\infty s-1 dt\ denotes incomplete gamma function aligned 1-\rho 1-\rho 2^k aligned expectation value analogous analytic expression leading analytic formula s_i^\text gauss i=1,2,3,4\ gaussian model shown supplementary information figure illustrates s_1^\text gauss function gaussian correlation multiple volatility chosen threshold two security gaussian model doe allow strong level association two security readily yield value s_1^\text gauss however doe exhaust full range possible s_1\ -values fact s_1\ -values possible gaussian model lie substantially may therefore explain high empirical s_1\ -values empirically determined value s_1^ emp curve shown fig may conclude data would offer refutation model figure illustrates excess empirical s_1\ -values s_1^\text gauss p-500 stock red color amount information figure much make readily applicable doe illustrate using s_1\ -value offer simple test applicability gaussian model two stock conclusion discussion key objective scientific domain understand causal structure give rise observed correlation example finance factor drive risk return component financial portfolio finding asset allocation risk diversification strategy lead smooth balanced outcome different financial regime key financial stability economic prosperity studying association mechanism joint price change financial instrument therefore high importance approach explore established framework physic linking assumption causal structure correlation long history cross-fertilization physic discipline regarding chosen example finance notable application concern heat equation pricing hedging financial derivative quantum method also applied problem social science cognitive modelling game finance regarding correlation bell approach influential framework understanding way particular causal model linked observed correlation nature framework general method understanding structure correlation two component system afforded underlying causal model however formulation doe depend law quantum mechanic principle open application domain concerning economics finance see example main difference application bell framework physic application area former case employed test macrorealistic model whereas application macroscopic domain finance realism given violation bell bound interpreted term putative underlying causal network yield fairly generic approach recognizing correlation two variable occur shared cause random fluctuation former typically interest finance variable interest would price two security approach essentially assumes separation correlation resulting significant shared cause correlation assumed due residual market process separation realized using bell framework partitioning price data different regime allows different conclusion regarding causal model association regime open route explore possibly refute competing causal model available data offered basic example defined magnitude price change one two causal model fig readily excluded observation basis proposition remaining causal model fig general given parameterization allow simple description observed s_1\ -values shown proposition method specific finance easily generalized domain many alternative way restrict model including utilizing domain-specific theory finance two influential model factor model gaussian model though note applicability model quite general particular way model association variable factor model shown proposition conditional -values subject bell bound provided residual stochastically independent provides interesting testing possibility empirical data set measurement setting remain stable across chosen interval factor value mathematical result doe require linear relationship factor stock price return hold number factor proposition underline importance choosing right factor independent residual setting factor model proposition thus offer potential general test proposal factor model based particular combination factor regarding widely used gaussian model proposition show present framework employed limit s_1\ -value used probe gaussian distribution assumption gaussian model known underestimate probability extreme event s_1\ -value computed independently gaussian assumption empirical s_1\ -values outside range attainable gaussian model found inappropriateness gaussian assumption follows present approach offer alternative simple way test gaussian model complement existing method specifically finance generalised variant gaussian model approach present paper aim outline possible application bell method general framework linking causal assumption observed correlation even desirable restrict analysis single variable primary interest stock price rich range possibility one could employ depending focus interest paper one regime considered list possible regime readily extended following example finance study example causal mechanism market crash asymmetric definition set value zero case large price decline could used present advance computational power theoretical method machine learning application data mining algorithm finance often attempted however amount data may seem large available time period sometimes short relevant environment may static example finance ongoing change regulation investor behavior well fiscal monetary policy available time series data generally result different causal regime find appropriate quantitative model learning may also important incorporate human knowledge regarding economic political market mechanism machine learning approach another consideration present method generalised regime defined via additional variable take account particular hypothesis specifying different measurement regime finance variable might correspond known economic political regulatory market mechanism important point specifying underlying generative causal model would many case different model imply different restriction ensuing correlation tested using present approach particular bell test may reveal certain formalisation human knowledge odds observed statistical fact language bayesian network causal model approach may thus help build better model based statistical data assumption putative causal mechanism ultimately informative measure association may derived simple choice concerning underlying causal mechanism variable interest overall shown bell framework physic adapted offer measure association variable domain focused distinction strong weak change explored various causal model formalising intuition change due shared substantial cause vs. incidental process illustrated various way initial causal model proposal could refined additionally considered two well-known generative model application domain based factor driving market return bivariate gaussian distribution describe co-movements security price case showed framework provide simple test validity chosen model different case thus s_1\ -value extends concept correlation instrumentally term underlying supporting theory