introduction diffusion magnetic resonance imaging dmri powerful technique enables measurement molecular diffusion biological tissue providing valuable insight tissue microstructure context brain imaging dmri allows characterization nerve fiber microstructural property brain tissue measurement proven useful various neurological disease including brain tumor significant alteration tissue microstructure occur despite advancement dmri technology current detection delineation brain tumor still heavily relies conventional mri technique flair acquisition technique limitation ability capture intricate microstructural change associated brain tumor therefore need explore potential dmri detecting microstructural anomaly accurately delineating brain tumor recent year significant progress field supervised brain tumor segmentation using deep learning technique brain tumor segmentation brat challenge international competition automatic segmentation brain tumor mri scan played pivotal role driving advancement area state-of-the-art algorithm based fully convolutional neural network u-net architecture achieved remarkable result rivaling performance human annotator basis currently best performing supervised segmentation method laid fully convolutional neural network u-net proposed algorithm brat challenge deep learning-based example current state-of-the-art i.e. winning algorithm optimized u-net open-source network architecture design similiar nnu-net developed isensee previous year challenge compared original u-net modification focus post-processing region-based training data augmentation detection segmentation brain tumor directly dmri data heretofore mostly relied diffusion-derived scalar map combination dmri measurement mri acquisition particular shown incorporating diffusion tensor image dti data brain tumor segmentation improves segmentation accuracy also possible delineate tumor volume interest using dti data use resulting volume tumor classification deep learning tumor segmentation apparent diffusion coefficient adc map improved distortion-correction used adc map also used combination mri image deep learning approach characterize brain tumor contrast supervised brain tumor segmentation anomaly detection method model healthy distribution brain shape tissue property identify out-of-distribution sample mri scan currently unrivaled detailing soft tissue mri mostly modality choice brain tumor anomaly detection anomaly detection method human brain often based autoencoders generative adversarial network gans however off-the-shelf anomaly detection method optimally suited medical data special attention paid two aspect first medical measurement anomalous often dependent instantaneous value often dependent external factor environment history example increased heartbeat may indicate disease may completely normal exercise similar effect observed medical image data certain value range may normal abnormal depending age medical history patient secondly sensitivity i.e true positive rate often greater importance medicine industrial application thus medical anomaly detection method unique property found application setting variety brain anomaly detection method proposed recent year baur compared variety autoencoder architecture model structural brain mri scan healthy subject using trained model residual map generated multiple sclerosis lesion delineated concluded anovaegan architecture best suited task zimmerer augmented similar variational autoencoding architecture context-encoding branch used residual map segment brain tumor also performed systematic hyperparameter study find optimum training application setting effect showed reconstruction error improved including kullback-leibler-loss two latest approach field anomaly detection brain mri data deal highly advanced vaes marimont combined density restoration-based approach using vector-quantized variational auto-encoders vq-vae able achieve better result compared conventional vae mood dataset consists brain abdominal image furthermore combining vae transformer pinaya improved pixel-wise detection brain mri datasets small vessel disease algorithm rely groundtruth annotation outperform unsupervised method current benchmark nevertheless unsupervised method able delineate tumor without trained prior annotation better suited deal changing acquisition parameter offer protection unusual effect seen training database dmri acquisition offer unmatched insight brain tissue microstructure hypothesize acquisition method used detect tumor-induced brain change earlier compared conventional method therefore study leverage deep learning-based anomaly detection method detect analyze brain tumor dmri data compare performance different deep learning model groundtruth segmentation obtained structural mri scan trained neurooncologists also inspect result focusing area groundtruth segmentation anomaly detection method deviate furthermore investigate correlation anomaly score follow-up data patient explore potential anomaly score biomarkers early glioma infiltration harnessing unique capability dmri deep learning-based anomaly detection study aim advance field brain tumor detection contribute improved diagnosis treatment planning brain tumor patient promote transparency enable research made code implementation anomaly detection model publicly available github http material method data two datasets used work brain tumor dmri dataset first dataset consists dmri scan cerebral glioma acquired university hospital aachen uka patient control group age- sex-matched healthy subject enrolled study subject gave written informed consent participate study study approved local ethic committee medical faculty university rwth aachen ek294-15 conducted accordance standard good clinical practice declaration helsinki dataset consists flair dmri acquisition dmri data single-shell acquisition b-value one b-value anterior-posterior phase encoded gradient direction isotropic voxel size 2.4 54\ voxels dmri acquisition corrected susceptibility-induced correction fsl topup toolbox described eddy current motion artifact fsl eddy reverse-phase encoded image wrongly acquired corrupted five case case fsl eddy applied brain extracted using fsl bet flair image used obtain groundtruth tumor segmentation see section groundtruth segmentation detail finally anatomical weighted image registered pre-processed dmri image using symmetric diffeomorphic image registration implemented ant tissue segmentation parcellation including segmentation ventricle excluded analysis transformed diffusion space proposed anomaly detection algorithm trained healthy control group anomaly detection performed patient image follow-up data patient available consisting flair-weighted mri acquisition median time interval preoperative scan follow-up scan 17.1 month brat dataset image brain tumor patients-data including post-contrast flair acquisition well tumor segmentations-were extracted brat initiative tumor segmentation comprises class necrosis enhancing tumor edema determined previous top-ranked brat algorithm manually refined neuroradiology expert mri scan acquired different protocol various scanner multiple institution image resampled uniform isotropic resolution preprocessed well skull-stripped cancer imaging phenomics toolkit captk groundtruth segmentation obtain groundtruth tumor segmentation brain tumor dmri dataset customized supervised deep learning network trained brat dataset supervised segmentation framework based optimized u-net brain tumor segmentation repurpose network work minor change made specifically number input image reduced network trained flair image preprocessing brat data freed redundant background voxels normalized one-hot encoding mask foreground voxels created distinguish value close zero background mask stacked input data flair image brain tumor dmri dataset identically preprocessed spatially adjusted optimized u-net inferred brain tumor segmentation transformed diffusion space registration dti-derived fractional anisotropy map using ant toolbox nearest-neighbor interpolation applied transform segmentation due lower resolution second image spurious intermediate value would otherwise occur tumor segmentation dmri space finally checked plausibility trained expert expected network two mri sequence input inferior original network separate brat validation dataset reach dice score 0.89 original network four input channel reach dice score 0.92 anomaly model several different anomaly detection framework exist investigated two promising deep learning approach based state-of-the-art technique differ fundamental principle fundamental anomaly detection principle previously published mri tumor detection well visual anomaly detection adapt fundamental principle dmri data modify setting model trained unsupervised dmri data healthy subject found brain tumor dmri dataset denoising autoencoder first principle use denoising autoencoder dae anomaly detection dae architecture designed reconstruct corrupted data traditionally used noise reduction denoising effect used anomaly detection network able reconstruct known pattern anomaly input data result faulty reconstruction case brain tumor transformed healthy tissue anomaly detected based difference input output important note hold model trained exclusively healthy image figure picture general framework subtracting input output lead anomaly score map figure setup denoising autoencoder network trained using control group aim learn reconstruction healthy brain finally residual formed post-processed full size image convolutional variational autoencoder architecture linear latent space chosen varied latent space dimension lsd evaluate optimal amount information reconstruction network able reproduce input data different variation detail architectural detail follows convolutional layer normalized activated leakyrelu function negative slope 0.01 loss model composed mean squared error mse kullback-leibler divergence aligned loss mse x_j x_j x_j aligned x_j\ element latent space vector size divergence slightly weighted 1.22 10^ due high amount possible combination limited computing power could test every possible set hyperparameters thus following set experiment needed decide set reasonable hyperparameters without extensive hyperparamter search mentioned loss weight chosen put focus reconstruction adam together learning rate scheduler used optimizer learning rate per epoch decayed 0.95\ model trained epoch furthermore batch size chosen computationally intensive parameter configuration network could trained vram configuration evaluate approach residual output input data formed anomaly detection carried raw diffusion image output comprised feature map calculated residual per channel voxel summed residual took absolute value summation taking absolute value summation reduced noise individual channel residual map composed calculated residual voxels finally classification binary anomaly map obtained threshold detail setting threshold found section evaluation daes anomaly detection noise may lead incorrect reconstruction misclassification voxels reduced misclassification ensured spatial consistency morphological opening binary image cubic kernel side length used structure element optimize reconstruction quality network two parameter optimized first output activation function two different option compared sigmoid function map value set input data often used binary classification alternative linear output function tested second parameter amount information reconstruction modified case different dimension linear latent space vector tested dae size considered general assumed smaller latent space make reconstruction difficult table detailing architecture found supplementary material discriminatively trained reconstruction anomaly embedding second approach based discriminatively trained reconstruction anomaly embedding model recdiscnet using two-step approach dae first step discrimination network second step well synthetically adding just-out-of-distribution appearance input data hypothesized stronger learning effect achieved noted still need labeled data simulation reflect real anomaly appearance target domain figure visualizes approach figure image control group enhanced just-out-of-distribution appearance reconstruction network trained denoise input image using mean squared error discrimination network utilizes concatenated image input reconstruction create anomaly map artificial groundtruth weighted binary cross entropy loss applied train discrimination network full size image reconstruction network trained denoise artificially altered input image discrimination network tried detect anomaly using concatenated input reconstruction data preprocessing training data necessary artificial noise needed added input data groundtruth segmentation map needed generated random number anomaly patch applied input image image inpainted one patch none two patch ellipsoid varied size orientation axis projection placed exclusively brain overlapping different tissue type background possible spatial information applied equally channel data augmentation dataset expanded four input image including different patch proposed dmri just-out-of-distribution appearance based heuristic different method generating incorporating appearance evaluated proposed appearance based random distribution scanner- tumor-independent different random distribution characteristic evaluated noise either sampled normal distribution mean standard deviation set mean standard deviation brain tissue half mean standard deviation brain sampled uniform distribution mean value set mean half mean value brain range chosen standard deviation brain tissue visual representation possible noise distribution given fig noise block-consisting four dimensions-each voxel either assigned randomly sampled value random value fixed per diffusion-attenuated image leading spatially consistent channel-specific block random value every voxel location fixed resulting random value across diffusion direction three approach understood random directionally-dependent isotropic out-of-distribution diffusion figure normal uniform distribution defined mean standard deviation observed mri signal diffusion attenuation brain noise spectrum also shown mean value halved full size image loss model composed two part reconstruction evaluated using mse whereas discrimination interpreted using binary cross entropy bce loss aligned loss mse p_1 y_i y_i aligned implementation presented includes sigmoid activation function second part measure bce target input probability whereby number data point furthermore two weight introduced one hand amplifies impact bce total loss p_1\ hand weight positive class compensated class imbalance anomaly map optimizer batch size number epoch chosen accordingly dae model presented required gpu least vram evaluation method anomaly map model evaluated utilizing residual map dae output recdiscnet avoid artificially improving result evaluation confined area within brain mask purpose voxels belonging white gray matter brain considered result quantified two classical metric tumor detection dice coefficient—the commonly used metric segmentation research especially brat challenge—is used binary map evaluation receiver operating characteristic roc curve corresponding area roc curve auc used evaluate anomaly map auc value provides performance metric across possible threshold evaluation anomaly map post-processed binary map used different approach select classification threshold simplest approach pre-fixed value thus treshold set 0.5 recdiscnet 0.3 dae first value result halving discrimination map output range latter pursues idea detect even small deviation residual dae furthermore otsu method threshold selection evaluated lastly determined threshold pooling output image 16\times 16\times 16\ local average kernel local selecting resulting global maximum value aligned local aligned moreover supervised method threshold selection evaluated context supervised implies information anomaly map corresponding groundtruth available thus must noted result utilized comparing output different anomaly model architecture first supervised threshold based roc curve threshold maximizes subtraction true positive rate false positive rate selected also called maximum value youden index another approach used choose threshold optimizes binary dice coefficient result evaluated 7-fold cross validation therefore healthy subject training datasets divided random subset trade-off number subset generality per subset subset used validation set network parameter callback chosen validation loss result evaluation anomaly map first evaluated performance anomaly detection model calculating auc different configuration dae table present auc value various parameter combination including lsd output activation function linear sigmoid observed model using sigmoid activation function achieved better result compared linear function model largest latent space dimensionality achieved highest auc 0.820 0.11 even smallest model performed relatively well auc 0.804 0.12 table area receiver operating characteristic curve auc dae model full size table recdiscnet assessed auc value different combination distribution type appearance type mean value disturbance noted calculating residual necessary output recdiscnet directly used anomaly map table present result showing model trained mix available parameter achieved highest auc 0.772 0.17 choice just-out-of-distribution disturbance strong effect result particular model trained half disturbance outperformed trained full disturbance overall recdiscnet demonstrated good performance anomaly detection table area receiver operating characteristic curve auc recdiscnet different just-out-of-distribution appearance parameter combination full size table distribution anomaly score gain insight discriminatory performance analyzed density distribution anomaly score generated best worst performing model fig observed brain matter mostly scored close zero model scoring anomaly varied best performing model top left exhibited strong separation anomaly healthy brain tissue indicating ability effectively detect anomalous region contrast worst performing model bottom right showed clear separation anomaly healthy tissue figure distribution best top worst bottom performing model half left full right shown model half create clear separation brain matter anomaly worst model behaves similarly random classifier fit area receiver operating characteristic curve 0.55 full size image binary segmentation compared performance dae recdiscnet binary segmentation brain tumor present dice score obtained using different thresholding method table presented show best performing model configuration dae recdiscnet dice postprocessed mean image processed morphological opening thresholding calculating dice score table show dice score different model achieved pre-defined threshold method recdiscnet achieved best result dice score 0.603 0.24 post-processing clearly improves result dae achieving dice score 0.431 0.19 pre-defined threshold may suboptimal two data-driven thresholding method evaluated otsu threshold maximum value mean pooled output treshold selection see section material method detail table dice score obtained using pre-defined threshold full size table otsu threshold strongly improved result dae dice score 0.501 0.20 table noted calculated threshold dae lower previous assumption 0.3 however recdiscnet improved otsu determined threshold close pre-defined fixed threshold table otsu threshold improves result especially post-processed dae full size table determining treshold maximum value mean pooled output result improved table post-processed score superior model strongly increasing dice score dae table maximum mean pooling image based entirely output data provides good basis one-class segmentation anomaly full size table finally present optimal threshold i.e. threshold optimized knowing groundtruth data purpose threshold result best dice coefficient without post-processing used table show result test data expected dice score increased comparison data-driven threshold model recdiscnet still performed best dice 0.660 0.23 table optimal result dice score chosen unprocessed dice score optimized full size table qualitative comparison section show qualitative output presented model figure demonstrate ability detect large medium small tumor different model figure column data show mean diffusivity image groundtruth segmentation colorbar refers anomaly map unprocessed binary postprocessed image represent binary segmentation using respective threshold result best performing dae model unsupervised threshold seen fig quantitative dice score recognized model able generate solid segmentation post-processing unprocessed image noisy single misclassified voxels transition csf well visible eliminated filtering best dice score dae achieved model figure therefore show qualitative result optimized threshold quality processed result particular greatly improved background noise smaller tumor still difficult detect corresponding dice score qualitative result recdiscnet consistently exhibited superior performance figure show maximum mean pooling threshold map post-processed image differed minimally stated recdiscnet achieved excellent qualitative result without post-processing without supervised threshold value post-processing may even slightly degrade excellent quality result case seen recdiscnet combination large tumor patient finally fig show qualitative map quantitatively optimized network recdiscnet supervised threshold excellent result achieved comparable shown figure qualitative result dae model otsu threshold full size image figure qualitative result dae supervised threshold full size image figure qualitative result recdiscnet using unsupervised threshold excellent result achieved even without post-processing full size image figure recdiscnet supervised threshold qualitative result comparable maximum mean pooling threshold full size image visual comparison diffusion anomaly follow-up scan finally particular attention given area marked anomaly model present groundtruth segmentation map area could due faulty segmentation also possible anomaly detection algorithm highlight early change brain structure yet delineated conventional mri test hypothesis mismatching area groundtruth tumor segmentation anomaly-score map evaluated comparison preoperative well post-operative structural mri follow-up scan recdiscnet showed superior discriminative ability tumor healthy tissue superior dice score providing clear distinction normal abnormal tissue see fig dae model achieved better auroc score see table output introduces uncertainty anomaly scoring capturing well area continuous transition best dae model thus used visual inspection visual inspection revealed anomaly map mostly concordance preoperative flair hyperintense region showed additionally diffusion-anomalous labeled region malignant glioma patient mismatch found glioblastoma patient showed partially overlapping area flair-weighted mri follow-up data mismatch diffusion anomaly data preoperative flair weighted image observed iii glioma patient showed partially overlapping area flair-weighted mri follow-up data mismatch found glioma patient exemplary case preoperative flair-weighted scan respective anomaly score map generated dae method juxtaposed month post-operative flair-weighted scan glioblastoma patient fig seen area characterize region altered diffusive property yet visible preoperative structural scan colocalize lesion delineated later conventional mri follow-up data figure area high anomaly score show follow-up scan upper two row flair-weighted mri diffusion anomaly detection-based data obtained preoperatively lower row flair-weighted mri month later yellow arrow mark area tumor recurrence observed anomaly score higher expected based preoperative flair scan full size image discussion result demonstrate potential dmri detecting microstructural anomaly delineation brain tumor offering valuable insight beyond achievable conventional mri technique delve significance study finding highlight performance anomaly detection model evaluate distribution anomaly score discus binary segmentation result provide qualitative comparison model evaluation anomaly map evaluation dae anomaly map demonstrated varying performance based different parameter combination auc value obtained different value latent space dimensionality activation function presented interestingly model utilizing sigmoid activation function consistently outperformed using linear function although model largest latent space dimensionality achieved highest auc 0.820 0.11 even smallest model performed relatively well auc 0.804 0.12 regarding recdiscnet doe require residual calculation auc value different combination just-out-of-distribution disturbance appearance presented notably model trained half representing halving mean anomaly distribution yielded better result mix model achieving highest auc 0.772 0.17 distribution type directional dependence seemed minor influence result distribution anomaly score gain better understanding discriminatory performance distribution anomaly score generated best worst performing model full half analyzed using density distribution anomaly score different model brain matter mostly scored close zero model scoring anomaly varied best performing model exhibited strong separation class despite achieving lower auc best dae model conversely worst performing model showed clear separation anomaly healthy brain tissue binary segmentation term binary segmentation performance dae recdiscnet model evaluated using different thresholding method simplest approach pre-defined threshold recdiscnet achieved highest dice score 0.603 0.24 post-processing significantly improved result dae yielding dice score 0.431 0.19 data-driven thresholding method otsu maximum value mean pooled output threshold selection also evaluated otsu threshold improved result dae achieving dice score 0.501 0.20 mean pooling threshold demonstrated data-driven improvement model post-processed result particularly superior recdiscnet finally optimal threshold optimized based groundtruth data determined threshold determination method suitable real-world application adequate unbiased comparison dae recdiscnet recdiscnet outperformed dae achieving dice score 0.657 0.23 qualitative comparison visual comparison follow-up scan provide qualitative assessment depicted output different model various tumor size figure demonstrate ability model detect tumor different size highlight difference unprocessed binary post-processed image notably post-processed image showed reduced noise improved segmentation result dae recdiscnet model overall recdiscnet consistently exhibited superior qualitative result compared dae referencing ground truth segmentation structural scan optimized thresholding method improved segmentation quality however clear distinction normal anomalous region uncertainty anomaly scoring introduced dae model still seemed contain additional valuable information microstructural alteration yet detectable conventional mri revealed comparison follow-up structural mri scan particular mismatch beween structual scan diffusion anomalous map time acquisition observed malignant glioma well complies invasive nature higher tumor grade glioma infiltrate brain along white matter structure known impact white matter integrity fiber compression and/or displacement consecutive fiber disintegration diffusion mri known detect early microstructural white-matter alteration capturing altered diffusivity water molecule consequence altered microstructural boundary change diffusivity previously shown occur glioma patient even brain region appear conventional mri normal appearing white matter diffusion-based anomaly detection method might sensitive early delineation occult tumor infiltration could aid identify future itinerary tumor progression early detection tumor recurrence combining diffusion-based anomaly detection imaging modality may allow validate advance present finding potential drawback method however tumor volume seemed rather underestimated area near cortex deep nucleus also equivocal signal alteration well artifact especially mesiotemporal basal area first require refinement method well validation longitudinal prospective study larger sample size certainly needed might become applicable clinical context conclusion study demonstrates efficacy deep learning-based anomaly detection method delineation glioma lesion diffusion-mri data highlight potential dmri valuable imaging modality enhancing brain tumor analysis potentially providing insight early microstructural change yet visible conventional mri scan could improve prognostication disease evolution tumor treatment strategy