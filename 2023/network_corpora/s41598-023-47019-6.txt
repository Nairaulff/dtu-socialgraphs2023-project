introduction stroke second leading cause death significant disability world cerebral infarction occupies approximately total stroke due insufficient blood supply brain leading death brain tissue acute ischemic stroke treatment intravenous recombinant tissue plasminogen activator within 3–4.5 intra-arterial mechanical thrombectomy within 6–24 well advised stroke guideline early identification ischemic size location brain image help decision-making urgent treatment acute ischemic stroke ncct commonly used brain image due well accessibility versatile fast speed however ncct limitation early eis lesion localization may take hour day visible ncct depending stroke duration severity location especially infratentorial region medulla pons midbrain cerebellum supplementary fig mri give better localization infarction early hour stroke onset mri expensive time-consuming readily available hospital since treatment time window acute narrow urgent detection localization early ncct highly demanded save time improve treatment outcome artificial intelligence widely used medical image data analysis potential machine learning automated software named e-aspects alberta stroke program early computed tomography score rapid aspect ischemaview developed analyze ncct quantify aspect score automatically early case big data involved becomes cumbersome job extract feature manually even expert involved besides aspect focus mainly ten region middle cerebral artery mca area supratentorial region without considering area anterior cerebral artery aca posterior cerebral artery pca supplementary fig aspect scoring need experience limited applicability detecting small infarction lacunar size 1.5 addition localization infarction using ncct cortical area challenging comparison subcortical area due presence central fissure sulcus supplementary fig although related work developed early ischemic stroke detection segmentation model using first-line ncct image none considered analysis based different region occurrence complicacy detection varies area size infarction instance early ischemic lesion detection stroke onset performed small study population patient although model achieved accuracy 0.74 detection limited anterior posterior territory context-aware cnn network proposed early ischemic stroke sign detection stroke onset estimate presence ischemic stroke sign hemisphere level patient data however robust method ischemic stroke could occur part brain dl-based early infarct identification aspect scoring determination using ncct number ischemic patient proposed designed model considered mca region achieved accuracy 0.85 auc 0.83 however lower f-score 0.40 signifies imbalance outcome precision recall early stroke detection method using yolo developed patient collected two institution although model included case smaller size infarction value f-score 0.50 due low sensitivity 0.40 precision 0.60 cnn framework designed ischemic stroke detection achieved accuracy considering number data set patch besides collected data mca territory supratentorial region focus stroke localization apart cnn analysis several method developed ischemic region localization using concept statistical analysis one developed early infarction onset detection method ncct considering infarction occurred segment mca even considered stroke age infarction region ncct visible although ml-based automatic aspect prediction model achieved accuracy greater 0.80 sensitivity 0.50 different part mca region caudate internal capsule mathematical model developed ischemic region detection localization calculating stroke imaging marker sim manually however manual calculation early based single parametric value could considered general solution extensive amount data besides intensive mathematical calculation requires massive computational time need modeler understand relation parameter using analysis researcher developed ai-based automatic segmentation ischemic region considering image early detection ischemic stroke author proposed fully automatic cnn system considering diffusion weighted imaging dwi proposed cnn model achieved average dice score 0.67 generation higher false negative fns could lead misclassification brain contains lesion residual-structured fully convolutional network res-fcn developed automatic segmentation acute sub-acute ischemic stroke considering different mri sequence dwi adc apparent diffusion coefficient however designed model low training testing accuracy 0.80 0.64 respectively one study achieved sensitivity 0.93 specificity 0.82 designed cnn model considering angiography cta image acute ischemic stroke detection nonetheless use injected material cta image may bring lot side effect itching vomiting nausea also chance cancer therefore faster safe ischemic stroke diagnosis considered affordable first-line ncct analysis previous study shown customized-vgg16 cnn model perform well identify presence early ischemic lesion ncct slice using concept automatic feature learning present study intended develop automatic localization model early infarction sign irrespective cerebral region ncct examined within stroke onset method study population total 9,353 patient retrospectively screened chang gung memorial hospital linkou medical center taiwan among patient 5.52 met inclusion criterion recruited processing fig ncct mri collected de-identification imaging interval day mean 7.4 5.3 day recurrent ischemic event interval mr/dwi sequence used image annotation mr/adc sequence employed validate ischemic region dwi image collected chang gung research databank format digital imaging communication medicine dicom image size pixel study approved institutional review board irb chang gung medical foundation taipei taiwan license number 201900028b0 informed consent waived chang gung medical foundation institutional review board tung hwa north road taipei taiwan republic china method performed accordance relevant guideline regulation figure patient recruitment flowchart figure represents inclusion exclusion criterion ischemic stroke patient enrolled considered present analysis according stroke onset time affected brain region area size infarction ncct non-contrast computed tomogram magnetic resonance dwi diffusion-weighted image full size image brain scan performed single detector scanner aquilion toshiba japan thickness brain ncct original ncct transformed brain/sinus window center 40hu width 150hu level brain image performed 3.0 tesla scanner ingenia 3.0t system philip usa eligible image screened based regular report neuroradiologists identified infarction initial ncct examined within stroke onset positive dwi/adc signal subsequent mri re-confirmed two neurologist case conflict neuroradiologists neurologist image included analysis inter-observer difference near study methodology five phase performed establish infarction localization model including preprocessing ground truth formation cnn input preparation infarction sign detection infarction localization supplementary fig preprocessing phase improve issue low resolution poor contrast quality presence skull bone in-built noise could create difficulty detecting infarction region following preprocessing step used first ncct dicom image converted jpeg joint photographic expert group using software radiant dicom viewer maintenance original image dimension standard 8-bit grayscale depth 0–255 pixel-level analysis performed instead voxel-level ncct slice preferred distortion brain tissue carefully prevented conversion ncct image second ncct slice containing infarction differentiated infarction based dwi/adc sequence mapping ncct mri performed considering various cerebral feature including structure ventricle sulcus order image sequence third bony skull falx calcification removed combining automatic algorithm binary pixel-based thresholding along combination morphological operation like erosion opening together http fourth increase contrast quality well remove inbuilt noise ncct denoising convolutional neural network dncnn http applied final step preprocessing comparing peak-signal-to-noise ratio psnr value different filtering algorithm mean filter median filter etc http ground truth formation phase prevent manual labelling error dwi/adc sequence used reference create label ncct using supervised learning method however several intermediate processing step brain tissue tilt adjustment cropping resizing performed using imagej software prior annotation processing step necessary acquisition setting patient health condition vary modality however intermediate processing solely performed annotation training image first tilt adjustment done selected ncct dwi slice make completely straight rotating clockwise anti-clockwise cerebral falx line image modality form 90° 270° angle x-axis 180° angle y-axis angular adjustment performed automatically using bilinear interpolation method embedded imagej next step brain tissue part cropped image cropped ncct slice resized equal size dwi match accurate region infarction infarction region extracted dwi/adc image using shanbhag segmentation method embedded inside imagej next masked infarction region overlaid corresponding preprocessed ncct finally ncct annotated early infarction confirmed neurologist using corresponding dwi/adc shine-through effect dwi slice taken care corresponding adc slice cnn input preparation phase dl-based infarction localization model considered image patch input cnn instead entire ncct slice use image patch prevent imbalanced pixel ratio acute infarction lesion normal brain region prepare appropriate input cnn model different sub-phases patch generation patch selection patch resizing adopted phase patch generation tilemage image splitter version 2.11 http used divide image slice smaller patch user-defined size size patch varied 15–22 pixel based dimension input image patch formed considering annotated corresponding un-annotated ncct generated patch stored jpeg format based requirement dl-based localization model supplementary fig patch selection infarction non-infarction patch selected analysis designed model infarction abnormal patch extracted infarction region whereas non-infarction normal patch collected brain region situated contralateral hemisphere applying brain symmetry property supplementary fig patient infarction hemisphere non-infarction patch hemisphere considered training patch resizing pool infarction non-infarction patch resized testing model resizing batch patch performed using plastiliq image resizer version 1.2.5 http supplementary fig infarction sign detection phase infarction localization phase focused mainly identification infarction region obtained using cnn model selection finalization infarction identification process carried correctly classifying infarction non-infarction patch using pretrained cnn purpose total 21,436 infarction abnormal patch 20,391 non-infarction normal patch extracted 1,634 ncct slice patient main aim localization phase identify least single infarction patch accurately could assist diagnosis acute cerebral infarction cnn model selection input patch size entire pool abnormal normal patch divided randomly training/validation testing set ratio 80:20 several state-of-the-art pretrained cnn model already trained large imagenet dataset employed based reusability faster analysis pretrained cnn model adopted concept transfer learning learning process pretrained model initiated pattern already learned training various dataset instead learning scratch different pretrained cnn model performed including visual geometry group vgg16 residual network resnet50 googlenet inception-v3 inception-v4 inception-resnet-v2 ir-v2 trained imagenet dataset customized using transfer learning cnn model finalization selection appropriate pretrained model default setting proper hyperparameter tuning performed derive final cnn model infarction localization derived model validated k-fold cross validation cnn model tuning performed including addition three batch normalization layer one flatten layer two dense layer different standard vgg16 model supplementary information default architecture vgg16 number neuron modified first dense layer second dense layer different standard 4,096 output layer activation function modified sigmoid default softmax activation function binary classification model could perform optimally feature difference among input complicated feature differentiation infarction non-infarction patch challenging adjust learning rate adaptively lower requirement hardware computational resource adam optimizer used loss minimization categorical crossentropy loss function considered performed well binary class input encoded form one-hot vector like infarction 0,1 normal patch respectively establish robust infarction localization model rigorous hyperparameter tuning performed using concept random search technique outperforms traditional grid search technique performing several trail experiment different combination hyperparameters fine-tuned model obtained setting optimal value learning rate 0.001 batch size number epoch number step per epoch dropout rate 0.40 first dropout layer 0.30 second dropout layer k-folds cross validation strategy ass robustness tuned-vgg16 cnn model well handle overfitting issue whole dataset patch generated infarction patient divided patient-wise k-folds randomly fold patch patient patient selected randomly testing whereas patient early infarction patient data patch used training validation purpose primary reason consider fold provide larger set training data machine round model could extract multiple distinct feature could help correct recognition unseen testing data finally best checkpoint model smallest validation loss highest average performance value saved final derived model implementation carried using gpu version tensorflow 1.14 specification titan rtx 24gb intel®xeon®scalable processor upi 10.4gt/s memory nvidia-smi 430.40 ubuntu 18.04.3 platform various predefined library kera 2:1:6 python 3:6:9 numpy 1:18:4 matplotlib 3:2:1 opencv 4:1 pillow 7:1:2 scikit-learn 0:21:3 used image analysis infarction localization phase localization classified abnormal infarction patch performed respective ncct using template matching algorithm developed opencv http designed localization system took classified abnormal patch preprocessed ncct altogether input matched abnormal patch corresponding ncct using derived algorithm supplementary information infarction localization phase statistical analysis performing analysis acute infarction patient using deep learning accuracy achieved model sufficient evaluate performance therefore performance metric sensitivity/recall tp/ specificity tn/ precision tp/ f-score precision sensitivity precision sensitivity used evaluating developed classification model proposed model true positive represented actual infarction patch predicted infarction per requirement true negative denoted non-infarction patch correctly predicted non-infarction similarly false positive predicted non-infarction infarction false negative incorrectly predicted infarction non-infarction apart performance metric receiver operating characteristic roc also plotted show area curve auc predict binary outcome average precision curve also depicted represent trade-off sensitivity precision useful unbalanced dataset http model performance also evaluated compare outcome patch-level accuracy patient-level accuracy total number correctly classified patch represented total number patch considered hemisphere infarction localization individual patient defined total number correctly identified patient infarction lesion total number considered infarction patient result patient demographic among 9,353 patient screened 5.52 met inclusion criterion used analysis patient stroke onset time stroke onset time fig patient divided based infarction region including supratentorial region infratentorial region supratentorial region comprised aca mca pca area categorized cortical subcortical cortical plus subcortical area similarly infratentorial region comprised midbrain pons medulla cerebellum current study also considered analysis infarction size 0.5–1.5 supratentorial infratentorial region clinical profile considered ischemic patient represented table table clinical profile ischemic stroke patient recruited onset time 6–12 full size table cnn model input size selection selection preferable patch size robust pretrained cnn model carried several performance metric table model selection primary metric considered among model value vgg16 patch size 0.69 higher pretrained model patch size table supplementary fig although ir-v2 performed better 0.68 vgg16 0.55 patch size performance metric like specificity 0.70 f-score 0.68 higher case vgg16 table based result performance metric table supplementary fig pre-trained vgg16 model input patch size selected cnn model classify infarction non-infarction patch accurately table performance metric related cnn model patch size selection full size table cnn model finalization average testing value obtained using 20-folds experiment considered result different performance metric corresponding mean obtained performing 20-fold cross-validation study presented table table performance evaluation tuned-vgg16 infarction detection model full size table tuned-vgg16 model achieved mean auc 0.73 table 5th row 8th column along mean specificity 0.78 table 5th row 5th column precision 0.77 table 5th row 6th column respectively delineation roc curve showing individual auc 0.73 stroke onset time auc 0.74 stroke onset time within 6–12 fig justified uniformity derived model infarction localization irrespective onset time localization infarction infratentorial region fig c–f table 11th 12th row 8th column showed tuned-vgg16 model performed equivalently supratentorial auc 0.74 stroke onset time auc 0.73 stroke onset time within 6–12 mean specificity 0.89 mean precision 0.78 table 13th row 5th 6th column suggested ability proposed cnn model recognize non-infarction patch precisely false positive fps achievement 0.69 stroke onset time 0.63 stroke onset within 6–12 signified balanced outcome higher precision lower recall table 11th 12th row 9th column case supratentorial infarction derived localization model could correctly determine infarction region mean value auc 0.73 table 9th row 8th column sensitivity 0.77 table 9th row 4th column figure receiver operating characteristic roc curve generated tuned-vgg16 infarction localization model stroke onset time stroke onset time 6–12 supratentorial region infarction supratentorial region infarction 6–12 infratentorial region infarction infratentorial region infarction 6–12 cortical area infarction cortical area infarction 6–12 subcortical area infarction subcortical area infarction 6–12 cortical plus subcortical area infarction cortical plus subcortical area infarction 6–12 infarction size 0.5–1.5 infarction size 0.5–1.5 6–12 roc receiver operating characteristic vgg16 visual geometry group full size image considering analysis infarction cortical area developed model achieved mean 0.75 table 17th row 9th column auc 0.69 stroke onset auc 0.73 stroke onset time within 6–12 fig f-score 0.72 stroke onset time 0.79 stroke onset time within 6–12 subcortical infarction table 19th 20th row 7th column signified harmonic balance higher recall lower precision cortical plus subcortical infarction model achieved significant outcome sensitivity 0.70 stroke onset time table 23rd 24th row 4th 9th column presented fig i–l roc curve showing auc 0.77 stroke onset time auc 0.78 stroke onset time 6–12 case subcortical infarction along value auc 0.69 stroke onset time auc 0.74 stroke onset time 6–12 cortical plus subcortical infarction signified ability tuned-vgg16 model differentiation positive negative derived model achieved auc 0.78 stroke onset time case infarction size 1.5 fig mean sensitivity 0.77 0.75 table 29th row 4th 9th column conveying stability selected cnn model localization small infarction considering patch-level accuracy tuned-vgg16 model achieved accuracy without misclassified infarction patch patient infarction size 1.5 patient infarction size 1.5 fig accuracy varied patient even smaller infarction size 0.9 scatter plot fig case infarction size 1.5 fig tuned-vgg16 achieved patch-level accuracy total stroke patient figure analysis patch-level patient-level accuracy analysis patch-level accuracy patient infarction size 1.5 analysis patch-level accuracy patient infarction size 0.5–1.5 analysis patch-level accuracy patient infarction size 1.5 analysis patient-level accuracy full size image patient-level accuracy analysis using tuned-vgg16 model showed derived vgg16 model could correctly recognize patient fig even patient single classified infarction patch infarction localization ncct infarction localization model developed automatically display infarction region corresponding ncct fig supplementary fig shown fig finalized tuned-vgg16 localization model could successfully recognize abnormal patch supratentorial infratentorial brain region fig supplementary fig also cortical subcortical cortical plus subcortical area fig supplementary fig figure localization early infarction first-line ncct automatic localization early infarction supratentorial region automatic localization early infarction infratentorial region automatic localization early infarction cortical subcortical cortical plus subcortical area inaccurate localization infarction could observed tuned-vgg16 model incorrectly localized infarction opposite hemisphere 3rd row two distinct infarction located dwi 6th row represented green purple circle respectively case developed model could accurately localize bigger size infarction ncct green circle whereas failed identify comparatively smaller one besides could visualized localized ncct slice 9th row identified infarction region smaller corresponding dwi ischemic patch misclassified normal fns ncct non-contrast computed tomogram dwi diffusion-weighted imaging full size image although infarction localization model could correctly identify patch different infarction size corresponding nccts case localized infarction ncct fig smaller dwi/adc fns instance tuned-vgg16 model localized infarction normal region opposite hemisphere fig misclassifying non-infarction patch infarction fps however type wrong localization could managed clinician considering neurological deficit criterion discussion previous study developed cnn-based model identify early ischemic injury first-line ncct could accurately classify normal ischemic stroke patient identifying probable ischemic slice however previous study limitation localize infarction ncct slice know region size severity infarction present study reformed develop supervised deep learning -based localization model early infarction sign integrating several automatic method software proposed model considering stroke onset time also different region supratentorial infratentorial area cortical subcortical cortical plus subcortical even lacune-size infarction although related work developed dl-based infarction localization model using ncct none image analysis performed infratentorial supratentorial region considering complicacy localization cortical subcortical area detailed comparison related study related clinical contribution presented table table comparison different localization model using ncct full size table although previously proposed work used first-line ncct methodology early ischemic stroke detection segmentation several technical limitation exist term model development data partition performance evaluation instance previous work performed slice-wise analysis global feature generated cerebral part like sulcus artery ventricle dominate local feature infarction resulting higher fns therefore sensitivity 0.41 0.65 f-score value 0.44 0.49 related work contrast trained model providing local global information form ischemic normal patch patch-based solution extracted opposite hemisphere patch-based analysis performed using first-line ncct first-work resnet used patch classification considering size whereas second work two-stage model unet-resnet employed early ischemic stroke segmentation considering fixed patch size smaller size patch might lead feature distortion performing internal resizing input resnet whose default size might lead inadequate feature extraction especially infarction size large small accordingly used patch size qualitative feature extraction extensive performance analysis different patch size presented table adopted size patch enables network differentiate infarction normal region effectively besides execution sequential vgg16 faster two stage unet-resnet computational-intensive segmentation performed first following classification current study large study population patient stroke onset considered previous work developed limited datasets instance patient recruited patch-wise classification precise segmentation early infarction using multi-scale u-net developed considering ischemic case primary reason low sensitivity 0.65 dl-assisted detection model could imbalance data normal slice ischemic slice therefore model could learn normal feature proposed model developed considering ncct slice without visibility ischemic lesion stroke onset differentiation ischemic normal feature challenging contrary clear visibility stroke region prior proposed work easy differentiation one novel point analysis automatic generation ground truth analysis related work training image needed annotated first annotation procedure might contain error based doctor experience expertise clinical scenario infarction visible early annotation difficult using naked eye therefore constructed automatic model combining dual image modality using dwi/adc ncct imaging interval day minimize chance annotated error automatic model reduce burden clinician also increase annotation accuracy every procedure annotation performed automatically one study neurologist generated ground truth early ischemic stroke segmentation model without considering reference image besides outcome validation hence might potential diagnostic verification bias reviewed dataset used analysis relatively comprehensive comparison analysis performed previous related work rigorous study design achieved mean accuracy 0.73 stroke onset duration even variation ischemic change table 5th row 3rd column main reason achieving lower mean sensitivity 0.57 table 13th row 4th column infratentorial infarction comparison supratentorial infarction likely due small number considered patient also slower ischemic change resulting increase fns infarction patch misclassified normal patch achievement patch-level classification accuracy patient infarction size 0.5–1.5 fig inferred effectiveness developed model detecting lacunar infarction could observed pattern scatter plot trend-line fig patch-level accuracy localization model could increased along increase number patient one notable point derived model besides cnn model developed current study could classify patient-wise one two patch participant infarction size 1.5 hence percentage patch-level accuracy considered patient fig however case early ischemic stroke sufficient know location infarction even single correctly classified patch limitation present study first testing whole ncct slice fps normal patch misclassified abnormal generated fig 3rd row especially patient stroke onset time infarction minute comparison contralateral side however mistake could overcome using information neurological deficit since supratentorial infarction may cause neurological abnormality contralateral body clinical information second found patient size infarction region localized patch smaller dwi/adc fig 6th 9th row signified abnormal patch classified normal due extended time gap initial ncct follow-up dwi/adc might affect infarction outcome third could observed localization accuracy higher large infarction small infarction reason might imbalanced distribution healthy tissue infarction hence model performance learned feature normal region dominated distinguished feature infarction region interval dwi/adc initial ncct could another potential reason therefore model achieved good accuracy classify equal number infarction normal patch extracted hemisphere given input however biasedness derived model could observed testing patch generated whole ncct slice consequently either infarction patch misrecognized non-infarction infarction wrongly detected non-infarction region due misclassification normal patch fourth sometimes case patient old recent stroke infarction old stroke detected instead recent stroke fifth study image collected single center may able generalized medical system validation proposed automatic ischemic region localization system may needed medical system different ncct sequence also prospective study collecting image emergency department next aim study sixth improvement system localize tiny infarct size 0.5 considering feature whole ncct slice necessary conclusion present study set ai-based automatic model concept automatic feature extractor using detect early infarction sign supratentorial infratentorial region stroke onset examine different brain area including cortical subcortical cortical plus subcortical also infarction size 0.5–1.5