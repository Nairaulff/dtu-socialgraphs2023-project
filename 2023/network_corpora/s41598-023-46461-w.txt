introduction since introduction optical coherence tomography oct commercialization fast non-invasive scanning technology widespread use clinical study routine clinical practice especially field ophthalmology variety eye disease diagnosed monitored using high-fidelity volume produced oct micrometer resolution tandem development standard clinical diagnosis common macular disease diabetic macular edema dme age-related macular degeneration amd revolutionized based primarily oct scan management amd leading cause blindness elderly patient cross-sectional view macular region offered oct compared color fundus photography provides important insight staging amd currently amd classified early/intermediate iamd two late stage neovascular amd namd wet amd geographic atrophy based presence drusen exudation outer retinal atrophy color fundus photograph respectively furthermore oct invaluable guiding treatment namd anti-vegf agent expected oct bring similar value future monitoring first complement inhibition agent become available thus paramount importance accurately stage disease amd patient detect conversion iamd namd and/or immediately upon onset initiate timely treatment maximize preservation visual function patient numerous oct scan acquired daily part management patient amd busy clinical routine parallel creates large-scale real-world imaging repository within picture archiving communication system pac hospital repository large amount retrospectively prospectively collected yet unstructured data treasure trove information curated successfully mined clinical insight amd progression pathomorphological risk factor however defines new challenge curation large unstructured unlabeled data repository statistical machine learning analysis artificial intelligence advent deep learning offered path toward creating automated image recognition system using convolutional neural network cnns shown capable automated diagnosis level retinal expert abundance prior work oct classification segmentation however majority work addressed image classification task primarily focusing classification central oct cross-sectional slice b-scan therefore minority work addressed task classification staging oct volumetric scan patient amd paper propose deep learning method determine current oct scan show biomarkers corresponding early/intermediate stage amd eye already converted one two late stage disease namely namd achieve goal automated amd staging datasets extracted real-world clinical cohort propose two-stage deep learning approach classify macula-centered oct volume detect presence four different biomarkers i.e. macular neovascularization mnv macular atrophy drusen normal retina defined best knowledge work represents first approach classify stage entire oct volume amd patient scan acquired real-world clinical setting main contribution summarized follows development flexible effective deep learning model classify real-world oct volume proposed pipeline exploit key benefit approach b-scan level classification combined uncertainty quantified volume prediction efficiently group clean grade curate large amount retrospective oct datasets extensive evaluation network real-world hold-out test set external evaluation large-scale real-world test set image domain population shift material method participant imaging characteristic real-world dataset denoted pinn consisting volumetric oct scan associated electronic health record ehr collected retrospective branch pinnacle consortium extracted university hospital southampton moorfields eye hospital contains data patient year old diagnosed amd period 2007–2019 pinn therefore represents twelve year clinical routine two large eye hospital consists total 156,872 oct volume 6,616 patient acquired topcon scanner topcon corporation tokyo japan spectral domain -oct t-1000 t-2000 swept source -oct triton scan complemented in-house graded dataset denoted opt topcon scan oct-volumes available optimum lab medical university vienna austria dataset extracted repository clinical study data included represent prototype clear-cut case one stage-defining amd biomarker present contrast mixture biomarkers typically co-occurring real-world pinn scan image resolution size topcon scan differed three image dimension restricted common scan mode present datasets i.e b-scans a-scans denoted dimension respectively covering 20^ 20^ field view axial dimension varied z=480\ –650 t-1000 z=885\ t-2000 z=992\ triton topcon device qualitative comparison image quality topcon model distribution scan different dimension found supplement table fig study adhered tenet declaration helsinki standard good scientific practice medical university vienna retrospective data collection clinical site approved need informed consent waived wale research ethic committee ref 19/wa/0079 presented study part pinnacle initiative approved ethic committee medical university vienna vienna austria ref 1246/2016 data curation grading obtain reference label pinn training validation testing supervised deep learning approach split grading three step brief subset scan selected based ehr subset manually cleaned remove bad quality scan scan centered macula grading training set experienced non-retinal specialist validation test set retinal specialist based ehr determined approximate scan label randomly selected disease stratified subset pinn dataset included fellow eye eye undergoing treatment anti-vegf additional eye representative healthy retina selection criterion increased chance encountering recently converted late-stage case fig resulting subset manually cleaned curated labeled computer scientist experience retinal image analysis non-medical grader cleaning involved removing scan non-amd disease bad quality scan scan without biomarkers considered related amd stage cleaning necessary step efficient grading process ehr detailed enough derive biomarkers visible scan long follow-up daily clinical routine scan give rise unavoidable scan quality issue relied presence drusen fluid atrophy representative imaging biomarkers iamd namd respectively following describe presence absence three biomarkers binary label drusen mnv macular neovascularization macular atrophy absence three normal b-scan example biomarker shown supplementary fig corresponding clinical description label found grading protocol supplementary material curated set together opt denoted main dataset consists oct volume eye patient supplementary fig containing scan biomarkers iamd namd amd scan level hence also volume level simultaneously figure example two eye pinn dataset convert early/intermediate late stage amd top row eye small drusen month later show visible occurrence retinal fluid bottom row eye large drusen month later show visible occurrence atrophy full size image deep learning-based oct volume classification model implemented two-stage deep learning model composed two cnns used train b-scan classifier oct volume classifier respectively fig approach allows learn datasets variable label granularity b-scan-level vs. volume-level addition avoids using fully cnns much larger number parameter difficult train limited volume-level label available first stage consists imagenet-pretrained resnet50 trained identify disease category b-scan stage serf two purpose first provides b-scan-wise encoding form 2048d vector latentbscan second enhances interpretability model offering b-scan-level localisation predicted class within volume fig concatenating volume latentbscan representation tensor obtain volume-level representation latentvol second stage trained independently first stage take latentvol input size 2048\times\ bscans consists four separate resnets trained perform binary classification task level oct volume i.e. predict particular disease-specific biomarker present somewhere volume resnet18 employed predicting presence mnv resnet34 predicting presence drusen volume normal classification uncertainty estimation uncertainty estimate volume-level class generated monte–carlo dropout inference time ten evaluation per oct scan uncertainty quantified using margin confidence metric moc based fact several binary problem observation described milanés-hermosilla stated four binary problem reflect presence absence biomarkers oct volume run monte carlo dropout inference equips softmax output positive negative class moc estimate uncertainty binary problem subtracting lower softmax value higher one i.e likely value per inference run average total amount monte-carlo dropout run computational detail found milanés-hermosilla resnets derived standard pytorch resnet implementation adding dropout layer linear classification head figure proposed deep learning model consists following two cnns b-scan classifier predicts presence biomarkers individual b-scan volume classifier collates feature learned b-scan classifier obtain prediction oct volume level macular atrophy active namd mnv drusen normal full size image figure example b-scan localisation result test set volume predicted mnv first column volume predicted second column b-scan-level classification displayed top mnv red yellow green otherwise four illustrative b-scans seven true positive example one true negative example full size image training detail stage model trained weight decay dropout label smoothing first stage b-scan model trained sgd optimizer cyclic learning rate second stage volume model trained adam optimizer stage pretrained imagenet weight b-scan model initialized topcon model pretraining kerm dataset epoch trained topcon b-scan model epoch b-scan dataset supplementary material pre-trainings standard data augmentation random rotation cropping erasing horizontal flipping applied b-scans resized 224\ using default pytorch resize function bilinear interpolation stage latentvol embedding created entire training validation test set hence first stage b-scan-level cnn seen frozen trained tuned second stage four different resnets binary biomarker lower-dimensional embedding without additional data augmentation epoch different resnets trained respect batch-size learning rate depth final resnet type four volume-level model chosen based performance validation set measured sum sensitivity specificity evaluation methodology internal dataset oct classification following describe oct volume-level dataset used training validation testing model dataset used train b-scan-level classifier described supplementary material serve training set total scan patient eye randomly selected graded using grading rule supplementary material experienced non-medical grader therefore considered silver-standard label serve validation hold-out test set subset scan chosen random label-stratified manner eye disease according limited ehr available validation test set consisting distinct oct volume eye patient per set graded retinal specialist presence drusen mnv absence biomarkers normal scan excluded grading due poor scan quality disease amd non-active mnv scan centered optical nerve head instead macula final validation set consisted volume test set volume patient independent particular test set consists distinct eye distinct patient table show distribution biomarkers three set table distribution class type biomarkers present oct volume training validation test set note oct patient eye may counted several biomarkers present oct volume contrast last row total contains total amount unique patient eye oct volume used dataset split full size table internal evaluation comparison baseline method report volume-level performance model hold-out test set predict biomarker presence four target performance b-scan classifier reported supplementary material want show approach reach state-of-the-art performance benefiting disease b-scan localization capability simple train setup therefore trained evaluated two collection resnet3ds one resnet3d trained biomarker standard pytorch architecture resnet3d34 resnet3d50 baseline method first network resnet3d trained tuning learning rate batch size resnet depth i.e also size input number b-scans slice resolution via hyperparameter search second network denoted resnet3dnaive b-scans volume fixed b-scan size 224\times 224\ learning rate model depth batch size tuned b-scans selected approach including central b-scan direction period b-scans available e.g x=4\ case second network get b-scan percentage approach trained one binary classifier per biomarker one-vs-all epoch operating point network determined maximum youden-index pinn validation set compare model baseline approach chose following standard performance metric area roc curve auc balanced accuracy bacc accuracy acc f1-score sensitivity specificity addition report matthew correlation coefficient mcc recently shown truthful metric binary classification problem respect confusion matrix category defined aligned mcc =\frac +\text +\text +\text +\text aligned number true positive true negative false positive false negative respectively evaluation classification uncertainty order find suitable threshold distinguishing certain uncertain prediction optimized matthew correlation coefficient mcc compute mcc per biomarker pinn validation set use derived moc threshold i.e. mnv 0.8 0.85 drusen 0.8 normal 0.5 determine high-confidence prediction verify uncertainty estimate prediction comparing performance three different subset hold-out test set task distinguish scan late stage presence mnv and/or non-late stage presence mnv and/or particular denote high confident subset hctestset set scan test set high confidence prediction label i.e greater equal threshold defined simultaneously mnv confident subset ctestset defined similarly require one biomarkers predicted high confidence also added three different naive b-scan approach experiment based first stage model first model gtcbscan ground-truth label central b-scan distinguish late non-late amd central b-scan graded mnv approach predicts late-stage scan two model denoted bscanmodel predict oct volume late single b-scan predicted late second one predicts late least total amount b-scans predicted mnv use n=10\ proposed n=15\ comparison report statistical significance group using non-parametric mann-whitney-wilcoxon test external validation public datasets duke biobank also evaluated model external public duke dataset used different oct scanner dataset contains scan amd early/intermediate late stage according definition healthy eye acquired bioptigen oct bioptigen inc. research triangle park bioptigen scan acquired field view 6.7\ 6.7\ size physical voxel size 6.7 3.24 different internal development evaluation set topcon-2000 scanner field view size physical voxel size 11.719 46.875\ 2.6 order report sensitivity specificity accuracy dataset randomly selected total data identified operating point using youden-index applied remaining data report metric task distinguishing healthy amd scan investigate screening property approach population scanner domain shift applied network biobank dataset ukbb ukbb consists 175,869 lower quality topcon-1000 oct 85,709 patient variety disease majority expected healthy representative population screening divide analysis two part first screened total amount oct volume late-stage amd i.e. volume dry wet late-stage amd second extracted oct volume patient year age resulted volume patient screened late-stage amd two cohort filtered remove low quality scan applying quality index based thresholding per b-scan proposed stein applying filter 121,608 oct volume 71,763 patient remained first cohort scan patient second cohort subset ukbb classified model uncertain positive late-stage prediction moc smaller 0.6 ignored adjust scanner model domain shift classifier detected scan and/or mnv first cohort scan second cohort evaluate classification first cohort positive predicted scan i.e mnv graded retinal specialist presence mnv secondary amd exudative retinal disease diabetic macular edema dme retinal vein occlusion rvo central serous chorioretinopathy atrophy secondary degenerative retinal disease therefore report positive predictive value ppv second cohort patient graded manner entirety able report sensitivity specificity addition ppv result internal evaluation comparison baseline method qualitative example correct misclassified oct volume shown fig roc-curves confusion matrix model per biomarker shown fig model reached high roc-aucs test set across biomarkers 0.96–0.97 exception drusen 0.88 one hand performance drusen corresponds fact test set also contains early amd case show minimal drusenoid elevation retinal pigment epithelial rpe one single b-scan make particularly hard distinguish normal curved retina noise real drusen lead false negative case false positive case hand detected scan rather small example pigment epithelial detachment ped partly vanished rpe atrophy scan large amount retinal fluid obscure shape retinal layer structure discussed test set contains scan several biomarkers hence one biomarker obscure presence biomarkers late stage amd scan show large retinal deformation fluid shrm rpe debris condition increase difficulty detecting small drusen atrophic area small diameter comparison baseline approach averaged across biomarkers given table metric per individual biomarker supplementary table although model outperformed baseline biomarkers mnv normal model detected slightly fewer case fully tuned resnet3d approach performance drusen biomarker mixed three approach indicating challenging test set overall approach showed comparable better performance compared baseline additional benefit b-scan-level disease localization slightly behind bacc approach achieves higher mcc indicating better correlation true label prediction figure example correct misclassified oct volume internal pinn test set relevant b-scan displayed full size image figure roc-curves roc-auc area confusion matrix detecting biomarker full size image table comparison two-stage approach two baseline resnet3d classification model column roc-area curve roc-auc balanced accuracy bacc accuracy acc matthew correlation coefficient mcc score sensitivity specificity per model bold mark highest value full size table evaluation classification uncertainty strategy categorize test set volume described evaluation methodology section certain uncertain case thresholding moc value lead respectively high confident confident prediction label excluding uncertain case based two criterion described particular measure metric two subset scan compare metric computed whole test set approach based ground-truth central b-scan label performs poorly expected task sole b-scan model approach b-scan threshold late predicted scan perform better term sensitivity trade-off higher false positive rate metric highly volatile respect percentage threshold plot mcc different threshold supplementary fig metric increase nearly perfect score high confident labeled subset false negative increase confident subset substantially false negative compared whole dataset detailed metric table uncertainty moc value corresponding prediction test set shown fig moc value significantly different correct false prediction biomarker observation point direction moc used identify reliably classified sample figure margin confidence moc true false prediction four biomarkers statistical significance denotes 0.01\ denotes 0.0001\ full size image table performance model binary classification task late amd non-late amd volume level gtcbscan model central b-scan grading retinal expert bscanmodel first stage network different threshold threshold define many b-scans classified late amd volume volume classified late corresponds full model different subset test set pinn ctestset corresponds subset scan testset certain prediction hctestset subset scan high certainty full size table external validation public datasets duke biobank external duke dataset reached almost perfect roc-auc 0.994 task distinguishing amd vs. healthy eye compared 0.992 reported original work 0.97 0.999 recent work result show model ability generalize oct device furthermore high performance external test set bacc 0.98 compared performance internal pinn test set bacc 0.9 show level difficulty real-world datasets compared clinical study datasets external ukbb classifier achieved low ppv presence active mnv 0.14 high ppv presence 0.88 first cohort oct volume reformulating classification target presence retinal fluid namd rvo dme ... model achieved ppv 0.89 retinal fluid 0.91 fluid-and/or-atrophy vs. no-fluid-and-no-atrophy cohort addition ask detect scan without mixing two late stage biomarkers i.e. retinal fluid atrophy scan atrophy fluid see rise performance ppv 0.94 detection atrophy ppv 0.99 retinal fluid second cohort patient detected atrophy case retinal fluid lead sensitivity/specificity 1.0/1.0 atrophy 0.5/1.0 retinal fluid result suggest although trained solely amd dataset vast majority scan different oct device model detect general retinal fluid atrophy hence learned biomarker amd specific feature discussion numerous oct datasets collected eyecare center around world oct gold standard imaging modality managing amd patient although many study developed applied retrospectively investigate oct study imaging data limited amount examine exploit real-world oct data clinical routine partly due ehr unstructured offering diagnostic granularity used extract patient subcohort interest therefore proposed deep learning classification pipeline able detect current disease stage given oct scan amd patient real-world longitudinal dataset availability amd stage datasets used perform downstream clinical statistical analysis larger number image boosting value retrospective study oct scan presented robust flexible approach classify retrospective amd datasets three main stage disease achieved good performance roc-auc 0.944 averaged biomarkers randomly selected retinal expert-graded independent test set addition work trained tested nearly entirely real-world data showed uncertainty estimate subgroup test set reflect quality prediction monte carlo dropout inference time although many classification segmentation approach proposed stage amd b-scan level practical relevant classification whole volume real-world data received prior attention furthermore many proposed deep learning method classical machine learning method classification trained evaluated solely clinical study data unfortunately well-specified patient inclusion criterion study reflect challenge real-world clinical dataset several amd stage-associated biomarkers present oct volume sometimes even b-scan additionally quality issue oct taken daily clinical routine manifested clinical study datasets particular used limited amount training label create robust classifier directly retrospective data extracted two different hospital proposed method analyzing volumetric oct data general modular underlying cnns interchanged retrained separately two-stage classification approach two main advantage existing classification approach first use different datasets train b-scan volume-level classifier since grading b-scan level much involved volume-level new scan labeled rather fast already existing labeling strategy allows adapt unseen scan noise pattern different oct scanner type rather easily leveraging transfer learning smaller amount newly graded b-scans addition progress image classification focused image easier train implemented computational cost also mean easily interchange architecture pretrained model depending availability progress field classification second simultaneously receive b-scan-level explainability volume classification based b-scan classification indicates b-scans disease label likely identified used combination uncertainty estimate decide guide clinician review specific region oct volume deemed especially relevant volume-level staging chose focus classification representative biomarkers correspond main stage amd particular consider scan form drusen see definition absence late-stage biomarkers early/intermediate stage scan visible intraretinal cystoid fluid subretinal fluid considered active namd wet amd i.e mnv identify onset stage amd i.e visible smaller atrophic lesion i.e complete rpe outer retinal atrophy crora least micrometer diameter although presence biomarker one b-scan could imply volume-wide label approach error-prone real-world data particular biomarkers sparsely spread volume b-scans considered missed observed supplementary fig different number b-scan prediction volume used predict stage whole volume even cleaned test set bad quality scan approach show highly volatile performance respect number b-scans chosen study several limitation used datasets acquired variant topcon oct scanner hence trained model may generalize popular device e.g cirrus spectralis nevertheless show good generalization bioptigen device expected perform similarly scan signal-to-noise ratio although bioptigen device differs quite substantially resolution see validation section detail point overall appearance b-scan slide similar topcon compared e.g heidelberg spectralis device partly due comparable light source characteristic half-bandwidth 53.7 vs. wavelength vs. lack b-scan averaging general ensure wider generalizability domain shift adaptation approach pursued another limitation restricted focus datasets amd patient determined ehr lower probability presence non-amd biomarkers although trained detect disease biomarkers negative normal classification label combination absence positive mnv drusen prediction also indicate presence diseased oct scan general population cohort beyond amd approach araújo out-of-distribution ood detection could possible mitigation aspect disease screening general population strong limitation application grouping patient level amd non-amd ehrs quite effective even unstructured health record however result ukbb reflect strength caveat population-biased training machine learning model although trained detect mnv secondary amd classifier able detect fluid atrophy exposed screening population beyond eye amd promising application work retrospective detection onset stage use acquired label volume level automatically label longitudinal oct datasets early/intermediate late stage disease observing appearance biomarkers time allows use onset drusen characterize early/intermediate stage late stage reached either development fluid atrophy patient typically convert late stage either fluid first atrophy first visible oct hence patient convert late stage via fluid presence start considered namd wet amd case even fluid present later due treatment anti-vegf injection contrast patient develops atrophy early/intermediate stage considered stage possible onset fluid thus make use volume label provide expert grader timeline supplementary fig indicate likely conversion point normal early/intermediate late leading efficient grading detection onset two main late amd stage longitudinal oct data moc uncertainty prediction used setting extract especially challenging interesting case although usage uncertainty fall domain data engineering part grading seen first step test computed moc evaluate application real-world screening setting assist retinal specialist clinician daily routine judge quality result presented potential general screening algorithm thus seen blueprint general cleaning grading pipeline real-world data analysis medical image data help leverage unused potential large retrospective datasets