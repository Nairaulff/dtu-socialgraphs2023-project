introduction flood one destructive frequent extreme event exist 2.6 billion people affected flood accounting people exposed weather-related disaster large portion exposed people live low-to-middle income country effect flood sometimes followed food security crisis according tellman population affected flood grew 58-96 million frequency magnitude flood event also increased climate change projection indicate trend continue two striking flooding event hit pakistan australia cataloged high-return event worst country century australia heavy rainfall episode february march april broke historical record several main city eastern part country thousand house business flooded estimated cost claim 1.83 billion usd persistent heavy rainfall throughout remainder led extreme flooding event october affecting queensland nsw tasmania pakistan two month heavy monsoonal rain affected million people caused serious food security issue due cropland loss estimated flood impact cost 14.9 billion usd damage 15.2 billion economic loss flood extent map derived satellite image key understanding magnitude flooding event well quantifying mitigating damage first stage flood extent map used planning assisting emergency response terrain second stage map used flood damage assessment intersecting high resolution geographical layer nowadays proliferation free global high resolution map product flood damage assessment carried automatically many location worldwide however current approach operational flood extent mapping damage assessment global scale present several limitation firstly order cover large area typically low medium resolution product 100\ used produce flood extent map instance tellman estimated population exposure flooding using modis product spatial resolution urban area high population density may lead imprecise estimate another example flood extent map released unosat flood event pakistan generated using viirs data also used derive statistic affected population post-flood damage figure vector-format flood extent map generated pipeline australia pakistan case study left right figure depict entire area interest consideration section flood map closer view city-size region city lismore queensland australia sukkur sindh province pakistan showcase precise resolution generated flood map map produced using quantum qgis full size image imagery sentinel landsat constellation potentially used accurate global flood extent mapping since much higher spatial resolution respectively also high revisit frequency 2â€“4 day depending geographic location additionally flood extent map based cloud-free optical imagery e.g sentinel-2 accurate based synthetic aperture radar sar sentinel-1 inherently sar data flood mapping face challenge speckle noise interference inconsistency wind-driven capillary wave distortion layover shadow effect due side-looking geometry terrain-induced artifact variation polarization effect particular accurately detecting floodwater becomes greater challenge urban environment area covered dense forest canopy scenario floodwater segmentation optical imagery complex tends yield successful outcome however several limitation hamper use data optical sensor operational pipeline first cloud frequent peak-flood post-flooding imagery worldfloods dataset approximately pixel marked cloudy first available sentinel-2 revisit average 1.3 day date flood event thus order exploit partially cloudy revisits flood detection algorithm able operate presence cloud optimally distinguish thin semitransparent cloud surface still observed opaque thick one secondly method applied automatically large scale flood event based spectral index exploit spectral property water body method widely studied used remote sensing community produce significant amount false positive dark surface situation high sun zenith angle dark soil terrain shadow cloud shadow additionally method reported underperform water suspended debris pollutant frequent flooding episode properly capture flood trace i.e non-flooded area acquired satellite image inundated peak event thirdly potentially accurate solution based machine learning lack comprehensive datasets training detection model validated flooding episode limited number different geography addition given complex nature model open-source final trained model available operational application intercomparison difficult work address limitation demonstrating end-to-end flood mapping system produce flood extent map sentinel-2 landsat-8/9 optical imagery without human intervention pipeline new cloud-aware flood segmentation model produce independent cloud water mask able detect flood water semitransparent cloud model carefully validated manually labeled dataset globally distributed flood event order demonstrate capability system large scale flood extent mapping run proposed pipeline extreme flooding event australia pakistan fig produce vectorized flood extent map covering total area 475,000 ^2\ 165,000 ^2\ respectively afterward derive flood damage map metric intersecting flood extent map global high-resolution product population density building crop publish dataset code accessible ml4floods http comprehensive python package cover data ingestion processing model training evaluation inference necessary tool post-process result derive vectorized flood product result flood mapping damage assessment large flooding event pakistan flood pakistan monsoon season started late june lasted late september period several episode prolonged torrential rain occurred resulting rainfall almost three time higher national 30-year average 130.8 fact preceded period prolonged drought resulted one catastrophic event country ever experienced reason great effort map extent event develop new framework quantify consequence ran flood segmentation method imagery acquired sentinel-2 landsat l8/l9 produce vectorized flood extent map pre-flood post-flood water polygon create map defined region interest covering indus river basin split region grid square tile ^2\ tile downloaded pre-event image 16th may 6th june post-event cloud-free image 25th august 10th september total processed sentinel-2 image landsat image corresponding data acquired area 165,000 ^2\ figure vector flood product pakistan flood false color composite sentinel-2 multispectral band b11 produced image early june pre-event composite early august post-event composite considered area interest cover area 165,000 ^2\ total sentinel-2 landsat imagery used produce flood product map produced using quantum qgis full size image run segmentation model downloaded image producing per-pixel map raster mask three class water cloud land process vectorize water cloud mask aggregate vector flood map time mosaic temporal aggregation first obtain pre-event permanent water pre-event map afterward derive post-event product merging time series post-event map obtained grid tile resulting maximal flood extent product obtaining flood extent product individual grid tile perform spatial merge tile obtain complete flood map finally subtract pre-event product post-event flood map resulting final flood inundation product distinguishes pre-flood post-flood water figure show pre- post-event mosaic sentinel-2 imagery final flood map although extremely large spatial extent final flood map produced multispectral image 10m 30m resolution allowing flood damage assessment fine spatial scale damage quantification compute affected population damaged infrastructure area cropland lost estimating damaged infrastructure use microsoft building footprint provides worldwide building delineation derived high-resolution maxar image cropland impact assessment vectorize esa land cover map affected population use high resolution settlement layer hrsl figure show example pre- post-flood sentinel-2 image intersection flood map layer top row show pre-flood 27th june post-flood 31st august image covering city larkana one largest pakistan intersection flood extent map building layer top-right panel ^2\ tile estimated total area ^2\ covered flood water total mapped area potentially affecting 36,000 building nevertheless many city building shown green marked flooded according hrsl estimated direct number people affected scene roughly 240,000 second row fig show result analysis one grid tile mostly covered cropland near city layyah right show intersection cropland flood extent product analysis reveals significant amount water overtopped indus river bank inundated crop covering floodplain total estimated area ^2\ cropland affected flood water scene figure example intersection flood product selected land-cover building delineation product top row examine larkana major city sindh province estimation 36,000 building approximately 240,000 people potentially affected flood within grid tile bottom row focus shift agricultural area near layyah located punjab region grid tile intersection indicates estimated ^2\ potentially damaged cropland full size image conducted analysis tile ^2\ encompass mapped region indus basin figure provides overview flooded area affected building flooded cropland affected population province sindh emerged severely affected area primarily due high population density extensive cropland consequently suffered greatest loss term cropland affected population building additionally substantial amount floodwater observed balochistan near sindh border however region lower population density resulting comparatively lesser estimated damage finally province punjab located top-east region also experienced significant impact analysis suggests estimated total area approximately 54,300 ^2\ covered floodwater encompassing approximately 28,700 ^2\ cropland flood event estimated impacted around 10.8 million individual roughly 656,000 building potentially affected flooding provide comparative perspective intersected building cropland population data flood map released unosat generated using viirs spatial resolution 375m analysis revealed 43,300 ^2\ potentially covered flood water 25,700 ^2\ would cropland moreover flood event estimated impact approximately 10.0 million people potential damage total around 673,000 building statistic obtained flood product exhibit consistency thus supporting reliability method figure local estimation damage indus basin total grid cell ^2\ left right show per cell estimation area water detected number affected building area flooded cropland affected population count full size image australian flood eastern part australia affected persistent heavy rainfall successive extreme weather event broke many historical record instance two month february april equivalent one year average rainfall occurred new south wale nsw region queensland official source counted ten thousand displaced people around twenty thousand flooded home deployed flood mapping system generate maximum-extent water map covering 450,000 ^2\ sampled processing tile 25\ side total area interest includes part southeast queensland eastern nsw eastern victoria illustrated top-left panel fig time-range interest spanned february 26th march 30th encompassing several successive rainfall event total 14,681 sentinel-2 image landsat-8 image curated produce final flood map followed identical procedure described previously generate pre- post-flood map estimated approximately 27,000 ^2\ likely inundated intersecting derived product bing microsoft building map found 125,00 building potentially affected event significant impact area near brisbane queensland machine learning based flood extent segmentation flood extent delineation multispectral satellite image tackled work binary semantic segmentation task want classify pixel image land water either flood water permanent water basic remote sensing technique using optical data detect water relied spectral index normalized difference vegetation index ndvi inclusion thermal infrared band modis landsat mission specific water detection index designed e.g normalized difference water index ndwi modified version mndwi short-wave infrared swir band substantially improve water detection index fast easy compute one obtain binary segmentation mask applying threshold deep learning method convolutional neural network cnns fully convolutional neural network fcnns shown superior performance task semantic segmentation remote sensing image problem land-use classification cloud detection also flood water detection contrarily classical spectral method method excel discerning intricate structure pattern unique water multi-dimensional often low-level feature space concretely fcnns exploit spectral spatial dimension satellite image learning pattern huge catalog data however training process deep learning method requires huge amount labeled data i.e annotated reference mask fed network learn relevant feature best mapping classify water problematic limitation since labeling satellite image time-consuming requires significant expertise especially distinguish water body mixed cloud cloud shadow frequent flood event currently labeled datasets flood extent segmentation publicly available one hand sen1floods11 dataset consists patch sentinel-1 sentinel-2 manually labeled ground-truth mask well automatically labeled patch extracted flood event hand worldfloods dataset contains co-located pair sentinel-2 image reference flood extent mask flood event occurred resulting approximately 180,000 patch size result harmonizing flood extent product generated emergency response organization copernicus emergency management service cems unosat glofmir service activated cover flood event size dataset allows training large deep learning model however drawback limited size test set hamper evaluation trained model low quality several flood map training split figure multioutput binary model training inference flowchart 2-layer reference mask corresponding cloud/clear land/water problem fed train segmentation model best case unet++ input feature sentinel-2 image patch number channel image model trained produce output two layer one give per-pixel probability cloud another give per-pixel probability water brightness reflectance input image computed norm visible band model output probability brightness combined according prediction rule yield final flattened three-class segmentation mask full size image work build framework i.e data pipeline dataset model deployment platform applied operationally produce flood extent map flood event location world order build globally diverse dataset improved extended worldfloods dataset firstly incorporated flood event occurred secondly filtered low-quality flood map mostly covered cloud presented significant labeling error thirdly manually curated map using labeling tool specifically developed work finally created new validation test set high spatial variability ensure robust model selection evaluation resulting dataset 13-band sentinel-2 level patch co-located corresponding reference mask different flood event total split data tile pixel get approximately 75,000 sub-images pair see fig detail regarding presence cloud usually frequent peak-flood post-flood imagery thick cloud force discard many observation thin cloud one main source classification error increased uncertainty predicted water mask previous work developed model landsat forced predict presence absence water underneath cloud adopted similar strategy albeit conservative reference label generation instead one layer containing three mutually exclusive class land water cloud generated two independent binary reference mask one clear/cloud problem another land/water problem two separate overlapped problem multioutput model trained confidently distinguish many type cloud e.g thick cloud semitransparent cloud time confident predicting land/water case cloud permit partially see ground allows model output maximum amount information user decide cloud conservative moreover creating separate binary mask cloud instead grouping non-water class make learning easier previous study allows one take advantage newly developed cloud detection algorithm significantly increased cloud detection accuracy also included label generation process small water stream cems flood map included first version dataset figure show top training procedure two-layer binary mask used train multioutput segmentation model segmentation model multioutput layer trained see method section training detail image arbitrary size fed output cloud water probability size afterward produce three-class segmentation mask combining water cloud probability brightness computed visible band according prediction rule detailed fig brightness threshold included distinguish bright cloud assume surface observed thin cloud set threshold th_ experimentally 0.35 threshold applied output probability classify pixel cloud water th_ cloud th_ water respectively set 0.5 default possible tune according user requirement depending application user might need cloud water conservative order let user make informed decision threshold fig show precision-recall curve illustrates trade-off changing water probability threshold seen default threshold 0.5 multioutput model high recall good order detect flooded area however threshold resulted highest intersection union iou value evaluation dataset 0.7 meaning changing threshold towards restrictive value result better balance task important commit false positive comparison original multiclass model room tuning prediction changing threshold mndwi would produce high rate false positive false negative global validation proposed model showcasing model australia pakistan flood validated model novel benchmarking dataset satisfies required condition robust evaluation composed flood map flood event occurred wide variety location biome world i.e global dataset see fig manually curated ensure trust evaluation result show evaluation result five model baseline use mndwi band b11 sentinel-2 additionally also consider linear model second strong baseline proposed clouds-aware operational segmentation model modified unet architecture call unet multioutput sentinel-2 input produce segmentation mask main advantage multioutput model produce two independent binary mask one cloudy/clear pixel another water segmentation mask additionally refer unet s2-to-l8 modified version trained sentinel-2 visible band nir band swir band resulting model also applied landsat image finally compare model unet multiclass originally proposed ref produce segmentation mask three mutually exclusive class land water cloud regard evaluation metric considered recall precision iou water class three common segmentation metric highlight possible error committed binary segmentation value computed flood event report mean value across flood test dataset see performance metric fig comparison generalization model detecting flood water calculated iou water class stratified land cover class according esa land cover fig also analyze thin cloud class generated combining cloud label reference mask brightness threshold 0.3 refer reader method section supplementary material detail evaluation metric dataset model training strategy figure performance metric obtained evaluation set 0.5 threshold water probability output unet model 0.0 threshold mndwi output precision-recall curve best model mndwi default threshold mndwi mean iou class water flood stratified per land cover type according esa land cover class percentage class dataset indicated minority non existent class mangrove snow ice moss lichen removed full size image mndwi shown strong baseline produce fairly good result term accuracy taking account applied general threshold flood event however experiment deep learning segmentation model outperform mndwi result term considered metric multioutput model higher iou multiclass model detecting flood water arguably hardest important task apart metric output layer model highly configurable tuned yield model restrictive prediction term water detection provide evidence advantage using model fig supplementary fig regarding stratification land cover type observe overall good performance model majority class lower performance built-up forest area due high spectral mixing exists area expected detecting flood water becomes challenging result analysis consistent study also reported lower performance built-up forest area among multioutput model unet s2-to-l8 consistently best-performing model also worth mentioning lower variance across different training initialization important band water detection i.e visible nir swir band suspect adding additional sentinel-2 band model add redundant information consequently addressing complexity requires higher-dimensional model turn necessitates larger training set longer training period converge solution become dependent initialization addition quantitative result model also offer huge operational advantage since applied sentinel-2 landsat 8/9 image finally worth mentioning accuracy model without swir band i.e unet multioutput rgbnir doe decrease significantly supplementary fig show prediction model use different band combination figure show prediction generated unet multioutput s2-to-l8 three flood event part global evaluation dataset particular correspond flood finland madagascar australia firstly event finland show cloud-free image acquired peak flood relatively easy case predict model accurately capture water secondly event madagascar show post-flood imagery acquired peak time area covered mud water debris i.e flood trace case model able capture flood water flood trace really useful post-flood damage quantification first satellite overpass coincident flood peak image overly cloudy finally australian evaluation event show moderately-cloudy image plenty flood water type image cloud shadow challenging well case water thin cloud figure multioutput binary model prediction evaluation image top bottom flood event finland madagascar australia meant represent model performance different real-case scenario post-flood imagery variety worldwide location post-flood cloud-free image peak-flood time cloud-free image presence flood trace moderately cloudy image presence flood water covered thin cloud respectively full size image since one biggest advantage model able account discard observation thin cloud zoomed area australian event fig compare prediction generated model type scenario first false color sentinel-2 composite highlight water shown band followed reference segmentation mask prediction generated three main model comparing multiclass unet produce highly accurate prediction cloud-free area top image however predicting three mutually exclusive class result thin cloud classified cloud thus discarding valuable information actually extracted acquired image segmentation mask produced multioutput unet predicts cloud thick cloud doe allow confident detection flooded area showing accurate prediction cloud-free area flooded area semitransparent cloud finally mndwi produce moderately accurate prediction cloud-free area fails region surrounded thin cloud combined land non-water surface figure prediction evaluation flood event australia area presence thin cloud flood water multioutput unet correctly delineates flood extent even presence semitransparent cloud mndwi hampered cloud predicts much flood extent actual one multiclass unet discard lot valuable information predicting cloud thin cloud flood water distinguished full size image extend visual analysis prediction presence thin cloud created additional evaluation set composed worldfloods event contain high percentage transparent cloud water dataset compared iou multiclass multioutput unet fig plot left see event thin cloud model perform similarly event however event abundant semitransparent cloud right plot multioutput model exhibit significantly higher iou multiclass model also see figure performance model scene thin cloud lower shall taken account operational application instance image many thin cloud scene shall validated human expert utilizing produce final flood extent product regardless selected method nevertheless thin cloud represent total amount 4.54 pixel worldfloods dataset see fig compare flood water represents 3.36 dataset considering trade-off proposed model increase amount usable post-flood imagery leading precise flood extent map additionally provide deeper exploration ramification brightness threshold adjustment model predictive capability computed precision-recall curve different value brightness threshold worldfloods test set thin cloud subset result found supplementary fig moreover fig show visual demonstration produced segmentation mask showcasing impact adjusting brightness threshold flood map significant presence thin cloud effect changing brightness threshold minimal test set since example thin cloud comparison thick cloud clear observation however result obtained thin cloud subset seen increasing brightness threshold result lower precision expected increasing threshold cause thick cloudy observation treated thin cloud thus included predicted water mask likely resulting misclassifications experiment flood segmentation empirical evidence running model inference mode previous work cloud segmentation concluded 0.3 reasonable brightness threshold fully exploit available observation without sacrificing precision however one would like mask observation threshold could reduced case output cloud mask would completely determined output cloud segmentation model figure comparison model image thin cloud compare iou obtained multiclass multioutput model two evaluation set one thin cloud left another higher presence thin cloud right full size image discussion work presented end-to-end pipeline flood extent mapping multispectral satellite image used operationally location world presented detailed validation robustness global applicability manually labeled data set composed flood event occurred wide variety location biome one differentiating factor proposal deal presence thick semitransparent cloud frequent post-flood imagery previous work exclude partially cloudy image training inference step view several drawback firstly recent work found training deep learning model cloud free imagery cause severe misclassification problem secondly excluding cloudy image lead under-exploitation available information critical emergency response scenario proposed methodology also configurable tuned depending need available imagery instance conservative estimation water extent needed brightness threshold adjusted discard area covered semitransparent cloud see supplementary fig additionally due temporal misalignment exists sample dataset model detect also flood trace area inundated current scene past useful scenario limited post-event data needed flood trace discarded adjusting water threshold see curve fig combining output mndwi proposed model trained different band combination applied sentinel-2 also landsat result output product spatial resolution 10m 30m much higher resolution utilized large scale flood mapping work e.g ref use modis viirs data also interoperability increase temporal cadence image allowing image almost daily key monitoring evolution flood also enable detection short-time event might undetected larger temporal revisits tested methodology two large-scale flood event occurred australia pakistan pakistan derived statistic consistent analysis carried flood map released unosat produced viirs imagery resolution although result encouraging validation required process deriving metric flood impact particular several uncertainty affect estimate affected population one hand land cover classification urban area challenging even optical satellite due heterogeneity background flood extent delineation problem exception hand estimate flood exposure present high discrepancy depending population density data used foresee two main direction future work firstly utilizing proposed pipeline impact past flood event re-quantified helpful instance study flood-induced migration well flood exposure secondly incorporating data different modality e.g sar dem could increase coverage area persistent cloud coverage following line easy extension would add simultaneous sentinel-1 imagery database expansion could enable development new strategy overcome limitation posed cloudy optical scene maintaining accuracy model cloud-free scenario another limitation tackled slightly worse performance model working rgbnir band enable applicability model commercial satellite lack swir band increase turn availability post-flood imagery shown several work swir information crucial accurate water detection already preliminary work aiming mitigate downside tested commercial satellite imagery planet method architecture model training updated version worldfloods dataset validation test data split carried hand-picked example evenly cover worldwide location biome training set composed pair sentinel-2 image reference mask flood map however pay careful attention avoid data leakage excluding training flood map event represented test validation set instance one flood event represented test split emsr342 according copernicus code two flood map corresponding flood event 06northnormanton 07southnorthnormanton included test set therefore excluded training process rest flood map emergency activation figure statistic extended worldfloods dataset used train model location flood event included extended worldfloods dataset color code correspond associated data split training validating model full size image training dataset includes data flood map different flood event see fig flood map split patch pixel train model training epoch loop randomly patch total around 65,000 image patch training dataset trained model using different band combination input unet multioutput trained band sentinel-2 unet s2-to-l8 trained using rgb nir swir band sentinel-2 band total allows using model landsat image finally also trained model using rgb nir band input respect data augmentation used common nondestructive transformation flip 90-degree rotation model produce output two image water probability cloud probability see fig model trained minimize average binary cross-entropy loss pixel problem water/land cloud/clear final loss weight water/land problem higher 0.8 cloud/clear 0.2 dataset strong class imbalance land much frequent cloud water accounted weighting pixel binary-cross entropy loss water/land problem inverse frequency water class fig allows obtain high recall model especially class water relevant flood detection finally learning rate set scheduled reduction two epoch also implemented early stopping epoch improvement validation loss order avoid overfitting necessary code reproduce training implemented python package ml4floods available http metric calculation order evaluate model performance considered precision recall intersection union iou three common metric semantic segmentation problem defined based possible error committed binary segmentation problem true positive water pixel correctly classified water true negative non-water pixel correctly classified non-water region false positive non-water pixel incorrectly classified water false negative water pixel incorrectly classified non-water precision measure percentage pixel actually water contrast recall measure percentage captured model finally iou trade-off precision recall aligned precision tp+fp aligned aligned recall tp+fn aligned aligned iou tp+fp+tn aligned compute metric flood map test validation dataset masking invalid pixel bright cloud pixel labeled cloud brightness 0.3 since surface information case totally blocked figure supplementary table report metric calculated water class evaluation dataset duplicate publication statement preliminary result work presented agu fall meeting esa living planet symposium conference conference proceeding accepted abstract published