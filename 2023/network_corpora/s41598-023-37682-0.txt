introduction functional anatomical connection human brain form complex network link infrastructure mind understanding connectomes potential provide insight effect neurological disease used better inform targeted intervention treatment strategy particular functional connectome shed new light onto psychiatric neurological condition schizophrenia autism spectrum disorder asd two condition alter brain function healthy neurotypical control popular approach used investigate brain function functional magnetic resonance imaging fmri non-invasive neuroimaging technique measure blood-oxygenation-level-dependent bold signal time correlate brain activity fmri image complex spatio-temporal picture brain voxels volumetric pixel describing spatial location time series voxel describing bold signal reduce spatial complexity voxels collated user-specified region interest roi functional connectomes investigated pearson correlation matrix roi known functional connectivity matrix one approach investigating functional connectivity using partial least square pls regression method introduced wold use chemometrics pls extension multivariate multiple regression high-dimensional data predicts response data set lower-dimensional latent variable unobserved variable constructed predictor data popularised fmri mcintosh pls used explore relationship fmri data either behavioural data experimental design seed region activation however standard pls ignores structure functional connectivity data—functional connectivity matrix correlation matrix hence positive definite non-negative eigenvalue ignoring positive definite criterion standard pls functional connectivity data potential ignore intricate non-linearities data provide invalid prediction model given number roi space r\times symmetric positive definite matrices—which includes functional connectivity matrices—forms convex cone r+1 -dimensional euclidean space form shape much like ice-cream cone high dimensional euclidean space singularity origin however considered affine invariant geometry space symmetric positive definite matrix becomes complete riemannian manifold—a general mathematical space perform calculus—with non-positive curvature curve interesting complex way considering non-linear geometry symmetric positive definite matrix glean interesting new insight functional connectivity see pennec citation therein process generalising statistical model riemannian manifold potential investigate non-linearities data gaining significant interest neuroimaging recent year fletcher proposed principal geodesic analysis generalisation principal component analysis riemannian manifold application shape analysis medically-defined anatomical shape later fletcher generalised simple linear regression riemannian manifold called geodesic regression investigate medically-defined anatomical shape change age following vein research kim generalised canonical correlation analysis riemannian manifold explore multi-modal imaging relationship diffusion tensor image structural mri alzheimer patient however pls closely related method yet generalised riemannian manifold propose extension pls model allow riemannian manifold response predictor data call riemannian partial least square r-pls r-pls model allows predict functional connectivity data accounting intricate relationship enforced positive definite criterion fit r-pls model propose tangent non-linear iterative partial least square tnipals algorithm related previously proposed application pls functional connectivity data literature determine optimal number latent variable using cross validation aid interpretability high-dimensional functional connectivity data determine significant functional connection identified r-pls using permutation test variable importance projection vip statistic popular measure variable importance standard pls apply r-pls two datasets two different roi atlas demonstrate versatility predicting phenotype data functional connectivity first cobre dataset investigates difference functional connectivity healthy control n=74\ patient schizophrenia n=72\ consider two separate atlas cobre dataset test generalisability r-pls across atlas multi-subject dictionary learning msdl atlas look low-dimensional roi data-driven atlas well automated anatomic labelling aal atlas higher-dimensional roi anatomical atlas second dataset abide dataset new york university imaging site investigates difference functional connectivity typical healthy control n=98\ subject asd n=75\ consider abide data aal atlas investigate generalisability r-pls across datasets thus predicting using msdl atlas considering unique functional connection since r=39\ predicting using aal atlas considering unique functional connection since 116\ result dataset atlas predict multivariate phenotype information age group cobre dataset well sex eye status abide functional connectivity data using r-pls model categorical variable group sex eye status represented binary value phenotype information standardised mean zero standard deviation one analysing functional connectivity matrix aal atlas one matrix cobre dataset matrix abide dataset low-rank hence positive definite deal low-rank functional connectivity matrix consider regularised functional connectivity matrix following venkatesh 116\times 116\ identity matrix compare r-pls standard pls model using upper triangle functional connectivity matrix predictor raw correlation well fisher transformed value fisher correlation model fitting determine optimal number latent variable pls model ten-fold cross validation using within one standard error rule minimising root mean square error rmse multivariate phenotype information due interest cobre abide datasets investigating difference healthy control patient also present group classification metric accuracy sensitivity specificity area operator receiver curve auc since represented group binary value classify subject patient group schizophrenia asd predicted group score greater zero control group otherwise graph cross validation result found supplementary material fig cobre dataset msdl atlas ten-fold cross validation showed latent variable parsimonious within one standard error minimum rmse k=3\ compared euclidean pls using raw fisher-transformed correlation r-pls outperformed method across metric except specificity group prediction table however three method produced similar result every metric table mean 10-fold cross validation result riemannian partial least square r-pls cobre abide datasets euclidean pls using raw fisher transformed correlation full size table considering cobre dataset aal atlas ten-fold cross validation showed latent variable parsimonious within one standard error minimum rmse k=3\ similar result msdl atlas found r-pls outperformed euclidean pls method across metric although inclusion group specificity table using aal atlas cobre dataset observe substantial increase cross validated r^2\ value euclidean method abide dataset ten-fold cross validation found latent variable parsimonious within one standard error minimum rmse k=6\ compared euclidean pls using raw fisher-transformed correlation r-pls outperformed method across metric except specificity group classification table particular r^2\ value auc r-pls substantially larger euclidean method interpretation investigate functional connectomes associated phenotype variable consider regression coefficient matrix pls see method section column represents effect functional connectivity matrix response variable age group sex eye status much like regression coefficient ordinary least square coefficient matrix pls capture multivariate association functional connectivity phenotype data determine functional connection significantly associated phenotype variable permutation test vip statistic method section using permutation significance level =0.05\ described method section analysis performed using visualise column matrix pls symmetric matrix tangent space fréchet mean dataset represent connectomes standard brain image using nilearn package python assist visualising pattern regression coefficient across connectome average coefficient value across connection within predefined resting state network similar wong within-network connectivity average coefficient connection within single resting state network between-network connectivity average coefficient connection two resting state network msdl atlas involves reducing roi resting state network associated atlas aal atlas associate roi seven resting-state network suggested parente colosimo eighth containing cerebellum vermis call cerebellum network resting state network msdl aal atlas visualised supplementary material msdl fig aal fig s10 cobre dataset msdl atlas permutation test vip statistic permutation found significant functional connection roi predictive age subject group fig considered aal atlas permutation test vip statistic permutation found significant functional connection roi predictive age subject group fig abide dataset permutation test vip statistic permutation found significant functional connection roi predictive age subject group sex eye status fig figure significant regression coefficient predicting age schizophrenia measured variable importance projection vip riemannian partial least square r-pls model cobre dataset multi-subject dictionary learning msdl atlas latent variable visualised connectomes symmetric matrix blue value represent connection positively associated phenotype increase connectivity two region blue edge would indicate increase phenotype variable conversely red value connection negatively associated phenotype increase connectivity two region red edge would indicate decrease phenotype variable show connection increase age show connection decrease age show average coefficient value age resting state network msdl atlas fig show connection increase patient schizophrenia show connection decrease patient schizophrenia show average coefficient value schizophrenia resting state network msdl atlas fig darker outlined box show top 25\ influential region measured absolute coefficient value within network network abbreviation aud auditory striate striate dmn default model network occ post occipital posterior motor motor network att right ventral attention network basal basal ganglion att left ventral attention network att dorsal attention network sec secondary visual cortex salience salience network temporal temporal network language language network cereb cerebellum dors pcc dorsal posterior cingulate cortex cing-ins cingulate-insula network ant anterior intraparietal sulcus full size image figure significant regression coefficient predicting age schizophrenia measured variable importance projection vip riemannian partial least square r-pls model cobre dataset automated anatomic labelling aal atlas latent variable visualised connectomes symmetric matrix blue value represent connection positively associated phenotype increase connectivity two region blue edge would indicate increase phenotype variable conversely red value connection negatively associated phenotype increase connectivity two region red edge would indicate decrease phenotype variable show connection increase age show connection decrease age show average coefficient value age resting state network identified parente colosimo cerebellum fig s10 show connection increase patient schizophrenia show connection decrease patient schizophrenia show average coefficient value schizophrenia resting state network identified parente colosimo cerebellum fig s10 darker outlined box show top 25\ influential region measured absolute coefficient value within network dmn default mode network full size image across atlas cobre dataset increase subject age tended towards decrease within-network connectivity measured mean decrease functional connectivity within-networks particular emphasis auditory network cingulate insula left right ventral attention network msdl atlas temporo-parietal limbic basal ganglion network aal atlas fig a–c increased age associated increase between-network connectivity particularly msdl atlas show increased connectivity involving cingulate insula motor network notably increase age associated decrease between-network connectivity basal ganglion aal atlas msdl atlas abide dataset increased age associated increased decreased functional connectivity within resting-state network fig a–c although observed increased between-network connectivity thalamus occipital network cerebellum default mode network exhibited decreased between-network connectivity age note decreased within-network connectivity basal ganglion age also present abide dataset subject schizophrenic group basal ganglion exhibited increased decreased connectivity network across atlas fig d–f particular msdl atlas decrease connectivity basal ganglion cerebellum salience network whereas observed increase connectivity basal ganglion auditory language network schizophrenic group aal atlas similarly demonstrates reduced connectivity basal ganglion cerebellum show reduced connectivity basal ganglion fronto-parietal network contrast analysis msdl atlas using aal atlas suggest increase connectivity basal ganglion default mode network schizophrenic subject atlas default mode network highly discriminatory schizophrenic group showing increased decreased between-network connectivity finally note aal atlas highlight connectivity thalamus highly discriminatory schizophrenic group represented msdl atlas since thalamus roi figure significant regression coefficient predicting age autism spectrum disorder asd measured variable importance projection vip riemannian partial least square r-pls model abide dataset automated anatomic labelling aal atlas latent variable visualised connectomes symmetric matrix blue value represent connection positively associated phenotype increase connectivity two region blue edge would indicate increase phenotype variable conversely red value connection negatively associated phenotype increase connectivity two region red edge would indicate decrease phenotype variable show connection increase age show connection decrease age show average coefficient value age resting state network identified parente colosimo cerebellum fig s10 show connection increase patient asd show connection decrease patient asd show average coefficient value asd resting state network identified parente colosimo cerebellum fig s10 darker outlined box show top 25\ influential region measured absolute coefficient value within network dmn default mode network full size image figure significant regression coefficient predicting sex eye status measured variable importance projection vip riemannian partial least square r-pls model abide dataset automated anatomic labelling aal atlas latent variable visualised connectomes symmetric matrix blue value represent connection positively associated phenotype increase connectivity two region blue edge would indicate increase phenotype variable conversely red value connection negatively associated phenotype increase connectivity two region red edge would indicate decrease phenotype variable show connection increase male show connection decrease male show average coefficient value male resting state network identified parente colosimo cerebellum fig s10 show connection increase patient eye open show connection decrease patient eye open show average coefficient value eye open group resting state network identified parente colosimo cerebellum fig s10 darker outlined box show top 25\ influential region measured absolute coefficient value within network dmn default mode network full size image subject asd observed increased within-network connectivity exception limbic network fig d–f also observed decreased between-network connectivity particularly connection involving cerebellum limbic network observed similar connectivity pattern subject sex fig a–c subject eye closed model suggests decreased within-network connectivity fig d–f exception default mode network limbic network basal ganglion saw decreased between-network connectivity particular emphasis occipital network discussion r-pls model identified many functional connection associated age asd schizophrenia sex eye status well represented literature across datasets atlas identified reduction within-network connectivity age previously observed exception temporo-parietal fronto-parietal limbic network abide dataset salience network cobre dataset show increase connectivity age datasets exhibit decreased connectivity within default mode network consistent existing literature also note previously observed decrease within-network connectivity basal ganglion prominent aal atlas msdl atlas one region interest basal ganglion msdl atlas within-network connectivity defined subject asd decreased connectivity cerebellum limbic network previously observed however decreased between-network connectivity suggested r-pls contradiction existing literature particular wong showed increase between-network connectivity associated asd full abide dataset using logistic regression also observe connectivity subject sex highly correlated connectivity asd group although interaction subject sex asd identified believe highlight possible limitation r-pls requires investigation future research role basal ganglion schizophrenic patient previously observed particularly decrease connectivity salience network basal ganglion decreased connectivity cerebellum basal ganglion similarly importance thalamus schizophrenia identified using aal atlas well-known connectivity pattern involving default mode network previously reported schizophrenic patient result eye status scan also well represented literature decreased within-network connectivity default mode network patient closed eye previously reported yan increased between-network connectivity default mode network recently discussed han observed decrease connectivity occipital network agrees agcaoglu use vip statistic identify significant connection functional connectivity previously studied demonstrated statistic identify many functional connection addressed previously literature without limitation first focus generalising partial least square riemannian manifold vip statistic doe take account riemannian geometry considering mitigated tangent space approximation performing directly account geometry data research could help better generalise vip statistic r-pls vip statistic associate effect single predictor full multivariate response situation like consider make difficult determine functional connection associated outcome variable example connectivity within default mode network deemed significant vip statistic abide dataset unclear whether connectivity significance every outcome variable subset work done generalise vip statistic outcome variable multivariate research needed investigate generalisation r-pls method shown generalisable different atlas datasets notable difference analysing cobre dataset observe similar result functional connectivity age subject group due different granularity msdl aal atlas roi msdl aal able find relationship example relationship within-network connectivity basal ganglion age role thalamus schizophrenia comparing aal atlas across cobre abide datasets find r-pls still preferred model euclidean method looking relationship functional connectivity age across datasets see similarity result difference explained different age considered cohort mean age cobre year old mean age abide 15.2 year old table however work needed verify r-pls clinical context first able investigate test-retest reliability method due cross-sectional nature cobre abide study thorough study test-retest reliability r-pls would invaluable method would increase versatility clinical study second investigated effect different preprocessing choice fmri data would beneficial generalisability result r-pls determine robust across preprocessing choice different preprocessing pipeline abide study offer one avenue investigate clear area future research result suggest r-pls provide insight functional connectome relates subject phenotype data due specification generality r-pls model method readily applicable imaging modality particular multimodal imaging study application r-pls multimodal imaging study area future research may help understand functional network make human connectome method data international neuroimaging data-sharing initiative indi initiative set encourage free open access neuroimaging datasets around world consider two datasets accessible part indi cobre center biomedical research excellence cobre contributed structural functional mri image indi compare schizophrenic patient healthy control data collected single-shot full -space echo-planar imaging matrix size 64\times 64\ slice giving voxel size 3\times 3\times ^3\ data downloaded using python package nilearn 0.6.2 contains subject control 74\ phenotype information subject group age information available table supplementary material fmri data preprocessed using niak 0.17 centos version 6.3 octave version 4.0.2 minc toolkit version 0.3.18 data subjected band pas filtering nuisance regression removed six motion parameter frame-wise displacement five slow-drift parameter average parameter white matter lateral ventricle global signal well estimate component based noise correction cobre dataset consider fmri msdl atlas aal atlas msdl atlas functional roi decomposition node across resting state network aal atlas anatomical atlas node across brain time series atlas extracted roi taking mean time series across voxels region abide autism brain imaging data exchange abide part preprocessed connectomes project indi abide data collection preprocessed fmri image international imaging site individual diagnosed asd neurotypical control ntc abide initiative provides data preprocessed four separate standard pipeline well option band-pass filtering global signal regression consider subject ntc new york university imaging site restrict site reduce inter-site variation imaging largest individual imaging site data collected tesla allegra mri using echo-planar imaging matrix size 64\times 64\ slice giving voxel size 3\times 3\times ^3\ fmri data downloaded using python package nilearn 0.6.2 preprocessed using niak 0.7.1 pipeline data subjected motion realignment non-uniformity correction using median volume motion scrubbing nuisance regression removed first principal component motion parameter square mean white matter cerebrospinal fluid signal low frequency drift measured discrete cosine basis 0.01 high-pass cut-off band-pass filtering global signal regression consider subject preprocessed fmri well subject group age sex eye status scan open closed information available table supplementary material abide dataset consider fmri aal atlas time series extracted taking mean time series across voxels roi partial least square euclidean space pls predictive modelling technique predicts response matrix set predictor originally introduced chemometrics literature wold pls found application bioinformatics social science neuroimaging see rosipal krämer citation therein example extension multivariate multiple regression pls shown better predictive accuracy multivariate multiple regression standard regression assumption met advantage pls effective since performs prediction lower dimensional latent variable pls construct new set predictor variable predict let predictor response matrix respectively suppose column centred suppose mean column pls proposes existence latent variable decompose set score matrix n\times loading matrix p\times q\times aligned aligned aligned aligned n\times error matrix assumed small possible superscript denotes matrix transpose pls assumes diagonal matrix aligned n\times aligned matrix residual equation called outer relationship defines inner relationship connects combining inner relationship outer relationship give aligned aligned highlight regression latent score notice error given error combination error inherent response data error estimation inner relationship ^t\ inclusion residual matrix complicate discussion pls method common consider estimated inner relationship instead estimation pls model commonly done non-linear iterative partial least square nipals algorithm algorithm supplementary material input nipals algorithm data matrix pre-specified number latent variable noting true number latent variable unknown value chosen method cross validation nipals algorithm output estimate score loading regression coefficient well matrix p\times q\times known weight weight matrix linear transformation efficiently fit pls model defined within nipals algorithm see supplementary material information using result nipals algorithm write aligned pls aligned aligned pls aligned matrix regression coefficient using pls see pls linear regression technique similar ordinary least square ridge regression cross validation choose optimal number latent variable pls model ten-fold cross validation split dataset ten equal subset c_1 c_2 stratified subject group schizophrenia asd subset c_i\ i=1 10\ train pls model remaining nine subset value 50\ using phenotype data response variable functional connectivity predictor predict subset c_i\ calculate test rmse taking average rmse cross validation fold get estimate test rmse model value return minimum cross validated rmse optimal model cross validated rmse within one standard error cross validated rmse vip statistic determine significant predictor response variable pls model use vip statistic suppose predictor variable response variable latent variable extracted using nipals following tennenhaus vip statistic predictor variable aligned vip t_k aligned _k\ column score matrix weight predictor t_k cor ^2\ t_k coefficient cor ^2\ squared correlation response variable score denominator measure proportion variance explained numerator t_k ^2\ measure proportion variance described latent variable explained predictor thus vip statistic measure influence predictor explained variation model commonly greater one rule used find predictor significantly associated response however rule motivated mathematical property vip _j\ rather statistical property thus use permutation test determine significance vip _j\ alternative afanador used 95\ jackknife confidence interval determine significance vip specifically predictor variable permute value time permutation refit pls model calculate vip -value vip score aligned value vip vip aligned data predictor functional connectivity matrix thus know priori diagonal element uninformative since identically one hence predictor describes diagonal element set -value account multiple comparison problem adjust -values using false discovery rate determine significance significance level 0.05\ mathematical preliminary riemannian manifold intuitively speaking riemannian manifold space perform calculus measure distance measure angle tangent vector specifically smooth -dimensional manifold connected hausdorff second countable topological space covered set coordinate chart u_i u_i\rightarrow defined indexing set every point belongs u_i\ i\in intersection map _j^ smooth map ^d\ every coordinate chart make space locally euclidean sense every point neighbourhood look like euclidean space since concept differential calculus local nature construction smooth manifold allows perform calculus general space important concept study manifold tangent bundle tangent space space defined set equivalence class curve _1\ _2\ equivalent prime denotes derivative vector space generalises notion vector tangent surface arbitrary smooth manifold riemannian manifold manifold together smooth map m\times tm\times g_a m\rightarrow inner product every a\in riemannian metric allows measure angle tangent vector measure distance point manifold used define geodesic locally length minimising curve t_0 t_1 two point consider complete riemannian manifold space every geodesic domain geodesic get concept riemannian exponential logarithm map allow smoothly move manifold tangent space riemannian exponential point a\in map exp m\rightarrow defined exp exp geodesic riemannian exponential smooth map locally diffeomorphic hence local inverse denoted log log m\rightarrow defined log geodesic point close think log shortest initial velocity vector based pointing direction information riemannian manifold found book lee carmo accessible introduction medical imaging found book edited pennec fréchet mean capture centre data manifold consider fréchet intrinsic mean data x_1 x_2 x_n first consider riemannian distance two close point x_1 x_2\in defined aligned d_g x_1 x_2 log x_1 x_2 aligned norm x_1 induced riemannian metric generalising sum squared distance definition arithmetic mean fréchet mean given aligned argmin i=1 d_g x_i ^2\ aligned solve _x\ using gradient decent see algorithm supplementary material information affine invariant geometry symmetric positive definite matrix let gl_r set r\times real invertible matrix set symmetric positive definite matrix defined aligned s^+_r gl_r aligned superscript denotes matrix transpose set s_r^+\ smooth manifold easily seen embedding s_r^+\ r+1 convex cone construction show tangent space s_r^+\ given set symmetric r\times matrix however s_r^+\ interesting intrinsic geometry known affine-invariant geometry affine invariant geometry s_r^+\ becomes complete hadamard manifold—a riemannian manifold non-positive curvature exp diffeomorphism every ^+\ affine-invariant metric defined aligned aligned s_r^+\ s_r^+\ denotes trace operator using calculate riemannian distance s_r^+\ aligned d_g _r\left -1/2 -1/2 ^2\ aligned _r\left -1/2 -1/2 eigenvalue -1/2 -1/2 letting s_r^+\ s_r^+\ get aligned exp 1/2 exp -1/2 -1/2 1/2 aligned aligned log 1/2 log -1/2 -1/2 1/2 aligned exp log matrix exponential logarithm respectively riemannian distance exponential logarithm essential definition fitting r-pls model defined riemannian pls let complete riemannian manifold let x_1 x_2 x_n y_1 y_2 y_n let _x\ _y\ denote respective fréchet mean let r-pls model proposes existence loading subject score aligned x_i exp exp _l\right _i\right aligned aligned y_i exp exp _i\right aligned aligned l\text aligned exp _l\right exp error vector _i\vert\ _i\vert\ small equation outer relationship riemannian data inner relationship connecting response predictor note since riemannian exponential map euclidean space vector addition ^p\ ^q\ r-pls model reduce standard pls model one approach fitting r-pls directly generalising nipals algorithm riemannian manifold becomes computationally intensive fails converge sample size see ryan detail instead propose tangent space approximation fitting r-pls data close fréchet mean similar method riemannian canonical correlation analysis principal geodesic analysis tnipals algorithm algorithm work first linearising manifold data neighbourhood fréchet mean using riemannian logarithm see supplementary material information applying euclidean nipals algorithm linearised data vector-valued thus tnipals provides combination simplicity efficiency euclidean nipals geometry riemannian manifold algorithm tangent non-linear iterative partial least square tnipals algorithm provides general approach wong al. method constructing predictor functional connectivity matrix predict asd using pls logistic regression considering euclidean response symmetric positive definite predictor similarly zhang liu chu also proposed pls method using affine-invariant geometry symmetric positive definite matrix generalised tnipals tnipals algorithm r-pls closely related pls method symmetric positive definite matrix offered perez gonzalez-farias also propose linearising symmetric positive definite matrix affine-invariant geometry fit pls model