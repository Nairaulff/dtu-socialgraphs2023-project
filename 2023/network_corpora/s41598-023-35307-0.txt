introduction classification wafer bin map pattern gaining attention critical approach increasing yield quality semiconductor manufacturing process allowing root cause analysis rca integrated circuit chip composed electronic circuit enable desired function various electrical product continuously decrease size manufacturing process becomes sophisticated making cause defect process difficult analyze later stage semiconductor production process prior packaging different electrical thermal test undertaken evaluate whether chip normal wafer die level binary defect displayed chip-by-chip basis wafer form defect pattern defect pattern end outcome whole procedure feasible analyze correlation defect pattern process history detail enabling rca process therefore wafer map defect pattern classification particularly important field strongly tied improving quality semiconductor industry aiming also raising production yield addition pattern-based defect classification increasing demand automation classification process wafer map pattern labeling process directly conducted expert field labor- cost-intensive diagnosis performance varies depending engineer recent research automated labeling using wafer map classification model conducted due data-based classification model superior automation capability variety sector existing approach classified two category depending data-driven inference mechanism machine learning-based deep learning-based machine learning-based approach wafer defect pattern classification utilize variety prediction model extract class discriminative feature based several hand-crafted feature derived wafer map yuan proposed classification spatial defect pattern using support vector clustering bayesian method proposed support vector machine svm based method using set radon scale-invariant feature demonstrated radon-based feature used acquire rotation-equivariant response proposed use joint local non-local linear discriminant analysis wafer map defect detection recognition based multiple feature including geometric radon feature saqlain proposed voting ensemble classifier using various feature including radon feature various model employing useful feature actively examined method based domain knowledge however exists limitation term inference performance due shallowness machine learning-based model depth inference model increase due development computational resource deep learning-based method actively studied wafer defect pattern classification automatically learn meaningful feature raw data without expert intervention enabling improved pattern classification performance deep learning-based method follows two step first deep learning framework simply applied wafer map defect pattern problem second practical concern data scarcity memory efficiency addressed regarding former early research adopted convolution neural network cnn model show exceptional performance among deep learning model image classification wafer map classification kyeong proposed mixed-type defect pattern wafer bin map using multiple cnn model proposed two stage recognizing classifying wafer map pattern however obtaining sufficient clean labeled wafer map data high quality often constraint throughout manufacturing process therefore model including additional approach traditional cnn model required regarding latter several study proposed model based fact label remains unaffected rotation flip according predefined labeling rule wafer map kang proposed data augmentation method learn rotation- flip-invariant representation augmention along discrete angle direction kahng proposed self-supervised learning pretext-invariant representation includes rotation invariance data-augmentation context result possible achieve high classification performance limited data situation however previously proposed method limitation directly incorporate rotation flip invariance model architecture mean model ability recognize invariance specifically built design instead method rely data augmentation additional parameter inefficient insufficient addressing memory efficiency concern already noted rotational variable cnns field computer vision discussed related work paper propose novel method classifying wafer defect pattern invariant rotation flip considering orientation variation wafer defect pattern due manufacturing process equipment achieving rotation flip invariance becomes crucial accurate robust classification furthermore incorporating invariance classification method approach efficiently extract relevant feature limited data helping mitigate data scarcity issue achieve rotation flip invariance utilize equivariant trait radon feature hand-crafted feature previously used machine learning within cnn framework moreover achieve flip invariance designing kernel within network minimizing reliance data augmentation validate model conduct qualitative quantitative analysis qualitative analysis introduce multi-branch layer-wise relevance propagation multi-branch lrp method interpret model decision specifically designed model multi-branch structure like kernel flip module demonstrate individual impact radon transformation kernel flip qualitative quantitative evaluation using ablation study also evaluate model unseen generalization performance rotation flip augmented dataset background preliminary related work cnns inherently posse strong capability learn translation-invariant feature translational weight sharing pooling operation however achieving form spatial invariance rotation flip remains limitation cnn framework numerous study conducted address challenge augmenting feature input image several transformed copy encoding desired transformation invariance cnn using specific trainable module within network former broken input data augmentation feature augmentation inner filter network many early study input data directly augmented various application laptev proposed transformation invariant pooling ti-pooling layer taking highly activated transformation-invariant feature max-pooling fully connected layer extracted weight-shared cnn input based rotationally augmented training dataset cheng proposed similar method rotation invariant cnn ricnn train existing cnns rotationally augmenting training sample object detection task cheng proposed rotation-invariant fisher discriminative cnn rifd-cnn also using data augmentation strategy ricnns adding fisher-discriminatory layer however directly augmenting input data critical limitation fundamentally requires higher memory size network capacity obtain generalizable rotation feature augmentation internal filter network lately gained considerable attention variety method dieleman proposed multiple branch structure cnn extracting different viewpoint augmented image dieleman extended concept performing various operation cyclic symmetry cohen proposed group-equivariant cnn based group theory utilizing symmetry group pooling operation group marcos suggested explicitly incorporating rotation invariance method model associating weight group filter various rotated copy group canonical filter gao proposed set kernel rotation flip method achieving rotation flip invariance cnn summary feature augmentation method follows structure sampling multiple branch data variation within network main limitation trade-off relationship generalizing data variation number branch second work utilization certain trainable module inside cnn encode required transformation invariance cnn worrall proposed harmonic network achieves rotation invariance replacing regular cnn filter circular harmonic thus returning maximal response orientation jaderberg proposed spatial transformer network stn learnable module explicitly allowing spatial manipulation input data reduce pose variation subsequent layer within network esteves suggested polar transformer network ptn extended version stn combining canonical coordinate representation dai proposed deformable cnn deformable convolution roi pooling based idea augmenting spatial sampling location module work constraint require additional trainable parameter additional module also require complex structure adapt cnn study propose novel rotation flip invariant cnn approach classifying wafer map defect pattern taking consideration challenge data scarcity achieve suggest incorporating handcrafted feature deep learning framework specifically utilize rotation-equivariant property radon feature commonly used hand-crafted feature previous machine learning context wafer classification task obtain rotation invariance cnn framework furthermore achieve flip invariance introducing kernel flip module two-branched structure learns data variation flipped copy produced branch worth noting method achieves flip invariance direction securing combination rotation invariance utilizing rotation-equivariant feature minimal branch flipped kernel approach allows compact efficient representation potentially leading better performance reduced training time compared data augmentation-based method equivariance invariance facilitate understanding problem statement essential first comprehend concept equivariance invariance given mapping function input set input group call equivariant transformation input related transformation output stated conversely invariant independent transformation relationship output domain expressed problem formulation clearly explain proposed mechanism obtaining rotation flip invariance formulated principle proposed approach including radon transform kernel flip cnn backbone module wafer defect pattern image data label set exist geometrical transformation denoted translation rotation flip group transformation denoted labeling rule function label given according represents function composition objective build model approximates function label t\left label cnn model cnn use label inference inherent ability learn translation-invariant feature exhibiting following characteristic cnn cnn however cnn model rotation-invariant cnn cnn provide context let represent application rotation transformation input understanding explain model rotation-equivariant mapping function radon transform radon intermediate step address lack rotation invariance cnn model radon radon result cnn radon cnn radon cnn radon proposed model aim achieve rotation flip invariance address lack flip-invariance incorporate kernel flip module cnn architecture cnn+kf radon cnn+kf radon flip symmetry wafer map preserved changing flip axis account radon feature effect radon radon combining rotation flip transformation model inherently account possible flip orientation according group theory union rotation flip group remains regardless orientation flip axis x\right x\right x\right x\right result model effectively extract rotation flip invariance accounting possible rotation flip transformation employing minimal number flipped kernel branch proposed method described detail following section methodology proposed framework proposed rotation- flip-invariant representation learning method comprises two main module cnn backbone illustrated fig initially radon rotation-invariant module transforms wafer map tomography image converting rotation translation subsequently flipped feature set obtained two branch kernel flip operation employing max-out operation highly-activated feature among pair flipped feature set backbone cnn often referred translation-invariant due capability acquiring translation-invariant feature learns discriminative representation capture wafer label characteristic rotation equivariant flip equivariant feature figure overview method upper proposed model architecture comprises radon transformation kernel flipping module acquiring rotation flip equivariant feature followed translation invariant back-bone cnn-based classifier lower multi-branch lrp method multi-branch structure induced kernel flipping used interpreting model prediction wafer map heatmap image visualized using python 3.8.4 released wm-811k wafer dataset available http radon inverse radon transforms performed scikit-image library version 0.20.0 lrp heatmap obtained using proposed multi-branch lrp method full size image radon transformation proposed method adopts radon feature input representation due rotation-equivariant characteristic respect wafer map radon transformation method acquire sinusoidal tomography r\right projection image rotation radon transform forward projection obtain tomography r\right original image radon transform function given xcos\theta +ysin\theta r\right x=1 y=1 xcos\theta +ysin\theta projection convert original image rotation impact translation radon feature comparing first row fig recognize original wafer map rotation corresponds radon feature translation result radon transform function rotation-equivalent bridge enabling use translation-invariant cnn backbone model obtain rotation-invariant representation additionally comparing second row fig see vertical flip wafer map corresponds horizontal flip radon feature implies flip equivariance radon feature inherently guaranteed flip equivariance wafer map considering change flip axis figure illustration rotation flip example edge-loc class wafer map wm-811k corresponding radon transforms wafer map image figure visualized using python 3.8.4 radon transformation performed using scikit-image library version 0.20.0 full size image kernel flip kernel flip module aim learn flip equivariance generated flipped copy input feature multiple flip version kernel proposed method use two branch flipped kernel original one single-axis flipped one processed radon feature passing several layer input module weight-sharing flipped kernel output flipped feature set without increasing number trainable parameter ensuring model efficiency learning flip variation radon-based feature model capable acquiring flip equivariant property addition rotation equivariance main consideration narrow branch structure described related work exists trade-off generalization performance number branch therefore additional single branch may lead weak flip-equivariant performance however described problem formulation obtaining flip equivariance rotation-equivariant representation corresponds direction flip equivariance generating flipped feature set max-out module take active feature element-by-element pas cnn classifier module aiming efficient memory flow inside network drop-out effect finally obtained rotation flip equivariant feature radon kernel flip module make possible learn rotation flip invariance cnn classifier multi-branch lrp study adopted lrp evaluate method qualitative manner recognize effect inference based radon feature accordance original wafer map-based prediction also verify proposed model work intended lrp primarily used comprehend model inference using interpretability-based approach deep learning-based model based deep taylor decomposition method described relevance score obtained output prediction root point taylor series substituted term taylor series higher-order polynomial term sequentially repeating relevance propagation previous layer input layer relevance score finally obtained f\left x\right =f\left a\right i=1 f/\partial x=a x-a\right +\epsilon apply technique model structural consideration difficult propagate relevance score as-is model multi-branch model best knowledge lrp method used complicated structure multi-branch cnn herein propose novel lrp method multi-branch structure depicted fig relevance score arrived kernel flipping module two relevance score generated passing kernel propagation separated relevance score provides multiple relevance score unrelated model judgment ground input layer solve structural problem concatenate relevance score kernel channel axis propagate relevance concatenated relevance feature kernel generate combined relevance score result discussion experiment data description general wafer map pattern categorized seven class based cluster position shape specific process condition effect center donut edge-loc ring loc scratch random example center type effect problem plasma area thin-film deposition edge-loc type effect uneven heating diffusion process therefore considered important task classify determine state process cause process deterioration estimated existing machine learning-based wafer sorting task mainly researched two scenario individual fab data open data pro con using private data advantageous optimizing problem hand methodological generalization difficult however publicly available data easier compare method implying method generalization could claimed hence preferable utilize verification real-world fab data wm-811k frequently used wafer classification task via machine deep learning data representation wafer map formed image varying size shown fig wm-811k contains total nine class including seven aforementioned class additional near-full none class total amount 172,950 among 25,519 labeled data approximately 14.8 data additionally shown table highly imbalanced data distribution i.e. near-full class account 0.1 appropriate data processing evaluation addressed experimental setup figure used wafer pattern wm-811k study near-full none pattern excluded described experimental setup full size image table data distribution wm-811k full size table experimental setup ass proposed method effectiveness utilized seven typical class wm-811k indicated fig setting balanced data distribution class previous research wafer map pattern classification using wm-811k classified two category first case nine class second take seven eight class depending whether contains none near-full class mohamed highlighted negative effect using none class impact model training performance analysis several reason thus followed latter approach taking seven class excluding near-full none class focus addressing data scarcity aside data imbalance problem sub-sampled train test datasets seven class small dataset ranging 6,400 balanced data size class preprocess data first resized wafer map removed wafer map background retaining defect point due varying wafer map size lead slightly different shape side resizing thus affecting model training negatively comparatively evaluate proposed model via ablation study established four comparative model first baseline model utilized wafer map input baseline network detailed table second model radon model took radon transformation inputting wafer map baseline network third model kernel flip model two-branched kernel flip module within baseline network used wafer map input lastly proposed model incorporated radon transformation kernel flip module onto baseline model also detailed table table baseline proposed model comparative analysis full size table experiment initial learning rate set 0.0003 adam optimizer used updating model weight learning rate decay used every epoch decay rate 0.99 training step stopped early validation loss decrease epoch prevent overfitting loss function used cross entropy loss suitable classification task experiment repeated time using different random seed result reported average standard deviation repeated measurement evaluation strategy evaluate performance proposed method conducted quantitative qualitative analysis firstly performed qualitative analysis using lrp method verify adequacy proposed method specifically visually examined lrp heat map analyze model focus different part wafer map make decision additionally verified effect rotating flipping original wafer map proposed model inference assessing transformation affect model attention wafer map throughout experiment compared qualitative performance baseline proposed method lrp heatmap proposed method based radon feature direct comparison baseline difficult thus applied inverse radon transform relevance score obtained radon feature-based inference using projection-slice theorem verify consistency original wafer map radon feature-based inference allowed compare proposed method baseline secondly conducted quantitative analysis evaluate performance proposed model initially performed ablation study verify validity proposed method analyzing effect module overall performance entire sub-classes addition assessed impact rotation flip proposed model performance class using confusion matrix degree variation rotation flip differs depending wafer map pattern class exhibiting insignificant variation others display wide variation instance center donut class contain uniformly defective point direction resulting insignificant variation rotation flip scratch class wide variation flip rotation since exists curved straight line form independent direction location lastly validate generalization performance model conducted thorough comparison performance proposed model comparative model original test set unseen out-of-distribution augmented test set specifically evaluated ability model generalize unseen distribution rotation flip transformation original test set considered unseen used training still limited distribution within original dataset ass proposed model robustness generalization generated dataset directly rotating flipping test set extend beyond distribution original dataset rotation augmented test set included 90° 180° 270° rotationally augmented test set flip augmented test set included horizontally vertically flipped test set integrated two augmentation method rotation flip important note augmented test set include original test set comparison allowed confirm validity proposed model architecture verify robustness unseen situation qualitative analysis radon transform-based classification begin confirm model decision made label classification obtained lrp heatmaps figure compare baseline model class proposed model relevance score examining second column clear baseline model primarily concerned visual pattern represented wafer map meanwhile due difficulty directly interpreting radon model decision compared using transformed relevance inverse radon transform depicted fifth column result determined proposed model also corresponds defect pattern wafer map significant finding demonstrates shape information contained wafer map retained even model evaluated solely based radon feature moreover comparing prediction outcome evident proposed model focus exclusively primary defect location explains higher classification performance particular result show class proposed model pay attention location clear pattern compared baseline observation consistent fact wide range variation rotation flip transformation making difficult baseline model learn class-discriminative feature contrast proposed model show robust learning regard rotation flip transformation could reason behind observed performance improvement finding provides evidence proposed method effective learning robust discriminative feature presence diverse image transformation especially useful challenging real-world scenario figure layer-wise relevance heatmap analysis baseline proposed method class model trained train set size sample first third column correspond input baseline proposed model respectively second fourth column depict lrp interpretation result model decision fifth column display inverse radon transform result proposed method lrp outcome represented match original wafer map shape image figure visualized using python 3.8.4 radon inverse radon transforms performed scikit-image library version 0.20.0 lrp heatmap obtained using proposed multi-branch lrp method full size image rotation flip invariant classification figure compare relevance score baseline proposed model rotating flipping test set multi-branch lrp method wafer map radon feature row 1–4 exhibit rotation wafer map act translation radon feature row 5–8 demonstrate vertical flipping wafer map act horizontal flipping radon feature based lrp heatmap obtained proposed model activated region translated horizontally rotated wafer map similarly vertically flipped wafer map additionally performing inverse radon transformation proposed model heat map confirmed relevance score indicates defect pattern original wafer map result proposed model radon transform-based kernel flipping method significantly contributes obtaining rotation flip invariance wafer pattern classification figure layer-wise relevance heatmap analysis baseline proposed method rotated flipped test wafer map model trained train set size sample first third column correspond input baseline proposed model respectively second fourth column depict lrp interpretation result model decision fifth column display inverse radon transform result proposed method lrp outcome represented match original wafer map shape image figure visualized using python 3.8.4 radon inverse radon transforms performed scikit-image library version 0.20.0 lrp heatmap obtained using proposed multi-branch lrp method full size image another notable point whenever original wafer map rotated flipped relevance score baseline model pay attention various different position proposed model focus defect point original wafer map indicates proposed model high robustness classification performance input wafer rotation flip variation also reason show improved classification performance original augmented test set discussed later quantitative analysis quantitative analysis classification performance comparison figure table present comparison classification accuracy comparative model various train set setting radon kernel flip model well proposed model exhibit higher classification accuracy baseline model notably radon model performs better kernel flip model indicating wafer map pattern exhibit variation rotation flip method proposed model achieves highest performance indicating invariance ensured rotation flip figure comparison classification accuracy comparative model various train set size accuracy gap class baseline proposed method confusion matrix baseline model confusion matrix proposed model train set size full size image table comparison classification accuracy comparative model various train set size full size table figure b–d present comparison baseline proposed model term class accuracy figure show difference class accuracy diagonal element confusion matrix fig figure indicates proposed model higher accuracy class baseline model particular edge-loc loc random scratch significantly increased among class trend matched fact class considerably rotation flip variance class therefore confirmed high accuracy proposed model derived rotation flip invariance generalized classification performance unseen rotated flipped test set table compare classification accuracy comparative model augmented test set row 1–2 baseline kernel flip model evaluated flip augmented test set row 3–4 baseline radon model evaluated rotation augmented test set row 5–6 baseline proposed model evaluated rotation flip augmented test set case comparative model score higher accuracy baseline model mean proposed model ablation model work rotation- flip-invariantly unseen augmented situation rotation flip table comparison classification accuracy comparative model unseen augmented test set full size table figure show classification accuracy comparative model original unseen augmented situation train set size figure depicts evaluation result original test set flip augmented test set baseline kernel flip model fig depicts evaluation result rotation augmented test set baseline radon model fig depicts evaluation result rotation flip augmented test set baseline proposed model illustrated fig radon kernel flip proposed model achieve increased accuracy baseline model augmented test set however three case accuracy slightly decreased two situation noteworthy reduction gap baseline model larger comparative model interpreted proposed model higher resistance performance degradation generalization performance unseen augmented situation figure accuracy comparative model original augmented test set train set size baseline kernel flip model compared flipped augmented test set baseline radon model compared rotated augmented test set baseline proposed model compared rotated flipped augmented test set full size image figure compare generalization performance class proposed baseline model train set size figure show difference class accuracy baseline model presented fig original test set fig rotated flipped augmented test set figure show difference class accuracy difference fig original test set fig rotated flipped augmented test set proposed model figure show difference fig fig demonstrates proposed model better generalization baseline model class fig see proposed model higher resistance performance degradation term generalization unseen augmented dataset class class edge-loc loc scratch show significant increase extraordinary generalization performance rotation flip sensitive class demonstrates proposed model effectively preserve rotation flip invariance additionally trend accordance finding original test set discussed classification performance comparison figure class accuracy gap original test set rotated flipped augmented test set baseline model train set size class accuracy gap original test set rotated flipped augmented test set proposed model train set size difference indicating increased generalization performance proposed model compared baseline model class full size image conclusion paper introduce novel method achieving rotation flip invariance wafer map defect pattern classification utilizing combination radon transform kernel flip technique radon feature ensures rotation invariance transforming original wafer map rotation translation kernel flipping approach provides flip invariance proposed method employ efficient network structure minimal number flipped kernel branch appropriately combining two module validate model extensively using wm-811k dataset qualitative quantitative evaluation proposed model interpretability demonstrated verifying decision using newly suggested multi-branch lrp method proposed model achieves high detection performance even limited data situation successfully ensuring rotation flip invariance additionally assessed proposed method generalization performance regarding rotation flip invariant out-of-distribution data using rotation flip augmented test set study provides efficient end-to-end deep learning model appropriately reflects characteristic wafer labeling serve suitable baseline wafer diagnosis future