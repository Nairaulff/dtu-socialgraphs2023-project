introduction rapid development internet entered era connected everything internet brought many convenience also created many problem internet security one serious incident network fraud privacy leak emergence various network attack method increased sharply leading people realize importance network security intrusion tracking technology emerged way discover real location network intruder take appropriate countermeasure intrusion behavior however attacker often use stepping stone anonymous protocol hide real address attack making intrusion tracing extremely difficult stepping stone intermediate host forward attacker traffic another remote destination address mask true origin attack make intrusion tracing challenging recent year various traffic analysis technique developed track attack traffic stepping stone traditional method passive traffic analysis statistical method find correlation outbound inbound traffic however method require long observation time work real-time computational cost high processing large amount collected traffic also highly susceptible network jitter active traffic analysis technology another method network flow watermark nfw technology mainstream nfw mark trace network traffic adjusting certain feature network flow embedding detection side share watermark parameter embedding side embeds watermark signal incoming traffic detection side decodes watermark signal outgoing traffic discover correlation traffic compared passive traffic analysis nfw requires fewer data packet suitable traffic tracing due high precision low resource consumption concealment adaptability active network flow watermark become one mainstream method traffic tracing according type carrier nfw divided network flow watermark based flow rate inter-packet delay time slot interval among time-based network flow watermark better concealment become research focus network flow watermark recent year time-based nfw divided three type inter-packet delay-based interval packet count-based interval centroid-based many advanced interval centroid watermark scheme sacrifice performance aspect watermark efficiency exchange robustness although improves robustness watermark problem low watermark efficiency watermark requires large time overhead often need cache thousand packet embed watermark attacker complete network attack target short time therefore length target network flow often short resulting poor practicality watermark key challenge designing efficient nfw scheme ensure robustness watermark maximizing watermark encoding efficiency much possible study propose concept watermark capacity characterize encoding efficiency network flow watermark improve watermark capacity propose efficient hexadecimal nfw scheme based adaptive interval length unlike existing watermark scheme proposed nfw scheme adapts interval length collecting data stream ipd feature dividing interval six sub-interval watermark data embedded delaying packet change number packet sub-interval scheme modulates 4-bit watermark data interval improve watermark encoding efficiency increase watermark capacity network flow main contribution research follows propose concept watermark capacity refers number watermark bit embedded fixed-rate network flow within unit time concept used characterize encoding efficiency network flow watermark scheme propose efficient hexadecimal network flow watermark scheme adaptive interval length scheme self-learn watermark parameter based network traffic feature improves watermark encoding efficiency embed watermark bit finite-length network flow ensuring watermark robustness thereby increasing watermark capacity network flow remaining part paper organized follows related work section introduce several state-of-the-art nfw method related work nfw methodology section elaborate theoretical scheme proposed nfw scheme including concept watermark capacity adaptive interval length algorithm efficient hexadecimal encoding decoding method network flow watermark experimental result analysis presented experimental result analysis section finally conclusion future work section summarize conclusion paper suggest future work related work recent year various scholar proposed different method network flow watermark nfw detect stepping stone tracking anonymous communication system cloud track article examines current mainstream nfw technology categorizes three type based carrier watermark signal rate-based nfw inter-packet delay-based nfw slot-based nfw nfw based flow rate flow rate refers transmission rate network traffic within specific period nfw technology based flow rate modulates data flow rate specific time embed watermark information collecting flow rate extract watermark information track data flow typical method proposed called dsss-w spread original signal pseudo-noise code sender slightly adjusts flow rate spreading period embed watermark using certain adjustment amplitude method accommodate numerous watermark track multiple flow parallel achieve high tracking rate stable flow rate environment however suitable network large fluctuation flow rate transformed time-domain watermark feature-invariant frequency using frequency-domain analysis technology embedded wireless network data flow electromagnetic interference effectively reducing anonymity flow-based wireless mix network huang improved scheme effectively resist mean square-related attack however scheme applicability poor due difficulty generating long code satisfy condition nfw based inter-packet delay inter-packet delay ipd time difference arrival departure pair packet network flow nfw based ipd change ipd packet delaying certain packet network flow embed watermark signal wang reef proposed ipd-based watermark scheme several packet short network flow randomly selected watermark signal embedded fine-tuning ipd packet approach advantage simple implementation high accuracy used track real-time flow address issue wang proposed another ipd-based network flow watermark method technique doe quantify ipd network flow change average value set normalized ipd difference adjusting incremental parameter embed watermark signal park reef proposed adaptive network flow watermark technique adaptively selects watermark parameter based actual situation watermark network flow complete watermark embedding pan proposed ipd analysis attack idea based adjacent footprint gave algorithm infer watermark parameter significantly alleviate decrease watermark detection rate caused time perturbation reduce impact adding virtual packet network flow peng used packet matching technology watermark scheme approach match appropriate packet network flow associate data flow reduce impact fake packet watermark analyze flow correlation using non-blind watermark achieve good robustness attack houmansadr proposed non-blind watermark scheme called rainbow added ipd database watermark framework storing ipd iacovazzi proposed invisible network flow watermark technique called dropwat data leakage attack nfw based time slot interval nfw based time slot interval achieves watermark embedding detection modulating number packet centroid value packet within data flow interval however flow watermark based inter-packet delay ipd work effectively packet loss packet reordering occurs solve problem pyun proposed first interval-based watermark ibw scheme ibw scheme network flow divided multiple equal-length period certain offset period time slot interval watermark embedding achieved manipulating number packet interval delayed packet solve packet disturbance packet grouping problem pyun proposed improved ibw scheme self-synchronization property effectively solve problem fake packet flow segmentation flow merging proposed efficient quaternary network flow watermark technique embed 2-bit watermark data within interval improve coding efficiency watermark extent interval division wang proposed first centroid-based watermark scheme icbw centroid interval defined average offset packet arrival time relative start time interval watermark information embedded delaying packet change centroid value wang proposed double-centroid-based watermark scheme dicbw selects two adjacent interval embed watermark resulting higher detection rate better defend multi-flow attack mfa luo combined icbw direct sequence spread spectrum coding technology proposed centroid-based spread-spectrum watermark scheme icbssw scheme effectively resist mfa suitable parallel tracking multiple attack flow however watermark detection icbssw requires repeated parameter attempt lead high time space cost enhance stealthiness flow watermark liu proposed high-stealth nfw scheme based centroid using internal swapping algorithm interval centroid changed exchanging limited number ipds within time slot interval without changing time characteristic network flow improves scheme stealthiness hou proposed watermark technology based histogram-specified centroid interval improves resistance existing technology multi-flow attack edge computing reduces time space cost detector liu kexian proposed multiple redundant flow fingerprint model based time slot operating data packet within specified time slot embed fingerprint effectively detect man-in-the-middle attack prevent network identity spoofing analysis existing nfw technology found advanced nfw scheme good robustness concealment however disadvantage watermark encoding efficiency low resulting small watermark capacity network flow track shorter network traffic poor practicality therefore study designed efficient hexadecimal nfw scheme adaptive interval length scheme self-learn watermark parameter based network flow characteristic improve watermark encoding efficiency thereby enhancing watermark capacity network flow improving practicality watermark ensure good robustness different type network traffic methodology section describe detail watermarking capacity overall framework watermark hexadecimal network flow watermark scheme watermark capacity various network scenario significant difference exist network flow rate length number packet aspect practical network scenario network watermark need embedded relatively short network flow requires watermark high coding efficiency embed sufficient watermark information shortest possible network flow ensuring watermark accuracy paper proposes using watermark capacity network flow characterize watermark coding efficiency assuming packet throughput rate network flow stable formula calculating watermark capacity pps formula pps represents packet throughput rate network flow characterizes packet flow rate network flow measured pps indicating many packet sent per second represents number embedded watermark bit represents number packet required embed bit watermark information watermark capacity measured bit per second bit/s watermark capacity represents number watermark bit transmitted unit time network flow i.e. watermark-carrying capacity network flow directly reflects coding efficiency watermark scheme watermark overall framework different application scenario network flow watermark found characteristic network flow differ greatly existing network flow watermark technology dynamically adjust watermark parameter resulting low coding efficiency watermark small watermark capacity network flow poor practicality network flow watermark order enhance watermark capacity network flow improve practicality flow watermark paper proposes efficient hexadecimal network flow watermark method based efficient quaternary network flow watermark scheme combine watermark interval synchronization algorithm improve coding efficiency practicality scheme overall framework watermark scheme shown fig figure overall framework watermark scheme full size image achieve slot interval synchronization watermark embedding detection party first learn network flow characteristic adaptively synchronize interval length starting offset time starting watermark transmission achieve interval synchronization slot synchronization completed embedding party delay sending data packet embed watermark start marker encodes watermark bit sequence network flow encoding completed embedding party generates empty interval without sending data packet embed watermark end marker watermark detection party receives network flow self-learns interval length starting offset time detects watermark start marker detecting start marker detection party prepares receive watermark bit information determines interval position based self-learned interval length starting offset time decodes watermark bit sequence network flow watermark end marker detected empty interval data packet arriving detecting watermark end marker hamming distance watermark bit sequence calculated verify whether embedded watermark information detected scheme mainly includes adaptive interval synchronization watermark start end marker hexadecimal watermark scheme watermark decoding component described detail hexadecimal network flow watermark scheme section describe detail interval synchronization algorithm watermark start end marker watermark encoding watermark decoding interval synchronization algorithm embedding watermark necessary determine watermark parameter including n-bit watermark bit sequence interval length starting offset time parameter consistent watermark embedding detection side efficiently embed detect watermark different network flow scheme share watermark bit sequence watermark embedding detection side parameter dynamically self-learned adaptive network flow feature embedding watermark watermark embedding detection side simultaneously collect network flow feature network flow packet throughput packet fluctuation synchronize interval length starting offset time adaptive interval algorithm realizing interval synchronization watermark embedding detection side method calculating interval length starting offset time interval synchronization algorithm follows 12\left pps pps represents throughput data packet network flow standard deviation inter-packet delay ipd reflects degree fluctuation data packet network flow calculation method ipd time difference two adjacent packet target network flow arrive host represents ipd i-th packet network flow starting interval synchronization represents average ipd packet using adaptive interval length algorithm possible achieve adaptive watermark parameter tuning various network environment approach maximizes transmission efficiency network watermark ensuring data reliability significantly enhancing efficiency network flow watermarking watermark start end marker enhance practicality watermark scheme study introduces watermark start marker beginning watermark watermark end marker end watermark accurately locate watermark position improve efficiency practicality network flow watermark theoretical model watermark start end marker shown fig watermark embedding party learns average ipd interval length starting offset time three consecutive ipd watermark start marker 3d_ represents first ipd sequence encoding watermark watermark embedding party delay sending data packet generate empty interval without sending data packet embeds watermark end marker figure theoretical model watermark start end flag full size image self-learning average packet inter-arrival time interval length starting offset time watermark detection party continues learn network flow characteristic record ipd value monitor arrival watermark start marker three consecutive ipd value consistent 2.5d_ 4.5d_ indicates detection watermark start marker watermark detection party start decode watermark bit information based distribution data packet within interval watermark detection party decodes watermark bit packet arrive interval indicates detection watermark end marker watermark detection party end watermark bit decoding watermark detection process completed watermark encoding paper proposes efficient hexadecimal network flow watermark method improves upon existing efficient quaternary network flow watermark method proposed scheme divide network flow multiple time slot length starting initial offset automatically obtained interval synchronization algorithm discussed earlier time slot divided six equally spaced consecutive sub-interval denoted i,1 i,2 i,3 i,4 i,5 i,6 number packet sub-interval denoted i,1 i,2 i,3 i,4 i,5 i,6 respectively properly sized network flow interval synchronization algorithm yield appropriate value packet time slot uniformly distributed number packet six sub-interval almost equal assuming interval divided six consecutive sub-interval average number data packet subinterval within interval difference number packet first sub-interval half average number packet six sub-interval i,1 i,1 i,1 i,2 i,3 i,4 i,5 i,6 similarly i,2 i,2 i,4 i,4 i,5 i,5 data packet approximately uniformly distributed within interval inferred e\left i,1 e\left i,2 e\left i,4 e\left i,5 greater equal zero target network flow watermark embedding scheme form new network flow delaying directly transmitting data packet interval achieve watermark encoding network flow delay time t/6\ scheme six sub-interval one interval encode 4-bit watermark data delaying transmission data packet changing number packet first second fourth fifth sub-interval interval i,1 i,2 i,4 i,5 value i,1 i,2 i,4 i,5 controlled greater encode watermark data encoding process four-bit watermark data shown fig figure encoding process four-bit watermark data full size image watermark decoding detection party initially learns interval length starting offset time self-learning process recorded upon detecting watermark start marker reaching starting offset time first interval begin interval time length divided six sub-interval cycle every time passed sub-interval length t/6\ number data packet arriving sub-interval recorded saved end sixth sub-interval number data packet entire interval calculated summing recorded number data packet sub-interval denoted average number data packet sub-interval i,1 calculated difference number data packet sub-interval obtained i,1 i,2 i,4 i,5 watermark bit information decoded based magnitude calculation method follows array i,1 i,1 array array i,2 i,2 array array i,3 i,3 array array i,4 i,4 array using watermark extraction algorithm described watermark information sequentially decoded based distribution data packet interval 4-bit watermark data decoded interval length watermark detection stopped watermark end marker detected empty interval data packet arrive finally decoded watermark bit data compared embedded watermark bit data similarity calculating hamming distance h\left two-bit sequence h\left set hamming distance indicates successful detection watermark information otherwise indicates watermark information detected setting hamming distance instead exact matching determine presence watermark improves robustness watermark interference attacker increase success rate watermark detection experimental result analysis section simulated realistic network environment evaluate proposed network flow watermark scheme compared two existing watermark scheme namely dicbw efficient quaternary flow watermark scheme dicbw efficient quaternary network flow watermark scheme two stable efficient interval-based network flow watermark technology dicbw 1-bit watermark data embedded selecting adjacent pair interval adjusting data packet within interval change centroid difference two adjacent interval efficient quaternary network flow watermark scheme embeds watermark data adjusting distribution data packet within interval involves changing number data packet within interval experimental environment experimental environment built paper illustrated fig five edge computing node namely sender watermark embedding end jammer watermark detection end receiver connected local area network sender responsible generating network flow comprising icmp ssh traffic sent receiver generate target network flow required watermark prior watermark process watermark embedding end watermark detection end share original watermark information real-time watermark embedding end modulates target network flow based characteristic flow embeds original watermark information network flow sends modulated flow jammer jammer introduces jitter random packet loss simulate network jitter packet loss may occur real network environment watermark detection end learns watermark parameter based characteristic network traffic record arrival time data packet network flow detects watermark information finally calculates hamming distance detected watermark information original watermark information calculated hamming distance determines whether watermark detected thereby achieving flow correlation completing intrusion tracking figure topology experimental environment full size image network flow packet experiment real network packet including icmp protocol packet ssh protocol packet sent sender receiver experimental data chosen dataset provided cooperative association internet data analysis caida february watermark capacity paper present novel efficient hexadecimal network flow watermark method coding efficiency verified comparison dicbw efficient quaternary network flow watermark scheme experiment conducted icmp ssh network traffic calculate watermark capacity three scheme compare coding efficiency network flow speed embedding watermark bit requires data packet relationship number watermark bit required data packet experimentally verified compare coding efficiency different watermark scheme experimental parameter set follows flow rate network flow data packet pps 5pps\ meaning five data packet transmitted per second according self-learning interval length algorithm proposed paper interval length proposed watermark scheme determined therefore interval length icbw efficient quaternary network flow watermark scheme set starting offset time 1.5\ watermark bit number increased experimental recording shown fig experimental result icmp network flow fig experimental result ssh network flow horizontal axis represents watermark bit number vertical axis represents number data packet required embed watermark figure number packet required embed different number watermark bit full size image condition unchanged parameter number data packet required embed watermark increase increase embedded watermark bit number clearly seen embedded watermark bit number proposed efficient hexadecimal network flow watermark method requires fewer data packet two scheme higher watermark coding efficiency icmp ssh network flow hamming distance set detection success rate three watermark scheme packet flow rate pps 5pps\ watermark sequence bit according calculating watermark capacity watermark capacity 1.49\ bit efficient hexadecimal network flow watermark scheme watermark capacity 0.49\ bit dicbw watermark capacity 0.95\ bit efficient quaternary network flow watermark scheme obtained network flow environment watermark capacity efficient hexadecimal network flow watermark scheme highest three time dicbw scheme 1.5 time efficient quaternary network flow watermark scheme embedding network flow watermark different flow rate network flow time required different theoretical analysis show embedding length watermark bit sequence faster network flow rate shorter time required experimental parameter set follows setting starting offset time hamming distance embedding watermark sequence length bit icmp ssh network flow respectively time required embedding 60-bit watermark three network flow watermark different network flow rate recorded figure respectively represent experimental result icmp ssh network flow figure seen compared dicbw efficient quaternary network flow watermark scheme network flow rate efficient hexadecimal network flow watermark scheme proposed paper requires shortest time embed length watermark bit sequence highest watermark encoding efficiency icmp ssh network flow hamming distance detection success rate three watermark scheme figure time required embed watermark different network rate full size image experimental result demonstrate compared two interval-based nfw scheme efficient hexadecimal network flow watermark scheme proposed paper higher encoding efficiency requires time fewer data packet embed watermark length higher network flow watermark capacity watermark robustness practical application network flow watermark robustness watermark actual environment important efficiency watermark encoding test robustness watermark scheme conducted experimental test ssh network flow chose original watermark length bit set hamming distance calculated hamming distance detected watermark sequence original watermark sequence hamming distance indicates successful detection watermark flow otherwise indicates unsuccessful detection conducted multiple experiment recorded watermark detection success rate reflect watermark robustness firstly considered impact hamming distance watermark detection success rate experimental parameter set follows original watermark length bit network flow speed pps 10pps\ interval length dicbw efficient quaternary network flow watermark set network jitter ms. recorded watermark detection success rate hamming distance shown fig hamming distance increase watermark detection accuracy also increase watermark detection success rate three nfw scheme detection success rate dicbw efficient hexadecimal network flow watermark method close figure detection success rate watermark different hamming distance full size image test robustness proposed nfw scheme network disturbance conducted following experiment original watermark length set bit network flow speed pps 10pps\ interval length dicbw efficient quaternary network watermark set interference generator placed watermark embedding detection device produce random delay mimic real network disturbance disturbance increased increment experiment recorded change detection success rate three network watermark network disturbance increased hamming distance experimental result shown fig network disturbance three network watermark scheme could ensure watermark detection success rate detection success rate three network watermark network disturbance detection success rate three network watermark network disturbance experiment verified hexadecimal network watermark proposed scheme slightly lower robustness network disturbance dicbw scheme however similar resistance disturbance quaternary network watermark highly resistant disturbance making suitable network environment network disturbance figure detection success rate watermark different network jitter full size image real network environment network jitter type interference may occur type interference packet loss false packet injection also occur due poor network condition malicious attack evaluate impact packet loss false packet injection network flow watermark study conducted experiment interferer simulated real network communication environment experimental parameter included original watermark length bit network flow rate pps 5pps\ network jitter interval length dicbw efficient quaternary network flow watermark packet loss rate loss false packet injection rate insertion two set experiment conducted loss insertion 10\ loss insertion 20\ hamming distance increasing detection success rate watermark recorded experimental result shown fig indicate horizontal axis represents hamming distance vertical axis represents detection success rate observed loss insertion 10\ hamming distance set detection success rate proposed efficient hexadecimal network flow watermark method similarly loss insertion 20\ hamming distance set detection success rate efficient hexadecimal network flow watermark method also reach shown figure compared dicbw quaternary network flow watermark scheme proposed hexadecimal network flow watermark scheme slightly lower robustness presence network jitter packet loss false packet insertion higher robustness efficient quaternary network flow watermark scheme scheme good anti-interference ability ensure high robustness even harsh network environment figure detection success rate watermark different packet loss rate false packet insertion rate full size image man-in-the-middle attack identification various network attack man-in-the-middle attack stand commonly employed method type attack occurs assailant intervenes communication process misleading communicating party believing directly communicating reality communication monitored manipulated attacker deceptive action involve masquerading legitimate participant communication allowing attacker perform malicious operation consequently man-in-the-middle attack regarded specific manifestation network identity deception based severity man-in-the-middle attack classified two category flow monitoring man-in-the-middle attack flow tampering man-in-the-middle attack category correspond attack effect monitoring tampering network traffic respectively man-in-the-middle attack data communicating party intercepted completing identity deception process alters timing characteristic original network flow thereby impacting effectiveness network flow watermark detection efficient hexadecimal network flow watermarking scheme proposed paper address issue determining presence man-in-the-middle attack network success rate watermark detection approach serf defense network identity spoofing effectively resolve problem man-in-the-middle attack verify detection man-in-the-middle attack efficient hexadecimal network flow watermark scheme following experiment conducted jammer used packet monitoring tampering resending simulate man-in-the-middle attack process experimental parameter set follows length original watermark 60bit network flow rate pps 10\ pps\ network jitter experiment recorded success rate watermark detection normal flow stream monitoring man-in-the-middle attack flow flow tampering man-in-the-middle attack flow hamming distance varied experimental result shown fig figure impact man-in-the-middle attack detection success rate full size image figure seen hamming distance greater success rate watermark detection higher normal network without man-in-the-middle attack whereas success rate watermark detection higher network flow monitoring man-in-the-middle attack higher network flow tampering man-in-the-middle attack experiment prof man-in-the-middle attack great influence detection success rate watermark network flow setting appropriate watermark parameter efficient hexadecimal network flow watermark scheme proposed paper good effect detection man-in-the-middle attack effectively solve network identity deception problem conclusion future work paper propose efficient hexadecimal network flow watermark method introduce concept watermark capacity enhance watermark capacity network flow scheme based high efficiency currently commonly used interval packet counting-based network flow watermark scheme divide single interval six sub-interval embeds watermark information modulating packet distribution within sub-interval sub-interval modulate 4-bit watermark information significantly improving encoding efficiency watermark reducing time overhead watermark encoding also propose watermark start mark watermark end mark self-learning watermark interval length network stream feature improve practicality robustness watermark conduct experiment real network flow including icmp traffic ssh traffic verify efficient hexadecimal network flow watermark method greatly improves encoding efficiency watermark capacity network flow ensuring anti-interference robustness effective detecting man-in-the-middle attack problem resisting network identity spoofing however still issue scheme mainly term concealment network flow watermark watermark embedding change packet distribution network flow extent resulting poor concealment watermark making easy watermark attacker distinguish watermark flow normal flow therefore discover destroy watermark information therefore improving concealment watermark scheme urgently needed future work additionally applying hexadecimal network flow watermark high-rate network flow still challenging task issue considered improvement future