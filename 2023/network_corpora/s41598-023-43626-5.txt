introduction ability implement targeted control measure due time emerging antimicrobial resistance amr depends efficient monitoring system amr human animal environment denmark surveillance programme antimicrobial usage amr danmap established since establishment danmap based phenotypic-based characterisation clinical isolates selected pathogen selected indicator bacteria sample animal human food using minimum inhibitory concentration mic panel antimicrobial resistance gene args occur bacterial specie using selected bacteria detecting emerging increased occurrence amr might miss emergence spread amr entire resistome ongoing development gene sequencing technology possible investigate presence abundance args sample using shotgun metagenomic sequencing dna fragment extracted organism sample subsequently mapping obtained sequence nucleobases database known sequence nucleobases args shown metagenomics approach useful reliable measurement amr pig production recently shown added value metagenomics approach direct comparison phenotypic surveillance used danish danmap program also suggested use metagenomics increase likelihood emerging args detected earlier since whole microbiota sample analysed amr however likelihood detecting emerging significant quantitative change arg population using metagenomics depends addition actual occurrence arg design monitoring system includes fraction population interest sample collected sample size frequency sampling much physical sample investigated metagenomics equivalent many extracted dna fragment sequenced sequencing depth national surveillance amr denmark many country key performance parameter lag time novo emergence novel arg population real change occurrence arg already present change detected significant change surveillance program sensitivity also practical importance program doe result many false alarm thus situation stable amr level program indicate change occurrence amr specificity sensitivity specificity monitoring program often negatively correlated presented study aimed given economic restriction ass different pooling strategy detecting emergence increase prevalence args danish pig population simulation simulation took account stochasticity related sampling laboratory procedure economic restriction based simulated data estimated sensitivity specificity compare pooling strategy surveillance args population production animal study show using relatively large pool combined metagenomics possible monitor args population result simulation show use metagenomics possible monitor known args detecting change endemic detecting newly introduced args result study measured occurrence args count per million cpm interpreted many sequenced gene fragment representing specific arg normalised 1,000,000 fig args coding efflux pump causing tetracycline resistance fig args coding resistance gentamicin true occurrence cpm cpm pooled sample cpm measured using metagenomics illustrated figure observed occurrence fluctuating around truth result sampling error laboratory noise effect increasing number sample per pool time reducing sequencing depth metagenomics lower deviation true observed data highly abundant low abundant gene figure time-series plot simulated data representing scenario surveillance year gene coding efflux pump causing resistance tetracycline swine faeces simulated sampling schedule monthly collection sample upper left sample upper right sample lower left sample lower right faeces random pig population sample collected per month pooled analysed using metagenomics blue line true cpm population graph brown line cpm pooled sample green line observed cpm metagenomics full size image figure time-series plot simulated data representing scenario surveillance year gene coding resistance gentamicin swine faeces simulated sampling schedule monthly collection sample upper left sample upper right sample lower left sample lower right faeces random pig population sample collected per month pooled one technical sample analysed using metagenomics blue line true cpm population graph brown line cpm pooled sample green line observed cpm metagenomics full size image using deviation truth sampling schedule five sample per pool reference relative deviation truth changing sampling schedule increased number sample per pool reduced sequencing depth calculated monitoring occurrence args coding tetracycline efflux pump table args coding gentamicin resistance table overall deviation truth using 50–100 sample per pool 1/3 relative deviation truth using sample per pool table relative deviation true occurrence args coding tetracycline efflux pump increasing number sample reference sample per pool per month subsequently reducing sequencing depth relative distribution absolute deviation due number sample sequencing depth full size table table relative deviation true occurrence args coding resistance gentamicin increasing number sample reference sample per pool per month subsequently reducing sequencing depth relative distribution absolute deviation due number sample sequencing depth full size table fig time detection start true increase iteration using sample size presented using violin plot regardless sample size range time detect month detected within month apparent difference time detect sample size used monthly pool simulated surveillance based phenotypic characterisation isolates iteration resulting detection within first month start change common resistance indicating amount type information resistance/sensitive isolate current monitoring system doe power detect change occurrence highly abundant resistance simulation phenotypic characterisation detecting change occurrence low-abundant resistance apparent difference time detect wherever using metagenomics phenotypic characterisation isolates figure result simulation monitoring significant change occurrence resistance tetracycline pig population using faecal sample per month occurrence resistance measured abundance args coding efflux pump causing resistance tetracycline using metagenomics phenotypic resistance e.coli pheno simulation conducted scenario increase year causing false negative signals—lower graph subsequently annual increase year measured time detection—upper graph full size image figure result simulation monitoring significant change occurrence resistance gentamicin pig population using faecal sample per month occurrence resistance measured abundance arg aph coding resistance gentamicine using metagenomics phenotypic resistance faecalis pheno simulation conducted scenario increase year causing false negative signals—lower graph subsequently annual increase year measured time detection—upper graph full size image number false positive signal indicating change occurrence highly abundant args dependent sample size fig number false signal phenotypic characterisation highly abundant resistance magnitude opposite number false positive signal indicating change occurrence low-abundant args strongly dependent sample size fig iteration respectively zero false signal using sample monthly pool iteration false positive signal simulated time year true change number false signal phenotypic characterisation magnitude scenario based metagenomics pooled sample sample per pool sample collected pooled sampling point closer sample represents true occurrence arg fig situation sample per pool relatively large amount economical resource spent sequencing deviation observed data truth due low representability sample animal pooled sample compensated sequencing deeper table reduction overall deviation truth increasing number animal per pool corresponding reduction sequencing depth presented increasing number sample per pool result deviation 1/3 deviation using animal per pool study used statistical algorithm analyse simulated time series significant change observed data used algorithm summarise simulated data generate pattern monitoring result different scenario suggesting algorithm used monitoring program real setting algorithm set detect change trend month acute change month another outcome interest time series significant change observed data 240-month long time series time point compared defined truth two first scenario initial month true change significant time point detected time interval false positive signal scenario monitoring arg relatively high abundance number false negative signal time series ranged fig irrespective number animal represented monthly pool alternative monitoring approach based phenotyping e.coli isolates per month number false positive signal similar tendency signal month true change scenario monitoring arg low abundance due relatively large impact selection error observed cpm large number false positive signal fig sampling schedule using sample per pool almost random month month signal time series false positive signal number false negative signal decreased increased number sample pool sample per pool common number false positive signal iteration several iteration false negative signal twice year signal total fig also alternative monitoring approach based phenotyping faecalis isolates per month number false positive signal high fig scenario monitoring change abundance high-abundance args already present population time detect true change ranged month sampling schedule strongly influenced number sample per pool indicating information needed detect change collected using sample however scenario monitoring change abundance low-abundance arg using sample gave general shortest time detect partly illogical result due impact random error observed result high scenario result also explanation high number false positive signal independent truth therefore signal significant change shortly change started random considering monitoring change low-abundance args taking number false positive signal account especially sample per pool predictive value positive signal indicating change low increasing number sample per pool 50–100 positive predictive value signal indicating change increase considered truly positive figure show distribution time detect iteration done scenario different number sample pool number sample per pool time detection varies several month due stochasticity sampling laboratory ranging detection within first month increased occurrence increase detected first several year variation time detection number sample per pool result stochasticity sampling population randomness fragment sequenced also partly variation actual sequencing depth fixed figure result iteration per sample schedule time detect newly introduced amr gene pig population simulated sampling schedule collection faecal sample random pig per month pooled one technical sample analysing metagenomics full size image occurrence pathogen within animal infected farm set abundance blatem real farm addition time detection also simulated using phenotypic method presence detected new amr strain e.coli transmission rate farm occurrence new strain infected farm set current prevalence esbl pig production right plot show prevalence farm different time introduction equivalent y-axis left graph used simulation transmission rate equivalent gene present almost farm year introduction one farm month prevalence figure illustrates 4-year forecast occurrence arg based data observed iteration period size uncertainty forecast increased period forecasted instead eyeball forecast analytical approach utilising data valid robust objective close approximation observed forecasted data true data fig reveals performance surveillance valid representation truth used forecast occurrence figure plot forecasted trend cpm gene coding resistance tetracycline due efflux pump left column gene coding resistance gentamicin right column green line show simulated observation obtained year monitoring resistance based monthly sampling upper row second upper row third upper row faecal sample lower row metagenome analysis full size image discussion study modelled utility metagenomics livestock production detecting monitoring forecasting presence args model developed two dimension first dynamic change occurrence amr second monitoring procedure—sampling schedule laboratory method interpretation statistical analysis laboratory result like mathematical model result must interpreted context model assumption quality available simulated data also result based arg data danish pig assumption spread args farm danish pig production system earlier indication change amr population effective preventive measure regulating banning use certain antimicrobial respect limiting occurrence amr however best knowledge first mathematical model developed estimating performance amr surveillance program based metagenomics simulation suggest considerable time delay detect either increased occurrence arg already present population 33–64 month first detection completely novel arg 19–33 month however result also show given amount funding might gain 14–31 month time detection using optimal pooling strategy combined metagenomics also suggested simulation correct pooling strategy might effective simply increasing overall cost used surveillance amr case generation time-series data general also give opportunity kind forecasting—either visually analytically surveillance program related health animal human population e.g. danmap forecast based visual inspection time-series data aggregating data annual occurrence use metagenomics combination strict sample schedule sample collected every month result time series quantitative amount known args per e.g. month estimating trend observed data estimated trend used long-time forecast amr given trend continuing given potential args transfer bacteria specie long time take reduce occurrence amr preventive measure forecasting occurrence amr support implementation preventive measure due diligence applying precautionary principle especially relevant amr decision need taken adverse effect amr observed human population sensitive make algorithm detect change greater number false alarm sensitivity whole surveillance must end balanced size potential risk cost false alarm end decision need made risk manager parameter duration dbest significantly detects change within time series data shorter duration faster breakpoint identified also short duration time increase likelihood false alarm compared surveillance based phenotypic characterisation isolated bacteria metagenomic method allows monitoring occurrence resistance gene known nucleotide sequence sample laboratory procedure another strength data structure outcome metagenomics count make possible aggregate count gene higher level obtain cpm gene coding resistance antimicrobial class tetracycline aminoglycosides etc. thereby surveillance amr based metagenomics reveal change occurrence amr bacterial population different level one apparent disadvantage metagenomics method doe indicate detected gene phenotypically expressed population bacteria however case surveillance amr population production animal risk related likelihood gene transferred human pathogen one deciding factor size risk absolute number resistance gene microbiome therefore context whether gene interest expressed collected sample minor concern inherent benefit using metagenomics monitor amr population possible monitor occurrence known args within one technical sample however power detect change occurrence amr depends strongly true occurrence amr population criterion set defining change traditionally handled adjusting sample size amr interest given probability detect change monitoring system present reality monitoring based metagenomics straightforward use sample monitoring known args within range simulation setting study also monitoring based metagenomics important factor obtain valid monitoring result technical sample high representativeness population interest compared monitoring based characterisation isolates metagenomics applied pooled sample result simulation indicate given economical constraint using technical sample 50–100 pooled faecal sample give valid result applying metagenomics monitoring amr danish pig population comparing result scenario high low abundance args metagenomics best performance monitoring change highly abundant args faster detect change fewer false signal monitoring change low-abundant args performance impaired fact random noise sampling laboratory procedure result false positive signal observed data solution increase magnitude change must observed classified change increasing cutoff value cost longer time detect true change detection new emerging args metagenomics better performance phenotypic-based monitoring using 50–100 sample per pool starting use metagenomics monitor amr population study elucidating effect decision criterion classifying change observed data true change must performed amount data information generated metagenomics comprehensively compared proportion resistant isolates pre-selected indicator bacteria specie comprehensiveness sequencing data must combined robust approach summarising metagenomic data outcome measure alignment aim surveillance system overall opportunity succeed strengthening surveillance amr animal population using metagenomics laboratory procedure applied large pool sample large pool sample increase representativeness monitored result dilution effect due pooling handled using high sequencing depth addition using metagenomics known args included monitoring program general result increased sensitivity monitoring likelihood false signal also increase balance sensitivity specificity monitoring program decision scientific question database used metagenomic analysis identify acquired args currently contains args due magnitude args monitored crude screening significant change chance result hundred false alarm every testing point time real setting well-functioning monitoring system characterized high negative positive predicted value likelihood absence signal monitoring system true reflection change true positive monitoring signal truly positive low negative predicted value monitoring system result emergence increased occurrence args extended identified preventive measure implemented low positive predictive value monitoring system useful unsubstantiated false-positive report result unnecessary investigation wasteful allocation resource monitoring change highly abundant args outcome iteration using different number sample sequencing depth similar indicating positive negative predictive value across different number sample per pool sequencing depth phenotypic characterisation isolates identify change positive predicted similar found monitoring based metagenomics negative predicted value significantly smaller many iteration true change detected detect newly introduced amr gene isolate pig population simulation setting almost irrespectively metagenomics phenotypic detection number sample used pool amr detected within year fig overall setup sample per monthly pool using metagenomics gave shortest time detection iteration using sample per pool metagenomics phenotypic characterisation isolates monthly newly introduced amr detected presented result simulation demonstrated overall performance monitoring program amr danish pig population depends abundance amr population sampling schedule laboratory method fast occurrence amr changing population threshold classifying observed change significant change situation monitoring amr population value positive negative predicted value monitoring system dependent characterisation monitoring system sample schedule data generated via laboratory method algorithm identify signal true occurrence amr population monitored optimize overall negative positive predictive value monitoring args population algorithm used screening result must take account args group args impose important risk human addition comparison consequence false signal unnecessary investigation wasteful allocation resource consequence time occurrence change detection uncontrolled spread args considered defining threshold used indicating change occurrence overall strength using metagenomics compared traditional phenotypic characterisation isolates known args monitored within laboratory analysis also metagenomic approach make feasible work pooled sample whereby larger proportion population interest represented sample method design study presented fig initially developed dynamic mathematical model describing occurrence change occurrence args interest population time model describes true occurrence args interest given time figure study flowchart study design adapted study full size image secondly model mimicking surveillance program overlaid model true occurrence simulate result observed surveillance given setting sampling schedule frequency sampling sample size pooling metagenomic procedure sequencing depth iteration taking account stochasticity sampling metagenomics time series observed data generated time series subsequently analysed statistically identify time point detection start change occurrence well estimate long-term trend addition given time series future occurrence arg interest population forecasted using forecasting methodology result statistical analysis finally compared known truth given dynamic model describing occurrence change occurrence arbitrary arg population time mathematical notification model describing true occurrence change occurrence arbitrary arg population time true occurrence arg study defined occurrence arg farm proportion farm positive within farm prevalence proportion pig within positive farm arg concentration arg faeces pig carrying gene concentration arg interest faeces obtained lognormal distribution fitted real-world data concentration args pig faeces chose lognormal distribution gave best fit data compared gamma weibull detail see supplementary fig study three different scenario true occurrence modelled representing args different occurrence change increased occurrence arg already widely present farm pig high-level endemic increased occurrence arg present lower frequency low-level endemic novo emergence novel arg emerging scenario used metagenomic data obtained sample collected previous study conducted danish pig population scenario used cpm args coding efflux pump causing resistance tetracycline tet tet tet tet tet tet tet tet teta tet tet type amr widely spread danish pig population therefore scenario proportion pig carrying amr set concertation varied pig within first month assumed increase concentration month introduced annual increase concentration scenario used cpm args coding resistance gentamicin enzymatic modification aac -ie- aph -ia type amr rearely occurs danish pig population therefore scenario prevalence animal within farm set accordance result observational study danish pig farm within first month assumed increase prevalence pig carrying amr month introduced annual increase prevalence scenario new arg introduced one farm population 4,000 farm arg allowed spread farm time emerging spread following generalized susceptible-infected si\ compartmental model detail see supplementary model based homogeneous mixing system transmission rate 0.148 resulting contaminated farm year spread described model considers spread arg farm soon arg introduced farm assumed occurrence pig carrying arg occurrence farm infected longer period assumed within-pig concentration emerging arg concentration blatem gene result observational study danish pig farm cpm extremely low compare use metagenomics surveillance current surveillance based culturing model mimicking surveillance also developed based approach result danmap surveillance phenotypic tetracycline resistance indicator bacteria enterococcus faecalis danmap used model increased occurrence antibiotic resistance already widely present farm pig high-level endemic phenotypic gentamicin resistance indicator bacteria e.coli danmap used model increased occurrence antibiotic resistance present lower frequency low-level endemic novo emergence novel antibiotic resistance assumed clone introduced one farm followed spread farm described spread emerging args scenario soon clone introduced farm assumed occurrence pig carrying clone occurrence farm infected longer period assumed within-pig occurrence emerging clone occurrence phenotypic gentamicin resistance indicator bacteria e.coli danmap model simulating result obtained surveillance program simulation generated result obtained hypothetical monitoring program including effect design monitoring—the frequency sampling number sample timepoint sampling study assumed sample collected time point pooled one single technical sample sequencing depending number dna fragment sequenced sequencing depth concentration arg interest initial output model number dna fragment assigned arg interest subsequently calculated count arg divided total million fragment sequenced sample—counts per million cpm thereby outcome surveillance amr using metagenomics cpm population cpm faecal sample product whether sample collected farm arg binomial\left prob farmprev collected animal within positive farm carrying arg binomial\left prob farmprev concentration arg animal carrying arg random draw lognormal distribution model includes pooling procedure number collected faecal sample timepoint sampling assumed pooled one technical sample dna sequencing mean cpm pooled faecal sample represents concentration arg technical sample given point time simulation conducted month sampling frequency per month theory design factor frequency sampling sample size sequencing depth infinite sensitivity monitoring program become lag time change occurrence detection change zero obtain realistic value design factor developed equation wherein price sampling sequencing integrated variable sample size sequencing depth summing given total annual cost monitoring program developed cost function estimate deep would able sequence pooled technical faecal sample given sampling faecal sample randomly collected month cost calculated using aligned total price lab cost lab technician cost price per sample price per fragment aligned number technical sample processed lab per month study k=1\ number sample pooling sequencing depth respectively detail see supplementary table important determinant likelihood metagenomics detecting emerging arg many gene fragment sequenced sequencing depth fragment sequenced sample random whereas number sequenced fragment pre-defined within certain range mean sequencing depth sample pool determined using rtruncnorm mean number observation month lower mean sequencing depth upper mean sequencing depth mean\ mean sequencing depth sd\ mean-a add randomness sequencing depth assume depth varying stochastically 0.17em mean following normal distribution range -20 equal 6sd simulation sequencing depth truncated 0.17em 3sd simulation scenario sub-scenarios iteration performed using monte carlo simulation representing time series observation calculating deviation observed true occurrence given setup simulation deviation observed data truth originates sampling error collection faecal sample deviation due sampling well gene fragment sequenced deviation due lab procedure two source error distinct one another compare two source error contribute deviation observed data truth observed data point time series decompose total deviation deviation due sampling lab procedure deviationsampling\left cpm sample\left cpm truth\left cpm deviationlab cpm observed\left cmp sample\left cpm subsequently absolute value deviationsampling deviationlab sampling schedule summarised compared relative also compare overall effect number sample sequencing depth close truth monitoring observed data point time series deviation calculated according deviation\_obs\_truth cpm observed\left cmp true\left cpm subsequently absolute value deviation_obs_truth summarised compared relatively different sampling schedule within scenario one two respectively statistical analysis time series obtained simulation performance surveillance program detecting ongoing change occurrence args population done initially identifying change observed data using breakpoint analysis subsequently calculating time start change given mathematical function defining true occurrence arg population time point change identified time-series observed data applying breakpoint analysis throughout time series observed data including initial period year true change also obtained number false alarm surveillance indicates change occurrence cpm occurrence changing breakpoint analysis—dbest method simulated observed data arg population using metagenomics analysed presence change occurrence time using breakpoint analysis reality occurrence endemic amr start change increase/decrease take place gradually months/years direct shift one level another within month package dbest statistical method applied analyse time trend detect change time dbest originally developed detect forecast change vegetation using remote information chose dbest ability handle cpm form continuous data possible surveillance package analysis program consider whole number study used dbest time-trend analysis looking change cpm arg interest time supplementary fig dbest detects estimate trend change two way abrupt non-abrupt timing magnitude number direction change dbest method five parameter must defined analysis description change_magnitude size change data indicate potential true change study used increase/decrease change_magnitude table cpm mean arg interest population increase occurred specified duration period breakpoint change must present indicate true persistent change given algorithm sensitivity detect change defined month study table table parameter used dbest method full size table following knowledge change args animal population time specified model statistical method identify non-abrupt change longer period abrupt change short time interval expected therefore parameter algorithm set look non-abrupt change therefore value first-level-shift second-level-shift set extremely high value whereby none detected change point classified abrupt technical issue worth noting alpha statistical significance level value used test significance detected change table show five parameter implemented dbest forecasting study based simulated data also tried forecast trend year month using package forecast trend obtained using exponential smoothing assuming additive error additive trend seasonality author contributor o.o.a. f.m.a. h.v conceived study o.o.a h.v designed study author acquired analysed data o.o.a. f.m.a. h.v interpreted finding o.o.a wrote first draft manuscript f.m.a h.v contributed writing subsequent version manuscript o.o.a developed code author critically reviewed paper approved final version corresponding author o.o.a final responsibility decision submit publication