introduction past decade powered exoskeleton widely used medical rehabilitation disaster relief military technology field rehabilitation engineering exoskeleton research dedicated develop technology system assisting patient motor impairment integrated advantage device reaction rate advanced control algorithm human robot interaction etc. could help patient perform necessary therapeutic training daily life without help medical staff demand better user experience recent year robot required ability proactive behaviour planning patient motion complex environment keep anti-disturbance important issue well efficiency traditional linear control method e.g proportional integral derivative pid typical representative important influence control theory engineering practice one disadvantage incapable handle strong nonlinear disturbance modeling disturbance development technology many advanced nonlinear control technique proposed improve tracking overall performance system disturbance uncertainty sliding mode control adaptive robust control neural network control remarkable design successfully solve control problem parameter uncertain system nonlinear disturbance system achieve better performance conventional linear controller however aforementioned control approach adopt full-state feedback control strategy mean state information i.e displacement velocity acceleration necessary practical perspective displacement information obtained relatively easily due potential structure limitation power limitation exoskeleton system besides measurement velocity acceleration usually contain noise factor also degenerate tracking performance full-state based control method therefore introducing feedback controller relay position information becomes natural progression known mpc method regarded effective tool deal uncertainty due mechanism feedback correction moving horizon optimization besides tackle complex nonlinear constraint flexibly mpc theoretically achieve optimal control system easily also drive development wide application mpc superior feature basic idea mpc deriving output prediction equation identifiable dynamic model controlled system build objective function based prediction control increment optimizing quadratic objective function generate optimal control law current state initially application mpc constrained slow-varying system e.g industrial field oil electricity aviation due limitation computation ability besides sampling period discretization need long enough ensure complete execution control algorithm latest decade improvement computing hardware mpc utilized fast system autopilot system robotic control despite impressive merit tracking performance mpc still improvable one problem control effect relies accuracy model could reduced disturbance uncertainty possible way solve issue design disturbance observer interesting control topic disturbance observer concept presented effective tool estimate influence disturbance control treating term dynamic model disturbance idea developed various form observer-based controller example proposed adaptive output-feedback controller based fuzzy state observer uncertain strict-feedback nonlinear system synthesized nonlinear robust controller hydraulic system control back-stepping method extended state observer eso studied integration mpc eso revise prediction model name moreover many outstanding accomplishment additionally achieved though eso-based mpc tracking control problem quad-rotor helicopter wind disturbance hydraulic system disturbance uncertainty well power converter system parametric uncertainty worth mentioning control study yield satisfactory performance rigorous theoretical property consequently expectable exploit eso mpc simultaneously control power exoskeleton disturbance encourages motivation paper paper proposed mpc strategy lower limb exoskeleton inspired recent progress linear eso model predictive control fundamental thought approach quadratic objective function solving final control law designed based uncertainty disturbance estimated designed eso coupling non-linearity unmeasured state disturbance wearer taken consideration contribution include following aspect introducing virtual variable dynamic model exoskeleton solves decoupling problem nonlinear multi-input-multi-output mimo system integrating eso mpc achieve tracking performance improvement exoskeleton strong disturbance proposing eso-based mpc controller depends position information exoskeleton improves practicability theoretical analysis prof proposed controller achieve specified tracking performance comparative experiment result demonstrate design significantly outperforms conventional mpc tracking effectiveness priority paper organized follows section dynamic model present dynamic model discussed exoskeleton section method present design eso mpc controller proof stability section experiment result present set virtual experiment result section conclusion conclusion dynamic model section two degree freedom dofs lower limb exoskeleton discussed dynamic model mpc controller derived limb exoskeleton composed two rotary joint two link modeled double pendulum two joint placed hip knee wearer respectively two link fixed thigh shank respectively model lower limb exoskeleton depicted fig worth noting point center waist relatively fixed space moving constant speed assumption consistent practical application rehabilitation exoskeleton patient relatively fixed bracket sling move forward constant speed mpc control scheme make exoskeleton taking step following set trajectory autonomously simplify study considered swing action one limb stepping cycle sagittal plane anterior-posterior direction thus two dofs motion monitored namely hip flexion angle knee flexion angle figure illustration lower limb exoskeleton left dynamic model sagittal plane right limb exoskeleton composed two rotary joint hip knee two link thigh shank modeled double pendulum full size image double pendulum considered potentially chaotic system since slight change certain parameter initial condition cause dramatic impact subsequent motion objective study make double link track motion trajectory thigh shank closely possible ensure smooth safe rehabilitation training patient mean tracking error disturbance must reduced minimum based second lagrange equation dynamic exoskeleton described aligned array _1=\left m_1 ^2+m_2 l_1^2+j_1\right +m_2 l_1 -\varphi +m_2 l_1 -\varphi +\left m_1 +m_2 l_1\right +\tau _2=m_2 l_1 -\varphi +\left m_2 ^2+j_2\right -m_2 l_1 -\varphi +m_2 +\tau array aligned represent mass moment inertia length thigh respectively represent mass moment inertia length shank respectively angular velocity angular acceleration hip joint knee joint respectively represent distance joint mass center two leg torque exerted respectively hip joint knee joint unknown torque generated human-machine interaction practice reasonable assume unknown control torque continuously differentiable define state variable vector x=\left control input vector u=\left =\left therefore based dynamic model system exoskeleton system presented state-space form aligned array =m^ f^m\left _d\right =b_0 u+d\left _d\right y=c array aligned =\gamma array -\left +j_ -\varphi -\varphi -\left +m_ +j_ array d\left =\left array array c=\left array llll 0\end array m=\begin bmatrix +m_ +j_ cos\left -\varphi cos\left -\varphi +j_ bmatrix d\left considered total disturbance system caused human-machine interaction nonlinear parameter deviation coefficient determined follows aligned =\gamma +j_ -\varphi +\left +m_ -\tau +\gamma -\varphi -\varphi -m_ -\tau =-\gamma -\varphi -\varphi +\left +m_ -\tau -\gamma +m_ +j_ -\varphi -m_ -\tau =\frac -\varphi -\left +j_ +m_ +j_ aligned worth mention practical work focused application used continuous dynamical model model system discretized convenient use stability analysis made upon discretized version method model analysis section physical parameter exoskeleton system i.e utilized design eso mpc controller based mpc theory obviously seen model system always subjected parametric uncertainty disturbance i.e uncertain time-varying parameter d\left accordingly treat total uncertainty model state-space equation main disturbance would estimated designed observer compensated mpc controller enhance tracking performance robustness system disturbance order accomplish task must first solve problem system decoupling strong coupling system decoupling control effective solution decoupling process realized solving inverse matrix using matrix decomposition method method simple also capable deal time-varying matrix achieve effect real-time control addition method relatively sufficient mathematical guarantee introducing virtual control variable u=\left array -\left +j_ -\varphi -\varphi -\left +m_ +j_ array input-output relationship link exoskeleton system written aligned array =\gamma +d_ =x_ array i=i ii\right aligned mean input link output =x_ single input-single output relationship virtual control variable controlled output link controlled output link virtual control variable completely decoupled therefore decoupling control multivariable system realized embedding controller parallel control vector output vector meanwhile actual control quantity determined formula virtual control quantity aligned u=d^ aligned therefore original state-space system written aligned x+b aligned a=\left array llll 0\end array b=\left array array d=\left let sampling time system notice sampling time system short enough meet performance requirement exoskeleton system applying forward euler discrete method discrete time model system given aligned array k+1 =\tilde +\tilde u^d +i_ t_s array aligned =\left i+t_ a\right =t_ =t_ design mpc controller eso following assumption made paper assumption time-varying non-linear disturbance bounded satisfy aligned aligned positive constant assumption according mpc theory let prediction horizon control horizon system state prediction equation output prediction equation derived state-space equation based following assumption aligned k+i i=n_ k+i =\delta k+i i=1,2 i=1,2 aligned denote increment control law system disturbance coefficient respectively eso design objective designing eso estimate total model disturbance real time accordingly first extend uncertainty additional state variable let represent time derivative respectively i.e =\dot =\dot extended state defined =\left extended state-space equation system expressed follows aligned array =a_ +b_ +h_ =c_ array aligned =\left array llllll 0\end array =\left array 0\end array =\left array array let denotes estimation extended system model linear form eso designed follows aligned =a_ z+b_ y-\hat aligned l=\left represents observer gain considered bandwidth observer analyze designed eso characteristic polynomial inferred aligned =\left s+\omega aligned let represents estimated error i.e =x_ -z\ estimation error shown follows aligned =\left array cccccc -\omega -\omega array +h_ aligned define =\textrm diag estimation error rewritten aligned =\omega +m_e aligned m_e= 0,0,1,0,0,1 hurwitz matrix inferred lemma reference assuming bounded estimated state always bounded exist constant positive integer finite time satisfy following equation aligned =o\left i=1,2 aligned lemma inferred designed eso stable addition estimation error system uncertainty made arbitrarily small increasing bandwidth according primary analysis therefore estimated value total disturbance obtained observed value i.e =z_ =z_ discrete time model eso given aligned array k+1 =\tilde +\tilde +\tilde -\hat =c_ array aligned =i+t_ =t_ =t_ mpc controller design subtracting state two adjacent sampling instant incremental form model system derived expressed aligned array k+1 =\tilde +\tilde +i_ k-1 array aligned k-1 state increment =u^ -u^ k-\ control increment =\hat -\hat k-1 disturbance increment taking current time step current system state initial condition state increment prediction k+1 time step k+1\ represented k+1 predictive system output k+1 time step k+1\ represented k+1 assuming prediction time domain control time domain based assumption state prediction equation conducted follows aligned k+1 +\tilde +i_ k+2 +\tilde +\tilde k+1 +\tilde x\left k+n_ k\right +\tilde +\tilde k+1 +\cdots +\tilde -n_ k+n_ -1\right +\tilde aligned additionally output prediction equation derived based expressed follows aligned k+1 y\left k+n_ k\right i=1 +\sum i=1 i-1 +\sum i=1 i-1 k+1 +\cdots k+n_ -1\right i=1 i-1 y\left k+n_ k\right i=1 +\sum i=1 i-1 +\sum i=1 i-1 k+1 +\cdots +\sum i=1 -n_ i-1 k+n_ -1\right +\sum i=1 i-1 aligned define follows aligned k+1 =\left k+1 k+2 k+n_ k\right =\left k+1 k+n_ -1\right aligned therefore output prediction equation reformed aligned k+1 =h_ +h_ +h_ +h_ aligned matrix determined matrix estimated error neglected made small enough increasing eso gain effect estimation error analyzed next subsection objective function mpc designed reflect control tracking performance controlled exoskeleton system optimal control sequence obtained optimizing quadratic objective function order track desired trajectory objective function controlled exoskeleton system designed follows aligned j=\left\| k+1 -x_ k+1 +\left\| aligned first term right equal sign terminal constraint second term control law increment constraint dynamic constraint diagonal weight matrix tracking error control increment respectively addition k+1 -dimensional vector represents reference trajectory substituting optimal control sequence solved expressed aligned =\left +q^ q\right k+1 aligned k+1 =x_ k+1 -h_ -h_ -h_ calculated based reference trajectory system output real-time according moving horizontal optimization mechanism mpc controller first term optimized control sequence input controlled system sampling period optimization process repeated next sampling period optimal control law mpc described aligned =k_ k+1 =u^ k-1 +\delta aligned 1,0 +q^ q\right regarded predictive control gain hard notice pre-calculated offline reduce computing load processor stability proof stability proposed eso-based mpc controller analyzed subsection based stability proof lyapunov theoretical framework first substituting k-1 rewritten aligned k+1 -k_ -k_ -k_ k+1 -k_ +h_ c\right -k_ -k_ k-1 aligned substituting incremental model discrete system disturbance written follows aligned k+1 +\tilde +i_ -k_ +h_ c\right +k_ k+1 +\left -k_ -k_ k-1 aligned similarly substituting k-1 =c_ incremental model discrete eso derived follows aligned k+1 +\tilde +\tilde -\hat =\left c-k_ c\right +\left -\tilde +k_ k+1 -k_ +\left -k_ k-1 aligned based state increment closed-loop system defined aligned =\left aligned consequently closed-loop system eso-based mpc described aligned k+1 +k_ k+1 +\left array -k_ -k_ array array -k_ array k-1 aligned =\left array -k_ +h_ c\right c-k_ +h_ c\right -\tilde array closed-loop system obtain nominal asymptotic stability total eigenvalue matrix within unit circle remark parameter adjustment proposed controller observer discussed mpc controller matrix objective function reflect design expectation tracking performance control increment matrix weighting factor matrix tracking error larger matrix closer theoretical system output reference trajectory matrix weighting factor matrix control increment larger matrix smaller control quantity system meanwhile matrix also crucial stability closed-loop system practice overlarge matrix may cause system instability due system state chattering therefore process matrix parameter adjustment matrix first adjusted based performance tracking error matrix adjusted meet limitation control increment alleviate control input chattering remark another set important parameter mpc controller prediction horizon control horizon ideally long enough predict system dynamic response long possible however unrealistic predict whole process due limitation computational cost time hence compromise scheme usually adopted taking lower limit prediction horizon length obvious change time step direct effect control input next time step k+1\ long-term effect system response acceleration time step k+2\ velocity time step k+3\ displacement time step k+4\ therefore choose minimum value prediction horizon =5\ implementation apparently length control horizon prediction horizon represents number step input control quantity seen constant predicting future output system similarly reduce calculation time amount optimization process choose =2\ paper remark considered bandwidth designed eso theoretically increasing bandwidth estimation error total disturbance state made arbitrarily small overlarge mean increasing sensitivity eso noise may cause chattering estimation amplification measurement noise etc adjustment process started small value gradually increased improve performance observation overall tracking performance reaching satisfied level implementation experiment result section explore tracking performance proposed eso-based mpc controller applied task exoskeleton motion control comparing conventional mpc strategy attempt demonstrate advantage proposed controller tracking accuracy disturbance setup evaluation co-simulation model exoskeleton system built shown fig order test verify tracking performance proposed controller firstly model existing lower limb exoskeleton product designed cooperative team computer via adam considering calculation cost non-critical part exoskeleton simplified screw rubber pad strap etc besides joint exoskeleton i.e hip knee ankle setup contact connection simulate real status system power supply problem replace actual driving motor cartridge ddr motor c043a c053a kollmorgen usa ideal virtual driving force limit control force increment mpc controller based physical characteristic motor -50 +50 -25 +25 avoid discus power control characteristic motor co-simulation figure control flow diagram co-simulation model deviation eso estimated position reference position combining total disturbance also obtained eso estimation substituted mpc controller obtain optimal control torque control quantity input exoskeleton dynamic model obtain actual position feed back controller form closed loop control system full size image though previous experiment interaction force human body exoskeleton measured shown fig considered external disturbance applied corresponding position model reference trajectory human lower limb given work researcher based composition exoskeleton system nominal value component parameter listed table control strategy consists eso mpc controller software interaction data collection realized via matlab simulink sampling time control system set =0.01 figure interaction force human body exoskeleton upper sub-figure interaction force thigh exoskeleton lower sub-figure interaction force shank exoskeleton full size image table parameter exoskeleton system full size table evaluate tracking performance control approach two control algorithm i.e fuzzy-pid conventional mpc quantitatively qualitatively quantitative description tracking performance visualized figure apparently controller show clear improves tracking accuracy disturbance quantitative evaluation three performance index including maximum tracking error average standard deviation tracking error utilized evaluate tracking accuracy method defined follows maximum absolute value overall tracking error defined aligned =\max i=1 aligned number recorded sample tracking error sample average tracking error defined aligned =\frac aligned standard deviation tracking error defined aligned =\sqrt aligned result discussion formally tracking trajectory human lower limb first conducted control test hip joint angle evaluate speed proposed controller compared result fuzzy-pid conventional mpc experimental condition consistent previous description reference trajectory set step function degree degree shown solid line fig performance three controller shown fig seen controller inferior pid term control speed superior traditional mpc significantly superior term overshoot addition strategy also better performance term terminal accuracy figure tracking performance three control scheme solid line reference trajectory set step function dotted line represents pid control result dashed line represents mpc control result dash-doted line represents strategy control result full size image control input overall tracking performance aforementioned three controller i.e fuzzy-pid conventional mpc proposed controller shown fig respectively performance index three controller collected table simulation result show proposed controller outperforms two controller tracking performance stronger robustness help estimation designed eso controller achieves higher tracking accuracy conventional mpc controller also demonstrates disturbance rejection ability designed eso-based mpc controller specifically main reason controller surpasses conventional mpc model-based compensation mpc method also employed linear eso estimate total disturbance case external torque modeling uncertainty integrated output predictive equation system word building novel output prediction equation eso-estimated total disturbance response controlled exoskeleton system predicted accurately enables optimization solution control quantity obtained precisely solving novel objective function containing disturbance hand comparing fig although performance conventional mpc controller good better fuzzy-pid indicates traditional mpc method still acceptable robustness besides control input proposed controller bounded shown fig figure tracking performance three scheme hip joint control solid line reference trajectory refers hip flexion angle human hip joint one gait cycle dotted line represents fuzzy-pid control result dashed line represents conventional mpc control result dash-doted line represents strategy control result full size image figure tracking performance three scheme knee joint control solid line reference trajectory refers knee flexion angle human knee joint one gait cycle dotted line represents fuzzy-pid control result dashed line represents conventional mpc control result dash-doted line represents strategy control result full size image figure control input control scheme upper sub-figure control torque hip joint lower sub-figure control torque knee joint full size image shown table controller show better tracking accuracy index introducing linear eso mpc mean tracking error proposed controller reduced 0.93 degree hip flexion angle 1.07 degree knee flexion angle mean tracking error mpc controller 1.45 degree hip flexion angle 1.61 degree knee flexion angle compared conventional mpc tracking performance controller improved 34–35 furthermore controller greater advantage compared fuzzy-pid tracking performance improved 35–39 table performance index aforementioned three control scheme full size table conclusion paper proposed disturbance rejection model predictive control strategy based eso lower limb rehabilitation exoskeleton key integrate estimation system total disturbance quadratic objective function used solving optimal control law mpc first introduce virtual control variable decouple exoskeleton system construct eso based expanded decoupled system estimate model uncertainty disturbance wearer total disturbance based stability theory lyapunov framework stability closed-loop system ensured indicates proposed eso-based mpc controller prescribed tracking performance condition disturbance uncertainty comparative virtual experimental result demonstrated control scheme exoskeleton outperforms two existing technique fuzzy-pid conventional mpc effectiveness priority strong disturbance case result achievement contribute better rehabilitation training patient using lower limb rehabilitation exoskeleton limitation future work paper certain simplification made physical model lower limb rehabilitation exoskeleton control strategy proposed gait sagittal plane simplify study addition regard human-machine interaction force system parameter uncertainty total disturbance observed compensated pose pose challenge performance eso future work refinement physical model exoskeleton carried problem gait walking three-dimensional space considered addition design eso observe interaction force uncertainty separately depending system modeled