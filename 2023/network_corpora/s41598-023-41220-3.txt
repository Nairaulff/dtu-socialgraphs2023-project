introduction demagnetization curve magnetization hysteresis curve second quadrant provide useful information characteristic property hard-magnetic material magnetic energy product maximum max magnetostatic energy calculated demagnetization curve besides remanence coercivity directly obtained respect demagnetization curve granular hard magnet key understanding magnetization reversal enhancing performance hard magnet thus characteristic shape demagnetization curve intensively studied earlier theoretical work including macrospin approximation sharrock equation linear response theory avrami kinetics jiles-atherton equation preisach formalism micromagnetic theory micromagnetic theory simulation allow determining demagnetization curve hysteresis curve according variety factor including intrinsic material parameter microstructures damping constant field sweep rate thus helping understand correlation demagnetization curve microstructures/compositions granular magnet example microstructure effect individual grain macroscopic performance hard magnet extensively investigated term size crystallographic orientation grain well precipitated phase within grain boundary thickness recently several machine-learning model also revealed correlation coercivity max switching field hysteresis loop microstructure fingerprint ai-driven understanding key microstructure factor played pivotal role custom design internal microstructures hard magnet context intriguing explore underlying physic magnetization reversal core–shell multi-main phase mmp magnet magnet fabricated conventional magnetic material dual-alloy process aim substituting costly neodymium element abundant lanthanide example reported mmp magnet incorporating la-ce exhibited higher cost performance single-main-phase magnet composition albeit roughly reduction max value enhanced cost performance attributed exchange coupling interface intergranular dipolar interaction according measurement curie temperature recoil curve also several machine learning model applied study hard-magnetic material deduce input-to-output relationship magnetic property even relatively small number datasets however model often limitation explicitly revealing internal parameter especially case highly accurate model neural network explainable artificial intelligence xai technique offer solution providing set number known importance value value quantify contribution input feature model output importance value extracted using specific algorithm including kernel shapley additive explanation shap study utilized novel approach grain-by-grain analysis demagnetization curve individual grain given mmp magnet order understand underlying reversal mechanism mmp magnet contributing overall demagnetization curve entire volume applied grain-by-grain analysis datasets obtained finite-element micromagnetic simulation simulation conducted core–shell sphere cluster model various inhomogeneous magnetic phase ndcefe different shell composition surrounding core sphere discovered overall nucleation field coercivity divided two distinct broad narrow distribution nd-rich nd-lean individual grain respectively attributed difference stray field resulting dipolar interaction individual sphere influence nucleation field reversed domain sphere according kernel shap analysis machine-learning model constructed coercivity either nd-rich -lean grain magnitude stray field position grain major factor contributing broader distribution coercivity nd-rich grain model interpretation align finding adjustment shell composition grain type manipulate nucleation coercive field via intergranular magnetostatic interaction role magnetostatic interaction explained analytical nucleation model composed two hard-magnetic sphere result discussion core–shell sphere cluster model inhomogeneous magnetic phase model studied composed spherical grain arranged double-layered cuboctahedron configuration core–shell structure sphere fig among various truncated octahedron cuboctahedron posse sphericity 0.905 close cuboctahedron cluster comprises specific number sphere given number layer cluster model sphere cluster model designed demagnetization factor 1/3 direction thus eliminating possible shape anisotropy overall cluster volume spherical grain diameter 2-nm-thick shell sphere separated neighboring grain 2-nm air gap fig note model incorporate soft nonmagnetic defect could serve nucleation site pin domain wall thereby potentially leading overestimated coercivity compared experimental value diameter considerably larger critical diameter 19.7 coherent magnetization rotation smaller diameter multi-domain state prevalent air gap neighboring grain inhibits short-range exchange coupling thereby behaving nonmagnetic phase figure perspective view sphere-cluster model sphere featuring core–shell structure along indicated dimension dimension core–shell structure within sphere individual sphere separated 2-nm thick nonmagnetic medium inset show surface mesh sphere class-i geodesic polyhedron 3,5 19,0 cuboctahedron cluster model consisting nd-rich sphere red-tinted color nd-lean sphere blue color ndcefe covered thin shell pink light blue respectively full size image emulate inhomogeneous phase mmp magnet sphere cluster model consisted two core distinct compositions—nd nd-rich ndcefe nd-lean enveloped single shell 0.5 respectively notably nd-rich sphere nd-lean sphere randomly dispersed illustrated fig model assume net content two different shell encompassing nd-rich -lean core conserved irrespective given value configuration nd-rich nd-lean sphere kept constant varied within range 0–0.5 increment 0.1 assumed core–shell microstructures formed diffusion process ndcefe particle mixed 5:5 ratio diffusivity atom scenario atom particle atom ndcefe particle presumed exchange 1:1 rate possible composition nd-rich nd-lean shell anticipated 0.5 respectively demagnetization curve figure show example simulation result overall demagnetization curve thick black line sphere entire cluster model system two separate demagnetization curve exclusively representing nd-rich -lean sphere case 0.3 overall demagnetization curve exhibit significant sudden drop beyond nucleation field succeeded series relatively smaller-step curve type curve typical reversal process nucleation reversed domain often observed exchange-decoupled magnet entire demagnetization curve dissected two separate curve obtained nd-rich -lean sphere depicted red blue color respectively notably two decomposed demagnetization curve exhibit stark contrast single pronounced step-drop nd-lean sphere versus numerous minor step-drops nd-rich sphere detail nd-lean sphere show sharp significant drop magnetization 4.3 nd-rich sphere show moderate-step drop many minor step drop therefore entire-system value cumulative result reversal nd-rich -lean sphere dominated switching nd-rich sphere moreover reversal process nd-rich sphere composed sequence successive switching individual nd-rich sphere different nucleation field across wide range sequential reversal process nd-lean -rich grain visually depicted supplemental movie available online figure demagnetization curve obtained core–shell sphere-cluster model 0.3 pink- light-blue- black line correspond normalized curve nd-rich sphere nd-lean sphere sphere respectively full size image grain-by-grain analysis demagnetization curve reversal individual sphere understand overall demagnetization curve characterized numerous step-like drop magnetization shown fig performed grain-by-grain analysis separating demagnetization curve individual sphere multiple step observed overall demagnetization curve result different nucleation field required switching reversed domain individual sphere interpreted demagnetization curve sphere-by-sphere figure highlight part cluster model emphasizing nd-lean sphere labeled twelve nearest neighboring sphere demagnetization curve sphere sphere separately plotted fig value sphere five nd-lean sphere ranged 4.26 4.32 figure show snapshot image local -component magnetization distribution 4.27 4.29 4.31 sphere twelve sphere magnetization reversal occurred sphere-by-sphere via individual switching sphere similar exchange-decoupled magnet although reversal sphere coherent quantitatively interpret switching individual sphere demagnetization curve plotted represent varying value coercive field nucleation field field width illustrated different sphere parameter defined field obtained 0.9 respectively defined difference 0.9 0.9 since reversal sphere model incoherent within volume sphere value also approximately measure mobility domain wall within sphere figure representation grain-by-grain analysis demagnetization curve highlight sphere surrounding single sphere labeled demagnetization curve several individual sphere along coercive force nucleation field slope defined within diagram thick blue line indicates demagnetization curve sphere thin line correspond neighboring sphere snapshot image describe temporal magnetization indicated value external magnetic field color indicate indicated color bar full size image distribution individual sphere distribution value nd-rich red color nd-lean blue sphere core–shell sphere cluster model inhomogeneous composition 0.3 depicted histogram fig normal distribution curve nd-rich -lean sphere separately plotted accompanied corresponding mean standard deviation value calculated using following equation 2\pi 2\left 2\pi 2\left represents number nd-rich nd-lean sphere including core shell nd-rich nd-lean sphere model denotes bin width histogram refer mean value standard deviation respectively fitting value mean standard deviation summarized supplementary table online normal distribution curve obtained manner nd-rich grain distributed wide range 4.5 mean value 5.07 5.06 standard deviation 416.7 418.0 respectively contrast nd-lean sphere displayed relatively narrow distribution centered around 5.07 5.06 standard deviation 18.5 17.8 respectively hence many step-like demagnetization curve nd-rich grain seen fig attributed variation nucleation field across wide range extremely broad range nd-rich grain explained following section reference uneven distribution stray field affecting nd-rich grain hand similar narrow distribution 19.5 17.0 3.20 2.76 nd-rich -lean grain indicate comparable domain wall mobility type grain according one-dimensional model speed domain wall expressed ext domain wall width ext applied magnetic field driving domain wall width domain wall curved geometry depends curvature value position within sphere particle well direction domain wall expansion relative crystallographic orientation taking account bloch domain wall width core region mean coercive field driving field value 1.34 1.48 5.07 4.29 nd-rich nd-lean grain respectively value nd-rich -lean grain estimated 1.88 km/s 1.75 km/s respectively value differ 7.0 two type grain compensated result 10.6 18.3 difference value driving field figure histogram displaying distribution value individual sphere case 0.3 red bar indicate nd-rich sphere blue bar denote nd-lean sphere dotted line represent fitted normal distribution nd-rich -lean sphere full size image explaining broader distribution nd-rich grain machine learning approach identify mechanism behind broad distribution observed nd-rich grain constructed machine learning model based artificial neural network extracted feature importance value quantitatively measure influence feature model output using kernel shap interpretation previous study identified crystallographic misorientations relative position grain key feature determining grain switching field similar manner compiled feature characterizing grain include material parameter relative position grain number neighboring grain different type rich lean mean stray field acting grain stray stray stray stray stray stray stray vector stray field acting -th grain calculated using approximate macrospin model employ volume-average -component magnetization stray magnetic scalar potential core core 3\mu_ core shell shell 3\mu_ shell core core shell core shell core shell saturation polarization volume-average -component magnetization radius core shell part -th grain center-to-center distance angle -th grain stray field closely corresponded demagnetizing field calculated micromagnetic simulation exemplified case sphere shown supplementary fig online using feature trained artificial neural network model different set hyperparameters optimized fast simulated annealing vfsa algorithm optimized model accurately reproduced prediction value comparable original datasets fig prediction root mean square error rmse 5.3 4.2 102.4 26.9 score 0.99 0.01 0.96 0.019 training test datasets respectively fig employing kernel shap interpretation method extracted importance value feature measure contribution model prediction therefore negative importance value contributes larger positive one smaller figure machine learning approach analyzing coercivity variation parity plot comparing original simulation data prediction made machine learning model pred using different set hyperparameters optimized vfsa large dot shaded orange green indicate prediction train test datasets respectively small dot red deep-green represent mean prediction train test datasets respectively violin plot depicting rmse simulation datasets prediction train test datasets made model kernel shap interpretation reveals importance value feature used train model feature negative importance value enhance positive value reduce full size image fig importance value calculated prediction neural network model summarized violin plot whisker indicating maximum medium minimum value among feature contribution stray field magnitude stray important factor nd-rich grain second important nd-lean grain importance value 0.706 -0.243 respectively number neighboring nd-rich grain rich key factor increased nd-lean grain value 0.29 also factor decreased nd-rich grain value 0.169 contrast -position grain decreased nd-lean grain importance value 0.105 increased nd-rich grain 0.344 however material nature grain negligible effect either type grain 0.02 nd-lean 0.01 nd-rich grain nd-rich grain influenced significantly stray importance value 0.706 0.344 nd-lean grain 0.243 0.105 consequently broader distribution nd-rich grain attributed stray field -position grain referenced study latter one prevalent feature weak grain resulted anomalously small value switching field magnetic energy product though importance value stray similar trend showed weak correlation 0.06 model latter part paper analyze switching field perspective stray field interpretation based eigenvalue problem rooted micromagnetic theory grain-by-grain analysis inhomogeneous magnetic phase account distinct dependency coercive force nucleation field examined demagnetization curve using grain-by-grain analysis shown histogram see fig mean standard deviation parameter different value summarized supplementary table online fig along single-main-phase model shown fig mean nd-lean grain decrease value increase aligned trend overall nucleation field hand increase following trend overall coercive force variation explained term inverse dependence anisotropy field 2\mu_ monotonically varies 6.71 5.24 0.5 indicated kronmüller relation nj_ microstructure factor effective demagnetization factor increase content shell suggests depletion atom shell nd-rich grain leading decrease anisotropy field nd-rich grain shell region reversed domain initially nucleated time surplus atom integrated shell region nd-lean grain enhancing anisotropy field discus dependence detail next section using empirical relation compare parameter single-main-phase model value marked green asterisk lying curve nd-rich -lean grain due intermediate content material assumed single-main-phase magnet model 1.5082 0.4918 figure histogram depicting distribution value individual sphere different value 0.1 0.2 0.3 0.4 0.5 vertical gray line histogram indicate corresponding median value 0.3 full size image figure plot averaged nd-rich nd-lean sphere fucntion green asterisk indicates single-main-phase sphere cluster model 0.3 full size image figure coupled stoner-wohlfarth model model geometry vertically aligned magnetic particle radius separated interparticle gap plot coercive field discrepancy relation radius interparticle gap shown logarithmic scale fitting curve using represented dotted line plot nucleation field discrepancy relation saturation polarization surrounding grain fitting curve represented dotted line full size image exploring mechanism behind variation previous section found stray field essential among feature however relying solely results-driven machine learning model inference lack physic background therefore section established analytical model involves solving nucleation problem classical micromagnetic theory worth noting nucleation field varies different although overall chemical formula sphere cluster 0.491 0.5 minimal difference cerium stoichiometry varying 1.8 apart chemical composition microstructural factor intergranular exchange stiffness easy axis alignment grain size cause discrepancy experimental ideal coercivity and/or nucleation field problem well-known brown paradox previous study discrepancy experimental ideal coercivity granular material explained relation demagnetizing field demagnetizing field linked physical characteristic grain cavity field originating sheath grain demonstrated monte-carlo simulation however assessing coercivity simulation method limitation calculated coercivity depends dynamic feature model system damping parameter sweep rate furthermore method provide detailed insight mechanism behind relationship material parameter coercivity analytical expression thus used analytical macrospin model account inter-particle magnetostatic interaction energy demonstrate stray field reduce coercivity magnetically coupled particle nucleation field calculated using principle second derivative magnetic energy hold zero eigenvalue nucleation reversed domain begin developed model geometry composed two hard-magnetic sphere radius center-to-center distance exhibiting uniaxial anisotropy fig around point nucleation magnetic energy two sphere coupled magnetostatic interaction approximately given s,1 n,1 s,2 n,2 s,1 s,2 correspond spin angle saturation magnetization ideal nucleation field sphere respectively first second term taylor expansion stoner-wohlfarth particle second order verge nucleation h\cos h\cos 2k_ representing ideal nucleation field using nucleation condition state determinant becomes zero nucleation nucleation field -th sphere coupled system given n,1 n,1 s,2 based dependency relation decrease nucleation field general system grain radius interparticle distance saturation magnetization particle scale follows positive exponent validate scaling rule performed additional micromagnetic simulation simulation conducted using material parameter ndcefe sphere radius ranging center-to-center distance 6.4 409.6 satisfies 2r\ coercive field calculated applying external magnetic field direction sphere initially magnetized 0,0,1 fig difference coercive field system coercive field single sphere dimension plotted along fitting curve based parameter extracted datasets ranged 0.13 1.35 0.35 1.68 respectively empirical relation applied datasets fig aiming illustrate discrepancy nucleation field calculated simulation ideal nucleation field described value 0.1 0.2 0.3 0.4 0.5 fitted fig discrepancy nucleation field nd-rich -lean grain plotted volume-average saturation magnetization nd-lean -rich grain logarithmic scale volume-average saturation polarization calculated based volume fraction follows core core shell shell core core shell shell representing volume fraction saturation polarization nd-rich -lean grain ideal nucleation field curling rotation mode calculated 2x_ 2\mu_ 2.0816\ value obtained fitting fig 3.97 11.8 respectively indicating positive value according analytical nucleation model stray field alone account large part discrepancy mismatch calculated ideal coercivity value addressing eigenvalue problem two-sphere model demonstrated introduction stray field magnetostatic interaction term result decrease nucleation field finding consistent interpretation given kernel shap machine-learning-based regression model shown fig mathematical standpoint convex position energy function approximately expanded polynomial shown altered superposition stray field emanating magnetic charge domain considering stray field uniformly magnetized sphere result surface magnetic charge stray field model explain coercivity mechanism core–shell mmp magnet potentially phenomenon related microstructure brown paradox directly applying macro-spin model previously published experimental result mmp magnet proved challenging however model demonstrates decrease increase decrease provides insight previous experimental observation related grain size grain-to-grain exchange interaction example decrease increase attributed surface defect analogue structural mechanical weakest-link statistic hand reduction increased inter-grain exchange coupling explained micromagnetic simulation earlier study comparison single-main-phase model comparison inhomogeneous phase magnet model also examined single-main-phase magnet model homogeneous composition equivalent 0.3 1.51 0.49 value individual sphere extracted using aforementioned grain-by-grain analysis summarized fig supplementary table online mean value homogenous phase model 4.87 4.86 respectively excluding four outlier value spanning 5.5 outlier value correspond delayed reversal specific grain small amount negligible effect overall coercive force nucleation field hand standard deviation 13.1 12.7 respectively inhomogeneous phase model 0.3 distribution mean value 16.3 single-main-phase magnet model similar inhomogeneous phase model hence calculated domain-wall speed 1.88 km/s roughly equivalent mmp model standard deviation also mmp grain similar case figure histogram distribution value individual sphere homogenous composition equivalent core–shell sphere cluster model 0.3 dotted line represent normal distribution full size image overall nucleation field coercive force explained previous section superior single-main-phase magnet model compared mmp model composed nd-rich grain nd-lean grain important note content mmp dual-main phase magnet single-main phase magnet generally different starting material due formation precipitate phase around thermodynamically stable b-phase grain summary utilized finite-element micromagnetic simulation investigate individual demagnetization curve sphere varying nd-rich -lean core-shells within sphere- cluster model overall demagnetization curve entire inhomogeneous magnetic phase constructed summation demagnetization curve individual grain grain-by-grain analysis coercive force nucleation field grain observed nd-lean grain reversed nucleated nearly identical least similar value followed intermittent reversal nucleation nd-rich grain widely varying value attributed localized irregular dipolar field produced nd-lean grain undergone reversal nd-rich grain furthermore machine learning analysis using kernel shap interpretation indicates significant contribution stray field reversed nd-lean grain reversal nd-rich grain wide switching field range similar narrow distribution observed nd-rich -lean grain attributed comparable domain-wall mobility compared reversal inhomogeneous magnetic phase mmp single-main-phase model showed relatively narrow distribution 13.1 12.7 mean value higher mmp model emphasize magnitude mmp model trended mean value nd-lean grain respect value magnitude mean value nd-rich grain owing distinct distribution value two type grain furthermore according proportionality anisotropy field kronmüller relation mean value nd-lean grain increased due addition atom shell nd-rich grain decreased due atom depleted shell work offer guidance optimal design granular hard magnet composed abundant rare earth transition element aiming cost-effective performance meticulous adjustment microstructures elemental composition method micromagnetic simulation demagnetization curve sphere cluster model numerically calculated using finite-element micromagnetic simulation tool femme tool solves landau-lifshitz-gilbert equation eff gyromagnetic ratio permeability vacuum damping constant eff reduced magnetization effective field used interpolated value material parameter exchange constant 7.7 pj/m saturation polarization 1.61 uniaxial anisotropy constant 4.3 mj/m exchange constant 5.0 pj/m saturation polarization 1.17 uniaxial anisotropy constant 1.5 mj/m represent given compositional alloy material damping constant set expedite convergence initial magnetization configuration assumed external magnetic field linearly decreased span finite-element mesh sphere surface constructed using geodesic polyhedron approximation sphere composed triangle fig edge length shorter exchange length 2.7 design ensures correct evaluation exchange interaction term model system small size micromagnetic cell allow precise description domain wall 3–5 restricted mesh size finite-element simulation 2a_ 2a_ present femme simulation mesh size sufficient accurately describe domain wall configuration material characteristic width bloch 4.24 class-i icosahedron-based geodesic polyhedron subdivision frequency edge length approximately 1.98 3,5 19,0 wenninger notation calculated using open-source code antiprism tetrahedron mesh generated inside geodesic polyhedron using tetgen software optimization machine learning model develop machine learning model generated artificial neural network ann model using scikit-learn package python employed mlpregressor function scikit-learn package generates single-layered artificial neural network trained via backpropagation hidden layer consisted node input layer took nucleation field core shell part grain total divided training set test set due small size datasets trained machine learning model various hyperparameters determined fast simulated annealing vfsa algorithm nevertheless majority machine learning model showed fairly good prediction 0.92 vfsa algorithm incorporated adaptive cooling schedule cand curr cand curr indicate objective function candidate solution current solution respectively candidate solution hyperparameters searched time temperature continuing current temperature reached –30 kernel shap interpretation trained machine learning model analyzed kernel shap interpretation implemented implemented alibi package according ref importance value machine learning model calculated contribution -th feature feature output model denoted reference average output 0,1\ explainable model coalition vector respectively