introduction biobank genetic data integrated electronic health record ehr come development predictive model designed healthcare application urgent need develop robust modeling pipeline using machine learning determine whether ehr-derived common clinical risk factor predict phenotype interest whether adding genetic factor improve model performance several factor considered model development including selection bias biobank data case–control imbalance temporal bias feature acquisition impact confounding factor optimal model selection capture multi-way interaction predictive power generalizability final model choose clostridioides difficile infection cdi proof-of-concept given complexity clinical importance purpose study develop integrated pipeline predicting symptomatic cdi using common ehr-derived clinical genetic risk factor focusing symptomatic cdi driven fact testing treatment cdi recommended asymptomatic individual cdi considered common cause healthcare-associated diarrhea listed one top five urgent antimicrobial resistance threat center disease control prevention http existing literature reporting cdi prediction focus three outcomes—symptomatic infection severity infection recurrence prediction model developed field vary setting patient recruitment data source study design feature selection algorithm ehr-based study become popular due improved predictability specificity generalizability host genetic susceptibility cdi epidemiology difficile strain topic investigation intestinal inflammatory cytokine correlate closely disease severity pathogen burden mechanism inflammatory cytokine applies inflammatory cytokine signature plasma level il-6 il-8 tnf-α prediction covid-19 severity survival previous candidate gene approach revealed genetic polymorphism rs4073 –251t rs2227306 781t/c pro-inflammatory cytokine il-8 associated il-8 production predisposition cdi functional impact efigure genetic marker yet included established disease scoring system clinical decision tool risk stratification cdi due unclear causality small effect size complex gene environment gxe interaction data availability/accessibility material method study conducted reported according transparent reporting multivariable prediction model individual prognosis diagnosis tripod guideline geisinger institutional review board approved study meet non-human subject research using de-identified information research performed accordance relevant guidelines/regulations geisinger built performs regular update de-identified structured ehr database research linked mycode community health initiative biorepository structured ehr matching genetics data allowed conduct retrospective study primary cdi informed consent obtained subject and/or legal guardian mycode patient analysis pipeline well cdi-specific study parameter illustrated fig figure flowchart illustrated sample size pipeline prediction model development full size image robust phenotyping algorithm phenotype algorithm used identify cdi case control ehr data developed emerge entitled phenotype algorithm pseudo code august collected phenokb http algorithm adopted golden standard used laboratory test data identify cdi case based clinical symptom first identified adult age cdi geisinger ehr three consecutive liquid stool within day may tested difficile based recommended guideline polymerase chain reaction used laboratory reference standard test patient tested difficile negative result exposed antibiotic high moderate risk appendix- served control nongenetic risk factor collected study included index age people healthcare setting antibiotic treatment underlying comorbidities inflammatory bowel disease ibd type diabetic mellitus t2dm hiv cancer medication chemo transplant corticosteroid anti-tnf proton pump inhibitor ppi observation window risk factor empirically defined avoid uneven sampling disease trajectory might lead temporal bias feature selection clinical risk factor demographic information extracted structured ehr based international classification disease icd -related code medication code appendix using data january december identified 6,035 case 72,241 control case 69,086 control self-reported european ancestry overall 22.4 1156/14,148 case/control european eur patient enrolled mycode project genetic data available data pre-processing entire cohort participant eur ancestry 5911/69,086 first split based availability genetic data missing data observed included clinical variable mycode sample genotyped previously reported snp rs2227306 rs4076 il-8 passed quality control without missingness genetic variable routinely treated dosage manner data extraction pre-processing detail z-scored index age binary code variable previously described either test substituted fisher exact test frequency per group anova test performed screen bivariate association heatmap created show significance bivariate association based log-transformed p-value bivariate test fig figure association among feature performance model prediction cdi mycode nonmycode sample simulated genotype included heatmaps show significant association variable employed prediction model using training dataset data extraction pre-processing detail z-scored index age binary code variable previously described association among variable index age dummy coded assessed using bivariate test examine discrimination power modeling algorithm testing dataset estimated auroc using common clinical risk factor cdi without rs2227306 predictor genotype rs2227306 simulated nonmycode sample summary aurocs optimal modeling algorithm gbm xgbdart versus glm using simulated rs2227306 genotype value represent result delong test compare auroc model without simulated genetic data included without psm index age sex full size image simulation determine predictive power genotype simulation study conducted determine different modeling algorithm predictive power generalizability nonmycode cohort genotype rs2227306 il-8 cohort case 54,938 control created simulation strategy based assumption binomial probability distribution allele equaling prior parameter maf estimated corresponding mycode subgroup stratified cdi age sex table alleledosage =rbinom\left i\in maf +rbinom\left maf vector matrix summary statistic derived mycode cohort maf represent number subject corresponding maf subcategory simulation strategy considers confounding factor age sex may impact association genetic variant outcome variable individual snp association testing genotype phenotype association conducted using logistic regression controlling covariates age sex subgroup stratified sex age binary controlling confounding age sex identified confounding factor association genetic/nongenetic risk factor cdi see result selected covariates logistic regression model create propensity score matchit package chose nearest neighbor matching without replacement create balanced case control ratio 1:5 1:10 shown efigure selecting machine learning algorithm model development optimization based selecting optimal sampling approach followed comparison eight classification algorithm including logistic regression glm gradient boosted classification gbm extreme gradient boosting dropout regularization regression tree xgbdart bagging tree treebag neural network nnet using 1-layer fully connected neural network shallow c5.0 logitboost support vector machine svm selected model based model/algorithmic diversity performance similar task model interpretability ease implementation specifically set algorithm well-established good performance tabular data wide range classification task furthermore ensemble method c5.0 xgbdart bagging logitboost combine multiple weak learner create stronger model lead improved predictive performance better generalizability finally creating decision boundary complex linear neural network svm capable capturing non-linear relationship variable evaluation metric assessed performance multivariable model prediction cdi mainly sensitivity specificity positive predictive value ppv negative predictive value npv precision recall score matthew correlation coefficient mcc accuracy area curve auroc classification problem score recall precision recall precision mcc sqrt accuracy true positive true negative false positive false negative recall tp/ precision tp/ score mcc calculated based confusion matrix reliable metric evaluating binary classification model particularly imbalanced datasets score combine precision recall provide balanced evaluation model accuracy mcc considers overall balance four element confusion matrix value mcc range indicates complete agreement disagreement predicted class actual class respectively indicates completely random guessing result metric training testing datasets across eight algorithm summarized etable3 auroc graphical representation model rate sensitivity/recall versus rate 1-specificity various probability threshold auroc insensitive class distribution often preferred accuracy imbalanced datasets addressing data imbalance imbalance case control dataset lead biased model training model tends favor majority class underestimate minority class resulting high accuracy always predicting majority class oversampled data improve model prediction minority class significant unbalanced case–control cohort shown study 1:12 performed oversampling using synthetic minority oversampling technique smote random oversampling rose minority class model training address class imbalance used score mcc ass model performance smote function oversampled minority class rare event using bootstrapping perc.over k-nearest neighbor synthetically create additional observation event undersampling majority class perc.under case original dataset belonging minority class perc.over/100 new example class created rose applied smoothed bootstrapping draw artificial sample feature space around minority class without undersampling majority class oversampled minority class reach case control ratio 1:1 training dataset model optimization mycode nonmycode sample split training holdout data testing 7:3 ratio beginning study model tuned training data tested holdout data testing data described fig fivefold repeated applied corresponding training data either mycode nonmycode cohort nonmycode sample considered additional dataset determine overfitting however genotype nonmycode sample available common non-biobank population impute genotype data nonmycode sample simulation determine generalizability optimal model hyperparameter tuning grid used train model five-fold repeated cross-validation ten repeat caret package model tuning performed automatic grid search algorithm parameter randomly etable1 tuning parameter used final model finally testing set used calculate model auroc also compared optimal model benchmark algorithm glm extracted feature importance included variable rank variable feature importance particularly genetic variable compared across algorithm delong test used compare aurocs two modeling algorithm compare aurocs best model without genetic feature included model auroc calculated first confidence interval auroc also computed covariance matrix cov\left estimated auroc model respectively aurocs two model calculated formula covariance two sample proportion given cov\left 1-\widehat 1-\widehat sample size model respectively statistic -\widehat -\widehat -\widehat cov p-value computed assumption normal distribution p-value represented probability observing difference auroc extreme one observed data assuming null hypothesis difference two model result patient demographic entire dataset split based availability genetic data demographic clinical information mycode nonmycode cohort listed table case control ratio mycode 1156/14,148 1:11.55 comparable nonmycode cohort 4755/54,938 1:12.24 ratio 1:12 indicated approximately ten-fold enrichment control shown previously reported ehr-based large populational study 1:100 several demographic feature e.g. sex age known clinical risk factor showed significant difference case control group mycode nonmycode cohort bi-variate association among predictive variable illustrated fig antibiotic significant risk factor cdi table demographic potential risk factor genotype data mycode nonmycode participant without propensity score matching psm full size table genotype–phenotype association logistic regression analysis showed significant association rs2227306 genotype cdi young mycode patient 0.138 0.048 vs. 0.062 0.263 controlling sex controlling age nominal association observed female 0.119 0.034 0.053 0.427 minor allele snp higher expression level cxcl8 cxcl6 associated increased risk cdi comparing oversampling method manage case–control imbalance smote outperformed rose seven eight examined algorithm fig using xgbdart gbm model smote training dataset led better 0.264 0.272 respectively rose 0.253 0.261 respectively testing dataset process without resampling provided worst 0.037 0.056 respectively smote chosen following analysis mcc score showed smote yielded slightly higher value rose without genetic feature included according xgbdart gbm model testing dataset etable figure comparing upsampling strategy mycode testing dataset using score metric performance smote function oversampled minority class rare event using bootstrapping perc.over k-nearest neighbor synthetically create additional observation event undersampling majority class perc.under case original dataset belonging minority class perc.over/100 new example class created rose function oversampled minority class without undersampling majority class make case control ratio training dataset equaled 1:1 oversampling strategy score weighted average precision recall selected determine performance oversampling summary sample size training without upsampling smote rose testing dataset stratified genetic data availability rose upsampling case case control ratio 1:1 control training dataset smote upsampling case case control ratio 1:1 control training dataset full size image predicting cdi mycode patient without propensity score matching psm best tuning parameter selected model based largest roc value training dataset summarized etable among eight algorithm examined found using clinical risk factor rs2227306 conjunction gbm xgbdart led superior result genetic feature auroc gbm 0.72 0.694–0.746 versus auroc glm 0.684 0.655–0.713 1.92e−07 fig significant difference gbm xgbdart auroc xgbdart 0.715 0.689–0.742 0.247 genetic feature always ranked higher known risk factor gbm xgbdart compared glm suggesting non-parametric algorithm better capture nonlinear interaction see radar plot fig compared base model integrated model provided best discriminative power testing dataset particularly gbm auroc 0.710 0.683–0.737 vs. 0.72 0.694–0.746 0.006 xgbdart showed similar trend better genetic feature reach statistical significance auroc 0.710 0.683–0.736 vs. 0.715 0.689–0.742 0.304 gbm xgbdart model provided balanced sensitivity 0.508 0.518 versus 0.481 specificity 0.792 0.796 versus 0.777 better ppv 0.178 0.183 versus 0.161 npv 0.948 0.949 versus 0.944 compared glm significant difference age sex observed psm table efigure algorithm best performance matching e.g 1:10 ratio remained gbm auroc gbm 0.711 0.681–0.740 xgbdart auroc xgbdart 0.701 0.671–0.731 rs2227306 fig former showed statistically significant improvement model without rs2227306 auroc glm 0.703 0.675–0.732 similar trend observed matching cohort 1:5 ratio fig gbm xgbdart model ranked genetic feature highest feature importance fig top two row glm glm also ranked index age sex lower figure feature importance cohort without simulated genetic data plotted two selected model gbm xgbdart outperformed model glm nnet study based feature including one genetic risk factor rs2227036 il8 feature importance glm nnet always plotted control compare rank feature weighted optimal modeling algorithm gbm xgbdart mycode top two row nonmycode sample bottom two row genetic feature weighted top tier gbm xgbdart glm nnet irrespective psm mycode cohort full size image predictive power nonmycode patient simulated genotype nonmycode cohort recapitulate nominal association rs2227306 cdi table consistent result mycode patient simulated genetic feature included gbm auroc gbm 0.820 0.809–0.831 xgbdart auroc xgbdart 0.819 0.808–0.831 outperformed modeling algorithm e.g. auroc glm 0.751 0.737–0.765 1.68e−57 fig rs2227306 ranked higher gbm xgbdartthan glm fig bottom two row result performance metric sensitivity specificity ppv npv precision recall score accuracy prediction cdi training testing datasets across eight algorithm using smote oversampling method summarized etable3 table two simulation strategy create genetic data rs2227306 il8 nonmycode cohort full size table discussion developed prediction model symptomatic cdi integrating common risk factor extracted electronic health record genetic risk factor rs2227306/il8 modeling pipeline included step minimize systemic bias final model adhering best practice improve model transparency step included applying robust validated phenotyping selecting optimizing range algorithm focus attribute generalizability interpretability potential interaction bias-variance trade-off addressing data imbalance performing extensive simulation study determine predictive power sample without genetic information finally using psm control confounding factor overall result supported decision tree-based ensemble method gbm xgbdart demonstrated superior discriminative power glm logistic regression gbm xgbdart based boosting algorithm ensemble technique sequentially build multiple weak learner focusing mistake predecessor assigning higher weight misclassified instance correct subsequent iteration ensemble method often work better individual algorithm due following reason handing imbalanced data giving weight minority class balancing prediction shown study reduced bias variance combing multiple individual model weak learner create single robust model strong learner complementary learning leveraging complementary strength individual algorithm overfitting improved generalization tackling complex relationship effectively captured single model robustness noisy data averaging voting mechanism often affected noisy data point outlier improvement gained including common genetic variant optimal model limited age- sex-dependent psm finding consistent decreased genetic heritability observed late-onset compared early-onset multiple complex disease trait rs2227306 il-8 related early-onset disease importance genetic risk factor across modeling algorithm feature importance considered measure individual contribution feature particular classifier regardless shape direction feature effect genetic feature consistently ranked high optimal model even higher psm subgroup finding corroborates clinical value genetic information prediction model conclusion made mycode sample could partially extended larger nonmycode sample potential interaction genetic feature clinical risk factor beyond age sex recognized implemented genotype simulation may prevent conclusion made mycode sample could fully extended larger nonmycode sample leading uncertainty discriminative power model simulated genetic feature included importance genetic feature ranked lowest logistic regression-based model suggesting logistic regression may underestimate contribution genetic variant prediction cdi highlighting importance capturing multi-way interaction assessing value common genetic variant small effect size prediction model clinical relevance selected genetic variant il-8 previous candidate gene approach genetic predisposition cdi revealed promoter polymorphism –rs4073 –251t linkage disequilibrium snp rs2227306 781t/c pro-inflammatory cytokine il-8—can result increased il-8 production predisposes subject cdi recurrent cdi severity cdi eqtl gene cluster located 4q13.3 efigure encoding several member cxc chemokine family cxcl8 aka il-8 cxcl6 cxcl5 cxcl1 promote recruitment neutrophil site infection minor allele snp associated increased expression level cxcl8 gtex increased il-8 protein level cxcl5 il8 message level associated prolonged disease intrarectal administration tcda/tcdb mouse model increase expression inflammatory mediator cxcl1 murine ortholog human il-8 phewas analysis ukbiobank efigure confirmed top phenotype associated rs2227306 included laboratory variable neutrophil count neutrophil percentage white blood cell count latter contributed composite risk score developed earlier study prediction cdi severity table study first evaluate integrated model including genetic common clinical risk factor using various optimized algorithm predict cdi table summary reported clinical decision tool predict clostridioides difficile infection cdi severity recurrence full size table context similar study since testing treatment recommended asymptomatic carrier difficile direct focus symptomatic cdi result study may eventually facilitate at-risk patient stratification targeted treatment patient likely benefit emerging prevention treatment option vaccine fidaxomicin monoclonal antibody fecal microbiota transplantation result may also support granular substratification therapeutic trial control defined patient without cdi based negative molecular laboratory result exposed similar risk factor antibiotic use using emerge phenotype algorithm inclusion/exclusion criterion define control case control ratio approximately 1:10 tenfold enrichment control increased risk cdi compared 1:100 ratio summarized retrospective cohort study table enrichment would make prediction challenging result subgroup psm suggested contribution genetic variant model prediction minimum elderly patient finding consistent decreased genetic heritability observed late-onset compared early-onset multiple complex disease trait rs2227306 il-8 related early-onset disease summarized table majority predictive model cdi based large ehr claim database recently whereas study performed recurrence severity include small cohort existing study compare algorithm instead focus amount information extracted necessary improved prediction general amount information number variable correlate model performance however including hundred variable lead model lower interpretability reduced generalizability healthcare system example institution-specific feature rank top tier feature importance therefore healthcare-based model may limited discriminative power prediction individual healthcare system geographic social-economic clinical management environment differ significantly generalizability developed prediction model single healthcare system others debatable since study aim utilize common clinical risk factor readily available ehrs build prediction model conclusion made study could better generalizability may easier implement elsewhere reason propose integrated model transferable ehr complex model manually curated variable datasets strength limitation strength study lie following development prediction model symptomatic cdi integration genetic common clinical risk factor evaluation several advanced algorithm compare performance identification association genetic variant outcome variable confounded age sex determination value genetic feature contribution model performance general propensity score matched subgroup identification selection bias cohort genetic data available study limitation including accuracy ehr data collection recording process may vary clinician hospital time possibly prevent generalizability developed model healthcare system data came single healthcare system patient population predominantly european ancestry feature selected homogenous population may best represent cover complexity feature space derived heterogenous population tested common genetic variant high maf expect polygenic risk score developed consortium-based gwas individual effect size estimated thousand genetic variant would better represent genetic liability cdi complex disease conclusion showed developing robust prediction model cdi perhaps complex condition requires step-wise approach ensure highest level transparency lowest possible systemic bias study leveraged cdi disease model demonstrate although genetic information may improve prediction benefit including genetic feature prediction model thoroughly evaluated