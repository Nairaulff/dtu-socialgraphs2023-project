introduction ultimate goal scientific engineering research field nuclear fusion build power plant producing sustainable clean electricity fusion reaction confined plasma heated million degree celsius tokamak torus-shape vacuum vessel within plasma confined magnetic field directed along long toroidal short poloidal way around torus maintaining high-temperature plasma long period time e.g. longer requires plasma pressure gradient lorentz force balanced throughout plasma volume operation tokamak mean knowing internal spatial structure plasma pressure magnetic field real-time beneficial operating tokamak plasma direct situ measurement plasma structure often difficult make owing harsh environment e.g. environment high temperature radiation although optic system directly measure internal information electron temperature density magnetic pitch angle exist measurement spatially localized require magnetic field structure mapped onto whole plasma volume hence suite magnetic diagnostics fundamental measurement device installed behind plasma-facing component far plasma used obtain magnetic field structure indirectly solving grad–shafranov equation equation constrained measured magnetic field describes force balanced plasma state conforming maxwell equation toroidal axisymmetry assumption finding solution equation constraint thus regarded reconstructing magnetohydrodynamic mhd equilibrium toroidal plasma equation resembling hick equation describes axisymmetric inviscid fluid two-dimensional poloidal cross-section nonlinear elliptic partial differential equation owing nonlinearity equation reconstructing mhd equilibrium consistent equation traditionally requires iterative numerical approach inverse free-boundary problem external measurement magnetic field typically available priori knowledge boundary separate vacuum region plasma region difficulty hinder real-time application equation course simple solution real-time application sacrifice accuracy solution ref however even accuracy eschewed human expert choice made reaching numerical convergence traditional numerical algorithm reconstruction chiefly efit often require subjective decision manual selection magnetic measurement neglected data participate reconstructing plasma equilibrium tend obstruct search converging numerical solution attempt made parallelize traditional numerical algorithm using graphical processing unit gpus supervised deep neural network fulfill real-time demand still require human intervention based efit algorithm contrast reconstruction method using bayesian inference introduced eliminate least explicitly articulate manual selection unlikely used real-time purpose owing heavy computation note reconstructing detailed plasma equilibrium real time using internal information active research area recent scientific computing supported deep learning therefore various approach proposed neural network learn physics-based differential equation solving many-electron schrödinger equation navier–stokes equation atmospheric model climate modeling example include interpolating partial differential equation regularizing neural network kohn sham equation previous work require actual solution prior knowledge unknown parameter approximated solution state target governing equation similarly attempt made find solution equation using neural network work given internal profile since equation solver i.e. equilibrium reconstruction algorithm additionally method using neural network solve stefan problem free-boundary problem describes phase-change liquid solid state however method assumes boundary phase-change state already known propose algorithm grad–shafranov deep neural network gs-deepnet learns plasma equilibrium without using existing traditional numerical algorithm reconstruct equilibrium i.e. find solution equation first foremost gs-deepnet trained self-teaching unsupervised learning without guess solution known information equation externally measured magnetic field acting boundary condition differential equation manual selection second gs-deepnet typical fully-connected neural network known capable retaining real-time application finally gs-deepnet auxiliary module detects plasma boundary information solely network output reach outcome develop neural network capable solving nonlinear elliptic partial differential equation free-boundary inverse condition namely equation gs-deepnet trained validated tested korea superconducting tokamak advanced research kstar environment result architecture gs-deepnet novel unsupervised learning algorithm gs-deepnet comprising two deep neural network fig parameter respectively find solution equation dp\left d\psi -f\left df\left d\psi r\frac +\frac defined two-dimensional elliptic partial differential operator tokamak machine coordinate z\right toroidal axisymmetry assumption i.e. =0\ first line consequence =0\ axisymmetric toroidal geometry respectively magnetic field current density maxwell equation state elliptic differential operator acting poloidal flux function proportional product major radius toroidal plasma current density permeability constant proportionality second line derived using force-balanced mhd momentum equation =\nabla plasma pressure poloidal current function f=r toroidal magnetic field quantity related poloidal plasma current formally function thus task gs-deepnet find two-dimensional poloidal plane fig two free function satisfying boundary condition set given magnetic measurement state call feature note finding together known reconstruction mhd equilibrium toroidal plasma figure self-teaching unsupervised learning scheme gs-deepnet leftmost location sensor number kstar magnetic diagnostics magnetic pick-up probe measuring blue flux loop measuring red plot signal show example measurement made using pick-up probe flux loop poloidal cross-section space function time refer feature color represent magnitude measurement black dot 41\times 41\ grid point gs-deepnet find solution blue red dot position pick-up probe flux loop black line example plasma boundary dividing plasma region inside line vacuum area boundary known last closed flux surface schematic representation gs-deepnet network maxwell net take spatial position feature magnetic data input output poloidal flux function used calculate automatic differential operator dif determining plasma boundary using auxiliary module output maxwell net network force-balance net take poloidal flux function input output pair ^\prime ^\prime example three-dimensional configuration reconstructed gs-deepnet kstar poloidal field coil gray vacuum vessel wall light orange plasma facing component light blue also shown well magnetic diagnostics blue red dot full size image single spatial point z\right set magnetic measurement =\left input trained output single-valued flux function vector notation mean collection measurement made different spatial location single time slice i.e. feature namely measurement resulting total magnetic measurement respectively -components poloidal magnetic field measured using magnetic pick-up probe blue dot fig poloidal magnetic flux measured using magnetic flux loop red open circle fig red dot fig magnetic pick-up probe flux loop installed tokamak boundary constitute suite magnetic diagnostics impose boundary condition real time gs-deepnet magnetic pick-up probe measure normal tangential component poloidal magnetic field respect vacuum vessel wall probe installed thus calculated using simple coordinate conversion see fig specified 41\times 41\ grid point black dot fig z\right plane i.e. poloidal plane trained output value equation constrains derivative must therefore supply proper boundary condition discussed supplementary note reason let also accept z\right position magnetic diagnostics input trained provide value tokamak boundary thus solution space 41\times 41\ grid point position magnetic diagnostics using automatic differential operator dif fig flux function =-1/r\cdot =1/r\cdot calculated used train network measured boundary condition refer together dif maxwell net output fed output two free function dp/d\psi df/d\psi ^\prime ^\prime input two free function thus guaranteed function tokamak plasma well-defined plasma boundary known last closed flux surface lcfs thick black line fig consequently outside lcfs toroidal plasma current density set zero based common assumption resulting =0\ flux function outside inside lcfs thus finding ^\prime ^\prime consistent relevant inside lcfs unfortunately lcfs identified solution space known reason solving equation free-boundary problem note recent work predict future lcfss real-time deep learning requires free-boundary problem solver e.g. efit identify boundary location gs-deepnet first infers lcfs basis solution space using auxiliary module boundary detection fig see method output ^\prime ^\prime using normalized input inside lcfs note normalized zero magnetic axis lcfs according boundary detection module output ^\prime ^\prime used calculate ^\prime ^\prime must equal according second line reason refer force-balance net mentioned earlier free function thus large number degree freedom constrain free function i.e. train network convey physical meaning use fact ^\prime ^\prime specifically ^\prime ^\prime dictate current source inside lcfs must constrained given magnetic data i.e. feature via response matrix calculated using biot–savart law see method measured total plasma current plasma quantity routinely measured using rogowski coil real time summarizing unsupervised gs-deepnet work maxwell net input generates whose normalized value input force-balance net generating ^\prime ^\prime maxwell net must equal ^\prime ^\prime force-balance net gs-deepnet train maxwell net force-balance net consistent matching measured magnetic signal tokamak boundary using automatic differential operator maxwell net response matrix force-balance net course impose plasma current outside lcfs lcfs determined plasma boundary detection module thus maxwell net also trained give =0\ constraint brings ill-posed condition problem explained detail method resolve issue train force-balance net using concept transfer learning singular value decomposition svd technique see method addition usual gradient descent algorithm make algorithm novel maxwell net force-balance net multiple fully-connected layer dropout swish nonlinear activation function maxwell net three hidden layer neuron bias layer whereas force-balance net two hidden layer node first second layer respectively without bias node used dropout scheme rate 0.05 0.10 maxwell net force-balance net respectively training process dropout rate also used network test prediction phase obtain model uncertainty detailed description train gs-deepnet collecting dataset defining loss function provided method example two-dimensional configuration gs-deepnet shown fig respectively relevant tokamak structure kstar work tokamak plasma toroidally axisymmetric assumed equation two-dimensional poloidal plane thus suffice reconstruct axisymmetry two-dimensional structure mhd equilibrium tokamak plasma statistical analysis gs-deepnet training well gs-deepnet teach solve equation gs-deepnet constrained equation given formulated loss function see method maxwell net force-balance net respectively measured magnetic signal boundary condition therefore first evaluate training performance i.e. evaluate well gs-deepnet learned solve equation boundary condition important gs-deepnet doe rely existing traditional numerical algorithm solve equation figure summarizes statistical result training performance figure statistical evaluation gs-deepnet training left profile maxwell net cyan corresponding measurement red function sensor number cyan dashed line represent uncertainty network estimated dropout right training statistic maxwell net abscissa network output ordinate measurement blue gradient indicates number occurrence red dashed line y=x\ line coefficient determination also given training statistic maxwell net abscissa force-balance net ordinate blue gradient indicates number occurrence red dashed line y=x\ line coefficient determination also given comparison cyan cross calculated using response matrix together output force-balance net measurement red circle relative error indicated blue bar shading indicate different type measurement i.e. yellow white gray full size image figure a–c show performance maxwell net outputting value corresponding calculated automatic differential operator according boundary condition magnetic measurement =\left taking single feature example left panel fig a–c compare gs-deepnet result cyan line average cyan dashed line uncertainty magnetic measurement red dot fig fig fig note uncertainty network obtained using monte carlo dropout method right panel fig a–c show histogram color coded generated using training data set comparing gs-deepnet result abscissa measurement ordinate y=x\ red dashed line also provide value coefficient determination close unity indicating maxwell net trained well consistent measured boundary condition mention kstar magnetic pick-up probe measuring toroidal location considering flux loop measuring shown probe loop index horizontal fig a–c among used magnetic pick-up probe others impaired simply output null value thus red dot instead fig signal flux loop devised algorithm using separate neural network examines whether measurement consistent measurement made magnetic pick-up probe necessary corrects flux-loop measurement real time thus able use measurement fig note real-time correction necessary number magnetic measurement sometimes impaired pick-up probe flux loop susceptible damage one advantage gs-deepnet traditional numerical algorithm solving equation gs-deepnet allows use every magnetic measurement except fully order hand traditional one require human selection measurement introduces human subjectivity even among seemingly good measurement guarantee numerical convergence i.e. minimizing chi-square estimation avoid obtaining unphysical plasma equilibrium moreover flawed magnetic pick-up probe among selected probe gs-deepnet incorporate existing real-time imputation scheme based bayesian inference gaussian process examine training performance force-balance net first compare algebraic combination output namely ^\prime ^\prime obtained maxwell net dictated equation given gs-deepnet must satisfy ^\prime ^\prime well trained figure histogram color coded generated using whole training data set compare result force-balance net ordinate maxwell net abscissa y=x\ red dashed line see coefficient determination close unity indicating gs-deepnet taught well solve equation free function ^\prime ^\prime must obey equation demonstrated fig also comply magnetic measurement otherwise two free function would much freedom applicable tokamak operation figure e–f show free function consistent magnetic measurement comparing force-balance net result given magnetic data background color yellow white gray indicating respectively response matrix current source containing toroidal current density plasma current flowing external coil vacuum vessel see method physical parameter learned gs-deepnet confirm high degree precision gs-deepnet learns equation measurement constraint boundary condition therefore present physical parameter gs-deepnet obtains—the poloidal flux function plasma pressure poloidal current function —to demonstrate real-time applicability gs-deepnet tokamak operation tokamak plasma generally categorized limited diverted plasma two type plasma fundamentally different magnetic topology limited plasma boundary touching solid wall fig top row whereas diverted plasma one magnetic x-point i.e. null point poloidal magnetic field leg extend divertors fig bottom row shown fig two type tokamak plasma well reconstructed gs-deepnet accordance measurement example feature randomly selected kstar discharge fig show poloidal flux function important quantity control plasma corresponding dictate toroidal current density shown fig absolutely mean determine equilibrium tokamak directly fig compare contour constant existing numerical algorithm efit gray dashed line gs-deepnet colored line contour match well also plasma boundary red dashed line coincides efit black dashed line argue whether contour efit true representation plasma equilibrium efit solves ill-posed equation nevertheless efit reasonable target comparison widely used field nuclear fusion figure also show model uncertainty obtained using dropout method figure equilibrium prediction using trained gs-deepnet first column example limited top diverted bottom plasma equilibrium produced maxwell net colored line compared equilibrium efit gray dashed line red black dashed line represent plasma boundary maxwell net efit respectively second column uncertainty map maxwell net red dashed line indicate last closed flux surface maxwell net histogram various plasma parameter gs-deepnet blue efit red relative error rel comparison profile plasma pressure force-balance net blue measurement black based p=2 red line obtained gaussian process measurement blue red highlighted region indicate uncertainty force-balance net gaussian process respectively left comparison profile calculated magnetic pitch angle tan force-balance net blue measurement red right histogram root-mean-square difference tan force-balance net measurement full size image complete statistical comparison estimated compared histogram several plasma parameter widely used plasma control namely major radius magnetic axis equilibrium elongation ratio vertical horizontal size plasma minor radius half distance innermost outermost position plasma triangularity shaping parameter see fig supplementary note histogram efit gs-deepnet shown fig together difference calculated rel =100\times efit efit efit take one plasma parameter efit gs-deepnet respectively although estimation similar two noticeable difference seen efit result bimodal histogram whether result real phenomenon identified point since find exist least uncertainty efit boundary estimation associated selecting slightly different combination working magnetic pick-up coil similar human subjectivity discussed earlier well finite spatial resolution efit i.e. radial resolution approximately note gs-deepnet get position input meaning gs-deepnet higher spatial resolution around magnetic axis x-point boundary one may argue availability real-time map maxwell net gs-deepnet suffices purpose tokamak operation examine radial profile plasma pressure part force-balance net essential training gs-deepnet comparing plasma pressure gs-deepnet measurement trivial tokamak plasma consist electron main ion usually isotope hydrogen fast ion trace amount impurity ion carbon nitrogen ion case ignore pressure contribution impurity ion density much lower density main ion thus denoting density temperature subscript electron main ion fast ion respectively total pressure boltzmann constant tokamak operation plasma heated current finite electrical resistivity injecting external electromagnetic wave resonating either electron ion also neutral beam injection heat plasma main source fast ion present tokamak unfortunately method measuring radial pressure profile fast ion kstar therefore need select plasma fast ion i.e. neutral beam injection make pressure comparison measurement mean measure pressure main ion either temperature main ion inferred charge exchange spectroscopy system requires neutral beam injection thus available pressure measurement electron using thomson scattering system provides separately therefore done tokamak simply set measured total plasma pressure p=2 ohmic discharge figure show radial profile measured pressure p=2 black dot kstar thomson scattering system ohmic discharge red line denoted obtained performing non-parametric gaussian process regression measurement pressure profile gs-deepnet denoted shown blue line comparison reveals pressure profile gs-deepnet agrees well measurement within uncertainty note uncertainty obtained gaussian process regression measurement uncertainty whereas estimated via dropout method without relying measurement uncertainty thus uncertainty smaller uncertainty core compared edge require careful interpretation addressed future work extended gs-deepnet proposed supplementary note another output force-balance net ^\prime f=r poloidal current function toroidal magnetic field examine quantity measured local magnetic pitch angle via motional stark effect mse diagnostic system mse system kstar measure pitch angle different radial position tan coefficient fixed geometrical configuration system note mse system requires neutral beam injection pitch angle field quantity rather specie quantity restrict ohmic discharge case pressure comparison together output maxwell net obtain =-1/r\cdot =1/r\cdot tan calculated output force-balance net figure compare radial profile tan red dot indicate measurement blue line result gs-deepnet agreement excellent calculated histogram root-mean-square error rmse tan i=1 tan -\mathrm tan 0.5 using kstar discharge subscript denotes channel index channel i.e. n=25\ superscript nn\ indicate value gs-deepnet measurement respectively guide rmse magnitude note rmse 0.024 fig discussion showed solving two-dimensional second-order nonlinear elliptic partial differential equation scratch i.e. tabula rasa possible proposed structure unsupervised neural network scheme differential equation solved equation provides fundamental information control tokamak plasma harnessing electricity via nuclear fusion reaction developed network gs-deepnet comprises maxwell net force-balance net output poloidal flux function pressure gradient d\psi quantity related poloidal current f\frac d\psi two-dimensional poloidal plane consistent equation magnetic boundary condition measured far solution space problem solved ill-posed free-boundary problem solved invoking concept transfer learning singular value decomposition technique ill-posedness aspect introducing auxiliary boundary detection module free-boundary aspect many physical phenomenon expressed form differential equation work shed light constructing neural network engineering science field solve problem starting scratch instance previous work solving complex physical system quantum mechanic fluid dynamic high-energy physic may advanced using proposed methodology specific field nuclear fusion gs-deepnet also confirmed capable generating reliable magnetic equilibrium result compared result obtained traditional numerical algorithm specifically efit mean gs-deepnet used together conventional real-time efit algorithm support sometimes rebuke real-time efit result one advantage gs-deepnet flexible adjustable spatial resolution instance higher spatial resolution around magnetic axis near magnetic x-point achieved gs-deepnet since position part input therefore using gs-deepnet together real-time efit anticipate tokamak performance enhanced supporting realization economical nuclear fusion reactor note gs-deepnet take estimate full two-dimensional flux surface grid using single gpu rtx a4000 final remark briefly mention gs-deepnet extended know two free function closed system thus exist advanced numerical algorithm kinetic-efit consider inferred based measurement reconstructing mhd equilibrium radial profile pressure typically measured using thomson scattering system electron density temperature whereas ion temperature inferred using charge exchange system poloidal current function inferred profile local magnetic pitch angle measured using mse system although attempt obtain real time profile typically available tokamak operation furthermore many mid- large-scale tokamak operation contain another type ion namely fast ion tokamak scenario contribution fast ion pressure negligible profile fast ion available real time nowadays therefore real time moment note kinetic-efit doe work real time nevertheless foresee profile may become available real time future propose extended gs-deepnet accommodate profile training force-balance net measured available real time output d\psi f\frac d\psi add auto-encoder elaborated supplementary note method response matrix let discus response matrix detail may trivial biot–savart law allows calculate arbitrary spatial position magnetic field generated using constant electric current fixed location owing linearity magnetic field generated certain position plasma calculated modeling total toroidal plasma current sum many toroidal current filament small rectangular cross-sections tokamak instance toroidal plasma current single r-z\ grid position black dot fig well-defined rectangular cross-section set distance neighboring grid point toroidal length 2\pi see fig fixed position thus pre-calculate contribution single toroidal current filament generating magnetic field measurement position subscript indicate magnetic sensor toroidal current filament dictating measurement source position respectively calculate component magnetic field location magnetic sensor due total toroidal plasma current run 41\times 41\ grid point total magnetic measurement contribution due plasma thus formulated row column matrix know lcfs advance prepare matrix cover 41\times 41\ grid point lcfs inferred plasma boundary detection module reduce size row column number grid point inside lcfs denote reduced matrix therefore i.e. column vector containing filament toroidal plasma current density provides column vector magnitude magnetic field magnetic measurement position due total plasma current tokamak external current-carrying coil generating magnetic field confine hot plasma see fig must also include current source affect magnetic field measurement position kstar tokamak gs-deepnet trained validated tested work poloidal field coil bundle two conductor four segment in-vessel coil toroidal current flow response matrix external coil denoted ext prepared dimension row column corresponding magnitude current ext known set using control tokamak current source induced toroidal eddy current flowing vacuum vessel may negligible source modeled current-carrying segment following previous approach used kstar thus row column matrix contains contribution eddy current flowing vacuum vessel obviously column vector dimension vector inferred unsupervised training procedure network must comply condition =\overline response matrix defined ext dimension row 14+16 +18\ column column vector current source defined ext dimension 14+16 +18\ figure show three-dimensional structure toroidal current filament rectangular cross section modeling plasma current density external coil current vessel current using model estimate matrix component response matrix equation =\frac 2\pi j,1 j,2 j,1 j,2 drdz\frac -k\left k\right +\frac -z\right r-r -z\right e\left k\right =\frac 2\pi j,1 j,2 j,1 j,2 drdz\sqrt k\left k\right +\frac -z\right r-r -z\right e\left k\right j,1 j,2 j,1 j,2 drdz\sqrt 1-\frac k\right k\left k\right -e\left k\right denote component respectively subscript identifies current source point fig whereas indicates magnetic sensor point fig thus j,1 j,2 j,1 j,2 denotes four vertex rectangular cross-section current source whereas spatial position magnetic sensor i.e. magnetic pick-up probe flux loop note designate 1\le i\le 31\ 32\le i\le 62\ 63\le i\le 107\ value value value respectively resulting total value compared measured magnetic field 1\le j\le =1681\right value 1\le j\le =14+16\right value ext 1\le j\le 18\ value k\left k\right e\left k\right complete elliptic integral first second kind respectively elliptic modulus k=\frac -z\right k\left k\right d\theta 1-k sin e\left k\right d\theta 1-k sin train gs-deepnet demonstrate performance proposed architecture gs-deepnet randomly collected experimental plasma discharge kstar campaign including limited number ohmic phase reasonable number l-mode h-mode phase discharge lasted ten second supplementary note describes typical kstar plasma discharge discharge obtained magnetic data every 0.1 starting approximately 0.8 discharge time discharge resulting time slice feature including ramp-up flat-top phase ramp-down phase approximately 2\times spatial position 41\times 41+107\ position exactly gathered approximately 2\times 2\times datasets used training validation test datasets respectively training gs-deepnet via tensorflow continued terminated using early stopping method regularization method preserve generalization unseen feature took approximately day one gpu worker cpu core using mini-batch scheme total mini-batch size approximately 8000\ feature note measurement noise signal drift magnetic signal compensated adopting boxcar average scheme bayesian-based drift mitigation method respectively boxcar average time window sampling frequency measurement khz equilibrium control plasma typically updated every kstar training gs-deepnet start initializing maxwell net force-balance net random parameter respectively adopting glorot xavier initialization scheme iteration k\ge select random unseen feature total 8000\ feature resulting batch size +107=1788\ corresponding 41\times 41\ grid point 107\ different location magnetic measurement solution k-1 generated 1788\ spatial position automatic differential operator dif 1788\ set prepared lcfs inferred using plasma boundary detection module ^\prime ^\prime k-1 generated position inside lcfs giving set ^\prime ^\prime ^\prime ^\prime reminder number grid point inside lcfs train gs-deepnet need ext thus also prepare ext simply read tokamak control determined singular value decomposition svd training force-balance net every iteration randomly selected feature update network parameter using two loss function respectively following mini-batch training scheme one epoch completed gs-deepnet see total 8000\ feature corresponding 8000\ iteration one epoch use stochastic gradient descent algorithm train parameter mean loss function svd technique well maxwell net together dif trained output absolute value i.e. unnormalized value satisfies boundary condition well force-balanced equilibrium formulated loss function -\overrightarrow ^\prime ^\prime 41\times 41- angle bracket denote averaging operator subscript denoting number element average denotes calculated dif output location magnetic diagnostics =107\ thus first term force maxwell net comply measured boundary condition second term ensures consistency maxwell net force-balance net inside lcfs estimate maxwell net ^\prime ^\prime force-balance net third term ensures toroidal plasma current outside lcfs i.e. =0\ last term regularization sum square weight coefficient avoids overfitting together early stopping method force-balance net trained output ^\prime ^\prime input maxwell net normalizing value becomes magnetic axis boundary respectively loss function force-balance net constructed -\overrightarrow i=1 ^\prime +\frac ^\prime plasma first term specifies network consistent measured boundary condition response matrix associate current source function network output ^\prime ^\prime second term dictate sum filament toroidal current density inside lcfs calculated network ^\prime ^\prime area rectangular cross-section divided must equal measured total plasma current plasma unit megaamperes reason factor regularize weight connecting last hidden layer output layer regularization sum absolute value coefficient ^\prime ^\prime resolving ill-posedness system training force-balance net becomes complex use concept transfer learning svd technique addition usual gradient descent algorithm make algorithm novel thus provide detailed explanation algorithm optimizing force-balance net method optimizing force-balance net mentioned main text force-balance net accepts value input maxwell net output ^\prime ^\prime force-balance net two fully connected hidden layer first second layer node respectively without bias node neural network sensibly reproduce form profile similar case gaussian process long network sufficient number degree freedom find empirically choice number hidden layer node enough degree freedom describe experimentally measured profile ^\prime ^\prime optimizing force-balance net come problem minimizing loss function whose role reveal probable representation =\left ext explain given magnetic data measured total plasma current plasma consideration regularization determined algebraic combination ^\prime ^\prime reminder collection filament toroidal plasma current whereas ext current flowing external magnetic field coil eddy current flowing vacuum vessel respectively optimization process generally subject ill-posed condition number unknown quantity determined i.e. ^\prime ^\prime considerably larger number given measurement i.e. plasma note reasonably good information ext control parameter consequently optimizing force-balance net using gradient descent algorithm often lead to-be-determined current density stuck extremely unphysical solution space small plasma current order ampere throughout plasma region predicted small number segment eddy current vacuum vessel attempt explain entire set measurement likely least two reason first many nuisance local minimum owing ill-posed condition second constraint eddy current weak therefore relax ill-posed condition recasting loss function matrix multiplication form optimize source current =\left ext updating weight direct connection output node using svd technique weight last hidden layer determined using gradient descent algorithm transfer learning figure show matrix form loss function introduce clever representation plasma current density associated response matrix loosen ill-posed condition ext associated response matrix ext expressed red part fig note borrow idea matrix representation efit algorithm quantity regulate first term loss function wish minimize -\overrightarrow basically reform plasma contribution namely ^\prime ^\prime term network weight-wise form see red part fig respectively see fig explained let suppose want estimate plasma current density grid position inside lcfs output force-balance net ^\prime ^\prime know ^\prime ^\prime ^\prime ^\prime ^\prime ^\prime network structure node value last hidden layer dimension 1\times weight assigned output last hidden layer ^\prime dimension 6\times ^\prime dimension 6\times output node ^\prime ^\prime respectively thus rewrite weight-wise form ^\prime +\frac ^\prime weight-wise representation extended grid position inside lcfs ^\prime =\bar ^\prime ^\prime =\bar ^\prime matrix form hidden node value dimension let define two constant matrix containing ^\prime ^\prime ^\prime =\left ^\prime ^\prime =\left ^\prime =\frac whose dimension concatenated augmented matrix p\prime ff\prime dimension 12\ hadamard product ^\prime ^\prime dimension 12\times see fig thus change fig similarly predicted total plasma current ^\prime ^\prime represented using row vector =\left dimension 1\times play role second term loss function i.e. minimizing ^\prime ^\prime plasma key rationale behind reformulating weight-wise form instead letting measured plasma explained main cause ill-posed condition occupies majority design given measurement described drastically reduces number unknown parameter thus relaxes ill-posed condition third term loss function regularization purpose prevent network output unnecessarily complex i.e. preventing overfitting problem regularization embedded matrix form i.e. forcing small possible see blue part fig identity matrix dimension 12\times 12\ constant set ^\prime ^\prime indeed play crucial role determining flexible complex profile ^\prime ^\prime determined value using numerous profile ^\prime ^\prime obtained kstar past year force-balance net enough much flexibility satisfy given measurement must also consider externally generated magnetic field finite degree distortion owing incoloy effect kstar poloidal field coil subject incoloy effect made superconductors incoloy conduit whereas four made nbti superconductors sts316ln conduit let introduce ext denote actual current flowing external magnetic field coil always available real time tokamak operation use ext ext part calculated compare i.e. let ext =\vec ext generate bias error ext doe model incoloy effect instead rectifying ext include effect demanding challenging task relax condition ext =\vec ext let network determine ext consistent word allow ext effective external current including consequence incoloy effect done introducing diagonal matrix whose dimension 30\times 30\ relate ext ext see green part fig among diagonal component subscript indicates one external magnetic field coil set =0.9\ external coil susceptible incoloy effect i.e. poloidal field coil whereas others set unity ext also multiplied either 0.9 accordingly setting unity essentially mean smaller contribution minimization solving matrix using svd technique allowed recast problem overdetermined note value 0.9 also used kstar efit algorithm matrix form loss function also include constraint dirichlet and/or neumann boundary condition example dirichlet boundary condition included force-balance net output ^\prime ^\prime must equal zero outside plasma-facing component see black part fig i.e. pfc ^\prime =0\ pfc ^\prime =0\ pfc dimension 1\times contains node value last hidden layer outside plasma-facing component complete matrix form loss function resolve ill-posed problem expressing unknown term network weight-wise form modifying response matrix contain node value last hidden layer necessary constraint associated loss function modeled matrix see fig unknown current source =\left ext become =\left ext real-time available measurement =\overline see fig overdetermined problem readily solved using svd technique obtain unique =\left ext whose minimum matrix form generated update weight connection last hidden layer output layer i.e. need way update remaining weight input layer last hidden layer use transfer learning scheme force-balance net basic idea transfer learning network trained certain data set e.g. image cat transferred similar data set e.g. image dog instance weight network pretrained image cat reused except weight connection last hidden layer output layer weight retrained image dog allows save computational resource training phase furthermore transfer learning scheme allows work limited volume data thus use measured ^\prime ^\prime training force-balance net transfer learning scheme sagacious choice pretraining network detailed feature profile handled svd technique described thus pretrain network transfer learning scheme weakly force sinusoidal function three full cycle within last closed flux surface allowing profile certain level non-monotonic feature pretraining use normalized input domain namely norm =\frac axis lcfs axis lcfs axis value last closed flux surface magnetic axis respectively loss function pretraining thus defined =\frac i=1 output force-balance net i.e. ^\prime ^\prime y=\mathrm sin 6\pi norm target function subscript indicates normalized spatial position total number data point network pretrained adopting gradient descent algorithm dropout rate 0.10 regularization optimization force-balance net summarized first pretraining network produce general non-monotonic spatial profile fixing weight except connection last hidden layer output layer adopting transfer learning scheme updating weight using svd technique introduce physic constraint i.e. equation boundary condition i.e. real-time available measurement auxiliary module boundary detection plasma boundary known lcfs separate region inside tokamak vacuum vessel two region confined non-confined region basically confined region well-defined closed magnetic flux surface whereas non-confined region open magnetic field line make direct contact wall i.e. divertors plasma-facing component allowing plasma lost wall flowing field line main purpose auxiliary boundary detection module find separation two region occurs mean module task find value lcfs constant contour line lcfs z\right plane separate two region lcfs value lcfs boundary detection module first receives 41\times 41\ grid point black dot fig value plasma-facing component denoted pfc maxwell net iteration within epoch module search three smallest value poloidal magnetic field calculating =\sqrt 41\times 41\ grid point find corresponding z\right position motivated fact magnetic x-point located lcfs definition ideally =0\ magnetic axis magnetic center confined region also =0\ thus constrain possible region magnetic x-point 0.5\ according prior knowledge many existing kstar discharge let denote value three position smallest min i=\mathrm 1,2 value constraint 0.5\ min 0.5 create set containing candidate lcfs absolute value lcfs candidate =\left\ min 0.5 pfc finally obtain lcfs =\mathrm sgn max lcfs candidate max operator return maximum value set sgn original sign maximum value note lcfs determined pfc limited plasma fig top row otherwise diverted plasma fig bottom row note lcfs must identified routinely tokamak operation plasma boundary continuously evolving fig min i=\mathrm 1,2 must always found know whether limited diverted plasma advance loss function must able distinguish inside outside lcfs performed lcfs know inside mean lcfs note kstar confined region see fig clear training gs-deepnet finished provides well-behaved flux surface however training phase especially early stage likely randomly scattered z\right location satisfy lcfs thus facilitate training phase introduce another constraint inside lcfs i.e. position must within min max min max minimum maximum value three position smallest used determine min i=\mathrm 1,2 note described procedure finding plasma boundary specific kstar plasma one expects complicated plasma boundary e.g. snowflake shaped boundary boundary detection algorithm must modified accordingly boundary shape may differ different tokamak developed boundary detection algorithm auxiliary module modification main part gs-deepnet application tokamak minimal