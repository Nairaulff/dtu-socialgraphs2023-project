introduction age-related macular degeneration amd diabetic retinopathy two common eye disease million patient risk losing sight worldwide diagnose manage chronic retinal condition million optical coherence tomography oct taken year yielding micron-resolution volume retina routine fast noninvasive way oct become crucial instrument establishing patient treatment dependable tool validate efficacy novel therapeutic approach treat eye disease context intraretinal fluid irf subretinal fluid srf well-established marker directly linked amd identification localization within set concentric ring known early treatment diabetic retinopathy study etdrs ring critical disease assessment see fig different etdrs ring region linked different visual function level i.e. higher risk vision loss marker central 1mm ring lower risk ring driven clinical need numerous method proposed automate process identifying marker irf srf work follows research direction figure left view retina oct volume green square etdrs ring white virtually placed surface retina right three oct slice different position oct volume red circle indicate irf biological marker yellow rectangle indicates srf figure best seen color full size image previous method included irf srf detection segmentation model segmentation model advantage quantifying irf srf region often require large amount manually annotated segmentation label optimal performance counteract issue work use weak annotation slice level label retinal layer positioning foveal distance achieve voxel-wise segmentation weak annotation offer wide range possibility therefore others studied use bounding box develop positive-aware lesion detection network relevant work method use slice-level annotation presented weakly-supervised segmentation method geographic atrophy lesion spectral domain oct image method first segment retinal pigment epithelium extract class activation map multi-scale feature final en-face binary segmentation obtained refining map conditional random field utilizing slice-level label binary information presence similarly ensemble convolutional neural network cnns proposed detect irf srf individual slice using binary annotation slice level however removing need segmentation annotation method provide location information work propose novel weakly supervised deep learning framework overcomes limitation enables detection localization oct market etdrs ring without requiring costly location information training specifically method binary annotation marker presence oct slice training infers marker presence marker location etdrs ring test time introduce pooling strategy treat network convolutional feature map way preserve spatial relation partially pooled coarse localization combined novel loss function enforces geometrically biologically plausible solution allows ring assignment performed post-processing step independent training phase experiment demonstrate method predicts location marker etdrs ring high accuracy thereby significantly outperforming previous method use amount training information method objective train method capable inferring etdrs ring different marker located using oct slice associated slice-level binary annotation oct slice etdrs ring correspond set non-continuous vertical stripe see fig placement etdrs ring oct volume make following three important observation depending oct slice positioned volume different etdrs ring visible slice width different ring depends oct slice positioned ring symmetry preserved regardless slice position explicitly leverage observation design train approach figure mapping column prediction ring prediction central slice oct volume column layout left shared among slice position ring layout right specific slice location volume contribution ring -th column prediction ring marker full size image specifically instead training method produce different output depending slice location predefined partition oct slice image column see fig left train method produce prediction column regardless specific slice location within volume end section describe straightforward post-processing mapping column-level prediction etdrs ring shown fig left model formally partition oct slice equally spaced column wish train model 0,1 h\times 0,1 1+c map collection probability number different possible type marker found marker b\in collection contains probability presence entire oct slice probability presence column c\in denoted training data made tuples oct slice corresponding slice-level annotation _0\in ^b\ reference whatsoever ring column located comprehensive list variable found table supplementary material.ï»¿ figure proposed network architecture usage partial pooling extract information feature map infer location output set shared-weight mlps full size image figure depicts model architecture input oct slice processed cnn produce feature map d_z\times h_z\times w_z width equal number column w_z\ apply number pooling operation feature map describe entire oct slice well every column particular identify marker may appear large small given image set descriptor entire oct slice 2d_z\ -dimensional vector _0= avg\_pool max\_pool obtained concatenation average pooling maximum pooling spatial dimension likewise descriptor every column another 2d_z\ -dimensional vector _c= avg\_pool max\_pool obtained concatenation two pooling operator acting corresponding column descriptor vector processed multi-layer perceptron mlp followed element-wise sigmoid activation produce final probability aligned mlp mlp aligned training use combination three loss term train model first term standard binary cross entropy bce slice-level prediction _0\ slice-level ground-truth annotation _0\ aligned bce aligned second term incorporates constraint column-level prediction based image-level ground-truth specifically biological marker present input image penalize high predicted probability column hand marker present =1\ encourage high probability least one column formally compute aligned -\sum 1-\textbf 1-\hat aligned last term imposes invariance horizontal symmetry column-level probability model receives horizontally flipped image predicted column-level probability also flipped therefore equal c-c end penalize symmetric divergence corresponding probability aligned c-c c-c aligned specifically _3\ incorporates symmetry etdrs ring wish induce model note desired horizontal symmetry obtained random horizontal image flipping augmentation however _3\ enforces prediction column consistent regardless whether image flipped using similar symmetry argument _1\ _2\ final loss aligned aligned predicted probability input image corresponding horizontally-flipped version respectively figure show graphical explanation _2\ _3\ figure graphical explanation _2\ _3\ slice irf present srf example _2\ enforce irf must present least one column srf found anywhere _3\ incorporate symmetry consistency among flipped non-flipped slice full size image inference test time infer layout etdrs ring oct slice slice evaluated network correspondence one-to-one single ring usually contains several column one column may shared two ring thus produce ring-level prediction compute maximum probability column contained ring column spanning two ring weigh contribution column proportion column inside ring shown fig result present descriptive statistic training testing set table oct data come dept ophthalmology bern university hospital switzerland acquired using heidelberg spectralis system resolution slice pixel training testing set similar term pathology main difference granularity annotation training dataset contains slice-level annotation two biological marker testing dataset includes additional etdrs ring information per slice addition subset testing dataset manually segmented therefore pixel-wise annotation irf srf also available volume oct slice none patient test data present training data distribution irf srf occurrence testing dataset given table table dataset description full size table implementation baseline backbone model method efficientnet-b4 imagenet-initialized weight preliminary step train network alone task irf srf multilabel classification produce slice-level prediction fine-tune entire model described method section loss function use batch size slice sgd momentum 0.9 base learning rate 5\cdot 10^ scaled 0.99 every epoch feature map efficientnet-b4 sized perform maximum average pooling per column produce descriptor vector d_c\ dimension 2d_z=3584\ subsequently processed mlp get column-level prediction mlp consists single linear layer output srf irf followed sigmoid activation column-level prediction mapped ring-level prediction explained end method section direct existing baseline localization oct biological marker weak annotation compare method following alternative baseline masking test time mask slice region reveal relevant etdrs ring feed efficientnet trained slice-level detection task masking done replacing pixel region masking partial convolution partconvs masking baseline replacing convolutional layer partial convolution except squeeze excitation block ignore masked region grad-cam use grad-cam build heatmap output variable pick maximum value column serf column-level measurement presence srf irf use pre-trained efficientnet obtain final ring-level prediction applying post-processing mapping explained end method section ms-cam approach consists two stage first activation different feature resolution combined grad-cam++ obtain pixel-wise segmentation second segmentation refined using crf en-face projection image reproduced first stage converted resulting pixel-wise segmentation ring method implemented using pytorch method baseline trained epoch localization result table report performance method term auc roc average precision method achieves highest roc-auc every marker etdrs ring improvement particularly notable srf method double performance baseline figure compare method roc precision-recall curve partconvs baseline throughout three etdrs ring table also show occurrence biological marker one ring irf present 51.5 image testing set srf scarcer present 2.8 imbalance exacerbated ring annotation depicted fig ring present b-scans however 38.4 irf ring 0.4 srf explained fact srf unlikely found outer ring leading lower number occurrence test set irf table comparison proposed method evaluated baseline term auc roc location dataset marker entire slice different etdrs ring full size table figure roc precision-recall curve marker ring proposed method testing dataset solid line result compared partial convolution dashed line dataset full size image figure illustrates performance different method several case provide additional case fig supplementary material figure output method baseline four example oct image show slice number bottom right ring marker found top row highlight incorrect detection red full size image segmentation result demonstrate accuracy method locating biological marker also compare result subset test image irf srf ground-truth segmentation available oct slice purpose column considered positive marker contains least one pixel marker method achieved auc irf srf shown table low map srf attributed low occurrence rate table result segmentation dataset full size table en-face projection post-processing step convert column ring method produce coarse segmentation per b-scan projection output concatenation b-scans compose c-scan result en-face projection table compared coarse en-face projection method produce manually segmented volume computed mean area irf srf used resolution 11.72\ 120\ slice lateral sagittal respectively row expert refers pixelwise segmentation column expert calculated converting pixelwise segmentation column methodology previous section believe column expert version fairer comparison provides amount information prediction irf obtain mean area 5.73\ ^2\ 6.29\ ^2\ ground truth column srf number representative since volume contain type fluid table en-face projection result full size table figure show comparison predicted area per volume blue area delimited expert red figure calculated using column system figure show qualitative result four volume compare expert en-face projection full segmentation column conversion prediction figure expert red predicted blue area irf srf one volume blue red vertical line refer overestimation underestimation model respect expert segmentation volume sorted decreasing order srf area discrepancy sorting kept irf full size image figure en-face projection result specified marker b-scan location green prediction method different color represent uncertainty model lighter mean certain expert pixelwise segmentation expert segmentation converted column figure best seen color full size image ass clinical relevance method understood agreement approach expert-based segmentation built bland-altman plot srf irf segmentation fig compared prediction coarse en-face segmentation 16-column expert volume see four volume fall outside one standard deviation irf two case srf figure show correlation plot biomarkers irf linear regression return r^2=0.895\ slope close identity 1.09 contrary srf method achieves r^2=0.760\ slope 0.30 figure blandâaltman plot irf srf full size image figure correlation plot irf srf full size image ablation result conduct ablation study quantify different loss term equation affect method performance table show auc roc predicted output function loss term included training first fourth row labeled l_1\ correspond using traditional cross entropy loss doe make use column constraint l_2\ l_3\ impose constraint described method average improvement 5.4 roc auc 18.0 addition column constraint increased 7.6 19.1 respectively horizontal symmetry table ablation study quantify performance method using using term _1\ _1\ _2\ _1\ _2\ _3\ loss function full size table discussion proposed method achieved satisfactory result etdrs ring studied biological marker method outperforms compared baseline every marker etdrs ring confirming hypothesis feature map used coarsely identify marker location note however term prediction performance srf ring significantly lower reported value method discussed result section unlikely find srf outer ring leading lower number occurrence biological marker turn strongly reduces precision method soon false positive detection associated auc roc score exhibit behavior since include false positive rate segmentation result table show proposed method robust even post-processing mapping coarse biomarker localization meaning post-processing step transparent performance model ablation study table suggest architecture important l_1\ enforcing coherence column output slice label i.e l_2\ case srf provides significant performance increase without reducing performance output srf increase 41.2 43.4 close difference seen irf result l_1\ already outperform baseline boost outer ring highly beneficial presence biological marker ring especially srf highly scarce therefore making harder train appropriately testing dataset acquired variety eye patient b-scans showed srf ring finally including l_3\ brings modest consistent gain l_1\ l_2\ already used compared method model robust baseline giving reliable result even hard situation previous method struggle grad-cam go-to method virtually weakly supervised segmentation method oct rely cam-based approach various architecture line ms-cam proposes architecture leverage activation different feature resolution backbone combine grad-cam++ segmentation refined using crf en-face projection image fair comparison method doe use c-scan information implemented first stage result table show performance worse baseline strong difference difficult scenario srf ring ms-cam achieves 1.6 compared 19.1 method believe crf refinement play major role ms-cam reducing over-segmentation produced first stage over-segmentation lead false positive prediction set-up reduces average precision szeskin use vertical pixel-wide column oct slice classify atrophic region b-scan partitioned column fed contiguous slice convolutional neural network output binary label result projected onto infrared imaging image used identify segment atrophy lesion although work look similar differs training scheme use slice-level annotation allowing independent coarse segmentation per slice method proposed szeskin per volume labeling form image segmentation schlegl focus voxel-wise segmentation output could used location well method differs intent voxel-wise ground truth label train method slice much weaker annotation believe comparable baseline finally analysis en-face projection segmentation result table well fig show two aspect outperformance model baseline doe depend post-processing step although training inference act per b-scan method reliable consistent applied slice volume blandâaltman plot fig along correlation plot fig show area prediction per volume strongly agree expert segmentation case irf srf task remains challenging method tends underestimate en-face area proved slope 0.30 linear regression corresponding bland-altman plot however end goal method accurate segmentation en-face come byproduct demonstrated slice-level label sufficient locate biological marker etdrs ring oct scan weak constraint enforced loss function furthermore confirmed possible modify pooling strategy standard convolutional network perform coarse localization without annotation method proven reliable baseline even hard situation number training sample scarce shown table ablation experiment table demonstrate new term loss function especially l_2\ key performance model producing consistent gain scenario moreover even method presented individual b-scans training sense complete volume capable outputting volume-wise consistent prediction depicted segmentation en-face projection result table table respectively lastly constraint loss function regard marker located therefore described approach could potentially used locate biological marker long class label available approach limitation notably granularity output post-processing constrained resolution feature map granular output would likely improve precision method however achieving high-resolution feature map collides main intention classification neural network conceived reduce dimensionality input final linear layer another limitation come variety biological marker tested due labeling capacity present pathology data irf srf tested although proposed method agnostic aspect potentially behave equally larger cohort marker detailed study required confirm conclusion presented method locate marker etdrs ring oct scan relying solely slice-level annotation enforcing weak constraint loss function modifying pooling strategy standard convolutional network show method learn localize coarsely without annotation knowledge work done context retinal imaging demonstrated approach achieves significant performance improvement straightforward state-of-the-art baseline research focused extending obtain per-pixel segmentation