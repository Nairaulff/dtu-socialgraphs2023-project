introduction electric hybrid-propulsion system key enablers advanced air mobility transformation small large aircraft rely li-ion battery source part power need critical component powertrain safe operation battery require robust prognosis health management method current literature show array method battery monitoring model based first principle machine learning combination however existing modeling approach often find roadblock including governing equation complex available high-fidelity simulation computationally expensive executed onboard purely data-driven model necessarily obey governing physic generalize well scenario trained collecting enough high-quality data adequately train data-driven model complex system often challenging—in fact data available adjusting reduced-order model building machine learning model poor plagued noise missing data unbalanced observation input output etc. challenge commonly shared across many prognosis application creating need robust modeling approach computationally efficient grounded first principle account unstructured datasets background physics-informed neural network potential revolutionize prognosis health management class machine learning method potentially mitigate lack data well problem poor interpretability purely data-driven model offering accuracy comparable high-fidelity simulation fraction computational cost fact recent development neural operator indicate problem partial differential equation known trained neural network reused make prediction even outside boundary/initial condition used training however many complex system described purely partial differential equation rather set governing equation empirical law might fully characterized time available data scarce explains growing interest hybrid physics-informed machine learning promising modeling framework complex application electric hybrid propulsion system hybrid framework propose different paradigm compared physics-driven loss function leverage existing equation system build model introduces small data-driven kernel strategically within model data-driven portion model compensate missing physic model-form uncertainty ignorance model parameter figure hybrid bayesian physics-informed neural network framework application prognosis li-ion battery framework directly implement numerical integration governing equation hybrid graph model merges principle-based node data-driven node variational bayesian node result model accommodate information coming design testbed experiment historical usage data application ranging diagnosis prognosis modeling design uncertainty robust control etc li-ion battery prognosis application state-of-charge dynamic modeled recurrent neural network physics-derived reduced-order model built node data-driven well variational bayesian node quantify different form uncertainty prediction model used discharge prediction well battery aging forecast far ahead life battery full size image term li-ion battery prognosis difficult build model predict battery end discharge accurately accounting effect battery aging challenge include effect random-discharge cycle effect cumulative energy drawn battery inter-battery variability temperature effect aging availability/completeness recorded data order prognosis model useful must furnish uncertainty estimate used optimization battery operation well guiding model update paper propose hybrid bayesian physics-informed neural network approach depicted fig address following key challenge computational footprint model used prognosis computationally efficient term memory requirement speed often used embedded application run thousand what-if scenario proposed hybrid model implement numerical integration governing time-dependent dynamic using recurrent neural network partially characterized first-principle model many real-world application degradation failure mechanism partially modeled due computational complexity lack complete knowledge approach model-form uncertainty introduced either unknown physic reduced-order model compensated data-driven node placed design recurrent neural network unstructured datasets ideally prognosis model able leverage diverse source information—from legacy system design early operation etc framework handle heterogeneous source data design laboratory experiment e.g. reduced-order model constant used therein also compensating reduced number data point prior information coming historical data e.g. legacy fleet data hybrid graph model described fig foundation work presented composed series node one corresponding single multiple set equation equation derived first principle empirical phenomenological model data-driven model like deep neural network variational bayesian model input–output relationship among node represented edge connecting node thus blending physics-derived data-driven block physics-derived model parameter neural network parameter trained single stage using off-the-shelf deep learning library incorporation different data source possible part due hybrid nature model mix principle-based machine learning kernel example principle-based portion model friendly engineering design information machine learning portion accommodate observed data addition bayesian approach data fusion make possible use data becomes available different point battery life cycle recent year hybrid physics-informed data-driven modeling strategy prognostic proposed use mixture physics-based model parameter derived experimentally feed neural network intent predict remaining useful life complex system potentially outperform pure data-driven model others proposed deep learning architecture last layer tailored solve differential equation compute point-solution two time step simultaneously estimate parameter power electronic converter overview method broadly apply prognostic reliability analysis well system safety found prognostic framework differs existing framework blend physics-derived equation data-driven kernel sole hybrid model train data-driven physical parameter together using back-propagation framework combine physic machine learning sequentially model calibrated/trained independently serf input framework also accommodate physics-driven error metric loss function like addition model parameter either trained physical sample e.g. train different parameter battery training set separately shared across multiple sample system type e.g. train parameter represent fleet similar battery single model composed mix parameter shared across different specimen parameter need tailored specimen figure detail application proposed framework prognosis li-ion battery battery state charge approximated using discretized ordinary differential equation based nerst butler–volmer model foundation principle-based node blue block capture major trend battery state-of-charge discrepancy prediction model field data prevent used alone battery risk management therefore pair principle-based node graph purely data-driven node adjust model-form uncertainty coming model simplification variational bayesian node account data uncertainty coming battery-to-battery variability observation uncertainty practical term hybrid model offer following key benefit battery operator doe rely solely constant discharge curve standard estimate battery residual capacity therefore model updating performed without decommission battery handle battery-to-battery variation happen due factor inherent variability manufacturing initial internal damage etc model battery degradation incorporating fleet-wide data aid bayesian formulation handle model update full partial discharge cycle well missing history battery usage approach demonstrated using experimental data publicly available nasa prognostic center excellence data repository result present four key result estimation model-form inadequacy state-of-charge model modeling battery aging incorporation battery-to-battery variation model update using full partial battery discharge cycle ability derive battery-specific model without requiring battery usage history handling model-form uncertainty hybrid physics-informed neural network first result proposed hybrid physics-informed neural network numerical integration ordinary differential equation governing state charge directly implemented recurrent neural network class network model one-step-ahead prediction response interest associated model state given set input value aligned t-1 t-1 aligned subscript represents time discretization observable response internal state input variable defines transition time step figure implementing hybrid physics-informed neural network li-ion prognosis recurrent neural network design implement numerical integration governing equation state-space representation recurrent unit composed surrogate model describing main phenomenon driving battery electrochemistry data-driven node capture non-ideal internal voltage variational bayesian node model aging degradation battery parameter hybrid model take current time series input return battery voltage allows one use model tracking present discharge cycle well forecast future mission comparison experimental data prediction hybrid physics-informed neural network prediction obtained battery used training set full size image detailed fig propose designing implement appropriate integration scheme e.g. euler runge-kutta etc set governing equation use principle-based model intent capture trend data iii add data-driven variational kernel quantify model uncertainty li-ion battery model physics-based node implement simplified electrochemistry given butler–volmer–nernst model data-driven node estimate non-ideal internal voltage i=\ variational bayesian node model total resistance r_0\ ohm maximum charge max coulomb value driven aging battery may change one specimen another therefore data-driven variational bayesian node characterize epistemic aleatory uncertainty principle-based model computational cost associated model remarkably low principle-based model come fast-to-compute reduced order model data-driven model shallow multi-layer perceptrons mlps variational multi-layer perceptrons vmlps first-order ordinary differential equation governs time-dependent response integrated using state-space representation ideal onboard computing massive uncertainty quantification offline detail implementation node given method section supplementary material illustrate cost associated training prediction figure illustrates use hybrid model time series electric current drawn battery used input time step hybrid physics-informed neural network update internal state well estimate value voltage drop battery terminal set hyperparameters hybrid model data-driven variational bayesian node estimated using set discharge cycle full discharge cycle performed fresh battery used parameter optimization data-driven model used describe non-ideal internal voltage aging model utilize instead full partial discharge cycle order ensure diversity training data come set battery exposed different duty cycle finally trained model used predict battery discharge battery mission present training set figure show hybrid model prediction compare sample random discharge cycle result illustrate model ability track voltage throughout cycle allows one determine whether battery able finish given mission optimize deployment set battery across multiple mission accounting battery aging variational bayesian model second result framework able build aging model battery monitored test battery leveraging existing knowledge fleet similar battery achieve goal resort vmlps model updated new data coming test battery operation using bayesian update figure account battery aging using variational model correlation max cumulative energy drawn battery individual aging model fleet serve fleet prior used define aging model max r_0 ensemble distribution max fleet prior orange line posterior distribution green line shadowed area computed updating fleet prior estimate max visible black circle model a-posteriori predict future discharge profile different aging stage battery prediction posterior model green compared prediction carried without fleet prior model full size image first observed strong correlation capacity fading aging battery change model parameter max r_0\ shown fig fig s4b supplementary material assumed historical capacity-fading data fleet older battery collected used build aging model battery fleet model aim predicting expected value confidence interval function cumulative energy drawn model composed two vmlps capture epistemic aleatory uncertainty described method section figure show output individual variational model top collected capacity data thanks strong correlation observed parameter max r_0\ built aging model describing max r_o explained detail method section variational model battery fleet work prior test battery combined ensemble model follows aligned max _k^ max r_0 _k^ aligned _k^q\ _r^q\ weight -th model defined later method section max -th vmlps associated battery used build fleet prior illustrated fig therefore max r_0 represent estimate priori ensemble model derived fleet orange line fig show example prior max every time new data collected operation test battery either reference discharge cycle test indirectly estimating update ensemble-model prior given prediction fleet update weight bias test battery vmlp model using bayes rule lead new a-posteriori model depicted fig green line shaded area approach allows leverage existing trend capacity fading older battery infer future value max r_0\ test battery forecast max r_0\ future value one fig enables prediction voltage discharge behavior test battery different aging stage shown fig dealing complete censored data specialized loss function variational model figure using full partial discharge cycle perform model update partial discharge cycle available information used capacity imposes uncertainty estimation available li-ions fleet information used elucidate prior distribution full partial discharge cycle used continuous model update top panel illustrates update one full discharge kwh partial discharge cycle e=0 kwh kwh bottom panel show update full discharge kwh kwh partial discharge cycle e=0 kwh kwh uncertainty model parameter propagated state-of-charge throughout mission voltage history integration voltage current used estimate power energy used cycle estimated energy distribution compared actual used energy long distribution error energy estimation stationary hybrid model used specific battery metric kl-divergence used indicate new full discharge cycle needed model updating full size image third result proposed hybrid physics-informed neural network ability use complete information constant discharge well censored data random discharge perform battery-specific model update illustrated fig full discharge data obviously effective reducing model-parameter uncertainty partial discharge data however fact framework incorporate partial discharge implies model updated battery still use experiment observed model behavior consistent aging effect observed fleet similar battery used training thus aging test battery follows statistical distribution sense aging already seen fleet describing training set partial discharge cycle sufficient guarantee proper model updating refine model prediction future discharge cycle however full discharge data likely necessary test battery behaving differently one seen training set number full discharge cycle necessary strongly depends behavior battery operation update capacity model sample battery illustrated fig available data kwh composed one constant discharge kwh random discharge cycle run kwh posterior model used forecast capacity function cumulative energy updated model fig result reduction uncertainty obtained updating model partial discharge data provided supplementary material order evaluate whether model produce prediction accurate enough use propose estimating distribution error predicted consumed energy evaluate stationarity error using statistical measure predict voltage discharge curve corresponding uncertainty coming model parameter voltage applied load current profile integrated estimate energy distribution necessary specific mission energy distribution compared actual energy consumed battery fig model used prognosis long distribution energy error remains stationary metric kl-divergence present energy error distribution energy error distribution immediately model updated full discharge data used indicate need new full discharge data illustrated fig top panel show median confidence interval energy error distribution battery usage expected variation battery accumulates cycle cumulative energy reach kwh energy error distribution start diverge substantially easily captured kl-divergence becomes index health model shown bottom panel fig threshold level kl-divergence indicate need new full discharge data application dependent recommend use fleet battery determine study found value around 1.0 see discussion supplementary material quantifying uncertainty aging due unknown battery usage bayesian update fourth result proposed framework ability perform battery-specific model update without requiring complete knowledge past battery usage scenario likely occur monitoring legacy fleet battery-powered vehicle device operator insurer service provider might serve battery unknown previous operation route/usage structure pattern driver/user behavior etc nevertheless control operation maintenance cost important quantify battery degradation estimate capacity fade future usage hybrid physics-informed neural network model battery obtained monitoring present future decay capacity observed increment cumulative energy performing bayesian update fleet-wide model taken prior information light newly recorded data figure modeling battery aging without known usage history although capacity data might missing considerable amount operation consistently tracked used updating aging model fleet-wide information capacity versus cumulative energy used estimate cumulative energy distribution observed capacity level bayesian update performed difference observed cumulative energy enough observed capacity level aging model move fleet battery-specific distribution full size image figure illustrates case battery usage becomes available period without historical data capacity decay registered increment cumulative energy moment battery start monitored two observed capacity level physics-informed neural network developed data coming fleet used estimate distribution possible cumulative energy shown fig two distribution convert fleet-wide model battery-specific one performing bayesian update depicted fig use distribution fig define prior distribution increment cumulative energy p_0 observed define likelihood vector parameter hybrid model illustrated fig data becomes available fleet-wide model converge battery monitored battery-specific updated model used forecast capacity degradation therefore perform optimization battery usage throughout service life discussion formulation hybrid bayesian physics-informed neural network presented paper advance field scientific machine learning defining computationally efficient framework modeling dynamical system computational footprint illustrated supplementary material approach build directed graph model incorporating physics-based node capture trend data quantifying propagating uncertainty using data-driven node data-driven node introduced graph order compensate limitation predictability originally found principle-based model well handling unstructured datasets including partially observed historical data framework supported bayesian method li-ion battery prognosis application fleet-wide information build prior distribution battery-specific model updating model operational data among major advantage proposed framework mention quantification model inadequacy hybrid approach data-driven node quantify model-form uncertainty li-ion battery prognosis application approach showed ability reduce gap prediction observation reduced number training point quantification data uncertainty hybrid approach variational bayesian node quantify different form observation uncertainty application approach successfully account variability aging rate different battery due factor inherent manufacturing variability initial internal damage etc robustness unstructured data bayesian formulation allows using historical fleet-wide data build prior model parameter practice reduced need controlled full discharge cycle normally used precise estimation battery residual capacity mean model update performed without decommissioning battery addition prior estimate aging behavior ensure model update performed partial discharge cycle without even requiring previous usage history battery reliable tracking model accuracy approach able monitor predictive capability model i.e. health model monitoring stationary integrated output error battery application done using metric kl-divergence top error energy consumption cycle-by-cycle basis used inform controlled full discharge cycle needed major model update proposed framework impact onboard health monitoring system electric propulsion directly applied adjacent technology predictive maintenance digital twin industrial equipment soft robotics another challenging application space neural network used model complex dynamic approach proposed could reduce computational cost associated numerical integration highly nonlinear material model therefore enabling model-based control addition hybrid modeling framework potential substantially facilitate verification validation onboard analytics due ability quantify mitigate different source uncertainty capability facilitates formal verification validation improves compliance norm do-178 arp-4754 turn help clearing path certification machine learning enabled system highly regulated environment civil aviation among limitation framework presented paper mention modeling perspective framework assumes physics-based model approximate relationship input output interest exist engineer scientist able pinpoint cause gap prediction observed data consequently implement hybrid model place data-driven node accordingly assume physics-based equation implemented graph computational cost comparable linear algebra found neural network equation must differentiable enable back-propagation gradient application perspective approach tested using relatively homogeneous dataset discharge curve came li-ion battery similar one another addition battery used testing subject similar loading condition i.e. either constant loading piece-wise random loading anticipate aging behavior battery change battery subjected substantially different condition example recharging battery fully consistently depleted introduce discrepancy prediction observation potential future research model could tested realistic loading profile coming electric hybrid propulsion vehicle varying temperature profile representative real operation hybrid physics-informed neural network model could also extended powertrain component even full hybrid powertrain model electric vehicle operator hybrid powertrain model could provide end-of-discharge prediction also fault detection isolation within powertrain system another important suggestion future work quantify improve uncertainty prediction feature hybrid approach used accurately estimate model confidence method used include calibration curve metric expected calibration error finally another venue could explored model architecture alternative number layer number neuron activation function choice optimizers data-driven node subject application complexity one could pursue optimization data-driven architecture alternative technology neural architecture search method implementing hybrid physics-informed neural network hybrid physics-informed neural network proposed implement integration ordinary differential equation describing battery simplified physic state-space form describe simplified eletrochemistry model based nernst–butler–vomer equation well data-driven variational bayesian node fig equilibrium potential based work presented approximate equilibrium potential aligned u_0 1-x_i x_i x_i q_i max aligned subscript indicates negative positive electrode respectively u_0\ reference potential universal gas constant confused total resistance r_0\ electrode temperature number electron transferred reaction faraday constant mole fraction li-intercalated host material non-ideal internal voltage activity correction term null ideal condition mole fraction x_p=0.4\ x_n=0.6\ battery utilized work max q_n q_p\ amount available ion used represent aging total volume battery split two control volume bulk surface diffusion rate bulk surface aligned q_p q_n app -\dot -i_ app -\dot aligned diffusion coefficient concentration overpotential calculated using nernst equation surface aligned max max max v_i aligned voltage increment surface overpotential described butler–volmer equation aligned v_0 f\alpha arcsinh j_i 2j_ v_0 r_0 app aligned symmetry factor j_i\ current density exchange current density r_0\ ohmic lumped resistance used represent aging non-ideal internal voltage assumption unity activity coefficient applicable real battery result paper non-ideal internal voltage modeled multi-layer perceptron mlp aligned mlp x_n mlp x_p aligned _n\ _n\ _p\ _p\ mlp parameter subscript refer positive negative electrode respectively set equation define node implemented hybrid physics-informed neural network battery prognostic accounting battery aging variational model battery aging modeled capacity decay useful life use parameter max r_0\ proxy aging effect capacity input variable aging model cumulative energy drawn battery parameter max r_0\ strongly correlated thus modeled aligned ^2_c max r_0 max vmlp ^2_c vmlp ^2_c ^2_c ^2_c aligned scaling factor determined data shown fig linear model reported supplementary material variational model consequence aging parameter max r_0\ composed one vmlp predict mean value quantity interest epistemic uncertainty another one estimate confidence interval prediction aleatory uncertainty weight bias vmlps described normal distribution way -th layer vmlp aligned ^2_ ^2_ aligned similarly -th layer ^2_c vmlp aligned ^2_c ^2_ ^2_c ^2_c ^2_ ^2_c aligned mean standard deviation distribution optimized training loss function defined observation aging best modeled battery specific max r_0\ building model newly deployed battery constant reference discharge data enough build accurate vmlp model suggest using ensemble fleet-wide model build prior new battery ensemble prior corresponding weight follow aligned c_i aligned _i^ _j\ _i\ error measure model observed value paper used negative log-likelihood nll defined observed used capacity used model update alternatively observed capacity data plentiful mean-squared error observed predicted capacity used figure ensemble model used predict battery aging based bayesian update model max r_0\ built using variational inference-based layer composed two mlps one estimate expectation function cumulative energy one estimate aleatory uncertainty battery set independent model max r_0\ model combined ensemble model predicting distribution max r_0\ level cumulative energy draw bayesian update used adjust mlp parameter value capacity data collected full size image figure show graphical representation variational model vmlps fleet prior bayesian updating dealing complete censored data specialized loss function variational model model update performed using fleet-wide information definition model-parameter prior partial discharge cycle coming step-wise random variation input current give estimate used capacity similarly classic variational neural network loss function drive optimization vmlp hyperparameters sum negative log-likelihood kullback–leibler divergence aligned nll nll _c\left c_i ^2_c ^2_c _c\left c_j ^2_c ^2_c c_i ^2_c ^2_c p_0 ^2_c ^2_c aligned nll negative log-likelihood contribution computed using observed capacity constant discharge used capacity random discharge kl-divergence contribution computed across vmlp layer indicated subscript probability density cumulative distribution function normal distribution c_i\ c_j\ observed used capacity respectively likelihood vmlp weight bias p_0 probability density function prior distribution vmlp weight bias figure set algorithm used updating battery-specific model using full partial discharge cycle left panel describes step elucidation prior distribution vmlp model parameter practical application reference discharge data assumed previously available either battery manufacturer testing data collecting historical data center panel detail step model updating battery-specific data used drive bayesian update however study found heuristic balance fleet information using weighted average ensemble might needed data still poor formed mostly partial discharge cycle right panel describes algorithm monitoring health model. significant reduction model-parameter uncertainty expected adding new constant discharge data however cost associated information justify effort tracking model performance take battery commission obtain constant discharge cycle needed full size image assuming available fleet-wide information build prior vmlp capacity model using step described left panel fig fleet-based prior used estimate model parameter new battery full discharge cycle sparse data come regular battery usage assume initial constant discharge performed prior deploying battery service new battery included set used generate fleet prior partial discharge cycle provide used capacity feed continuous update battery-specific model center panel fig describe algorithm propose perform task quantified uncertainty affecting model-parameters propagated hybrid physics-informed neural network used guide acquisition new constant discharge data proposed algorithm detailed right panel fig calculates need new constant discharge cycle battery submitted constant discharge cycle depleted completely therefore observed battery capacity much stronger contribution loss function compared used capacity found regular partial discharge data quantifying uncertainty aging due unknown battery usage bayesian update many fielded battery usage history might known depicted fig assuming practical way ass battery initial capacity cumulative energy track battery capacity versus cumulative energy differential respect arbitrary point write aligned ^2_ aligned battery capacity increment cumulative energy moment battery start monitored parameter define map cumulative energy increment battery capacity propose using bayesian approach update uncertainty battery capacity function battery usage aligned p_0 p_0 d\varvec aligned random variable defines increment cumulative energy function battery capacity ^2_c ^2_c vector parameter vmlp model define set observed data case set observed capacity cumulative energy increment pair observed since battery started monitored p_0 posterior prior distribution likelihood model equation known hard solve due integral denominator order sample posterior distribution use numerical integration particle filtering convenience assume likelihood gaussian bayesian update strategy illustrated fig