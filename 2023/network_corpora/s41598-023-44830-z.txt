introduction aim paper investigate whether analysis clinical note written dutch general practitioner improve performance prediction model early detection cancer existing solution comprise prediction model potential identify patient high risk exclude patient low risk work primary care practice risk model used cancer detection based traditional logistic regression research include among others caper indicating symptom qcancer indicating symptom combined general data bristol-birmingham equation scoring system used identifying colorectal cancer model use structured feature variable predictor representing example age sex symptom like icpc-d18 change bowel habit scope improvement currently unknown signal earlier detection cancer identified general practice might present record general practitioner gps netherlands patient enlisted many year primary care practice free-text note practice contain coded information patient also information family medical history consultation note psychological social wellbeing since note usually collected several year may hold earlier predictive information problem address concern colorectal cancer crc worldwide third common cancer 1.8 million new case yearly 881,000 death estimated last six year referral suspected crc much increased e.g. alone similar growth demand endoscopy nowadays roughly half referral made gps presented symptom half population screening introduced research showed gps referred three quarter patient within two week presentation indicating symptom still half patient suffered disseminated disease main reason late referral appeared low suspicion cancer moreover crc notoriously difficult symptom overlap severe disease referred patient turn crc crc cancer general current method early detection make much progress half patient referred cancer already metastasized mean increasing need improved method detection selection patient national screening programme netherlands done bi-annually patient year age aim identifying cancer also pre-cancerous lesion however positive predictive value cancer case positive faecal immunochemical test fit screening test netherlands used cut-off fit still half patient cancer missed patient patient included screening programm early detection general practitioner still necessary research aimed clinical identification patient risk screened positive included program refused screening negative screening test hypothesis general practitioner free-text consultation note hold useful predictive information unknown therefore ass potential added performance primary care free-text dutch provide top currently known predictive feature using embeddings approach main contribution study demonstrate prediction model improved using free text automatically learning predictive feature form word embeddings aggregation represent whole patient history earlier work used similar approach secondary care note hospital discharge summary note rather short quite general cover long time period overuse abbreviation acronym contain many typographical error approach ass added value free-text prediction develop evaluate compare three clinical prediction model baseline logistic regression model based known predictive feature embedding-based model based free-text model based structured feature free-text together model based free-text first transform word embeddings average construct patient representation model development excluded patient data month diagnosis made measure performance term discrimination calibration accuracy predicted probability investigate prediction model hagnet database academic medical centre amsterdam containing dutch free-text note group primary care practice result patient characteristic table describes patient characteristic study population statistic included consultation note figure show distribution length number word among used consultation note patient without crc respectively comparison previous finding dutch primary care note distribution flatter i.e. lower fraction longer tail word higher frequent number word note word fraction text note 0.12 prevalence crc similar reported rate observational study crc data netherlands line published rate dutch cancer registry http table baseline characteristic patient population full size table figure distribution word count consultation note patient crc full size image figure distribution word count consultation note patient without crc full size image performance measure table show area-under-roc curve area-under-prc curve specificity true negative rate achieved test set along confidence interval brier score recall determining specificity set decision threshold model provide minimum sensitivity tp/ 0.95 crc figure show precision-recall curve prc model illustration purpose included decision threshold curve indicated dot labelled threshold number appearing near dot line depicted fig a–c denote various decision probability threshold diagnosis crc declared example decision threshold 0.02 ppv tab fig 2.5 sensitivity contrast ppv tabtxt decision threshold sensitivity show marked improvement ppv 2.5 figure show calibration curve model curve smoothed using lowess locally weighted scatterplot smoothing illustration purpose indicated plot percentile table median achieved bootstrap sample full size table figure precision-recall curve tab model labelled dot curve indicate decision threshold prediction model precision-recall curve txt model labelled dot curve indicate decision threshold prediction model precision-recall curve tabtxt model labelled dot curve indicate decision threshold prediction model full size image figure calibration curve tab model prediction reside shown threshold calibration curve txt model prediction reside shown threshold calibration curve tabtxt model prediction reside shown threshold full size image analysis tabtxt-model age gender selected structured feature caper q-cancer free-text performs statistically significantly better model interval 2.5th 97.5th percentile auroc difference tabtxt tab 0.0271–0.0857 tabtxt txt 0.0031–0.0509 difference interval indicate statistically significant difference 0.05 auprc model low see positive predictive value precision rapidly decrease still positive predictive value text model higher tab model almost decision threshold brier score model 0.01 brier score would imply high accuracy mainly resultant highly imbalanced dataset i.e. low crc prevalence brier score non-informative baseline 0.0087 0.0073–0.0105 prevalence 0.0088 0.0074–0.0106 cancer difference brier score tabtxt others small consider 0.05 vast majority prediction percentile txt lesser degree tabtxt model show good calibration tab model show slight underprediction tail expected outcome prevalence 0.01 model show fairly uncalibrated prediction extreme upper tail top specificity true negative rate tnr two model use demographic known crc feature specificity tab 0.321 tabtxt 0.335 higher model free-text specificity txt 0.234 discussion study set investigate predictive performance embeddings free-text prediction model colorectal cancer primary care main finding word embeddings free-text indeed improve predictive performance adding word embeddings established structured feature resulted statistically significant increase auroc 0.823 0.767 statistically significant difference model use text model use structured feature observe specificity improved model using structured feature calibration improved model using text moreover see increase auprc 0.041 0.029 0.023 combining text structured feature one model analysis medical text receiving increased attention recent year notably using conventional natural language processing nlp technique like entity extraction enrichment text term system topic modelling extraction clinical concept unsupervised text representation study used routinely collected care data three study use primary care data study compare different prediction model report internal validation using e.g cross validation none performed report statistical significance test added performance value text different model related work briefly summarised table table overview related work full size table used actual routinely collected primary care data relevant clinical outcome detection cancer first study word embeddings approach non-english dutch text primary care incorporate recent well-performing embedding approach enrich structured feature used multiple performance measure including calibration curve brier score accuracy predicted probability approach based aggregating word embeddings tabular feature systematic modular cheap compute integrates multiple type data render approach flexible finally included statistical comparison baseline structured model representing established current model primary care practice i.e. bristol-birmingham qcancer caper choice using word embeddings without contextual cue like order word text external ontology meant understand isolated incremental added value word strong point study excluded patient data month diagnosis made still limitation study exact moment referral often registered primary care although improving potentially lead considering wrong moment diagnosis study likewise model use icpc code may miss information actually observed recorded note rather code term prediction model include temporal information date order consultation however since goal investigate potential added value word adding temporal information may given text-based model unfair advantage regarding evaluation strategy applying bootstrapping whole dataset instead test set would account variability choice training validation test set would extremely computationally intensive case scale deeper language model concerning validation experimental result external validation needed show generalizable model setting requires similar enough also distinct dataset available still perform extensive internal validation i.e. evaluated trained model bootstrap sample test set validation text model compared non-text model early cancer diagnosis model i.e. tab -model patient data caper bristol-birmingham qcancer use finally real world application error analysis performed including model interpretability interpretability could example associating strength word outcome requires intensive computational analysis see word text indicated presence crc still note guarantee patient higher risk would correspond separate suspicious word amalgamation implicit cue result prediction discrete representation word although model yet far ready clinical practice foreseen future application entail providing risk estimate crc visit patient idea although timing crc diagnosis unknown visit would fall close month prior diagnosis predictive performance similar one reported paper researcher developer prediction model decision support system demonstrate potential using free-text real-world primary care medical documentation prediction term extending current state knowledge field add incremental evidence suitability machine learning harnessing information residing medical free-text model relevant improving decision support system medical decision aid consultation room potentially improving detection possibly reducing amount negative endoscopy referral concerning referral suspected crc medical specialist see improved specificity model structured feature text help temper increasing referral rate future application developed prediction model foreseen usage model provides prognostic risk score crc month ahead potential diagnosis lastly emphasize developed validated model research prediction model yet existing disease therefore model interpreted causally provide prediction future disease like cardiovascular disease patient hypertension imperative clinical implementation work model may help identify case precisely earlier stage finding suggest need research five recommendation firstly linkage cancer registry increase reliability diagnosis secondly incorporating better-informed structured feature related bbe caper and/or qcancer instead icpc code use well investigating context taking order event consideration including knowledge graph likely improve predictive performance thirdly data multiple centre increase model performance enable external validation fourthly interpretability model great importance acceptance model decision support tool allow improved error analysis finally cancer development span number year colorectal cancer year therefore longitudinal analysis f.e comparison annual data could provide prediction curve assisting clinical decision making even study show medical text note leveraged machine learning prediction task specifically early cancer detection primary care free text provides added predictive value clinical practice improved prediction model speed reduce referral suspected cancer contribution add current state art risk model since common accepted risk model used colorectal cancer use structured feature besides despite recent risk model use free-text still used english language and/or rely external source medical terminology reference list method study design developed prediction model developed three model data retrospective observational cohort model output probability based logistic regression either directly equivalently via node sigmoid activation function model tab -model baseline model model combining tabular hence model name feature established primary care risk model i.e. bristol-birmingham qcancer caper feature include age normalised gender three category normalised count icpc code correspond constipation diarrhoea changed bowel habit abdominal pain abdominal bloating rectal blood loss weight loss loss appetite anaemia thrombophlebitis d12 d11 d18 d01 d25 d16 t08 t03 b80 b82 k94 use reported coefficient original paper instead re-train model dataset txt -model model using free-text note word embeddings averaged represent patient embedding vector patient embedding fed logistic regression model tabtxt -model model combining feature first model tab patient embeddings second model txt outputting probability crc using logistic regression detail txt tabtxt model provided including model development used learning algorithm database population used amsterdamumc primary care hagnet electronic medical record database observational cohort network six primary care practice 40,000 current patient total 150,000 patient year period year 1995–2015 containing de-identified patient information episode problem list lab medication diagnosis using icpc coding system referral note written free-text dutch patient inclusion patient database year old included except without data required feature free-text selected time period per patient crc diagnosis identified labelled first icpc code starting d75 colon rectum malignancy record input data patient used two year data recorded prior five month date registering diagnosis advised clinical judgement prevent suspicion bias patient diagnosed crc applied time window two year data five month last visit data extraction pre-processing following data extracted per patient demographic age gender consultation note icpc code consultation example note dutch lage rugklachten bij vastzitten advies trainen met hartslameter loop adviezen kan een minhardlopen niet meer depressief translates including similar language error low backpain stuck training advice heart ate monitor walk advice runfor min depressed anymore minimal syntactic pre-processing performed note keep potential important signal text replaced rare token i.e. token equal a–z 0–9 space stripped excess empty space lowercased word model development prediction model architecture used txt tabtxt free-text shown fig used learning algorithm described detail following section split data randomly stratified training train model validation hyperparameter tuning testing final evaluation set figure model architecture used prediction model left text encoding right prediction model full size image learning algorithm word embedding model used recent year large datasets e.g. wikipedia order facilitate down-stream task like prediction general outline word embedding approach word corpus represented numeric vector vector space typically several hundred dimension training word embedding model word vector positioned embedded vector space word share common context taken semantically similar located close vector space example heart cor ventricle placed close e.g using cosine similarity measure prediction model fig based word embedding model consist two part first text processing part i.e. word text encoders aggregate word patient vector averaging word embeddings similar embed-and-aggregate method shown perform par involved deep learning technique like recurrent neural network rnns neural bag-of-words approach specifically small target task training set size approach learn embeddings offline i.e. independent prediction task shown learn representation yield significant accurate model additionally aggressive dimensionality reduction often benefit task small training set second part train prediction model possibly using extra structured feature indicated aux fig patient text representation embeddings process corpus free-text note training set plus free-text note patient year old used downstream task order transform text feature used subsequent prediction model particular feature based aggregate word embeddings also apply word bigram get embeddings frequent bigram e.g colorectal cancer instead single word shown fig word embedded word encoder word2vec skip-gram trained corpus d-dimensional case vector subsequently embeddings aggregated per patient creating single text embedding via text encoder used mean aggregation found perform better max min sum validation set i.e data set tune hyperparameters update embeddings downstream prediction task i.e learned offline performed better validation set keeping number trainable parameter low approach may lose information order word seems work well regardless cheap compute aggregated one text embedding per patient text representing textual note patient small dense fixed-size vector prediction model text embedding text resulting free-text processing fed logistic regression prediction model together structured input aux_p e.g age gender patient hyperparameter setting supplementary table show hyperparameter setting model prediction model minimise binary cross entropy loss adam optimizer early stopping validation set maximum number epoch batch size embedding model trained using following parameter word2vec use skip-gram embedding dimension window size using negative sampling threshold 0.0001 frequency downsampling word i.e frequent word downsampled lower minimum word count keep rare misspelling variant note subsampling performed deal imbalance rare frequent word frequent word e.g. cetera usually provide information rare word perform down-sampling word discarded probability inverse frequency strategy aggressively subsamples word whose frequency greater threshold 0.00001 preserving ranking frequency down-sampling prevailing strategy discard frequent word over-sampling boost rare word may considered well performance measure measured predictive performance term discrimination area receiver-operator curve auroc balance positive predictive value sensitivity area precision-recall curve auprc compared three model respective auroc value report specificity model threshold result sensitivity 0.95 order fair comparison model performance missing cancer case medically relevant score sensitivity 0.95 mean although relatively large number patient might need get attention based risk example seen follow-up visit directly referred patient much better selected subjecting huge number patient screening model provides rational approach decide needing attention included calibration curve indicate close predicted probability true rate observed event across full probability range use brier score measure accuracy predicted probability summarising deviation actual predicted outcome patient level brier score mean squared error predicted outcome lower brier score indicate better accuracy use brier skill score measure improvement model non-informative baseline prediction model one model predicts prevalence baseline 0.0089 patient second majority-rule model predicts cancer everyone score indicated maximum improvement improvement negative value indicates worse performance evaluation strategy evaluated trained model bootstrap sample test set recorded median auroc bootstrap result primary result using percentile bootstrap method provide confidence interval 2.5th 97.5th percentile also calculated statistical significance based percentile bootstrap method difference auroc two model took 2.5th 97.5th percentile inspect whether included remaining interval statistically significant difference result 0.05 statistical analysis analysis performed using python gensim word embeddings kera prediction model module hardware included consumer laptop data preprocessing pseudonymization embeddings cloud virtual machine prediction algorithm evaluation without gpu ethical approval record used dataset retrospective routinely collected observational data de-identified research exempted medical-ethical research board amsterdam umc medisch ethische toetsingscommissie amc meibergdreef amsterdam w21_197 21.214 informed consent informed consent obtained subject and/or legal guardian mean opt-out system case subject objected using data guideline statement item tripod guideline reporting statement pertaining development multivariable prediction model considered addressed paper