introduction researcher attempted develop model capture real-world phenomenon since early modern history humanity model desirable used devise solution real-world problem process refining hypothesis falsifiable meaningfully tested experimental data performed manually century automation process long great interest scientific community many attempt made autonomously extract physical law data abundance data inexpensive yet powerful hardware deep learning-based method attracted considerable attention revolution deep learning begin lecunn krizhevsky generalized backpropagation algorithm training multilayers network deep learning become popular robotics field due efficacy solving complex robotic task used extensively model control dynamical system recent year moreover deep learning model approximate physical quantity hamiltonian lagrangian mathematical quantity koppman eigenfunctions dynamical system koopman eigenfunction especially useful nonlinear dynamical system provides framework embed nonlinear dynamical system linear system infinite hilbert space another variant neural network graph neural network also used obtain dynamic model interacting particle method deep learning model separable internal structure provides inductive bias trained supervised manner xie combine graph neural network koopman analysis model behavior molecular dynamic unsupervised manner one caveat deep learning model act black box provide insight observational variable affect relate contrast neural network-based method recent trend favor parsimonious white-box modeling lowest complexity describe experimental data ground breaking work schmidt lipson demonstrated possible extract governing mathematical expression observational data although symbolic regression used determine nonlinear differential equation describe system behavior approach tends expensive sparse identification nonlinear dynamic sindy model nonlinear differential equation dynamic linear combination nonlinear candidate function obtains parsimonious model sparse regression although sindy offer many application across different field face certain difficulty dynamic contain rational function inclusion rational function library candidate function increase size library significantly making sparse regression challenging modification sindy known implicit-sindy reformulates sindy problem implicit form address challenge however method sensitive noise due non-convex optimization procedure sindy-pi proposed improve performance implicit-sindy term noise robustness reformulating problem convex optimization problem although sindy-pi substantially robust implicit-sindy obtain correct dynamical structure noise magnitude scale 10^ may sufficient real-world application furthermore predicted system may blow denominator equal zero incorrect combination denominator term discovered another sindy variant identify rational function rk4-sindy combine runge-kutta method sparse identification method instead reformulating equation implicit form rk4-sindy defines linear combination nominator denominator separately combining result however method tested rather simple rational equation possibility incorrect denominator found complex system may cause prediction blow still exists principle least action fundamental many dynamical system principle state trajectory selected system minimizes certain cost function cost function so-called action defined integral lagrangian input evolution certain period lagrangian desirable property compared underlying differential equation single scalar quantity contains information predicting system behavior robotics derivation dynamic often initiated lagrangian system several technique proposed approximate lagrangian data using polynomial basis function however approximation lagrangian polynomial basis function useful particular trajectory system likely generalized well across different initial condition effectively lagrangian-sindy sindy-based method designed extract lagrangian nonlinear dynamic retrieve true form lagrangian several dynamical system lagrangian-sindy first build expression total energy turn koopman eigenfunction eigenvalue =0\ adopts sparse regression comparing time derivative total energy net power come system however paper noted lagrangian-sindy certain sensitive noise recover lagrangian training data corrupted gaussian noise even magnitude scale 10^ remained challenge method noise always present real-world system development method robust noise important real-world application study propose method known extended lagrangian-sindy xl-sindy discover true form lagrangian robust presence noise lagrangian-sindy sindy-pi unlike lagrangian-sindy discovers lagrangian hamiltonian xl-sindy directly find lagrangian explained problem formulation section demonstrate effectiveness xl-sindy different noise level compare robustness sindy-pi physical simulation using four dynamical system single pendulum cart-pendulum double pendulum spherical pendulum figure block diagram proposed method xl-sindy depending case problem different cost function constructed cost function defined cost function minimized using proximal gradient descent method full size image result new problem formulation lagrangian acquisition consider lagrangian expression structure linear combination nonlinear candidate function let q_1 q_2 ... q_n configuration system generalized coordinate lagrangian system expressed aligned k=1 c_k\phi aligned k=1 ... set nonlinear candidate function k=1 ... corresponding coefficient interested determining value c_1 c_2 ... c_p believe coefficient zero lagrangian system satisfies eulerâ€“lagrange equation given aligned ext aligned q_i consider three different scenario active system external input ext system provided case passive system external input present case passive system prior lagrangian knowledge simpler system form constituent system provided case iii summary problem formulation shown fig case substituting yield aligned pred k=1 c_k k=1 c_k aligned pred predicted value external input ext given set coefficient c_1 c_2 ... c_p time derivative expanded using chain rule resulting term expressed aligned aligned pred =\left k=1 c_k ^\top k=1 c_k ^\top -\left k=1 c_k k=1 c_k\left ^\top ^\top k=1 c_k\left aligned aligned =\nabla ^\top =\nabla ^\top =\nabla lagrangian system obtained minimizing cost function ext pred however case external input present case end minimizing residual cost function pred observed pred form linear combination coefficient thus minimization residual cost function equivalent determination sparse null space arduous task using current optimization method instead modified solve pred expressed aligned k=1 c_k\left -\left k=1 c_k\textbf k=1 c_k\left pred -\sum k=1 c_k\textbf k=1 c_k\left aligned pred represents predicted value acceleration represents matrix inverse practice moore-penrose pseudo-inverse used calculate avoid numerical instability cost function pred defined learn lagrangian system owing inverse operation cost function non-convex respect variable mean optimization process doe always converge global minimum empirically found tendency candidate function correlate learning process hardly converges example tested computation method discover double pendulum different numbesr candidate function library seen fig even candidate function value loss function even reach single digit even epoch candidate function shown fig loss function hardly decreased even following lengthy iteration suggesting learning process converged local minimum therefore case used prior knowledge available system complex single pendulum preferable external input ext provided complex system multidegree-of-freedom system external input provided prior lagrangian knowledge simpler system form constituent larger system used boost learning process case iii explained following paragraph lagrangian multidegree-of-freedom nonrelativistic system described t_i v_i t_i v_i t_i\ v_i\ kinetic potential energy constituent system respectively total lagrangian system sum lagrangians constituent reasonable assume nonlinear term appear constituent also appear total lagrangian system given prior knowledge constituent system one several term appear total lagrangian system selected labeled lagrangian system unique many form lagrangian satisfy euler-lagrange equation particular system example k\mathcal constant satisfies euler-lagrange equation multiplying k=\frac c_l modified follows aligned array k=1 k\ne array c'_k\phi aligned c'_k c_k c_l point variable c'_k\ becomes coefficient interest redefine c_k c'_k\ simplicity notation euler-lagrange equation system expressed aligned aligned -\frac array k=1 k\ne array c_k array k=1 k\ne array c_k aligned aligned define following notation aligned right array k=1 k\ne array c_k array k=1 k\ne array c_k =\sum array k=1 k\ne array c_k\left aligned aligned left -\frac -\textbf aligned left right represent left-hand side right-hand side respectively possible obtain true lagrangian system minimizing cost function =\vert left right general one option available _l\ construct left practice must tested individually one yielding best model must selected figure value loss function versus number candidate function library double pendulum epoch learning using computation described case non-convex loss function full size image figure value loss function versus number epoch iteration double pendulum candidate function using computation described case non-convex loss function full size image figure dynamical system used verify xl-sindy upper left bottom right single pendulum cart pendulum spherical pendulum double pendulum system length rod 1.0\ mass pendulum except cart pendulum m_1 m_2 1.0\ gravitational acceleration 9.81\ m/s ^2\ cart-pendulum mass cart m_c mass pendulum m_p 0.5\ full size image performance verification different dynamical system evaluated xl-sindy using four ideal dynamical system illustrated fig first tested xl-sindy dynamical system excited external input ext random frequency process used model learning described computation case furthermore tested case passive system external input ext provided single pendulum assumed prior knowledge available therefore used computation described case system cart pendulum double pendulum spherical pendulum single pendulum one constituent complex version single pendulum thus assuming lagrangian single pendulum already obtained could use computation described case iii bootstrap learning process collected training data system performing simulation initial condition period measurement frequency initial condition experiment sampled uniform distribution certain threshold dynamical system obtaining analytical form lagrangian created validation dataset test obtained model calculating predicted state accuracy evaluation computed euler-lagrange equation using obtained model retrieved differential equation system integrated equation comparison actual validation data moreover tested proposed method using training data corrupted zero-mean white gaussian noise magnitude different scale range 10^ 10^ case active system gaussian noise added measurement state variable system assume function external input time known case external input given computer finally compared performance xl-sindy several passive dynamical system noisy training data sindy-pi lagrangian value obtained system summarized table active system table passive system performance xl-sindy compared true model simulation experiment cart pendulum double pendulum spherical pendulum presented fig active system fig passive system along comparison sindy-pi different noise level observed table xl-sindy exhibited better performance extracting correct structure external input provided included fewer incorrect additional term model external input provided regarding performance xl-sindy compared sindy-pi presented second column plot fig noise magnitude 2\times 10^ observed sindy-pi already started deviate true model three dynamical system xl-sindy still predicted accurate model noise magnitude also noted model estimate xl-sindy reasonable despite incorrect additional term included lagrangian observed example cart pendulum noise magnitude 6\times 10^ indicates model estimate potentially usable even incorrect lagrangian structure discovered figure comparison true model external excitation provided training data consists initial condition time period validation extrapolation beyond training data set conducted afterward result shown taken randomly one initial condition training data set cart pendulum double pendulum spherical pendulum full size image figure comparison true model sindy-pi external excitation provided training data consists initial condition time period validation extrapolation beyond training data set conducted afterward result shown taken randomly one initial condition training data set cart pendulum double pendulum spherical pendulum full size image table extracted lagrangian external input provided full size table table extracted lagrangian external input provided full size table single pendulum active system correct lagrangian structureâ€“one without additional missing term compared true lagrangian formâ€“could obtained presence noise magnitude 1\times 10^ passive system correct lagrangian structure could obtained noise magnitude 6\times 10^ although obtained coefficient differed true model ratio coefficient two term close compared true model cart pendulum according table xl-sindy could recover correct structure lagrangian presence noise magnitude 1\times 10^ external input noise magnitude 4\times 10^ without external input contrast sindy-pi could recover correct structure noise magnitude 5\times 10^ therefore xl-sindy eight time robust sindy-pi presence noise cart pendulum moreover sindy-pi sometimes predicted model blew large noise magnitude indicated second column fig predicted denominator term incorrectly unlike sindy-pi xl-sindy address lagrangian instead actual equation motion denominator lagrangian xl-sindy still provides reasonable prediction even though incorrect additional term included lagrangian double pendulum according experimental result xl-sindy identified correct structure noise magnitude 10^ active passive case whereas sindy-pi could extract correct structure equation motion noise magnitude 10^ hence xl-sindy time robust noise sindy-pi experiment observed summary table xl-sindy quite robust double pendulum compared dynamical system possible reason xl-sindy robust double pendulum chaotic signal caused double pendulum double pendulum yield entirely different signal path every initial condition owing inherently chaotic nature thereby creating rich training data spherical pendulum experiment xl-sindy robust 10^ active passive system case contrast sindy-pi robust 10^ thus xl-sindy time robust noise sindy-pi observed second column fig table although correct structure could obtained spherical pendulum 10^ performance xl-sindy inferior active system passive system lagrangian multiplied constant still valid lagrangian thus provided ratio coefficient true model obtained model also correct however active system lagrangian unique external constraint exists therefore although correct structure obtained coefficient closely match true model accurate long-term prediction ability exhibited discussion concluded simulation result xl-sindy robust obtaining correct lagrangian structure external input provided system although xl-sindy obtain correct lagrangian structure presence greater noise doe guarantee accurate long-term prediction ability lagrangian system unique external input provided thus mismatched coefficient result deviation long-term prediction contrast problem external input provided lagrangian unique provided ratio coefficient close true model effective long-term prediction model still established however absence external input xl-sindy slightly robust determining correct lagrangian structure used passive case baseline xl-sindy compare model comparison xl-sindy sindy-pi lagrangian-sindy presented fig experimental result demonstrate xl-sindy outperformed method term noise robustness three dynamical system used comparison moreover xl-sindy overcome challenge faced lagrangian-sindy xl-sindy discover correct lagrangian expression idealized nonlinear dynamical system presence substantially higher noise magnitude furthermore xl-sindy successfully extract lagrangian case lagrangian-sindy fails non-actuated spherical pendulum although obtained coefficient may exactly true model ratio coefficient term close true model couple reason xl-sindy much robust lagrangian-sindy previously mentioned lagrangian-sindy find lagrangian total energy coincides hamiltonian mechanical system lagrangian-sindy involves two different regression first compare change total energy external input system extract lagrangian reverse legendre transformation contrast xl-sindy directly find lagrangian euler-lagrange equation straightforward furthermore find sparse solution lagrangian-sindy used combinatorial search possible subset regression case active system singular value decomposition svd case passive system since regularization enforced optimization method result sensitive noise hand xl-sindy formulated optimization problem convex problem thus finding sparse solution done using convex optimization method _1\ regularization although sindy-pi also found robust noise certain magnitude xl-sindy time robust noise sindy-pi attempt seek expression dynamic may contain rational function purpose sindy-pi reformulates problem implicit form requires library include candidate function state time derivative system state consequently sindy-pi must also include variable construct term library unlike sindy-pi deal actual equation motion xl-sindy deal lagrangian requires variable construct term library hence xl-sindy naturally contains fewer term library obtain order family function e.g. second order polynomial function advantage xl-sindy sindy-pi xl-sindy provide greater coverage various term fewer coefficient parameter actual equation motion owing inherent nature lagrangian formulation example let consider lagrangian contains one term expressed aligned c_0\phi aligned substitute euler-lagrange formula obtain equation motion contains three different term follows aligned aligned =\left c_0 ^\top c_0 ^\top -\left c_0 c_0\left ^\top ^\top aligned aligned observed equation although three different term appear equation motion correspond coefficient c_0\ case sindy-pi requires three different coefficient represent different term equation motion hence would easier learn model using xl-sindy using sindy-pi fewer parameter maintaining amount coverage possible term actual equation motion one reason xl-sindy robust sindy-pi another reason xl-sindy robust sindy-pi performance learning process sindy-pi sequential threshold least-squares method basic concept run least-squares method remove term low coefficient sequentially hard thresholding however experimentally determined sequential least-squares method often fails remove non-relevant term training data corrupted thus concept hard thresholding sequential least-squares method combined soft thresholding lasso regression proximal gradient method found approach achieved better performance removing non-relevant term higher level noise shown table although xl-sindy term library sindy-pi xl-sindy still outperformed sindy-pi higher level noise double spherical pendulum finally sindy-pi may encounter problem incorrect combination denominator term discovered rational function denominator zero value blow case sindy-pi cart spherical pendulum according experimental result contrast xl-sindy contains rational term lagrangian mechanical function therefore minimizes possibility model blowing owing incorrect term learning-based method xl-sindy introduces several hyperparameters learning process sparsity constraint learning rate tolerance cost function cut-off threshold hard-thresholding process hyperparameter tuning also vital learning outcome particularly initial value learning rate sparsity constraint present hyperparameter tuning process performed manually trial error one major limitation xl-sindy difficulty designing library prior knowledge system essential deciding candidate function include library large number candidate function library likely sufficient make sparse optimization challenging robust noise hence balancing trade-off crucial outcome learning process better mechanism handling large library necessary applying xl-sindy complex system higher degree freedom one possible mean addressing large number library library-bootstrapping method case ensemble-sindy method many smaller library created sampling term without replacement original library several different model learned separately learning process complete term low probability inclusion removed process repeated sufficient result obtained presence external non-conservative force acting system considered study real-world scenario non-conservative force varying degree damping friction always present consideration external force model important apply xl-sindy real system one major difficulty incorporating non-conservative force model based lagrangian formula lagrangian formula doe take account non-conservative force thus include non-conservative force different model non-conservative force need included final euler-lagrange equation possible mean incorporating non-conservative force use generalized rayleigh dissipation function similar lagrangian rayleigh dissipation function single scalar quantity incorporated euler-lagrange equation generalized rayleigh dissipation function modeled linear combination candidate function lagrangian rayleigh dissipation function learned simultaneously however also mean number candidate term library coefficient exceedingly large extraction sparse solution presented optimization method paper still challenging thus consider handling non-conservative force future work addition group work also distributed neural integrator inducing synchronized oscillation unknown mechanical system non-while box approach combination box modeling black box modeling interesting direction research figure comparison maximum level manageable noise xl-sindy lagrangian-sindy sindy-pi maximum manageable noise defined maximum noise level incorrect model structure discovered xl-sindy provides robust performance noisy training data simulation three different dynamical system full size image figure diagram sparse regression using proximal gradient method combination soft threshold proximal gradient method hard threshold end learning stage accelerates learning process full size image table comparison size library full size table material method sparse regression proximal gradient method proposed learning method obtaining lagrangian depicted fig corresponding code available http first problem formulated described section called new problem formulation lagrangian acquisition given dynamic system time-series data gathered several initial condition regarding t_i ext i=1 subsequently library candidate function constructed general optimization problem becomes difficult library candidate function larger particularly true several candidate function may behave similar manner function trigonometric family important construct library sufficient excessively large optimization problem remains tractable however also preferable include trivial term satisfy euler-lagrange equation regardless trajectory ^n\dot technically although trivial term affect system behavior better remove unnecessary complexity library reduced different cost function defined depending case mentioned previously believe correct solution sparse coefficient zero therefore added _1\ regularization term cost function sparsity constraint expressed aligned aligned sparsity-promoting parameter must carefully tuned several method used solve lasso include coordinate descent method sub-gradient method proximal gradient method least-angle regression accelerated proximal gradient descent method used study minimize composite cost function defined given initial point ^0\ update step proximal gradient descent defined aligned i-1 i-2 i+1 i-1 i-2 aligned aligned prox_ aligned coefficient iteration learning rate prox_ proximal operator _1\ norm _1\ norm penalty term separable sum component input proximal operator used minimize term proximal operator _1\ norm well defined separately component input expressed follows aligned prox_ sign _k|-\lambda aligned entry input vector case iii term known appear lagrangian used construct left impose penalty term applying proximal operator index corresponding term initialized value coefficient learning rate _1\ norm penalty parameter learning process performed several stage epoch batch size stage cost function reached defined tolerance value illustrated fig ideal tolerance value 10^ however convergence value may possible presence noise tolerance value must relaxed otherwise algorithm never stop general number candidate function library initially large attempt eliminate many non-relevant candidate function possible first learning stage therefore initially set value quite high 1-5 important note candidate function may different magnitude scale _1\ norm penalizes term equally regardless magnitude scale resulting candidate function smaller magnitude scale penalized may may necessary perform scaling first learning stage value high multiplying candidate function scaling term s_k\ case case iii depending difference magnitude scale candidate function moreover learning rate important hyperparameter particularly first learning stage high learning rate initial stage may cause relevant term penalized thereby preventing model obtaining true lagrangian system learning rate set 10^ initial stage performed hard thresholding end every learning stage removing index c_k threshold\ step effectively reduced number candidate function considered learning process mean convergence much faster hard thresholding performed subsequently verified whether cost function reached tolerance case proceed next learning stage owing fewer candidate function following previous hard thresholding process value decreased learning rate increased accelerate learning process rate increment decrement also significant increased rapidly optimization process may take longer converge decreased rapidly may possible eliminate non-relevant term tuning process required determine appropriate rate increasing decreasing step repeated cost function reached tolerance value learning process generally requires approximately three four stage tolerance value reached tolerance value reached value coefficient computed using case case iii analytical form lagrangian system obtained learning single pendulum state single pendulum described lagrangian expression single pendulum expressed m\dot mg\cos true lagrangian expression obtained substituting parameter fig shown second row second column table created polynomial combination second order excluding trivial term construct library candidate function training data initial condition -\pi created initial value hyperparameters 10^ 0.1\ cut-off threshold 10^ initial learning stage 10^ subsequent learning stage subsequent learning stage increased factor two decreased factor training converged three stage noise magnitude 10^ four stage higher magnitude relaxed tolerance value learning cart pendulum state cart pendulum represented lagrangian numerical coefficient obtained using parameter fig presented second row third column table polynomial combination third order constructed create library candidate function case excluded term doe appear lagrangian single pendulum system training data initial condition -\pi 0,0 created lagrangian single pendulum contains ^2\ hence term also appear lagrangian cart pendulum ^2\ tested construct left described term ^2\ yielded better result initial value hyperparameters 10^ cut-off threshold increment decrease previous case training converged three stage noise magnitude 2\times 10^ four stage higher magnitude relaxed tolerance value learning double pendulum given state double pendulum system parameter fig expression lagrangian numerical coefficient shown second row fourth column table first separated set trigonometric term non-trigonometric term construct library candidate function created polynomial combination second order set resulting candidate function respectively subsequently generated cross-terms two set thereby creating candidate function forming total candidate function library training data created initial condition -\pi -\pi ,0,0 constituent double pendulum single pendulum hence four option construction ^2\ ^2\ yielded equally good result result presented table display value ^2\ used construct left initial value hyperparameters 5\times 10^ cut-off threshold increment decrease previous case learning spherical pendulum state spherical pendulum represented true lagrangian expression displayed second row fifth column table case double pendulum first separated trigonometric term non-trigonometric term created polynomial combination set second order added cross-terms two set total library contained candidate function training data created initial condition deliberately selected high value initial condition equation motion contained may blow small value spherical pendulum higher-dimensional analog single pendulum therefore consider lagrangian spherical pendulum sum lagrangian pendulum direction used ^2\ construct left lagrangian single pendulum direction already known initial value hyperparameters 1\times 10^ cut-off threshold increment decrease previous case supplementary information