introduction biomechanical analysis running outside laboratory become possible due advance wearable sensor machine learning technology laboratory based technology motion capture instrumented force plate traditional method measure biomechanical data including spatial–temporal kinematic kinetic variable laboratory-based tool require significant investment high level training collect process analyze data wearable technology alternative laboratory based method become widely available monitoring running biomechanics uncontrolled environment example inertial measurement unit imu gps in-shoe force pressure sensor used estimate measure biomechanical data earlier research utilized imu estimation gait event foot ground contact time laboratory estimation specific kinetic variable statistical machine learning model completed strictly laboratory in-shoe force sensor measuring normal force foot shoe foot contact validated measure vertical ground reaction force grfs instrumented force treadmill allows basic kinetic analysis completed outside laboratory typically sensor commercially available multi-axial imu tri-axial accelerometer linear acceleration tri-axial rate gyroscope angular velocity tri-axial magnetometer magnetic field data imu need specific processing algorithm extraction meaningful biomechanical variable approach developed specifically running sensor located foot shank sacrum algorithmic technique demonstrated consistent feature extracted inertial data identification foot contact laboratory real-world environment however algorithm yet validated kinetic measure free running real-world environment uncontrolled running velocity different positive negative grade machine learning model implemented estimation prediction gait event single kinetic variable single stance phase grfs running study constrained laboratory either in-ground force plate instrumented force treadmill numerous approach model used seems optimal machine learning model estimation grf waveform long short-term memory network lstms bi-directional lstms bd-lstms network structure designed analysis temporally related data specifically natural language processing human gait data ideal type algorithm locomotion cyclic however must cautious application machine learning algorithm trained data collected laboratory evaluation running performance outside laboratory well established gait parameter kinematics kinetics different treadmill running overground running different duration currently unknown fully data driven model feature engineering performs data collected course entire run different grade velocity purpose study test two specific method biomechanical analysis running unconstrained environment heuristic algorithm estimation foot contact imu data machine learning algorithm feature engineering bi-directional lstm bd-lstm estimation normal grfs foot shoe therefore estimation gait event calculation discrete grf variable expect gait event detection algorithm similar accuracy across range running velocity grade study specifically expect root mean squared error rmse 0.04 error estimation foot contact imu data similar result reported benson finally expect estimated stance phase assessed waveform output machine learning algorithm would rmse 0.030 estimated discrete kinetic variable would moderate correlation measured variable similar previous work result 90,537 foot strike measured force sensing insole algorithmic output data foot mounted imu heuristic estimated total 90,063 88,364 analyzed foot strike bd-lstm estimated 90,579 85,406 analyzed foot strike average pace running speed shown table two participant ran different course initially prescribed longer mile data fold loocv presented table table participant characteristic full size table specific rmses estimated temporal variable imu heuristic algorithm estimated bd-lstm across velocity grade found table performance foot contact estimation foot mounted imu heuristic algorithm found fig stride frequency estimated force sensing insole presented fig stance phase rmse estimated bd-lstm presented table kinetic variable measured force sensing insole presented table table rmse bd-lstm presented kinetic variable across running velocity slope shown fig estimated foot contact kinetic variable bd-lstm presented fig pearson correlation coefficient presented well slope regression line bland–altman plot show mean difference estimated measured variable limit agreement loa fig data point figure represents minimum footfall velocity grade positive negative level ground participant left training set result show range rmse calculated variable heuristic bd-lstm algorithm across range speed slope otherwise data directly measured imu force sensing insole present minimum maximal value across range speed slope table imu heuristic temporal variable rmse full size table table bd-lstm temporal variable rmse full size table figure gait event difference estimated foot mounted imu panel panel show estimated measured contact time full size image figure estimated contact time foot mounted imu linear regression bland–altman plot presented foot contact followed level ground decline incline foot contact pearson correlation coefficient slope regression line presented panel bland–altman plot present difference estimated measured contact time average difference loa shown panel full size image table bd-lstm stance phase ground reaction force waveform rmse full size table table measured kinetic variable force insole mean full size table table kinetic variable rmse bd-lstm estimated waveform full size table figure estimated contact time bd-lstm linear regression bland–altman plot presented foot contact followed level ground decline incline foot contact pearson correlation coefficient slope regression line presented panel bland–altman plot present difference estimated measured contact time average difference loa shown panel full size image figure stride frequency measured force sensing insole across range velocity grade full size image figure kinetic variable across range running velocity grade full size image figure stance average grf linear regression bland–altman plot presented foot contact followed level ground decline incline foot contact pearson correlation coefficient slope regression line presented panel bland–altman plot present difference estimated measured stance average grf average difference loa shown panel full size image figure peak force linear regression bland–altman plot presented foot contact followed level ground decline incline foot contact pearson correlation coefficient slope regression line presented panel bland–altman plot present difference estimated measured stance average grf average difference loa shown panel full size image imu heuristic gait event contact time average rmse across speed slope estimated initial contact imu heuristic imu presented table difference imu measured initial contact shown fig panel estimation toe imu heuristic imu presented table difference imu measured toe shown fig panel rmse across speed estimated contact time presented table estimated contact time imu presented fig panel measured foot contact time force sensing insole presented fig panel linear regression analysis bias estimate found fig variable calculated force sensing insole stride frequency observed change across velocity minimally slope stride frequency displayed fig measured stance average grfs presented fig panel peak grfs presented fig panel impulse stance phase across speed presented fig panel measured alr across speed presented fig panel bd-lstm temporal kinetic variable rmse estimation across speed initial contact bd-lstm lstm shown table estimation rmse across speed toe bd-lstm lstm presented table contact time estimation rmse across speed table linear regression analysis bland altman plot bd-lstm presented fig stance phase grf whole waveform rmse across speed ranged 0.30 0.64 across running velocity grade table stance average grf rmse stated table peak force rmse displayed table impulse rmse presented table average loading rate rmse presented table figure present linear regression analysis bland altman plot estimated grf variable discussion purpose study test two specific method biomechanical analysis running unconstrained environment heuristic algorithm estimation foot contact imu data machine learning algorithm bd-lstm estimation normal grfs foot shoe specifically foot contact event discrete grf variable specific finding study summarized contact time foot-mounted imu estimated average rmse 0.030 bd-lstm output waveform estimated contact time rmse 0.031 bd-lstm output waveform step-by-step average combination velocity grade rmse 0.33 per step throughout discussion assumed greater range rmses lower pearson correlation coefficient wider loa due three potential source error unconstrained running environment study comparison running controlled laboratory environment lack feature engineering process presented completely data driven data presented across 13-fold loocv data yet presented normally representative participant presented past work validation ground reaction force variable observed decrease estimated contact time increased running velocity level ground incline decline foot contact fig panel minimal difference noted measured contact time level ground incline decline fig panel comparison stride frequency running velocity 2.5 4.5 current study treadmill study showed minimal difference ranged 2.60 4.64 stride min negligible difference level ground running decline incline stride frequency fig finding surprising velocity shown larger effect stride frequency however shown stance average grfs peak grfs alr increased running velocity fig following trend previously reported current study measured impulse ranging 0.33 0.40 table compared another study reported impulse across different velocity grade treadmill ranging 0.30 0.34 range alr study 31.92–58.31 similar previous work 30.10–64.70 across variety velocity grade difference alr decline running showed increase 9.3 decrease 2.05 incline running fig similar value reported previously estimation gait event foot contact imu bd-lstm approach estimating gait event used acceleration angular velocity data differs previous work study made use one type data either acceleration angular velocity difference imu measured current study occurred expected range 0.020–0.020 due iterative correction algorithm used previous study controlled laboratory environment reported identification imu across small range velocity 8–11 range rmse 0.004–0.008 smaller average rmse current study current imu rmse range 0.011–0.051 previous study reported larger rmse range identification imu 0.008–0.011 study presented imu rmse range 0.020 0.053 machine learning estimation gait event allows flexibility identification lstm lstm instead relying specific heuristic presented shown minimal difference imu heuristic estimated contact time bd-lstm estimated contact time rmse range imu 0.011–0.051 compared range 0.016–0.039 lstm larger rmse lower bound lstm narrower range rmses across range running velocity estimation imu rmse range 0.020–0.053 lstm rmse 0.014–0.059 table estimation inertial sensor shown variability estimation many different study including current study contact time estimated foot mounted imu bd-lstm decreased increased running velocity fig contact time estimation calculated heuristic algorithm study rmse 0.020 0.066 contact time estimated bd-lstm rmse ranged 0.021 0.040 improvement heuristic estimated contact time foot contact duration imu estimate 0.460 bd-lstm estimated foot contact duration 0.524 fig panel fig panel despite better agreement output bd-lstm bias estimation contact time bd-lstm compared heuristic calculated contact time level ground 0.010 vs. 0.005 trend continued different grade condition fig panel e–f another study reported 0.665 estimated contact time quantile regression forest current study presented 0.524 across foot contact external comparison model showed reduced bias estimation contact time compared benson reported offset 0.016 loa 0.058 0.027 current model resulted offset 0.005 loa 0.035 0.044 across heuristic calculated foot contact offset 0.010 loa 0.025 0.044 across bd-lstm estimated foot contact approach resulted narrower limit agreement heuristic bd-lstm estimated contact time previous study used raw data analysis compared use average combination velocity grade presented work bd-lstm ground reaction force analysis accuracy estimation grf waveform stance phase using bd-lstm varied across running velocity table level ground running largest rmse range 0.29–0.64 compared decline running 0.29–0.58 incline running 0.23–0.31 noted however level ground running also largest range velocity table observed bd-lstm underestimated grf across full range velocity grade stance phase rmse ranged 0.23 0.64 velocity grade compared previously estimated stance phase rmse ranging 0.12 0.20 derived kinetic waveform estimated machine learning algorithm treadmill running different velocity inclination stance average force mirrored estimation whole waveform correlation stance average grfs reported previous work group 0.408 across running velocity however current analysis yielded much lower agreement 0.105 current study loa 0.33 0.11 mean difference 0.11 foot contact fig slightly bias reported previous work group mean difference 0.09 external comparison lstm developed estimation stance average grfs reported rmse 0.34 0.63 current study reported stance average grf rmse 0.09 0.31 estimated peak force similar pattern estimated stance average grf fig correlation peak force reported previous work laboratory 0.614 level ground steady state running velocity current work resulted 0.332 across foot contact worse performance estimation peak force incline running foot contact 0.264 previous work reported moderate correlation estimated measured peak grfs data collected force instrumented treadmill 0.665 external comparison bd-lstm utilized foot contact information single sensor sacrum resulted 0.62 loa 0.17 0.18 bias 0.01 another study loa ranged 0.50 0.22 bias 0.14 major difference previous work estimated single stance phase vertical grfs treadmill estimated entire waveform free running environment inherently variable controlled laboratory setting figure impulse linear regression bland–altman plot presented foot contact followed level ground decline incline foot contact pearson correlation coefficient slope regression line presented panel bland–altman plot present difference estimated measured stance average grf average difference loa shown panel full size image impulse best performance calculated discrete kinetic variable estimated grf waveform least effected underestimation force waveform magnitude linear regression showed estimated measured impulse moderately correlated 0.571 foot contact fig panel impulse underestimated 0.04 foot contact equates approximately 6–8 error estimation impulse across range locomotion velocity grade precise estimation contact time bd-lstm increased impulse calculation accuracy comparison previous work laboratory estimated impulse weakly correlated measured impulse 0.385 bias 0.01 loa 0.05 0.07 current study observed 0.571 bias 0.02 loa 0.06 0.02 different group reported estimated impulse mean absolute error approximately 0.03 across velocity grade running treadmill compared current study rmse across running velocity grade ranging 0.02 0.09 rmses impulse present study tended larger decline running compared level ground incline running due pronounced impact peak observed condition figure average loading rate linear regression bland–altman plot presented foot contact followed level ground decline incline foot contact pearson correlation coefficient slope regression line presented panel bland–altman plot present difference estimated measured stance average grf average difference loa shown panel full size image estimated alr weakly correlated measured alr 0.160 level ground running 0.210 decline running 0.492 incline running previous study group correlation estimated measured alr level ground running track surface yielded 0.614 comparison another study using data collected laboratory environment across range velocity loading rate moderately correlated measured loading rate 0.57 bias 2.9 loa current study present loa 34.00 7.92 bias 13.04 work presented direct estimation vertical average loading rate valr performance model two running velocity laboratory environment correlation coefficient 0.93 output model specifically valr utilized imu data force plate highly controlled environment estimated alr reported larger percent error estimated kinetic variable present study error estimation may due inherent difference loading rate decline incline level running unconstrained environment alr typically much larger decline running incline level ground running various limitation collection running data outside laboratory highlighted two correction made force data study first iterative correction algorithm resolve difference internal clock imu force sensing insole second throughout study approximately footfall observed drifting baseline drifting baseline may result force sensing insole moving foot shoe highly dynamic running activity tested example alr may reduced accuracy due low sampling rate compared lab study force plate data sampled improvement wearable sensor increased signal sampling rate fidelity would likely improve outcome future work domain also small error synchronization gps data imu grf protocol greatly improved data analysis capacity unfortunately remained slight offset gps data footfall rectified use on-board gps imu force sensing insole lead gps hard synced integration sensor network would provide improved synchronization lead fewer assumption methodology bd-lstm algorithm show promise machine learning paradigm estimate running grf waveform however current algorithm appears limited transferability novel participant evidenced inferior performance estimation kinetic variable especially faster running velocity may significant training model level ground running speed therefore future may necessary different model different slope velocity terrain performance would likely improve addition data faster running velocity inclusion participant introduce variability dataset addition neural network architecture training data necessary improve model output algorithm ready application clinical research setting may include inclusion feature extracted waveform data stride frequency velocity slope future work may necessary use feature engineering addition use temporal windowing estimation grfs running model currently fit mean level ground running ground reaction force conclusion first study knowledge report kinetic measure free run outside laboratory despite inherent limitation transferability biomechanical analysis running real world purpose paper implement fully data driven technique estimate ground reaction force data collected person running real-world environment result applicability study limited doe highlight potential algorithm loocv result presented data given participant included error model expected significantly reduced first study estimate imu contact time validate kinetic standard data collected real-world running environment across wide range running velocity slope also shown bd-lstm architecture used estimate kinetic waveform via machine learning running data collected real world without feature engineering shown estimation gait event contact time using imu data match estimation variable machine learning algorithm future study focusing building model training load single participant machine learning model direct inclusion gps data input may reduce underestimation stance phase grfs faster running velocity method study approved university oregon institutional review board protocol 10062020.007 participant provided written informed consent prior enrolling study research procedure adhered principle defined declaration helsinki data collected participant table male female age 23.2 year height 167.8 mass 65.0 part larger ongoing study three participant excluded analysis due gps malfunction analysis performed custom matlab program mathworks natick usa multi-axial imu casio computer co. ltd tokyo japan mounted bilaterally dorsal aspect participant foot approximately sacrum clipped back participant waistband imu oriented x-axis imu alignment sagittal plane use multiple inertial sensor suggested improve estimation spatial temporal kinetic variable compared single inertial sensor multi-axial imu recorded linear acceleration angular velocity acceleration data post-processed kalman filter orient local imu coordinate system vertical gravity foot-shoe normal force data recorded loadsol insole force sensor novel electronics st. paul usa participant asked run five-mile course around university oregon surrounding park participant also wore gps watch forerunner garmin kansa city usa record elevation running velocity data exported garmin connect http second second running velocity percent grade extracted golden cheetah v3.5 http data processing force-sensing insole imu data synced foot stomp run imu data downsampled match force sensing insole filtered 4th order low pas zero-lag butterworth filter internal clock drift imu force sensing insole resolved iterative correction algorithm kinetic data normalized participant bodyweight filtered 4th order low-pass zero-lag butterworth filter post-hoc correction force insole data due drifting baseline made needed making correction entailed identifying swing phase period force drifting baseline setting swing phase measured footfall needed adjustment additionally force data set synchronization imu force data gps achieved matching sudden increase velocity measured gps beginning run period runner minimal velocity e.g. waiting street crossing elevation velocity measured gps filtered zero-lag 10-sample moving average filter velocity gps data set nearest 0.25 ranging 2.25 5.25 upper limit running velocity set number footfall available analysis running velocity 2.25 typically walking velocity walk run transition typically occurs around 2.00–2.10 grade calculated elevation data binned three different grouping incline foot strike identified measured grade decline foot strike identified measured grade level ground foot strike range grade considered level ground running set due observed noise throughout run portion course physically discernible grade data gps time-synced imu kinetic data data included analysis minimum footfall combination velocity grade required given participant force sensing insole calculated stride frequency stance average grf peak grf impulse average loading rate alr average loading rate calculated identifying impact peak calculating force/time slope middle region initial contact impact peak gait event detection algorithm gait event estimation initial contact toe imu data utilized heuristic rule similar previous work initial contact imu dorsal aspect foot imu identified two rule first identification minimum angular velocity x-axis imu minimum 0.500 identified minimum second temporal window relative minimum ranging 0.005 0.045 post searched resultant acceleration condition satisfied peak resultant acceleration set imu identification toe imu imu performed searching specific temporal window beginning 0.010 imu ending half-width estimated stride time window imu either identified local maximum vertical acceleration first instance vertical acceleration identification gait event foot-shoe normal force data utilized cutoff first instance force identified identified last instance force removed foot contact could matched imu force sensing insole measure imu within half contact time force sensing insole removed analysis machine learning architecture analysis hyperparameters bd-lstm optimized bayesian hyperparameter optimization algorithm matlab hyperparameter found significant effect model number hidden unit lstm layer optimized range hidden unit hyperparameters set matlab default temporal windowing identified sweep window length ranging one second five second half second interval one second window length found accurate result network bayesian optimization process using adam algorithm learning rate initialized matlab default 0.001 model consisted sequence input layer lstm layer standard activation gate fully connected layer sigmoid activation regression layer number footfall held loocv shown step measured column table workflow hyperparameter optimization shown fig panel loss function bd-lstm mean squared error figure outline machine learning protocol panel number step velocity grade presented panel panel temporal kinetic variable calculated measured estimated waveform panel show data two separate one second window concatenated full size image utilized bd-lstm hidden unit regression output thorough description network architecture found activation bd-lstm standard lstm activation function regression layer linear activation function number epoch batch size input bd-lstm 1-s window inertial data 3-d acceleration angular velocity respective resultant three anatomical location dorsum foot waistband approximately sacrum output bd-lstm 1-s interval estimated grf data summation grf waveform force sensing insole algorithm evaluated leave one cross validation loocv participant training data participant test data repeated participant estimated force data filtered 2nd order low-pass zero-lag butterworth filter estimated data tended noisier input grf waveform accounted lower cutoff frequency filter fig panel errant estimated grf data removed setting estimated force removal false foot-contacts generated model 0.100 0.500 foot contact shorter 0.100 consistent measured foot contact running foot contact longer 0.500 tended occur period quiet standing e.g participant street crossing observed swing phase estimation error approached errant data corrected using step described initial contact machine learning output lstm identified first instance force toe lstm identified last instance force greater ensure matching foot contact correctly analysis lstm within half contact time measured removed analysis total number footfall analyzed per speed shown fig panel model output grf waveform stance average grfs peak grfs impulse alr calculated fig panel statistical analysis included rmse linear model bias analysis ass estimated contact time calculated temporal difference measured force sensing insole kinetic variable difference model estimated variable measured variable waveform presented linear regression bland–altman plot confidence interval limit agreement loa respectively pearson correlation coefficient calculated show agreement estimated measured data strong correlation defined 0.8 moderate correlation 0.5 0.8 weak correlation 0.3 0.5