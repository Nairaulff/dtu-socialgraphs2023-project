introduction understanding set variable related becoming important aspect different field science e.g. social behavioral science neuroscience econometrics instance understanding drug efficacy population public policy expected effect society major climate effect niño southern oscillation enso influence remote region pathway different region brain interact interwell connectivity effective oil field management help comprehend dynamic behind complex system answer question standard procedure manipulate value variable performing randomized controlled trial rct however many case possible perform experiment unethical practically impossible expensive performing controlled experiment establish causal relationship smoking lung cancer see pearl mackenzie chap advent machine learning algorithm increasing amount collected data increased hardware processing power available allow processing data applying complex algorithm find causal relationship among variable i.e. establish causality classical definition causality meaning causal link intervention manipulation affect known driver target first approach measure degree association among variable compute correlation however correlation symmetrical doe take account directionality relationship hand causation asymmetrical provides directionality relation among variable need establish causality work establishing statistical association one major reason causality enables predict underlying dynamic system pinpointing variable intervened achieve desired output causal model ladder causation see pearl mackenzie chap defined three step simple data association hypothetical imaging scenario done paper focus first step establishing association variable dataset current algorithm also rung since rely data thus unable operate unseen scenario main application challenging problem production pre-salt field problem identifying causal link injector producer well critical influence operational decision help optimize production association discovered second rung called intervention given relationship level answer question would intervene doe happen finally last rung called counterfactuals answer question caused occurred effort infer causal structure observation carried following approach one assumes multivariate distribution observational data acquire knowledge parametric model estimate statistic model suitability observed data adherence imposed constraint evaluated determine whether assumed causal framework accurately describes observed phenomenon inspired ladder causation peyrard west propose metric based observational interventional counterfactual distance two different causal model establishing way comparing model based causal distribution induced instead graphical structure usually found literature aiming distinguish accidental association robust causal association support counterfactual reasoning barbero sandu propose approach called causal team combine team semantics structural equation model framework consists set assignment given collection variable expanded collection structural equation associated variable able account association evidential observational reasoning account intervention support counterfactual claim help ml-based agent climb ladder causation achieve counterfactual reasoning moruzzi point agent must incorporate compositionality sparsity guarantee agent explain new data observed previously unknown scenario identifying connection different variable determining variable responsible change scenario author point promising strategy include representation variable sparse factor graph meta-learning approach called recurrent independent mechanism use neuro-symbolic model causality hard establish attempting ass causality must ensure every possible variable might involved system dynamic must considered avoid spurious correlation real-world scenario condition rarely accomplished might unobserved confounders investigating potential causal-and-effect relationship confounding variable third variable influence supposed cause supposed effect data scarce variable may change simultaneously influence outcome observe either directly indirectly lack control system dynamic make even harder claim causal relationship exists lead researcher depend highly opinion expert area confidence finding one pitfall causal analysis so-called yule–simpson paradox occur confounder omitted causing measure association two variable change positive negative kuang propose avoid yule–simpson paradox purely observational approach necessary validate assumption needed causal inference using domain knowledge additionally conduct sensitivity analysis identify potential violation assumption paper focus time series ordered sequence value causal discovery aim establish causal link including time lag time-lagged causal discovery lag tell time delay cause occurrence effect related time series algorithm used classification clustering forecasting little work done employ infer causal relationship time series see moraffah full review subject firstly tested method weather dataset publicly available causeme.net additionally focus applying algorithm challenging context pre-salt field encompassing public synthetic private real field given unique demanding nature pre-salt field method specifically designed address robustness requirement considering field renowned complex geology application highlight relevance effectiveness method real-world scenario contributing optimization production reservoir management overall performance pre-salt field organize paper following section time series causality assessment section detail causality assessment proposed methodology section describes proposed methodology ass causality time series application section present application causal discovery applied two different domains—oil field production data climate finally conclusion future work section outline final remark discussing main finding future work time series causality assessment section formally set problem causality inference time series main challenge present explored method literature solution causal relationship given dataset time series length i.e. n\times want discover causal relationship time series time lag cause occurrence effect figure show sketch process causal discovery time series work set variable possible causal link tested variable l=1 including link past i.e. l=k\ allows reconstruct underlying causal dependency solid black arrow discard spurious association red arrow correlation significant causal dependence time dependence system lag main challenge faced method seek causal discovery distinguish direct indirect cause fig variable directly affect indirect effect act mediator distinguish instantaneous causal effect i.e. =0\ deal confounders fig common cause explains spurious correlation figure given set multivariate time series causal discovery aim estimate underlying causal dependency including time lag label edge spurious association appear due either common driver e.g. correlation indirect path e.g. correlation correlation adapted full size image related work vast amount time series data different area several effort made tackle causality type data last decade different method proposed ass challenge method categorized follows method based granger causality one first approach tackle causality time series suggested granger given two time series possible driver target say granger-cause considering past improves forecasting time mean contains unique information contained past mathematically expressed vector autoregressive model var aligned max t-\tau max t-\tau aligned max maximum lag past want consider granger-cause mean value zero main drawback approach assumes linear relationship among variable might suitable every case want establish causal relationship extension granger causality applied multivariate time series found haufe siggiridou kugiumtzis conditional independence-based method method test conditional independence relation variable past i.e. check conditional independence t-\tau ^k\ given past variable time series assumption made time-order cause precedes effect causal sufficiency direct common driver observed causal markov condition two variable connected causal graph conditioned parent see spirtes chap conditionally independent faithfulness two variable independent given subset variable connected causal link graph application class method found chu glymour runge structural equation-based model structural equation model sem collection statistical technique examine relationship one independent variable dependent variable mathematically expressed i.e. substantive variable function variable unique error term usage assignment operator rather equality operator equation must interpreted causally manipulating variable lead change substantive variable one interest necessarily observed totality application using sem applied time series causal discovery called time series model independent noise timino found peter deep learning-based model traditional time series causal discovery method assume linearity time series like granger causality however real-world case nonlinear method unsuitable scenario transfer entropy alternative suitable linear nonlinear scenario difficult implement sensitive parameter selection overcome issue take account nonlinearity approach proposed model time series using neural network architecture like multi layer perceptron mlp recurrent neural network rnn convolutional neural network cnns usually input deep learning -based framework past lag every time series driver output future value single time series target cnns use attention mechanism provide interpretability model attention mechanism coefficient interpreted model feature importance summary common causal discovery method applied time series shown nauta method includes description whether deal aspect like confounders hidden confounders necessity stationary data among aspect main drawback method relate existence hidden confounders data well need stationary time series since method could work expected fed kind data proposed methodology general idea ass causality able pinpoint predictor variable lag algorithm considers predicting output instance coefficient per lag granger causality approach see method based granger causality section usage attention mechanism dl-related algorithm see deep learning-based model section section present proposed methodology call aleph honor latin american writer jorge luis borges saw causal flow foundation world narrative activity architected many short story masterpiece aleph perspective proposed methodology first define variable possible driver causally affect target set driver known causally affect target discovered time series causal discovery section proceed ass significant feature lag based feature importance assessing feature significance section i.e. discovery lag influence every driver target first step regression method could employed second one need algorithm quantify importance feature predicting output ensemble algorithm like random forest catboost provide information feature importance therefore employ identify predictor model pay attention generating forecasting information reconstruct causal path see fig general pipeline propose perform causal discovery shown fig pipeline comprises two major step establish baseline considering target past value block predict target current value using information potential driver attempt improve forecasting block pipeline work follows following block identified capital letter fig given set variable want perform causal discovery select one considered potential target i.e. one causal relationship assessed using past data potential target chosen step define feature vector past-lagged value potential target see fig ensemble model trained based feature defined step used predict target current value detail time series causal discovery section see fig initial baseline established evaluation metric forecasting step comparison ground truth set potential driver might causally affect potential target defined set potential driver defined step empty driver selected consideration removed set otherwise result pipeline set discovered driver incremented step using past data potential driver chosen step define feature vector past-lagged value potential driver feature vector potential target step already discovered driver step potential driver consideration chosen step used predict target current value see fig metric evaluated based forecasting target current value model step compared baseline forecasting model step better baseline step otherwise step either case return step state driver selected step causally affect target evaluation baseline updated metric evaluated step driver consideration added set discovered driver consider driver consideration doe causally affect target ignore figure pipeline used perform causal discovery firstly model built considering past-lagged value target defines forecasting baseline second step build model considering information target potential driver may causally affect target improvement forecasting driver kept predictor added list discovered driver baseline updated new potential driver tested information already tested driver causally affect target discovered driver also included full size image main advantage approach assessing causality look causal relationship nonlinear data handle multivariate continuous time series iii take care confounders see step-by-step toy example section leverage feature importance given ensemble model pinpoint delay lag cause effect applied method datasets simulated real different area test applicability approach in-depth detail shown time series causal discovery assessing driver significance assessing feature significance section toy example devised step taken perform causal discovery following pipeline fig shown step-by-step toy example section time series causal discovery numerous technique employed determine causality time series idea behind approach similar one granger causality test whether adding information past possible driver improves forecasting future value target advantage model restricted variable linear relationship case granger causality employed two model regression based ensemble catboost model employed regressors predicting continuous value first used evaluate variable significantly aid regression term performance therefore considering variable target variable driver given variable determine drive causally affect define past value variable feature t-\tau max t-1 t-\tau max t-1 target depicted driver-evaluation experiment fig section similarly proceed build feature well feature vector t-\tau max t-1 also target depicted baseline experiment fig case goal predict current value using past information information lagged value improves forecasting compared baseline improvement significant according method described assessing driver significance section consider causally affect therefore included list discovered driver evaluation new driver figure representation feature vector defined sliding window ass causal link driver first set feature defined using max 10\ past-lagged values—at first target also already discovered driver d-1 —to predict current target value baseline experiment second set feature defined considering max past-lagged value target variable well discovered driver d-1 along value driver evaluation predict current target value driver-evaluation experiment forecasting current target value significantly improves baseline considering data new driver consider driver causally affect target full size image one might wonder order consideration driver set possible one matter see oil field production data considered order driver based geographical distance target closer first considered climate dataset considered arbitrary order based order specification variable dataset although evaluate influence order datasets experimented synthetic case step-by-step toy example section case eight possible driver lead permutation possible order consideration randomly tested case observed method obtains ground truth set driver indicating order doe seem matter much assessing driver significance previously mentioned enough variable improves forecasting considered driver key point approach assessing causality significant improvement predicting target value adding information potential driver quantify quality forecasting use metric commonly used regression compute significance evaluate new driver perform random shuffling feature coming driver selected shuffling approach surrogate technique due simplicity easiness application decompose temporal relationship driver target unsupervised way moreover formulation computationally costly shuffle feature train model make forecasting testing set retrieve quality forecasting metric repeating process time end set value metric due shuffling process additionally metric value real obtain training testing model without shuffling data goal ass statistical significance real distribution given significance level fit data statistical distribution compute probability real obtained chance probability consider driver causally affecting target assessing feature significance similarly proceed ass significance feature establish set driver causally affect target shuffle feature driver individually keeping feature unchanged train model retrieve feature importance provided ensemble model repeating process time building set t-\tau per driver per feature/lag similarly assessing driver significance fit data t-\tau statistical distribution compute probability real feature without shuffling obtained chance considering significance level combining time series depending research area seek establish causality time series could similar among one reason system constantly controlled like case oil industry technical reason value certain variable must kept within given range let define entity driver target one kind measurement information one variable entity may occur time series variable different entity similar instance term pearson correlation coefficient since aim obtain unique time series representation per entity propose combining time series entity one order circumvent drawback propose using uniform manifold approximation projection umap obtain time series representation per entity approach perform random grid-search experimenting different combination umap hyperparameters number neighbor minimum distance spread setup applied every available time series per entity determine umap hyperparameters combination lead best result term establishing causal relationship used output combination input pipeline defined fig find causal driver compare ground truth available fig show pipeline followed combine time series needed given dataset one measurement per entity want obtain unique time series representation proceed shown lower block time series filtered entity combined one output used driver target fig case dataset one measurement per entity filtering applied time series ready used target/driver figure pipeline processing combining necessary time series prior using driver target data selection performed considering best time window data cleaning trend removal applied time series selected time window keep variability specific case one measurement per entity time series entity combined one using umap time series target driver used ass causality pipeline given fig fit block outcome ensemble model provides answer driver causally affect target causal driver compared ground truth available create positive rate tpr false positive rate fpr metric full size image paper used approach combine time series oil field related datasets time series among various injector well correlated system human-controlled fig show two example similarity among pair injector time series similarity quantified calculating pearson correlation coefficient correlation coefficient high 0.8\ bottom hole pressure bhp time series 0.6\ water injection fig shown time series bhp water injection injector irk004 irk029 similarly applies injector irk049 irk036 shown fig high similarity prevents establishing causal connection injector producer hard differentiate injector time series figure example time series similarity panel show example bhp water injection rate respectively two different pair one pair per panel injector well simulated dataset plot see similar water injection time series pair compared well similar degree similarity seen bhp time series similarity quantified pearson correlation coefficient similar behavior found time series real oil field related dataset full size image step-by-step toy example test algorithm preliminarily see proposed methodology section proof concept devised synthetic example perform time series causal discovery example establishing causal relationship show mathematical definition—following var model—of time series one causally affected namely others example consider target reason mathematical construction test able distinguish direct indirect effect driver affected meaning indirect effect want test method pinpoint causal driver time series subindex t-\tau\ integer mean lag dependence past value time series current value shown time series depend time series causally affected others dependence time series aligned 0.3\textbf t-4 0.4\textbf t-2 +\eta aligned aligned 0.4\textbf t-4 0.5\textbf t-4 0.3 t-2 0.4\textbf t-5 0.3 t-9 0.3 t-1 0.4\textbf t-7 0.4\textbf t-3 0.6\textbf t-8 aligned aligned 0.4\textbf t-1 0.2\textbf t-2 aligned aligned 0.1\textbf t-3 0.3\textbf t-2 0.4\textbf t-6 aligned aligned 0.3\textbf t-8 0.3\textbf t-1 aligned aligned 0.5\textbf t-5 0.2\textbf t-9 aligned aligned 0.4\textbf t-8 0.4\textbf t-9 aligned aligned 0.5\textbf t-9 0.8\textbf t-1 0.7\textbf t-6 0.4\textbf t-7 0.6\textbf t-8 0.9\textbf t-1 0.7 t-2 0.7\textbf t-3 0.8\textbf t-4 aligned aligned 0.1\textbf t-1 0.1\textbf t-2 aligned aligned 0.3\textbf t-7 0.5\textbf t-8 aligned figure show graph ground truth causal link time series label edge show dependence lag target driver figure present time series given visualization short number data point generated figure doe show seasonality trend time series figure show case comparison time series computing pearson correlation panel show pearson cross-correlation coefficient time series column potential driver row different lag strong evidence looking correlation causal relationship among variable even know exist definition figure graph connection synthetic example given label edge every two node mean lag dependence target related driver full size image figure representation time series given time series generated considering var model different order full size image figure pearson correlation different lag time series given strong correlation close either driver row even though know definition influence driver show even low correlation driver target doe mean absence causal relationship full size image figure panel show feature importance synthetic example target feature lag higher importance correspond driver lag influencing target instance feature t-9 mean variable causally affect variable nine timestamps later ease comparison added panel show ground truth toy example full size image algorithm applied synthetic example work described mapping step fig given set variable select potential target procedure applies considered target using past data define feature vector past-lagged value t-\tau max max 10\ ensemble model trained based feature t-\tau used predict target current value initial baseline established evaluation metric forecasting comparison ground-truth set potential driver ^p=\ might causally affect defined ^p\ empty driver selected consideration removed set otherwise result pipeline set discovered driver incremented step using past data define feature vector past-lagged value t-\tau max feature vector t-\tau feature vector already discovered driver feature vector t-\tau used predict metric evaluated based compared baseline forecasting model step better baseline step otherwise step either case return step state causally affect baseline updated metric evaluated step added set discovered driver consider doe causally affect ignore every driver ^p\ tested end non-empty feature driver target tested significance explained assessing feature significance section determine significant feature lag shown fig figure see prominent feature match lag defined shown fig resulting sensitivity specificity 1.00 target target connection toy example application tested algorithm different datasets check causal relationship time series climate section show result applying causality test weather-related time series synthetic oil production field section provides result applying causality time series related synthetic reservoir finally actual oil production field section present result applying causality real production dataset pre-salt oil field data pre-processing required used input causal pipeline time series must transformed stationary toy example ran test varying number data point concluded data point method able detect completely every link oil-related dataset best scenario data point significant dataset size algorithm increased dataset size augmentation interpolation algorithm applied interpolation fill missing data oil-related datasets discussion oil-related expert defined threshold maximum day missing data order apply interpolation period missing data longer time window different period defined applying causal analysis climate test causality method data different field science use data available runge platform causeme.net chose dataset testweathnoise four sub-datasets define number variable length number observation file see data availability section employed sub-dataset 2000\ description dataset provided author say weather-type datasets feature typical weather data challenge autocorrelation nonlinearity time delay combined two common computational/statistical challenge namely high dimensionality short large sample size data additionally contaminated observational noise validate algorithm dataset platform requires result must submitted already defined format knowledge ground truth available download algorithm applied file dataset chose result generated uploading submit result platform computes area roc curve auc metric quantify quality method pinpointing real connection obtained auc 0.62 dataset testweathnoise_n-5_t-2000 information dataset found runge method proposed weichwald like slarac subsampled linear auto-regression absolute coefficient selvar selective auto-regressive model tested dataset obtained auc 0.86 0.84 respectively value obtained http dataset method var-based fit linear model data regressing present past value inspecting regression coefficient decide whether one variable granger-cause another approach optimized deal oil field related data obtained good performance kind datasets furthermore optimize algorithm climate dataset order general solution synthetic oil production field tested algorithm synthetic oil field production dataset known unisim-ii-m-co see data availability section dataset represents typical pre-salt field brazil information pre-salt refer actual oil production field section dataset simulates reservoir ten producer well prk014 prk028 prk045 prk060 prk061 prk083 prk084 prk085 wildcat eight injector well irk004 irk028 irk029 irk036 irk049 irk050 irk0i15 irk063 first letter well name indicates producer injector oil production history shown fig fluid injection history depicted fig plot based streamgraph visualization technique represent existence absence data time variable -axis value interpreted real value material volume data transformed plotting well prk052 wildcat fig operated short period excluded analysis resulting fig additionally since injection data fig present water alternating gas wag cycle month chose 6-month time window causality analysis figure oil production rate representation unisim-ii model well prk052 wildcat short operational period kind data visualization called streamgraph meant show existence/absence data time time series represented plot normalized interpret plot given specific date x-axis vertical thickness time series indicates relative oil production producer compared others instance timestamp labeled nine producer active producer prk052 lowest production rate similarly timestamp labeled seven active producer prk028 closed prk014 highest production rate time methodology applies figure utilizing streamgraphs visualize data full size image figure injection data representation unisim-ii field/model case injection cyclical i.e. every month injector switch injected fluid water gas vice-versa full size image oil field related time series use producer bhp target input analysis include producer past bhp combination bhp fluid injection rate injector taking account whether water gas injected based corresponding cycle information follows pipeline depicted fig result summarized fig compared connection confirmed tracer information figure connectivity map based causality analysis applied unisim-ii dataset connection detected causality analysis shown red arrow compared connection confirmed water tracer black arrow cross mark represents well included analysis due long shut-in period selected time window dataset proposed method found connection result sensitivity 0.74 specificity 0.90 full size image oil field tracer chemical compound injected reservoir track movement fluid well underground time chemical tracer injected injection well reach producer information injector–producer connection confirmed connection based tracer detection considered ground truth however important note absence tracer confirmation doe necessarily mean connection doe exist could simply mean tracer reached producer yet applies simulated real datasets seen fig good agreement connection confirmed tracer one detected causal method highlight methodology able detect connection yet confirmed tracer one prk028 injector irk029 irk028 connection identified based pressure communication may exist due injectors-producer proximity lag dependence cause effect i.e. time injection impact producer order day typically ranging day however examining travel time obtained tracer data simulated dataset observed clear trend travel time difference time detection producer time injection injector interwell distance complexity subsurface geology within reservoir lead preferential pathway make interwell connection faster regardless distance example fault pathway fracture corridor high-permeability features/layers reservoir formation result lack clear trend travel time pose challenge validating lag estimated causal analysis actual oil production field addressing challenge effectively managing pre-salt field requires advanced technological solution innovative approach comprehensive understanding complex reservoir characteristic use data-driven method one employed analysis contribute enhancing production optimization reservoir management overall field performance even case heterogeneous reservoir like pre-salt field applied method real/private dataset obtained pre-salt field brazil brazilian pre-salt significant offshore petroleum reserve localized ultradeep water m-depth coast brazil regarded one promising oil discovery recent year characterized thick high-quality oil-bearing rock formation beneath thick layer salt big challenge brazilian pre-salt field development due complex geology distance coast presence variable content reservoir water depth reservoir depth salt layer flow assurance issue brazilian pre-salt field oil extracted reservoir rock located deep beneath seabed specialized drilling rig used drill well penetrate salt layer reaching oil reservoir oil extracted using subsea pump natural pressure subsea production system floating production unit fpu enable extraction processing oil transported refinery pre-salt field consists production well injection well entire field split two region low high based well location figure show visual representation real value oil production rate upper panel plot injection history water injection rate gas injection rate injection bhp time representation allows see particular well open producing injecting closed low region fig fewer producer injector high region making easier find time window every well operates high region fig well dynamic injection three bottom variable frequently change making harder pick time window choose time window apply algorithm main criterion guarantee well producer injector per region active i.e. open available data case well closure short period real field data daily oil rate apportioned measurement made individually well chose use daily bhp data producer since measurement made per well either water gas injection rate together injection bhp injector therefore choose well low region selected time series span period year fig show chosen time window analyzing well low region high region chosen well p10 p11 p12 i10 i11 chosen time window span period month see fig well low region period opening/closing see fig upper panel show oil production history diverse well injection cycle injector well consequently harder choose larger time window well operating case injector without switching injection cycle within time window led use 6-month time window high region communication high low region expected according reservoir property data spatial distribution well figure visualization available data low region pre-salt oil production field first panel represents data coming producer remaining panel represent data coming injector full size image figure visualization available data high region pre-salt oil production field first panel represents data producer remaining panel represent data coming injector including injection bhp full size image connectivity map field shown fig real field oil production wag water injection well interwell connection confirmed either water gas tracer plotted well connection detected causality method anyhow worth noticing every monitor tracer comparing connection see good agreement detected confirmed connection one confirmed connection missed well behavior within oil reservoir highly dynamic changing time scale month year depending whether new producer injector drilled could happen within chosen time frame connection strong enough detected could misleading try quantify agreement detected connection causality confirmed connection tracer data metric like tpr fpr similar metric stated know every existing connection reservoir use ground truth perform comparison estimated lag within 1–8 day range use pressure-related time series injector producer expect communication faster pressure possible validate result due lack sufficient datapoints tracer information real dataset figure connectivity map based causality analysis applied pre-salt oil production field location well shown established connection based method tracer data cross mark represents well included analysis full size image conclusion future work paper showed approach establishing causal relationship among time series analysis performed three datasets one climate two oil field related data set performed successful causal discovery aiming estimate connection exist without quantifying contribution driver target causally affect approach data-driven leverage advantage model provide importance feature used input use feature importance determine target current value-lagged dependence also devised general pipeline establish causal relationship applied time series related different field proposed solution beyond correlation attempt unveil system underlying dynamic relationship directionality despite difficulty short time window work extracted valuable insight regarding interwell connectivity validated tracer data oil field related datasets every interwell connection confirmed tracer therefore scenario also depend opinion reservoir engineering specialist validate finding ideally desirable tracer confirmation every plausible closed well pair connection however using tracer associated economic operational investment applied tracer chemical equipment specialist involving reservoir engineer chemist field specialist knowledge first study area oil field production establishes interwell connectivity based causal analysis production data understanding proving interwell connectivity vital impact reservoir management one main difficulty faced related similarity among time series different source specifically different injector overcome proposed combine time series coming source one use output predictor solution worked well oil field related datasets providing way differentiate time series different source future work comprises performing causal inference allows compute strength connection particularly important oil field application area quantifying strength injector-producer connection allows fine-grained planning new strategy injection production depending quantification established connection give independent way validate connection use improve reservoir model way provide alternative quantifying strength connection quantification traditionally made using capacitance-resistance model crm field study want consider producer-producer relation approach another future work improve performance approach considering different application additionally another research front perform counterfactuals analysis i.e. test would happen change made driver data doe connection target hold doe strength change overall goal provide interpretability ml-based causal algorithm