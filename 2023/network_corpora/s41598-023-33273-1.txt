introduction optical spectroscopy powerful experimental technique investigating various physical system applied diverse area science technology fundamental practical viewpoint transmission spectroscopy example one shine light beam analyte measure intensity transmitted light measurement followed post-processing step yield transmittance analyte noise representing uncertainty estimated value case figure merit used quantify quality measured signal signal-to-noise ratio snr thus utmost importance increase snr end one simply crank power illuminating light thereby increasing intensity transmitted light always acceptable however due optical damage could occur photo-sensitive analyte inspection case energy illuminating beam constrained snr increased arbitrarily quantum sensing technique developed past decade used enhance snr carefully choosing quantum state probe beam well measurement performed scattered light one enhance snr without increasing intensity probe beam among various type parameter estimation problem treated framework quantum sensing so-called loss sensing understood conjugate phase sensing directly related optical spectroscopy aim precisely measure amount energy lost propagation analyte one practical state used quantum sensing two-mode squeezed vacuum tmsv state generated via spontaneous parametric down-conversion nonlinear crystal tmsv state posse strong quantum correlation two mode photon number frequency time position exploiting correlation tmsv state proven extremely useful many quantum technological application including single multi-parameter loss sensing particular recent experimental work demonstrated loss sensing scheme tmsv state along coincidence detection robust thermal noise compared classical scheme coherent state word snr quantum scheme larger classical scheme presence large thermal noise behavior interesting classical scheme usually outperform quantum scheme noise dominates first part work perform quantum theoretical analysis experimental setup studied ref comparing snrs quantum classical scheme quantum scheme tmsv state used along coincidence-counting measurement classical scheme coherent state used along intensity measurement i.e. photon counting calculation show significant advantage observed large thermal noise supporting conclusion experimental work also investigate performance alternative quantum scheme number-difference measurement employed show preferred scheme thermal noise weak sample transmission large compare aforementioned particular detection scheme optimal one determined using quantum estimation theory classical quantum setup second part noting quantum scheme robustness noise stem difference way noise introduced classical quantum setup move investigate new quantum setup noise introduced fairer fashion analyzing performance tmsv state new setup find classical scheme preferred much larger parameter regime large noise limit contrast original setup even parameter regime quantum scheme outperforms classical scheme advantage significantly diminished background classical quantum spectroscopy setup ref illustrated schematically fig generate classical probe halogen lamp used ref generates multi-mode thermal light instead using thermal state probe however consider coherent state classical probe commonly used classical benchmark quantum sensing outperforms thermal state sensing task described lead set classical scheme probe field prepared coherent state pass sample thermal background shown fig resulting output detected photon counter quantum scheme probe field prepared tmsv state n=0 ^\infty in\theta =0\ rest work signal beam sample idler beam experience thermal background resulting two mode subsequently detected separate photon counter figure diagrammatic illustration classical quantum setup investigated ref classical scheme coherent state probe first pass sample experience thermal noise average photon number n_\mathrm latter modeled fictitious beam splitter transmittance thermal noise n_\text injected background quantum scheme signal mode two-mode squeezed vacuum tmsv probe pass sample idler mode experience thermal background full size image sample modeled beam splitter transmittance vacuum entering unused port thermal noise modeled another beam splitter transmittance thermal field entering unused port ensure number thermal photon entering detector fixed n_\mathrm independently input thermal state entering unused port assumed photon number n_\mathrm n_\mathrm 1-\eta experiment input thermal light multi-mode frequency dependence sample transmittance kept consideration simplicity use single mode description narrow frequency window considered loss generality however since varying central frequency probe beam one recovers full spectral dependence sample transmittance assuming thermal noise parameter known beforehand unbiased estimator transmittance –that yield estimate intensity measurement a_\text ^\dagger a_\text –in classical scheme set aligned _\mathrm =\frac a_\mathrm ^\dagger a_\mathrm -n_\mathrm aligned a_\mathrm annihilation operator field entering photon counter mean photon number probe beam see supplementary information expectation value variance estimator _\mathrm aligned _\mathrm 2n_\mathrm n_\mathrm n_\mathrm aligned respectively quantum setup hand consider two different measurement scheme first scheme coincidence-counting scheme used ref whose measurement operator written a_\mathrm ^\dagger a_\mathrm b_\mathrm ^\dagger b_\mathrm second scheme number-difference detection scheme whose measurement operator written a_\mathrm ^\dagger a_\mathrm -b_\mathrm ^\dagger b_\mathrm latter used widely tmsv state various quantum spectroscopy imaging application due strong photon-number correlation signal idler mode unbiased estimator coincidence-counting scheme yielding estimate algebraically worked aligned _\mathrm ^\mathrm coin =\frac a_\mathrm ^\dagger a_\mathrm b_\mathrm ^\dagger b_\mathrm 2n^2+n n_\mathrm aligned average photon number mode expectation value variance aligned _\mathrm ^\mathrm coin 2n^2+n n_\mathrm n_\mathrm 3tn+2 +n_\mathrm 1+4\eta +20t\eta n^2 +2n t+4\eta +7t\eta +\eta 1+20t\eta n^3 2+4t+4\eta +3t\eta +n^2 6t+6\eta +20t\eta aligned number-difference detection scheme unbiased estimator yielding estimate read aligned _\mathrm ^\mathrm diff =\frac a_\mathrm ^\dagger a_\mathrm -b_\mathrm ^\dagger b_\mathrm +\eta n+n_\mathrm aligned expectation value variance aligned _\mathrm ^\mathrm diff t-\eta n^2+n n_\mathrm n_\mathrm 2\eta 1-t n+\eta 1-\eta aligned interested finding regime one quantum scheme outperforms classical scheme performance given scheme quantified snr defined aligned snr aligned following compare performance introduced classical quantum scheme using snr measure compare scheme optimal detection scheme chosen state optimal snrs obtained using quantum cramér-rao bound variance 1/h\ quantum fisher information qfi using relation quantum fidelity qfi see supplementary information quick summary one calculate qfis classical quantum setup written aligned h_\mathrm 2n_\mathrm aligned aligned h_\mathrm n_\mathrm 2tn+1 +\eta n\left 1+\eta n-t +\eta +n_\mathrm 1+t\eta n^2+n t+2\eta -3t\eta n_\mathrm +tn n_\mathrm +\eta 1-t 1+n_\mathrm +2tn n_\mathrm t+\eta -2t\eta aligned respectively result section calculate snrs tmsv state coincidence-counting scheme number-difference measurement scheme optimal scheme order determine parameter regime entangled state exhibit advantage coherent state latter consider number counting optimal scheme since experimentally generated tmsv state usually small mean photon number fix signal strength focus n_\mathrm 0.1,2,4\ i.e. thermal noise weak comparable larger signal strength clear choice parameter provides rich information general behavior scheme investigation furthermore use =1-\eta\ enables explain estimation performance term loss signal beam classical scheme snr photon counting scheme calculated read aligned snr _\mathrm 1-\gamma 1-\gamma 2n_\mathrm n_\mathrm 1+n_\mathrm aligned clear snr increase decrease increasing n_\mathrm behavior consistent experimental result ref illustrated fig figure snr coherent state function photon counting scheme average input photon number n=2\ thermal photon number n_\mathrm =0.1 snr increase increase decrease iii n_\mathrm decrease full size image quantum scheme thermal noise idler mode order examine possible quantum advantage using tmsv state compare snr two quantum scheme snr _\text defined quantum advantage quantified ratio snrs snr snr _\mathrm represents measurement scheme i.e. coin diff indicates quantum scheme outperforms classical benchmark indicates classical scheme outperforms quantum scheme figure illustrates comparison among three scheme top row show maximum value r_\kappa\ two quantum scheme n_\text =0.1 comparison reveals three separate region given value n_\text one two quantum scheme outperforms classical benchmark region labeled best scheme otherwise region labeled enhancement roughly speaking figure show number-difference measurement best transmitted signal sufficiently large compared thermal noise coincidence-counting scheme work best opposite case except region large discussed later also noteworthy fact enhancement region occupies significant portion parameter space noise small area shrink thermal noise level increase hand coincidence-counting scheme dominates almost entire parameter space thermal noise larger signal strength agreement experimental conclusion ref region labeled coin shrink n_\mathrm overall shape remains similar n_\mathrm 0.1\ shown supplementary fig plot provide useful information quantum advantage actual sensitivity achieved quantum scheme latter provided supplementary fig plot function figure top row quantum enhancement achieved tmsv state quantified r_\kappa\ region coincidence-counting scheme outperforms number-difference classical scheme enclosed red box labeled coin region dominated number-difference scheme enclosed blue box labeled diff grey area indicates quantum advantage observed either scheme bottom row ratio r_\kappa\ function 0.1,0.5 0.9 note coincidence-counting scheme becomes best choice parameter value n_\mathrm sufficiently large full size image dependence r_\kappa\ specific value clearly shown bottom row fig quantum setup shown fig loss parameter determines much idler beam lost mean number thermal photon entering detector fixed n_\text small value n_\mathrm r_\mathrm coin diverges making coincidence-counting scheme best option sample transmittance small i.e. t\ll whereas number-difference scheme best t\approx sufficiently large value n_\mathrm hand coincidence-counting scheme outperforms two scheme value interestingly observed quantum advantage increase either loss thermal noise level increase i.e. n_\text increase idler mode suffers imperfection quantum scheme fig signal mode suffers classical scheme fig motivates investigation alternative quantum scheme shown fig discussed later optimal detection scheme discussed previous section snr depends chosen detection scheme given input state mean snr maximized possible detection scheme leading optimal snr ^\text opt =t\sqrt given quantum cramér–rao bound qfi coherent state input one obtains snr _\mathrm ^\mathrm opt 1-\gamma 2n_\mathrm two-mode squeezed vacuum state input snr _\text opt obtained straightforwardly cumbersome write incidentally classical scheme optimal n_\mathrm verified comparing snr _\mathrm ^\mathrm opt let compare optimal snrs snrs calculated previous section order examine optimality considered detection scheme end define ratio r_\mathrm coh ^\mathrm opt snr _\text snr _\text ^\text opt r_\kappa ^\mathrm opt snr _\kappa snr _\text ^\text opt classical quantum scheme respectively upper panel fig illustrate ratio plot region divided accordance fig interestingly number-difference scheme classical scheme nearly optimal wide region parameter space n_\mathrm small coincidence-counting scheme sub-optimal three scheme become optimal increasing n_\mathrm however coincidence-counting scheme eventually dominates entire parameter space figure top row r_\kappa ^\mathrm opt measurement scheme respective region dominance bottom row r_\mathrm qfi illustrating upper bound achievable quantum enhancement full size image next compare optimal snrs coherent state tmsv state quantified ratio r_\mathrm qfi snr _\text opt snr _\text opt bottom panel fig plot r_\mathrm qfi clearly show optimum quantum scheme always outperforms classical scheme regardless value remarkably quantum advantage increase increase either thermal photon number n_\mathrm loss rate larger environmental noise larger quantum advantage observed fact ratio r_\text qfi 2n_\mathrm tn+1 1-\gamma n_\text alternative quantum setup thermal noise signal mode consideration led conclude quantum scheme significantly outperform classical scheme even thermal noise dominates sound interesting first puzzling second thought since quantum feature typically destroyed noise loss leaving classical scheme preferred option noisy lossy environment looking back fig difficult see potential source counter-intuitive behavior classical setup thermal noise added mode sample whereas quantum setup added idler mode used reference therefore extreme case noise intensity much larger source one would benefit simply discarding idler mode quantum scheme option classical scheme render quantum scheme advantageous noise loss increase make fairer comparison classical scheme revise previous quantum setup thermal noise enters signal mode depicted fig new quantum setup idler mode longer experience thermal noise signal mode hand experience thermal noise average photon number n_\mathrm passing sample figure schematic illustration alternative quantum setup noise introduced signal mode full size image thermal noise modeled beam splitter transmittance thermal field average photon number n_\mathrm 1-\eta fed unused port point setup simplified merging two beam splitter single beam splitter transmittance t\eta\ thermal field entering unused port beam splitter average photon number n_\mathrm n_\mathrm 1-t\eta beam splitter classical scheme merged way new number-difference scheme variance written aligned _\mathrm nqs ^\mathrm diff n^2 1-\gamma 1-\gamma 2n_\mathrm n_\mathrm n_\mathrm 1-\gamma aligned clearly function t'\ similarly variance coincidence-counting scheme depends t'\ complete expression cumbersome write quantum enhancement quantum enhancement new quantum scheme depicted fig also see supplementary fig plot quick comparison fig show quantum enhancement strongly suppressed new setup obvious symmetry space stem mentioned dependence total signal loss t\eta\ n_\text small quantum scheme better two extreme limit large small total loss large total loss i.e. coincidence-counting scheme beat classical number-difference scheme opposite limit small total loss number-difference scheme best choice figure quantum enhancement achieved tmsv state quantified r_\kappa\ new quantum setup region labeled way fig note diminished quantum enhancement compared fig full size image n_\mathrm decreased n_\mathrm 0.1\ coincidence counting scheme loses advantage classical scheme r_\mathrm coin n_\text number-difference scheme hand keep advantage roughly parameter region n_\mathrm 0.1\ increased value r_\mathrm diff behavior n_\mathrm =0\ shown supplementary fig increasing value n_\text coincidence-counting scheme start dominate parameter space cover entire parameter space n_\text limit shown one obtains simple formula r_\mathrm coin 2n+1 ^2/ 3n^2+2n limit monotonically decreasing function show tremendous quantum enhancement small minimum 33.33 advantage i.e r_\mathrm coin 4/3\ hand number-difference scheme becomes effective advantage classical scheme completely lost fact r_\mathrm diff limit infinite thermal photon number optimal detection scheme comparison chosen measurement scheme optimal scheme displayed upper row fig r_\kappa ^\mathrm opt plotted region classified according fig compared original setup see fig note two quantum scheme smaller region dominance subdued enhancement optimum quantum scheme optimality three scheme increase t'\ increase iii optimality three scheme increase n_\mathrm decrease figure top row r_\kappa ^\mathrm opt respective region dominance alternative setup bottom row r_\mathrm qfi illustrating upper bound achievable quantum enhancement full size image bottom row fig illustrates achievable quantum advantage quantified r_\mathrm qfi ratio r_\mathrm qfi snr _\text opt snr _\text opt increase increasing t'\ decreasing n_\mathrm although quantum advantage moderate compared original setup see fig persist parameter regime n_\text small greater two-fold enhancement achieved fact qfi 1-t -1/2 n_\mathrm indicating quantum advantage quantified qfi infinity note dependence signal photon number disappears limit opposite limit n_\text quantum advantage becomes independent qfi n+1 2n+1 1/2 interestingly quantum advantage persists even presence strong thermal background significant smaller value chosen value n=2\ r_\mathrm qfi 1.1\ i.e. advantage summary discussion theoretically analyzed experimental quantum spectroscopy setup presented ref calculation confirm observed quantum advantage tmsv state coincidence-counting scheme thermal noise strong also studied number-difference scheme showed exhibit quantum advantage wide region parameter space thermal noise weak latter case also showed classical scheme outperforms number-difference coincidence-counting scheme significant region parameter space compared signal-to-noise ratio optimal classical quantum scheme calculating qfi revealed significant amount quantum enhancement possible noting counter-intuitive behavior stem asymmetric way noise introduced classical quantum setup moved introduce alternative quantum setup noise introduced signal mode quantum enhancement number-difference coincidence-counting scheme survive new setup strongly suppressed compared original setup showed however quantum advantage persist optimum measurement scheme important future research direction find best implementable scheme example quick inspection fig demonstrates coincidence counting scheme far optimal still exhibit significant quantum advantage compared chosen classical scheme figure suggests quantum scheme classical scheme also sub-optimum therefore interest find better implementable classical scheme compare performance quantum scheme one possible option split thermal light two mode investigate performance coincidence-counting number-difference detection scheme finally straightforward direction find effect thermal noise introduced idler mode robust scheme noise currently investigating detail