introduction one main terminology analyzing internet ecosystem autonomous system set router run one network operator single clearly defined routing policy recently total number worldwide 109,4371 router ownership inference technology aiming assign router operating challenge internet topology research accurate router ownership inference play essential role many problem domain first foremost allows researcher combine router-level as-level internet topology grasp real connection detail within understand composition internet fine-grained level besides help network manager maintain network performance detecting congestion point appear link analyzing regularity internet interdomain routing inferring delay border link additionally benefit network security researcher identify border router critical network infrastructure great significance application safety actual internet multiple factor interfere accurate inference router ownership first router may respond traceroute probe different interface address including third-party address interfere router ownership inference second internet protocol address subnet space inter-as connection usually come one two i.e. address sharing resulting challenging identify inter-domain connection accurately additionally considering security competition factor internet operator tend hide network topology making difficult obtain ground truth modeling current typical algorithm bdrmapit achieved 91.8 -98.8 accuracy mapping boundary two internet-wide traceroute datasets however method relatively available constraint inferring router end traceroute path still room improvement accuracy response problem study call router appear back part traceroute path maybe traceroute destination last-as router last-as router link classification-based method router ownership inference lcroi proposed lcroi first classifies intra-domain inter-domain link establishing probability model type link hidden variable information implied link type increase available constraint inferring last-as router resulting better accuracy main contribution work summarized follows introduced three distinctive feature differentiate intra-domain inter-domain link using feature developed probability model link type hidden variable classify link method inferring router ownership known link classification-based router ownership inference lcroi proposed lcroi used link classification result impose constraint router resulting higher accuracy router ownership inference demonstrated actual test result rest article organized follows related work section present related work router ownership inference analysis bdrmapit problem definition section bdrmapit briefly analyzed problem router ownership inference defined proposed lcroi method section describes basic principle main step proposed method experiment analysis detailed experiment result section finally conclusion future work section concludes article related work existing method router ownership inference rely traceroute topology measurement alias resolution ip-to-as mapping technology router multiple interface different address alias resolution technology identify interface belonging router ip-to-as mapping technology map address number asn widely used ip-to-as mapping method look origin ip-to-as mapping table extracted border gateway protocol bgp routing table address mapped origin longest matching prefix multiple origin moa conflict occurs particular prefix appears originate one according application scope method existing router ownership inference method divided two category method single method entire internet shown table table related work router ownership inference full size table router ownership inference method single first selects target deploy vantage point vps traceroute probe infers owner router inside target border router inside neighboring bdrmap proposed luckie single target first executes targeted traceroutes vps inside combine relationship data using traceroute feature topology constraint perform inference infer inter-domain connection related network hosting vps observed vps router ownership inference method entire internet heuristic method infer router ownership tangmunarunkit chose frequently assigned origin set router method simple insufficient accuracy chang argued router border router interface address assigned multiple administration domain proposed intersection rule majority rule hole-filling heuristic approach complement method proposed tangmunarunkit however verify heuristic actual information border router claffy believed provider-customer connection provider side provides address space experience used method proposed huffaker pansiot motamedi others also since doe apply case heuristic supplemented improve inference accuracy huffaker created frequency matrix router matrix counted number interface known inferred appears router next described five different heuristic produce as-router dual graph including single election neighbor customer degree accuracy result need improved pansiot proposed router-to-as algorithm based probabilistic empirical allocation rule extract intra-domain topology large dataset collected mrinfo however since router supporting internet protocol version ipv4 multicast reply mrinfo scope application method limited motamedi proposed internet exchange point-assigned ixp-assigned valley-free heuristic improved previous heuristic needed heuristic fail identify owner would honor original bgp-based ownership assignment concerned interface marder created bdrmapit combined bdrmap previous algorithm map-it used iteratively inferring inter-as link interface-level graph infer router owner internet scale however inference accuracy improved somewhat router analysis bdrmapit problem definition section briefly introduces analyzes principle bdrmapit method give formal definition research problem paper analysis bdrmapit bdrmapit classical approach implement router ownership inference internet scale map boundary two traceroute data set accuracy bdrmapit method mainly includes three phase constructing graph annotating last hop graph refinement router-level directed topology established graph construction phase based ip-level topology traceroutes alias resolution second phase infers operator router appear end traceroutes phase provides topological context mapping graph refinement phase graph refinement phase map router observed middle least one traceroute path continuous correction made iteration finally accurate inference result router obtained primary process bdrmapit shown fig figure flow chart bdrmapit full size image bdrmapit combine bdrmap map-it adapt bdrmap target network iterative improvement framework map-it reduces bdrmap requirement number location vps expands scope application specific network number network moreover optimizes limitation map-it doe use alias resolution performs as-level boundary recognition interface level although bdrmapit achieved excellent result also two shortcoming fewer constraint available phase annotating last hop last hop traceroute path destination may destination configured firewall prevent responding network case bdrmapit considers last interface may border router network containing destination stage annotating last hop bdrmapit infers operator router outgoing link destination path router interface observed since destination set used candidate set relatively constraint available bdrmapit may misjudgments router better handle type router feasible enrich topological constraint inferring router owner failure experience lead error bdrmapit relies empirical knowledge internet practice mapping router operating infers result designing various rule practical application rule-based approach handle problem scenario still exception defined rule affect processing effect method example bdrmapit may choose candidate based valley-free assumption violation valley-free rule problem definition improve shortcoming bdrmapit consider adding available constraint router ownership inference different type link inter-domain link intra-domain link first introduce related definition concept problem formally defined definition path information p=ip_ ip_ represents path p=\left\ represents collection path included traceroute data definition link path divided several end-to-end link ip_ ip_ i+1 n-1\ definition network topology ip-level topology represents set node including address path represents set edge composed node pair constructed merging path router-level topology g_r g_r v_r e_r v_r\ represents set router node e_r\ represents set edge composed router node pair g_r\ generated alias resolution definition mapping function ip-to-router mapping i_r v_r represents mapping address logical router identifier ip-to-as mapping represents mapping address asns mean set asns router-to-as mapping v_r represents mapping logical router identifier asns definition intra-domain link intra-domain link refers link interface router aligned i+1 i+1 aligned definition inter-domain link inter-domain link refers link interface two border router connected aligned i+1 i+1 aligned problem studied paper given traceroutes set generate ip-level topology router-level topology combining ip-to-as mapping design feature classify link basis use additional information link type enrich inference constraint accurately map last-as router owner key stage involved include design link feature classification intra-domain inter-domain link inference router ownership proposed lcroi method link classified two type inter-domain link intra-domain link kind link observable feature probability particular feature occurring different various link type type link ip-level topology derived traceroute probe unknown still appropriate feature designed based domain knowledge distinguish inter-domain intra-domain link due anonymous nature link type different probability exhibited feature link classification problem modelled probabilistic model link type hidden variable probability given feature occur different link type parameter classification link type relies accurate prediction probabilistic model parameter expectation-maximization algorithm suitable estimating probability model hidden variable therefore problem due existence hidden variable link type algorithm used estimate parameter iteratively iteration algorithm considering possible correlation among feature use naive bayes classification technique algorithm converge give set stable parameter naive bayes classifier therefore feasible use naive bayes classification technique summary paper proposes router ownership inference method based classification intra- inter-domain link main idea design distinguishing feature use probability model classify link determine owner last-as router based voting mechanism principle framework method shown fig mainly includes three stage preprocessing link classification candidate voting preprocessing stage includes path preprocessing network topology construction ip-to-as mapping link classification stage based probabilistic model carefully designed feature divide link two type inter-domain link intra-domain link candidate voting stage two candidate list vote together infer router operating figure process proposed lcroi method full size image main step method follows step path preprocessing first avoid mistaking host router destination address traceroute path ignored extracting address traceroute path alias resolution address intermediate hop path covered delete path one address path loop addition delete address belonging bgp route server asn provided ixp establishing multilateral peer-to-peer connection step network topology generation use path processed step generate ip-level network topology step ip-to-as mapping use ip-to-as mapping technology map ip-level topology origin asns moa choose best mapping simplicity appears origin frequently source bgp table selected step modeling model link classification problem probabilistic model link type hidden variable parameter probability particular feature occurring different link type step link classification use algorithm estimate parameter model naive bayes classifier used calculate probability link belongs category convergence reached output result according probability threshold step candidate voting according link classification result obtained step corresponding router-level link type determined router-level topology containing link-type label constructed alias resolution generate intra-domain router set router combine destination set vote together determine owner step key step link feature design modelling link classification candidate voting described detail link feature design based domain knowledge section design three feature distinguish inter-domain intra-domain link including relation feature adjacent link fan-in fan-out feature address vector distance feature link relation feature adjacent link link type also relates business relationship without considering complex hybrid relationship relationship categorized provider-to-customer p2c customer-to-provider c2p peer-to-peer p2p sibling-to-sibling s2s method use ip_ denote ip_ mapped according different type address whether ip-to-as mapping result value possible situation paper shown table table value ip_ full size table rel\left ip_ ip_ i+1 utilized denote relationship ip_ ip_ i+1 besides three relation annotate link ip_ ip_ i+1 label ip_ =i_ ip_ i+1 addition relationship involving address used local area network lan ixp prefix address without origin result also indicated corresponding label shown table table value rel\left ip_ ip_ i+1 full size table regard link ip_ ip_ i+1 forward relation feature set aligned rel\left ip_ i-1 ip_ rel\left ip_ ip_ i+1 aligned tuple rel\left ip_ i-1 ip_ rel\left ip_ ip_ i+1 denotes relation relationship link ip_ ip_ i+1 forward link ip_ i-1 ip_ path forward relation set obtained traversing path similarly backward relation feature link ip_ ip_ i+1 aligned rel\left ip_ ip_ i+1 rel\left ip_ i+1 ip_ i+2 aligned also yielded take traceroute path example analyze role relation feature adjacent link classification link shown fig traceroute path ip_ as1 ip_ as1 ip_ as1 ip_ as1 ip_ as2 ip_ asj denotes ip_ router mapped asj internet practice two connect point-to-point link subnet link usually ipv4 typically one two address space worth noting p2c relationship provider usually supply address space subset moreover passing p2c link traceroute probe customer router usually address provider space respond probe example as1 provider as2 as1 provides address space link i.e. inter-domain link fact ip_ ip_ rather ip_ ip_ asns seems change result link ip_ ip_ i+1 included forward relation feature may inter-domain link furthermore forward backward relation feature link link likely intra-domain link figure example p2c link provider supply address space full size image fan-in fan-out feature general multiple probe path passing different router converge border router cross inter-domain link enter neighbor similarly multiple probe packet traversing inter-domain link reach distributed forwarded different router inside therefore inter-domain link may previous subsequent link switch shown fig intra-domain link fan feature capture likelihood certain number link switch occurs fan-in feature fan-out feature particular link given link type figure illustration fan feature full size image link ip_ ip_ i+1 traverse traceroute path count number forward link ip_ i-1 ip_ backward link ip_ i+1 ip_ i+2 switch path including ip_ ip_ i+1 fan-in fan-out feature link address vector distance feature considering address within may similar prefix address belonging different may far apart address vector distance feature proposed specifically address 32-bit binary number typically split four byte link ip_ ip_ i+1 expressing ip_ ip_ i+1 vector yield =\left i+1 =\left denote byte ip_ ip_ i+1 respectively count euclidean distance manhattan distance chebyshev distance cosine vector end intra-domain link inter-domain link obtained using bdrmapit method histogram shown fig figure vector distance statistic histogram address end link belong two different type full size image seen fig euclidean distance manhattan distance address end inter-domain link generally greater intra-domain link therefore address vector distance feature used indicate two end inter-domain link typically larger euclidean distance intra-domain link address vector distance feature link ip_ ip_ i+1 calculated following aligned euclidean\left ip_ ip_ i+1 =\sqrt j=1 -y_ aligned link classification use algorithm estimate parameter probability model established paper specifically first calculate conditional probability distribution feature different link type use naive bayes classifier update type link recalculate feature distribution according new probability repeat two step convergence probabilistic model requires initial parameter therefore first simply use ip-to-as mapping data generate initial type label intra-domain link inter-domain link link specific method consider link without switch intra-domain link link switch inter-domain link addition believed provider provides address space used interconnection p2c link following pseudocode introduces implementation probabilistic link classification algorithm input algorithm link initial type link feature vector minimum value threshold output inferred type link firstly feature feature vector calculate conditional probability two link type separately solve problem zero probability algorithm laplace add-1 smoothing line 2-5 compute prior probability link type counting proportion two link type beginning prior probability link type multiplied conditional probability feature line 6-11 finally recalculate probability two link type ratio probability inter-domain link intra-domain connection greater threshold inferred link inter-domain link otherwise intra-domain link line 12-17 process link type inference updating conditional probability distribution feature repeated convergence i.e. number link change type label current iteration prior iteration decrease small value time complexity algorithm number link network topology candidate voting router may many interface router-level link may many corresponding link router-level link one corresponding link inter-domain link think router-level link inter-domain link otherwise intra-domain link assigning router-level link type label router divided different inter-domain link router-level topology router call neighbor router connected intra-domain link intra-domain neighbor neighbor router connected inter-domain link called inter-domain neighbor given router first find intra-domain neighbor intra-domain neighbor choose router without inter-domain neighbor continue find intra-domain neighbor repeat process router eligible requirement mentioned intra-domain neighbor found added intra-domain router set given router let denote set interface generate list candidate cl_ containing router belong i.e. aligned cl_ =\left\ ip_ aligned asns repeated set traceroute destination address path containing ip_ denoted ds_ ip_ union destination address set router represented ds_ =\left\ ds_ ip_ ... ds_ ip_ ip_ generate another candidate list cl_ consisting ds_ mapped i.e. aligned cl_ =\left\ ip_ ds_ aligned asns repeatable use voting method determine annotation election held among asns list cl_ cl_ separately winner cl_ cl_ assign experiment result verify performance proposed method conducted experiment using publicly available topology probe data experimental setting section introduces experimental environment tool public datasets used experiment method comparison evaluation metric experimental performance experimental environment tool experiment result obtained using personal computer intel core i5-7400 processor 3.5 gigahertz core gigabyte memory running window 64-bit operating system additionally using team cymru asn mapping service used alicloud server running centos operating system virtual central processing unit gigabyte memory programming language utilized python integrated development environment jetbrains pycharm community edition 2019.1.2 experimental datasets experiment requires traceroute probe data ip-to-as mapping data ixp prefix list routing server asn list relationship data verification set data used verify inference result primary experimental data mainly come internet research institution management institution project database including center applied internet data analysis caida routeviews team cymru regional internet registry rir euro-ix peeringdb etc verify ownership inference result easy reason operator generally hide network topology avoid possible network security risk commercial competition risk therefore public data data peeringdb first selected verification set peeringdb open user-maintained network interconnection database designed support actual need network operator also valuable source information researcher peeringdb find real member asn router whose interface address mapped ixp operator addition researcher found analyzing domain name system dns host name interface information router obtained help determine type location router therefore also manually generate verification set based dns hostname data teliasonera as1299 verification set reason choosing dns host name used inter-as connection often indicate name interconnected specifically teliasonera verification set manually generated selecting interface path associated teliasonera example interface 62.115.14.14 hostname planetel-ic-301155-mno-b2.c.telia.net mapped as1299 ip-to-as mapping data fact router belongs as47217 whose name planetel find hostnames containing string -ic match string -ic name may connect teliasonera hand hostnames without above-mentioned character like snn-sec1-link.se.telia.net think interface well router teliasonera decode every hostname since hostnames hint exist ambiguous information finally verify link classification result verification set teliasonera-1 containing total link generated 16,180 inter-domain link 10,575 intra-domain link verify ownership inference result verification set teliasonera-2 containing total router generated teliasonera connected data source data scale main application experiment shown table table data source data scale main application experiment full size table method comparison introduce two baseline method detail map-it method bdrmapit method far know map-it method classic method infer inter-domain link verified real data result high accuracy rate bdrmapit method new method implement router ownership inference internet scale mapped boundary two traceroute data set internet scale accuracy map-it map-it try infer exact interface address used point-to-point inter-as link well specific involved map-it combine evidence switch distinct traceroute trace using forward backward neighbor set interface infer pas leverage prior inference refine existing inference discover additional inter-as link interface although map-it doe include alias resolution process inference interface router since map-it deduces inter-as link internal router determined ip-to-as mapping bdrmapit detailed introduction bdrmapit method described analysis bdrmapit section evaluation indicator router correct inference mapping operating conversely router assigned different real owner inference considered incorrect evaluation metric experiment accuracy i.e. fraction router correct inference aligned accuracy=\frac correct inference inference 100\ aligned result analysis link classification accuracy link classification result would affect ownership inference subsequent step subsection verifies experimentally effect link classification verified teliasonera-1 validation set last step algorithm determines result according relation probability threshold l=inter l=intra threshold\ link predicted inter-domain link inferred result classified four category follows true positive inferred type true type inter-domain link false positive inferred type inter-domain link true type intra-domain link true negative inferred type true type intra-domain link false negative inferred type intra-domain link true type inter-domain link effect algorithm related selection threshold last step therefore used receiver operating characteristic curve roc curve improve decision rule observing different effect algorithm different threshold local roc curve shown fig x-axis represents false positive rate y-axis represents true positive rate seen figure algorithm high true positive rate low false positive rate classification result intra-domain inter-domain link overall classification effect good besides threshold 0.09 overall true-positive rate increase rapidly false-positive rate increase slowly threshold greater 0.09 false positive rate increase rapidly true positive rate increase slowly obtain high true positive rate low false positive rate final threshold selected experiment 0.09 figure roc curve diagram link classification different threshold full size image determined threshold 0.09 precision recall score selected metric ass performance reflecting ability classify link counting number four case respectively precision interpreted many link predicted inter-domain link true inter-domain link shown aligned precision =\frac tp+fp aligned recall mean many true inter-domain link correctly inferred shown aligned recall =\frac tp+fn aligned score weighted average precision recall shown aligned score =\frac precision recall precision+recall aligned number link different circumstance classification effect algorithm shown table experimental result dataset link demonstrate link classification algorithm achieves high precision recall rate subsequent router ownership inference step type link router provide topological constraint help accurately infer table result link classification algorithm verification set teliasonera-1 full size table stability analysis candidate voting candidate voting stage may two scenario voting process tie non-tie case non-tie unique voting winner selected tie scenario one win handling tie situation may affect final result router ownership inference experiment vote tied chose randomly among vote therefore ran program ten time consider effect random selection strategy accuracy router ownership inference result validation set experiment peeringdb teliasonera-2 result shown table table accuracy router ownership inference result using random selection strategy full size table show accuracy result stable around 96.4 97.8 two validation set respectively experiment indicates random selection strategy slight effect number router inference almost effect accuracy strategy candidate high accuracy stability comparison method section compare lcroi map-it bdrmapit accuracy indicator experimental result shown fig data figure average result experiment figure comparison lcroi method using midar iffinder alias resolution full size image seen fig average accuracy lcroi 96.4 peeringdb validation set better bdrmapit 92.4 increasing since map-it method doe infer owner address ixp prefix compared peeringdb verification set average accuracy lcroi 94.6 teliasonera-2 validation set exceeds 83.4 map-it 91.4 bdrmapit growth 11.2 3.2 also studied impact different alias resolution method accuracy approach itdk dataset contains two router-level topology generated ip-level topology using different alias resolution technique first topology midar iffinder alias resolution second topology kapar besides midar iffinder two topology differ accuracy completeness former high confidence resolve false positive alias latter enriches alias false positive result experiment use midar iffinder technique alias resolution determine effect accurate enriched alias experimental result used second topology itdk experiment result shown fig figure comparison lcroi method using midar iffinder kapar alias resolution full size image seen fig average accuracy lcroi 87.5 peeringdb validation set better bdrmapit 85.1 increasing 2.4 average accuracy lcroi 95.5 teliasonera-2 validation set exceeds 81.1 map-it 90.5 bdrmapit growth 14.4 general inference effect lcroi better two comparison method particular analyze possible reason lcroi correct wrong result bdrmapit router wrongly inferred annotating last hop stage since appear last hop path bdrmapit topological constraint set destination router ownership inference second stage leading misjudgments router lcroi router intra-domain router set traceroute destination address jointly construct list candidate voting adding topological constraint infer router mentioned accurately could following reason responsible incorrectly inferred router stage graph refinement first type link taken account bdrmapit summing subsequent interface router resulting inter-domain neighbor possible interfering factor number inter-domain neighbor higher number intra-domain neighbor wrong inference may generate method classifies link reduces confounding factor voting second failure experience lead error example router subsequent interface traceroute path ixp public peer address bdrmapit typically selects candidate largest customer-cone based traditional assumption ignoring violation valley-free property thus leading existence misjudgments approach reveals characteristic data rather relying subjective judgment experience improving distortion extent conclusion future work designed address vector distance feature relationship feature link fan-in fan-out feature distinguish intra-domain link inter-domain link based presented probability model link type hidden variable classify link use additional information derived link type enriches basis router ownership inference improves accuracy inference result using two separate validation datasets verify result accuracy method range 94.6 96.4 slightly better map-it bdrmapit think representative feature may bring better classification performance type link optimize router ownership inference future work pay attention feature provide better classification effect link complex hybrid relationship also worth exploring addition future research conducted realistic setting develop confirm initial finding