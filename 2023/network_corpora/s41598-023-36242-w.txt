introduction remote sensing satellite unmanned aerial vehicle uav sensor susceptible atmospheric phenomenon impair contrast color fidelity collected image resulting weakened image detail making difficult recognize information image haze fog smoke common atmospheric phenomenon generated atmospheric absorption scattering application remote sensing technology field police security agriculture forestry plant protection electric power patrol inspection land resource survey similar application great significance accurately remove haze fog smoke remote sensing image rsis target detection target tracking uav detection simplicity term dehazing used uniformly denote removal haze fog smoke image dehazing task following expression widely used describe hazy image i\left x\right =j\left x\right t\left x\right +a\left 1-t\left x\right denote hazy image haze-free image global atmospheric light transmission map respectively single image dehazing challenging problem under-constrained due unknown depth information present numerous dehazing algorithm several direction proposed early prior-based approach demonstrated effective using must accurately estimated restore clear image one representative dark channel prior dcp method determine mapping relationship clear image atmospheric physical model relatively stable dehazing algorithm however dehazing effect large white area tends produce large deviation therefore several researcher use data-driven deep learning approach estimate intermediate parameter atmospheric scattering model construct mapping relationship hazy image intermediate parameter deep learning algorithm based atmospheric scattering model although greatly improved sky region visually effective traditional method model highly complex vulnerable limitation atmospheric lighting scene change resulting poor real-time performance darkened brightness restored image address problem several algorithm directly predict latent haze-free image end-to-end manner huang proposed conditional generative adversarial network rgb sar image dehazing mehta developed skygan specifically removing haze aerial image addressing challenge limited hazy hyperspectral aerial image datasets recent year vision transformer vit excelled high-level vision task focusing modeling long-term dependency data however earlier vit pyramid vision transformer pvt over-parameterized computationally expensive thus liang inspired swin-transformer proposed swinir consisting several residual swin transformer block rstb several swin transformer layer residual connection uformer introduced novel locally-enhanced window lewin transformer block learnable multi-scale restoration modulator form multi-scale spatial bias adjust feature multiple layer uformer decoder dong proposed transra two-branch neural network fused transformer residual attention recover fine detail dehazing rsis song proposed dehazeformer based swin-transformer u-net modifying standardization layer activation function spatial information aggregation scheme introducing soft constraint using weak prior dehazeformer shown superior performance compared previous method sot indoor datasets efficient fewer parameter lower computational cost however difficult obtain sufficient paired hazy rsi datasets due natural condition equipment limitation training sample small contain dense haze image dehazeformer performs poorly rsis dehazing sum rsis dehazing task local global feature important traditional image dehazing method rely sound theoretical foundation guide network learning thus designed new rgb remote sensing image dehazing model gtmnet based dehazeformer reconstructing model architecture combining dcp proposed network due down-sampling operation encoder dehazeformer compressed spatial information may effectively retrieved decoder dehazeformer therefore use strengthen-operate-subtract strategy decoder retrieve compressed information gradually restore latent haze-free image work also compare several advanced dehazing model gtmnet verify applicability proposed model paper main contribution follows novel hybrid architecture proposed based cnn vit combine dcp compared referenced model provides better psnr ssim transmission map optimized guided filtering linear transformation smoothly introduced model spatial feature transform sft layer enabling better estimation haze thickness image thus improving performance gradually refine restored image feature recovery module boosted module combined image dehazing task via skip connection proposed method section present detail gtmnet first introduce dcp estimate transmission map finally describe detail sft layer boosted module fusion module dark channel prior conducted statistical analysis non-sky region 5,000 haze-free outdoor image found often pixel low value least one color channel formally dark primary color haze-free image defined dark x\right c\in b\right\ min y\in x\right min y\right represents channel among channel local square centered represents certain color channel observation show haze-free outdoor image except sky region pixel value dark tends statistical observation called dcp dark primary color prior estimation transmission map obtain clear haze-free image necessary solve equation rewrite =a+\frac according dcp dark channel haze image approximates haze denseness well therefore picked top 0.1 brightest pixel dark channel hazy image among pixel pixel highest intensity input image selected atmospheric light assuming transmission local patch constant patch transmission x\right defined x\right =1- y\in x\right min min y\right mentioned literature even weather clear distant object affected haze author control degree haze introducing factor 0,1 give sense depth field specific expression x\right =1-\omega y\in x\right min min y\right usually taken 0.95 due local assumption estimated transmission map x\right exhibit block effect traditional image dehazing method x\right usually refined using soft matting method guided filtering fast-guided filtering although soft matting method achieve good result edge information object weak time-consuming therefore use fast-guided filter optimization filter window radius set regularization parameter 0.0001 figure show relevant result transmission map satehaze1k dataset find transmission map optimized fast-guided filter fig objectively estimate hazy distribution input image however introducing dcp paper aim estimate haze concentration shown fig highlight haze thickness image used linear transformation enhance optimized transmission map defined guided transmission map gtm formulated figure result transmission map satehaze1k dataset input image dark channel map transmission map optimized fast-guided filter guided transmission map full size image t1=2\times t-0.5\right gtmnet shown fig table proposed network gtmnet based dehazeformer incorporates sft layer boosted module sft layer integrate gtm gtmnet effectively fuse feature gtm input image accurately estimate haze thickness input image boosted module restore clear image iteratively end decoder soft reconstruction layer used estimate haze-free image figure overall architecture proposed gtmnet full size image table architecture detail proposed method up-sampling factor channel number input output channel per block spatial resolution input output per block input input per block full size table sft layer sft layer first applied super-resolution task parameter-efficient easily introduced existing dehazing network structure strong extensibility shown fig use gtm additional input sft layer first applies three convolutional layer extract conditional map gtm conditional map input two convolutional layer predict modulation parameter respectively finally transformation carried scaling shifting feature map specific layer obtain output shifted feature sft f|\gamma f\oplus feature map dimension referred element-wise multiplication i.e. hadamard product element-wise addition since spatial dimension preserved sft layer performs feature-wise manipulation spatial-wise transformation since size object generally tiny rsis obtaining local feature becomes crucial paper utilized sft layer shared parameter compensate transformer limited ability acquire local feature figure structure sft layer full size image boosted module boosting method mathematically proven effective image denoising iteratively restores clear image dong verified variety optional boosted module result show following boosted scheme best effect shown +up n+1 n+1 denotes upsampling operator using pixel shuffle method n+1 represents previous level feature denotes latent feature encoder +up n+1 represents strengthened feature denotes trainable refinement unit -th level parameterized according proposed architecture written +up n+1 -up n+1 n+1 denotes feature dehazeformer block decoder boosted module consists three residual block shown fig figure structure boosted module full size image fusion module song designed selective kernel fusion module inspired sknet fuse multiple branch using channel attention use fusion module fuse decoder branch specifically let two feature map x1\ x2\ linear layer f\left .\right first used project x1\ global average pooling gap\left .\right multilayer perceptron mlp\left .\right softmax function split operation used obtain fusion weight shown a2\right\ =split\left softmax\left mlp\left gap\left 1+x2\right finally weight a2\right\ used fuse x2\ additional short residual via y=a1\widehat 1+a2x2+x2\ experiment part first present datasets implementation detail gtmnet evaluate method rs-haze satehaze1k datasets finally ablation study comparative experiment conducted analyze proposed approach datasets rs-haze synthetic hazy rsi dataset synthesized rsis containing diverse topography good weather condition cloudy rsis image downloaded landsat-8 level data product earthexplorer final training set contains 51,300 rsi pair test set contains 2,700 rsi pair image resolution since proposed method optimized dehazeformer model experimental setup consistent dehazeformer train model using loss epoch validated image test set verification set satehaze1k also synthetic haze satellite remote sensing dataset photoshop software auxiliary tool generate rich real diverse hazy image dataset contains 1,200 rsi pair pair image includes hazy image real haze-free image image divided three haze image subset thin fog moderate fog thick fog image resolution select pair image type hazy image subset training set pair image test set type hazy image subset trained tested separately since satehaze1k dataset small train gtmnet epoch verify every ten epoch experimental configuration rs-haze dataset implementation detail provide four variant gtmnet tiny small basic large respectively implement proposed network structure using pytorch framework train model nvidia geforce rtx3090 training image randomly cropped patch set different mini-batch size different variant i.e. initial learning rate set variant use adamw optimizer cosine annealing strategy train model learning rate gradually decrease initial learning rate proposed mechanism gtmnet training illustrated algorithm learnable parameter gtmnet initialized using truncated normal distribution strategy evaluation quantitative evaluation use peak signal noise ratio psnr structure similarity index measurement ssim objective evaluation indicator compare number parameter gtmnet method shown table bold indicates optimal value underline indicates suboptimal value table quantitative comparison gtmnet-t method rs-haze dataset full size table table quantitative comparison gtmnet method satehaze1k dataset full size table rs-haze dataset due equipment limitation testing training conducted -t. compare proposed method four classical dehazing algorithm shown table psnr method slightly lower dehazeformer-t ssim since proposed architecture parameter easier overfit resulting poor generalization performance satehaze1k dataset compare proposed method dcp dehazenet huang sar skygan transra dehazeformer result shown table psnr ssim gtmnet-t three sub-datasets better dehazeformer-t especially psnr thin fog improved nearly 2.6 ssim increased 0.968 0.970 moderate fog psnr ssim gtmnet-b reach 27.22 0.973 respectively increase 7.2 7.6 compared skygan thick fog although psnr gtmnet-b lower huang sar skygan ssim metric improves 8.7 5.2 respectively compared two algorithm three sub-datasets gtmnet-t achieves better psnr ssim score transra significant improvement psnr performance shown table combined quantitative comparison result proposed model still lightweight although parameter increased slightly moderate fog thick fog sub-datasets gtmnet-b performs comparably dehazeformer-l 0.1 time number parameter however performance gtmnet-l inferior dehazeformer-l may caused two aspect firstly increased parameter quantity gtmnet-l make prone overfitting secondly generalization ability gtmnet-l reduced due small dataset qualitative evaluation qualitative comparison related method performed rs-haze satehaze1k datasets since song compared existing advanced dehazing image method rs-haze dataset present dehazed image gtmnet-t dehazeformer-t shown fig little visual difference gtmnet-t dehazeformer-t rs-haze image showing clarity rich feature information realistic colour sense hierarchy figure qualitative comparison image dehazing method rs-haze dataset full size image satehaze1k dataset present qualitative comparison result gtmnet state-of-the-art method hazy input image include farmland road building vegetation shown fig found dcp method failed possibly due similarity color atmospheric light object although method huang sar remove haze ground feature information restored image dense haze area rich enough building detail severely weakened general dehazenet skygan failed completely remove haze shown processing result first hazy image fig resulting unnatural color image weak recovery ability detailed information dehazeformer-t gtmnet-t solve problem incomplete image dehazing however area thick haze cloud haze dehazeformer algorithm suffers serious color distortion gtmnet improves problem image color deviation also sharpness figure qualitative comparison image dehazing method satehaze1k dataset full size image ablation study part perform ablation study proposed model structure analyze factor may influence result study except different subject strategy group experiment effect different component model performance study influence different component image dehazing effect take dehazeformer-t baseline model conduct ablation experiment different component satehaze1k dataset shown table d-sos-t refers adding module dehazeformer-t according table found psnr ssim indicator three sub-datasets significantly improved verifying effectiveness module image dehazing task d-gtm-t indicates introduction gtm prior dehazeformer-t two sft layer location sft layer shown fig according table performance adding prior gtm dehazeformer-t without using boosted strategy better dehazeformer-t moderate fog effect poor thin fog thick fog believe method obtaining gtm based statistic ordinary image large gap rsis ordinary image traditional prior method effective uniform haze image table ablation model different component full size table table quantitative comparison different component ablation model satehaze1k dataset full size table shown fig haze-free image generated dehazeformer-t d-sos-t d-gtm-t show building distortion among method dehazing effect gtmnet best ensure clarity restored image better restore color image thin fog thick fog sub-datasets psnr ssim indicator increase two component used together used separately figure qualitative comparison different component ablation model satehaze1k dataset full size image effect different input sos1 module model performance according designed two different ablation model d-sos-t d-sos1-t satehaze1k dataset specific configuration shown table according table directly upsampled input sos1 fig compared d-sos-t psnr decrease 27.09 26.77 value ssim remains unchanged moderate fog addition compared dehazeformer-t psnr ssim increase 26.38 0.969 26.77 0.971 respectively table ablation model different input sos1 module full size table table quantitative comparison ablation model different input sos1 module satehaze1k dataset full size table seen fig little visual difference dehazed image d-sos-t d-sos1-t dense haze area color distortion severe edge detail lost shown result third hazy image fig sum set input sos1 module figure qualitative comparison ablation model different input sos1 module satehaze1k dataset full size image effect sft layer gtm model performance according structure model position sft layer categorized four situation shown fig using one sft layer front dehazeformer block1 using one sft layer behind dehazeformer block5 using sft layer front dehazeformer block1 behind dehazeformer block5 respectively i.e. gtmnet using sft layer front dehazeformer block2 behind dehazeformer block4 respectively shown table highest psnr ssim moderate fog table indicates gtmnet-b greater increase psnr ssim moreover seen comparison result fig best dehazed result achieved using gtmnet-t significantly improved image clarity severe image color distortion especially third hazy image fig figure position sft layer front dehazeformer block1 behind dehazeformer block5 front dehazeformer block1 behind dehazeformer block5 front dehazeformer block2 behind dehazeformer block4 full size image table quantitative comparison ablation model sft layer gtm satehaze1k dataset full size table table quantitative comparison ablation model gtmnet different variant satehaze1k dataset full size table figure qualitative comparison ablation model sft layer gtm satehaze1k dataset full size image based result shown table conclude adding gtm encoder decoder superior effect removing haze thin fog rsis adding gtm solely decoder better effect removing haze moderate fog thick fog rsis believe effectiveness gtm related thickness haze also depends presence absence boosted module different transmission map impact dehazing performance model experiment utilized two type transmission map transmission map optimized solely guided filtering named -t-t gtm obtained optimizing estimated transmission map via guided filtering subsequently applying linear transformation used gtmnet shown table gtm lead higher psnr ssim indicator thin fog thick fog compared transmission map optimized solely guided filtering moreover subjective visual evaluation objective quantitative metric result demonstrate gtm also suitable local dense haze image yield remarkable dehazing effect effect initial learning rate model performance according training method dehazeformer initial learning rate model decrease batch size decrease following linear scaling rule initial learning rate gtmnet-b performed ablation experiment three sub-datasets found reduced initial learning rate gtmnet-b shown table value psnr ssim generally decreased significantly kept initial learning rate constant i.e. even reduced batch size iteration table quantitative comparison different initial learning rate gtmnet-b model full size table quantitative comparison real-world image order evaluate generalization ability gtmnet select two real-world unmanned aerial hazy rsis testing overall dehazeformer method suboptimal therefore compare result gtmnet-t dehazeformer-t part use model trained moderate fog test two real-world haze image figure show little visual difference processing result obtained proposed algorithm dehazeformer-t method produce clear rich ground information realistic color suggesting algorithm suitable hazy remote sensing image real world included additional visual comparison supplementary material showcase performance method real-world image supplementary material figure quantitative comparison dehazeformer gtmnet real-world image hazy input acquired dji-phantom pro full size image impact dehazing result subsequent task hazy image suffer problem like low contrast low saturation detail loss color deviation seriously affect image analysis task classification positioning detection segmentation therefore case dehazing crucial generating image good perceptual quality improving performance subsequent computer vision task section analyze impact dehazing result rsi water body segmentation firstly trained rsi water segmentation network inspired u-net biomedical image segmentation using rsis tested using rsis secondly selected two image test set added moderate concentration haze using photoshop software tested two image using model trained moderate fog finally qualitatively compare result water body segmentation hazy input dehazing result gtmnet-t dehazeformer-t haze-free image shown fig little visual difference dehazed image gtmnet-t haze-free image however dehazed image dehazeformer-t increased error water body segmentation process compared haze-free image figure qualitative comparison different dehazing result rsis water body segmentation task ground truth acquired dji-phantom pro full size image conclusion combining advantage vit cnn propose new rsi dehazing hybrid model gtmnet gtm first introduced model using two sft layer improve model ability estimate haze thickness boosted module introduced refine local feature restored image gradually experimental result show proposed model excellent dehazing effect even small-scale hazy rsi datasets compensating lack training data current low-level visual task effectively improving model applicability compared state-of-the-art method gtmnet mitigates extent color distortion roof building high brightness dense haze area found effectiveness prior gtm depends presence boosted module therefore strategy introducing external prior knowledge crucial future work inspired dynamic memory network dmn fuse target-related external knowledge image feature multi-level feature fusion network mffn address network redundancy explore self-weighted fusion strategy auxiliary data e.g. synthetic aperture radar image gtm rsi feature addition study strategy combining traditional method deep learning–based method design suitable model avoid overfitting