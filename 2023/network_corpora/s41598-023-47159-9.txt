introduction image dehazing hot topic classic computer vision whose goal restore clean image input quality captured image affected air particle absorbs ray emitted object reflects light camera describe hazing process aligned i\left x\right =t\left x\right j\left x\right +\left 1-t\left x\right aligned input hazy image corresponding clean image represents much light reflected object received camera air-light traditional image dehazing computing transmission map air-light highly ill-posed problem extra information available address dehazing problem lot dehazing method designed based various type prior additional information requiring additional information restricts application scope method prior used dehazing maybe fail case image containing white object sky boost robustness dehazing method deep learning-based method introduced predict transmission map dehazing performance method influenced precision estimated transmission map overcome problem end-to-end deep learning dehazing method proposed fuse transmission map airlight new parameter design low-time consumption dehazing method designed dehazing method transfer dehazing problem transferring problem liu al.employ attention mechanism multi-scale network boost dehazing performance dong employ boosting strategy dense feature fusion design dehazing network zhang propose transmission map guided dehazing network song propose wavelet-based dehazing method although method great power dehazing note performance boosted introducing model capture long dependency cnn shown effectiveness low-level computer vision task transformer shown great power ability high-level computer vision task recently work although introduce low-level computer vision task prior work introduced transformer computer vision task achieved impressive performance show potential computer vision task however computational burden transformer high limit application transformer boost dehazing performance dehamer propose transformer-based module estimate density haze combine cnn feature obtain final dehazed result however dehamer ignores information hazy image achieve high dehazing dense hazy image furthermore dehamer inherits problem transformer high time complexity zhao propose pyramid dehazing network extract large contextual information however work also inherits limitation cnn proposed model extract large contextual information using transformer reduces consumption time using deep guided filter address issue propose novel highly efficient dehazing method based transformer guided filter called deep guided transformer dehazing network dgtdn haze depend distance camera object result haze density different pixel pixel distribution haze global hard cnn capture long distance capture long dependency design transformer-based model capture global information haze however transformer capture local information well deal case propose lightweight cnn sub-network capture local information based advance transformer cnn propose restore global haze-free image transformer refine detail cnn sub-network achieve goal improving dehazing speed introduce guided filter reduce dehazing time contribution dgtdn summered follows introduce transformer-based sub-network restore coarse haze-free image detail refined via cnn-based sub-network restoring coarse haze-free image depends global information refining detail need local information encourages design dehazing model using cnn transformer introduce guided filter improve dehazing speed transformer time-consuming may limit application transformer-based dehazing method address issue introducing guided filter proposed model reduce input size transformer reduces execution time transformer-based model extensive experiment show superiority proposed method natural hazy image simulated hazy image also conduct ablation study show effectiveness proposed module related work show previous work related dehazing paper divide related dehazing work two group include learning-based prior-based method learning-based dehazing method cnn-based method swept computer vision task development cnns lot work attempt solve dehazing using deep learning model dehazing method often attempt compute key factor physical model corresponding haze-free image directly work employ cnn model compute transmission map however method may boost error transmission map result poor dehazing result deal problem end-to-end dehazing method proposed example zhang design cnn model incorporates physical model propose all-in-one dehazing model fuse transmission map airlight new parameter liu design novel dehazing model based attention multi-scale network however dehazing method based cnns limited local property convolution capture long dependency hazy image guo propose transformer-based dehazing method employ transformer-based encoder capture density haze different above-mentioned method overcome problem cnn introducing transformer block dehazing model capture long-range dependency work note difference simulated hazy real hazy image result drop dehazing performance real hazy image model trained simulated hazy image address issue psd proposes combine traditional prior improve dehazing quality real hazy image domain adaptation dehazing method improves dehazing quality real hazy image converting simulated hazy image real hazy image note method hard train furthermore proposed method focus improving learning ability simulated hazy image different goal psd prior-based dehazing method address ill-posed single image dehazing lot prior-based dehazing method additional information proposed method discover prior based statistical analysis clean image hazy one famous work dark channel prior dcp derived observation clean image patch contains least one pixel channel value close zero zhu discover color attenuation prior divergence intensity saturation positively correlated depth fattal use color-line prior removing haze berman find haze-line prior based observation one haze-free image presented small number color cluster however prior simple held real word complex scene transformer vision task natural language processing nlp applied transformer capture long dependency improved performance learned model transformer show effectiveness nlp image classification task also employ transformer improve performance success vision transformer vit follow-up researcher shown potential transformer image segmentation object detection although visual transformer shown success visual task hard directly apply single image dehazing first transformer often depend large-scale datasets however existing large-scale dataset train transformer-based image dehazing second hard capture local representation transformer may result loss image detail overcome issue proposed combining advantage cnn transformer capture local texture global structure jointly boost dehazing quality figure rough structure deep guided transformer dehazing network proposed network contains main three part basenet detailnet guidedfilternet swin represents swin-block used enlarge receptive field proposed model bilinear represents bilinear downsampling output bilinear downsampling represents output haze remove network low-resolution dehazing result full size image methodology section explain motivation behind deep guided transformer dehazing network dgtdn show detail dgtdn structure proposed dgtdn shown fig consists three part first part basenet used estimate baselayer low-resolution dehazed result second part detailnet used estimate missed detail base layer low-resolution dehazed result generated adding base layer detail layer third part guidedfilernet obtains final high-quality dehazed result upsamping low-resolution dehazed result motivation thickness haze dependent depth object result distribution haze global information based fact dehazing task need restore image detail dependent local feature single image dehazing dependent global local feature transformer shown ability capture long-range dependency critical improve dehazing quality however transformer capture local feature detail lead coarse detail dehazing according prior work cnn provide local connection capture local feature known transformer-based method time-consuming reduce inference time propose introduce deep guided filter dehazing network based analysis combine advantage cnn transformer deep guided filter boost dehazing quality reduce running time paper propose deep guided transformer dehazing network dgtdn dgtdn consists basenet detailnet guidedfilernet basenet designed capture long-rang dependency restore coarse haze-free image detailnet designed capture local feature restore image detail guidedfilternet designed enlarge low-resolution dehazed result reduce dehazing time structure proposed model based motivation subsection 3.1 introduce cnn transformer guided filter proposed dehazing network shown fig propose model containing three part basenet detailnet guidedfilernet enlarge detail haze remove network consists basenet detailnet shown proposed model process hazy image output high-resolution dehazed result via series step downsampling input hazy image via bilinear downsampling obtaining low-resolution haze image mark feeding haze remove network obtaining low-resolution dehazed result mark feeding input hazy image guidedfilternet obtain final high-resolution deazed result next introduce basenet detailnet guidedfilternet detail basenet basenet consists encoder extract feature decoder restores haze-free image encoder contains four stage decoder also contains four stage specifically encoder stage contains one transformer block followed one down-sampling layer similar encoder stage decoder stage contains one transformer block followed one up-sampling layer down-sampling layer designed downscale size feature map implemented convolution stride up-sampling layer designed enlarge size feature map implemented transposed convolution operation stride input basenet low-resolution version hazy image low-resolution hazy image generated using bilinear used obtain hazy image half size original input define output basenet follows aligned =basenet i_l aligned basenet basenet i_l\ low-resolution input hazy image base layer dehazed result detailnet detailnet designed restore missed detail detailnet contains four residual dilation block rdbs whose structure shown fig rdb contains two common convolution layer two dilation convolution layer pas low-resolution input hazy detailnet obtain detail layer aligned =detailnet i_l aligned detailnet detailnet detail layer dehazed result figure structure residual dilation block rdb full size image obtaining structure layer dehazed result image detail layer obtain dehazed result follow aligned =\hat +\hat aligned _l\ represents predicted low-resolution haze-free image guidedfilternet guidedfilternet based guided filter based local linear model express local linear model aligned q_o =a_ i_g +b_ aligned q_o\ output i_g\ guidance image location i_g\ local window i_g\ radius linear const coefficient local window model preserve edge q_o\ i_g\ edge q_o= i_g\ obtain solve problem reduces difference output q_o\ filtering input solve problem minimizes error aligned i_g +b_ ^2+\epsilon aligned used penalize large filtering input employ guided filter perform joint upsampling receives low-resolution hazy image corresponding low-resolution dehazed result original hazy image input obtaining final high-resolution dehazed result based local linear model relation low-resolution hazy image corresponding low-resolution haze-free image expressed aligned h_l =a_ i_l +b_ aligned h_l\ low-resolution dehazed result i_l\ low-resolution hazy image index i_l\ obtain ^l\ ^l\ reduce error _l\ h_l\ aligned i_l+b_ ^2+\epsilon aligned obtaining ^l\ ^l\ simple aligned h_l =a^l i_l+b^l aligned element-wise multiplication based local linear model also express relation high-resolution hazy image corresponding haze-free image aligned h_h =a^h. i+b^h aligned based construct relation high-resolution low-resolution hazy image according obtain high-resolution a^h\ b^h\ via bilinearly upsample aligned a^h= a^l aligned aligned b^h= b^l aligned algorithm list main step guided filter dgtdn bilinearly upsample operation box represents box filtering shown fig guidedfilternet receives output haze remove network input enlarges low-resolution dehazed result according original hazy image proposed model guidedfilternet interacts haze remove network bilinear downsampling performs joint upsampling function guidedfilternet designed enlarge dehazed result reduce dehazing time proposed model algorithm joint upsampling guided filtering proposed dgtdn full size image loss function loss function critical obtaining high quality dehazing result proposed method obtain two-scale dehazed result utilize useful information propose multi-scale content loss function aligned con =\frac i=1 _h^i _1+\frac i=1 _l^i h_l^ aligned denotes number training sample _1\ denotes l_1\ norm h_h\ ground-truth haze-free image h_l\ low-resolution ground-truth make predicted base layer similar low-resolution ground truth employ l_1\ loss low-resolution ground truth predicted base layer aligned baseloss =\frac i=1 h_l^ aligned baseloss defined base loss boost quality dehazed result introduce perceptual loss train proposed model aligned perc =\frac i=1 j=1 vgg _h^i vgg h_l^ aligned vgg represents vgg-16 model classic model trained imagenet indicates layer used estimate perceptual loss finally combine perceptual loss multi- scale content loss base loss perceptual loss train whole network defined aligned =\mathscr con +\lambda baseloss +\lambda perc aligned _1\ used determine contribution base loss _2\ used determine contribution perceptual loss experimental result section focus showing high performance proposed method first introduce implementation detail proposed method dataset second compare proposed method dehazing method simulated haze image real haze image third show effectiveness proposed module loss function table detail rdb full size table table evaluation result dehazed result using average psnr/ssim sot dataset reside full size table implementation detail subsection show detail proposed model proposed basenet implemented based swin-transformer block configuration proposed rdb listed table proposed dgtdn implemented popular deep learning tool pytorch using single gpu titan 12gb memory training crop training dataset image patch size 240\times 240\ learning rate set 0.001 decreased 0.8 every step set batch size employ adam train proposed model initialize _1\ _2\ 0.5 0.999 respectively set _1\ _2\ 1.0 0.01 respectively according strategy adopted reside chosen train proposed model indoor hazy image sot subset used evaluate dehazing performance addition evaluate performance nh-haze experimental result simulated hazy image part show dehazing performance proposed dgtdn dehazing method simulated indoor hazy image due fact hard find ground truth haze-free image real haze image simulated indoor hazy image used evaluate dehazing performance show quantitative visual dehazing result table fig shown table traditional dehazing method obtain low quantitative result traditional dehazing method derive prior haze-free image may held hazy image main reason traditional dehazing achieve high dehazing performance learning based dehazing method include two kind first learning predict transmission map mscnn dehazenet second kind learning predict clean image directly dcpdn gfn msbdn dehamer learning-based method learn relationship transmission map hazy image however relationship transmission map dehazing quality highly correlated result low dehazing performance end-to-end dehazing method construct relationship hazy image dehazed result however dehazing ability model depends model capacity transformer-based dehazing method high model capacity achieves second dehazing performance summarize proposed method achieves outstanding performance among famous dehazing method shown fig note traditional dehazing method dcp nld bccr often problem color distortion learning-based method problem retaining haze leaning-based method obtain dehazed result similar ground truth proposed obtain high-quality visual dehazing result similar ground truth figure visual result recently dehazing method proposed method dehazed result obtained dehazing method often retain haze color distortion proposed method remove haze completely obtain natural dehazing result full size image table evaluation result dehazed result using average psnr/ssim dataset nh-haze full size table figure visual result dehazing method dense non-homogeneous haze image proposed method restores haze-free image clearer structure texture full size image figure visual result recently dehazing method proposed method lake scene dense haze dehazed result obtained learning-based dehazing method often retains haze proposed method remove haze completely obtain natural dehazing result full size image also test dehazing performance nh-haze widely used dataset nh-haze famous dehazing dataset contains non-homogeneous haze non-homogeneous haze much harder remove traditional homogeneous haze dehazing performance tested non-homogeneous haze show model capability well listed dehazing quantitative performance dehazing method table shown table dcp bccr nld achieve low quantitative dehazing performance note dehazenet achieves lower quantitative dehazing performance dcp bccr nld learning-based method achieve higher dehazing performance dehamer achieves second-best quantitative dehazing performance proposed method demonstrates best psnr ssim among listed dehazing method result demonstrate effectiveness proposed method benefit combination cnn transformer also show visual dehazed result proposed method state-of-the-art method shown fig see traditional dehazing method often over-enhance dehazed result contain obvious color distortion learning-based method tend retain haze dehazed result contrast method proposed method often obtains visually pleasing dehazed result vivid color contain rich image detail figure visual result dehazing method dehazed result obtained state-of-the-art method tends show hazed dark appearance dehazed result mscnn aod-net lose detail contrast proposed method often show sharp dehazed result remove haze completely full size image figure visual result recently dehazing method proposed method dehazed result obtained state-of-the-art method tend show dark hazed appearance designed natural image dehazing domain adaption however note area marked black rectangle retains lot haze contrast proposed method often show colorful sharp dehazed result remove haze completely full size image table density value natural hazy image fig full size table table quantitative result different module synthetic hazy dataset full size table figure visual result different model configuration proposed method dehazed result obtained different model often retains haze color distortion proposed method remove haze completely obtain natural dehazing result full size image table quantitative result different loss function synthetic hazy dataset full size table figure visual result model trained different loss function dehazed result obtained different model often retains haze color distortion proposed method remove haze completely obtain natural dehazing result full size image experimental result real-world haze image show performance choose typical real-world hazy image density distribution haze real hazy image multiplicative synthetic image hence real-world hazy image dehazing challenging problem part choose three hazy image include dense haze large haze distribution dark haze image haze image show generalization dehazing performance deep-learning-based model firstly conduct experiment dense haze image dehazed result state-of-the-art method proposed method shown fig shown see image tends show dense haze whole image hard cnn-based dehazing method dehazed result aod-net dcpdn tend retain haze dehazed result gfn contains visible color distortion haze dehazed result cgan contains color distortion gfn remove haze better aod-net dcpdn gfn note dehazed result epdn dehamer proposed method better learning-based method note area lake well dehazed result epdn proposed method remove haze completely epdn dehamer due fact transformer capture long dependency boost dehazing quality proposed method dehamer remove haze dense haze image proposed method employ cnn restore image detail make proposed method restore image detail dehamer secondly conduct experiment hazy image large haze distribution hazy image typical image employed evaluate dehazing performance widely image contains dense haze area middle haze area light haze area marked using black red green circle respectively due large haze distribution learning-based method often fail remove haze well shown fig note traditional method often show better dehazed result learning-based method dehazed result non-local dehazing tends lose image detail show dark appearance dehazed result dcp tends retain small amount haze dehazed result cap dcpdn ffa-net aod-net tend retain large amount haze dehazed result gdn gfn contain color distortion dehazenet mscnn based deep learning koschmieder law note dehazed result mscnn better dehazenet remove haze also note dehazed result mscnn loss image detail dehazed result pgan however note dehazed result pgan still contains haze dehazed result epdn dehamer remove haze better however method tend generate dark dehazed result tend show haze around green circle area proposed method remove haze completely keep image detail well thirdly conduct experiment challenging image look dark dehazed result image often problem losing image detail retaining haze shown fig see dehazed result dcp aod-net aecr airnet epdn dehamer tend show dark appearance dehazed result dcpdn ffa pgan look brighter however dehazed result method tend retain haze dehazed result dehazed result psd dgtdn generate much brighter dehazing result however dehazed result psd tend retain haze whole image result tends leave haze black rectangle show blur dehazed result airnet based assumption whole image share similar degradation contrast proposed method remove haze completely obtain sharp dehazed result show quality dehazed result obtained proposed method dehazing method quantitatively use metric proposed shown table see proposed method remove haze better dehazing method ablation study table running state state-of-the-art dehazing method proposed method image size running state include language platform execution time parameter consumption gpu memory full size table effectiveness proposed module dgtdn design series experiment firstly design model show effectiveness transformer remove transformer proposed model keep part unchanged term model1 secondly show effectiveness detailnet remove detailnet proposed model keep part unchanged term model2 finally show effectiveness guidedfilternet boost dehazing speed proposed model show influence guidedfilternet design model remove guidedfilternet keep part unchanged term model3 show quantitative comparison table visual example fig shown table see model1 achieves lowest dehazing performance due limitation receptive field see basenet boost dehazing performance dramatically show transformer module necessary dehazing transformer module improve dehazing performance enlarging receptive field note application guided filter reduces dehazing performance however necessary improve dehazing speed reducing dehazing performance slightly show difference dehazed result model1 model2 model3 proposed model fig see model1 remove haze remote area dense haze transformer module necessary removing dense haze area adding detainet see model remove haze completely guided filter improve dehazing quality remote area show influence loss function design ablation involves model trained different loss first train model without perc second train proposed model without baseloss third train proposed model without con show quantitative result table shown con critical obtain high quantitative dehazing result con designed boost detail dehazed result con designed make dehazed result similar ground truth baseloss used reduce difficulty dehazing problem boost dehazing quality also show dehazed result model trained different loss function fig shown note model trained without con obtains dehazed result loss image detail dehazed result obtained model trained without baseloss perc generate result color distortion over-enhancement shown fig model trained loss generate high quality dehazing result analysis run state test dehazing speed dehazing method image size 256\times 256\ test hazy image outdoor part reside resize image fixed size 256\times 256\ conduct experiment notebook equipped intel core cpu 2.3gh 8gb memory 3gb rtx gpu average running time state-of-the-art dehazing method proposed method shown table traditional dehazing method slower learning-based method method executed without parallelization technology increase execution time early learning-based method faster however dehazing performance method poor proposed method achieves state-of-the-art dehazing performance keeping lower execution time addition show rum state method table running state include language platform execution time parameter consumption gpu memory shown table proposed model suitable parameter number consumes suitable gpu memory achieving highest quantitative performance also show effectiveness guidedfilternet reduce execution time gpu memory compared model3 shown table proposed method almost visible degradation compared model3 obtain conclusion guidedfilternet improve execution speed avoiding performance degradation extended application based fact proposed model capture local global feature jointly apply proposed model solve problem underwater enhancement detain human image generation single image underwater enhancement challenging problem due ill-posed nature global information local detail underwater image degraded water result degeneration pixel may different based observation high-performance model requires global feature capture degeneration underwater enhancement also need restore fine detail requires local feature underwater enhancement similar dehazing also need global local feature jointly low compute resource requirement proposed model capture global local feature jointly also applied underwater enhancement conclusion deep guided transformer dehazing network dgtdn proposed based transformer guided filter boost speed transformer-based dehazing method image quality dehazed result proposed model consists basenet detailnet guidedfilernet basenet detailnet proposed capture local global feature jointly boost advantage transformer module cnn module employ transformer module predict base layer clean image cnn module predict detail layer address dehazing speed problem transformer module employ guided filter model perform joint up-sampling improve dehazing speed keeping quality dehazed result show effectiveness proposed method comparing state-of-the-art dehazing method real simulated haze image also show effectiveness novel module comparing performance different architecture loss function future study strategy combining cnn transformer critical capture local global feature also study domain shift simulated-haze real-haze image critical boost dehazing performance real haze image