introduction morphological evaluation leukocyte peripheral blood smear bone marrow aspirate high numerical aperture objective important step diagnosing hematopoietic malignancy acute leukemia specifically blood smear must always inspected case unexplained leukocytosis complementary automated instrument suggests presence blast equally blood film inspection allows differentiating myeloid lymphoid lineage crucial treatment selection unfortunately examination peripheral blood bone marrow aspirate film strongly relies availability trained personnel time-consuming prone human error due fatigue cognitive overload emergence digital pathology presented potential scalable artificial intelligence assisted examination peripheral blood film bone marrow aspirate diagnostic decision support although computational pathology shown potential reproducing hematologist work training state-of-the-art supervised deep learning model recognize well established morphological indicator leukemia critical limitation previous study focus differentiating type leukemia acute lymphoblastic leukemia acute myeloid leukemia aml furthermore study attempted detect case acute promyelocytic leukemia apl warrant emergency treatment impacting early mortality prognosis time-consuming part clinical pathway ongoing available e.g genetics cytochemistry flow cytometry equally important drawback previous fully supervised model require hundred thousand object-level cell annotation provided human expert difficult obtain scale also susceptible inconsistency due subjectivity cognitive fatigue annotator overcome limitation provide clinically relevant system could support together clinical evaluation ancillary laboratory parameter prompt treatment apl case designed multiple instance learning leukocyte identification millie approach customizable annotation-free deep-learning framework leverage patient diagnostic label train weakly supervised model detect different type acute leukemia weakly supervised multiple instance learning model trained diagnostic label previously used analyze microscopy image cell biology computational cancer histopathology attempt apply capability acute leukemia clinical pathway result show despite trained classify individual cell millie accurately distinguish normal acute lymphoblastic leukemia acute myeloblastic leukemia recognizing normal wbc lymphoblast immature myeloid cell peripheral blood film millie equally able distinguish aml bone marrow aspirate healthy one millie also able detect promyelocytes blood film bone marrow aspirate indicator acute promyelocytic leukemia apl method trained millie model distinguish normal aml sample evaluated classification performance sample cell-level separate hold test set sample approach extract patch containing individual cell high-resolution field view peripheral blood film bone marrow aspirate fig employ patch train weakly supervised convolutional neural network model diagnostic label fig specifically millie trained differentiate bag cell instance extracted positive sample containing regular abnormal white blood cell bag cell instance extracted negative sample regular cell figure millie approach preprocessing training data generation peripheral blood smear field view acquired high-na objective lens 100×/1.4na blood film 50×/0.55 bma digital microscope processed histogram-based segmentation see method section employed generate binary mask corresponding individual cell rgb image mask employed crop individual patch image around individual cell rgb image training weak label extracted patch passed convolutional neural network corresponding convolutional feature vector pooled together one single feature vector max pooling followed fully connected classification layer weight model optimized predict sample-level label available routine clinical examination detecting morphological indicator trained individual cell passed one-by-one millie model classifies indicator specific disorder millie learned predict sample level full size image trained predict patient diagnosis millie implicitly identifies disease specific indicator minimum supervision fig render approach highly efficient e.g. hindered lack bias object-level annotation interpretable experiment detailed next section extracted patch individual white blood cell sample trained multiple instance learning convolutional neural network model sample-level label applied trained model reported result image datasets datasets used study publicly available table summarizes provenance characteristic image datasets diagnostic level label also termed sample level label used train test millie table summarizes provenance characteristic image datasets single cell morphological annotation also termed object level level used validate multi-instance weakly supervised millie approach table image datasets diagnostic level label used train test millie full size table table image datasets single cell object-level annotation used validate millie full size table image segmentation image rgb color space converted hsv space otsu thresholding applied saturation channel offer high contrast stained wbc nucleus morphological binary opening followed watershed removal small blob applied segment wbc nucleus tile pixel around centroid remaining binary blob cropped initial rgb image evaluated segmentation accuracy randomly selected field view comprising total manually annotated wbc segmentation algorithm missed cell recall 0.94 detected false positive precision 0.92 network architecture training detail convolutional layer millie model initialized weight vgg-19 model pre-trained imagenet dataset object interest corresponding image patch white blood cell extracted sample applying segmentation step described previous section millie trained classify bag object interest sample-level label provided routine clinical test convolutional feature vector corresponding cropped image conv model pooled single feature vector followed two fully connected layer classification layer softmax relu fusion number input image patch corresponding weight bias layer fusion feature aggregation rule specifically fusion number individual feature fifty image patch subject on-the-fly geometrical augmentation random rotation random flip well spectral augmentation random hue modification random gamma correction random noise randomly selected per sample iteration training augmentation applied testing sample-level cell-level prediction way spectral augmentation compensate covariate acquisition shift due difference camera microscope setting used image different datasets employed stochastic gradient descent learning rate 0.0003 cross entropy loss function optimize model weight maximum epoch early stopping testing time image patch sample passed network single cell classification task individual cell passed one time trained model exact weight sample prediction case difference fusion feature fusion longer needed compared max-pooling strategy recent attention-pooling one generalized average pooling found indication attention pooling would improve performance supplementary fig max-pooling strategy output higher aurocs sample-level prediction supplementary fig result millie differentiates aml recognizing myeloblast lymphoblast peripheral blood film trained validated millie model predict diagnostic label image field normal sample sample fig publicly available aml sample fig different publicly available databank http color transfer approach applied reduce color variation two datasets combined dataset randomly split train 2/3 test 1/3 millie trained bag patch encompassing pixel 12.8 12.8 around centroid previously segmented white blood cell wbc threefold cross validation yielded average accuracy three class 0.99 0.01 fig confusion matrix single fold figure acute leukemia detection typing blood film normal wbc lymphoblast detected two positive sample hold validation set normal leucocyte myeloblast detected millie aml sample confusion matrix sample classification validation set receiver operating characteristic roc curve single cell classification cell image test set confusion matrix cell classification lymphoblast myeloblast normal cell image test set pca visualization convolutional representation learned millie individual cell test set full size image tested model ability classify single cell separate publicly available dataset consisting image individual normal wbc image individual lymphoblast completed image individual myeloblast immature myeloid cell randomly selected another different public dataset show despite trained diagnosis level label millie able recognize object lymphoblast auc 0.97 myeloblast auc 0.97 cell high accuracy fig manner interpretability investigated cell-level feature space learned millie convolutional feature vector individual test cell image reduced two-dimensional space visualization transformation via principal component analysis pca point shaded ground-truth cell label fig pca show three distinct cluster point little overlap normal blast cell fig datasets used train millie necessarily contain single-cell level annotation therefore comparison using training datasets possible nevertheless compared millie fully supervised approach adding comparison cell-level classification performance result reported literature obtained using fully supervised model tested cell-level datasets supplementary table millie obtained identical performance fully supervised model detecting lymphoblast supplementary table millie recognizes acute promyelocytic leukemia identifies promyelocytes peripheral blood film next tested millie ability recognize apl sample detect promyelocytes blood film fig purpose trained validated binary weakly supervised model distinguish apl sample normal aml sample similarly previous experiment random split train:2/3 test:1/3 threefold cross validation performed term sample classification millie achieved auc 0.935 0.036 fig trained validated weak sample-level label tested millie ability distinguish promyelocytes type wbc separate test set comprising single cell image promyelocytes myeloid normal wbc randomly selected separate publicly available dataset millie achieved auc 0.88 fig pca learned convolutional feature show distinct cluster corresponding promyelocytes slightly overlapping type cell fig fact millie able differentiate image promyelocytes type wbc different public dataset trained suggests spectral augmentation training corrected covariate shift caused color variation datasets figure acute promyelocytic leukemia detection blood film promyelocytes detected apl positive sample hold validation set confusion matrix sample classification validation set receiver operating characteristic roc curve sample-level classification hold validation set roc curve cell-level classification cell image test set confusion matrix cell classification promyelocytes cell image test set pca visualization convolutional representation learned millie individual cell test set full size image demonstrate robustness method trained tested millie distinguish apl sample aml sample different publicly available dataset millie achieved auc 0.96 0.02 fig a–e random threefold cross validation higher auc 0.94 one previously reported 0.86 figure apl versus aml classification blood sample additional dataset receiver operating characteristic roc curve sample-level classification hold validation set confusion matrix sample classification validation set roc curve cell-level classification cell image test set confusion matrix cell classification promyelocytes cell image test set pca visualization convolutional representation learned millie individual cell test set full size image datasets used train millie necessarily contain single-cell level annotation therefore comparison using training datasets possible nevertheless compared millie fully supervised approach adding comparison cell-level classification performance result reported literature obtained using fully supervised model tested cell-level datasets supplementary table context fully supervised model trained specifically distinguish bma myeloblast promyelocytes perform slightly better classifying individual cell main aim weakly supervised millie approach show millie flag lymphoblast immature myeloid cell marker aml respectively millie detects aml apl identifying promyelocytes bone marrow aspirate validate approach trained validated millie classify blood film bone marrow aspirate healthy subject aml patient diagnosed apl using publicly available dataset random split train:3/4 test:1/4 fourfold cross validation performed three-class classification problem term aml apl sample classification millie achieved average auc 0.99 fig confusion matrix fig confirms high accuracy sample classification like previous experiment trained validated diagnosis level label tested millie ability distinguish myeloid immature cell myeloblast monoblast promyelocytes mature healthy wbc lymphocyte monocyte granulocyte bone marrow aspirate publicly available test set comprising manually annotated single cell image promyelocytes myeloblast normal wbc extracted unseen sample millie achieved auc 0.895 promyelocytes 0.862 myeloblast classification fig promyelocytes myeloblast classified correctly according weak label fraction normal mature cell mostly lymphocyte wrongly highlighted millie aml cell fig pca learned feature first fully connected layer show three slightly overlapping distinct cluster fig figure acute myeloid leukemia detection bone marrow aspirate receiver operating characteristic roc curve sample-level classification hold validation set confusion matrix sample classification validation set roc curve cell-level classification cell image test set confusion matrix cell classification promyelocytes cell image test set pca visualization convolutional representation learned millie individual cell test set full size image discussion approach address challenge clinical automated computational hematopathology namely detecting differentiating various type immature white cell peripheral blood film bone marrow aspirate precise apl diagnosis relies clinical suspicion morphology flow cytometry cytogenetic molecular detection translocation q24 q21 pml-rar time consuming available low resource setting furthermore limited access care diagnostic delay leading delay administration all-trans retinoic acid atra arsenic trioxide ato therapy factor influencing outcome patient apl context integrated within blood film bone marrow assessment clinical workflow deep learning computational pathology system millie could facilitate prioritization acute leukemia diagnosis currently overloaded healthcare system well playing important role low-resource setting millie produce deep-learning model blood film analysis trained diagnostic label without additional human-expert cell-level morphological annotation specifically train millie leveraged weak patient-level diagnosis label overcome lack annotation needed train fully supervised machine learning model white blood cell identification classification despite trained diagnosis label weak label millie successful identifying individual well-established indicator associated different type acute leukemia namely lymphoblast myeloblast promyelocytes detecting promyelocytes indicator apl extremely useful support emergency treatment impact patient prognosis also shown millie adaptable generally applicable multi-class classification problem along binary diseased versus healthy classification task commonly examined weakly supervised clinical context computational pathology approach based weak supervision appropriate integration within clinical workflow previous fully supervised approach since requires patient diagnosis level label doe rely hard obtain object-level label study could provide deep representation patient level clinical history diagnostic modality cytogenetic molecular flow-cytometry harnessed millie approach widen image detection capability reactive process show approach classify apl blood film bone marrow aspirate sample mainly distinguishing promyelocytes cell type research needed ass whether extended differentiate benign versus neoplastic promyelocytes well promyelocyte containing neoplasm present disorder chronic myeloid leukemia apl curable malignancy appropriate prompt treatment commenced deployed within overloaded hematology care pathway millie computational hematology approach could transform throughput blood film bone marrow aspirate assessed could lead prompt referral treatment reduce early mortality improve prognosis apl case regardless resource setting millie provides realizable solution clinical decision support clinical pathway prioritization context remote resource poor healthcare setting added absence cytogenetic molecular testing capability also lack expertise making distinction normal abnormal blood film marrow aspirate millie provide decision support initiate treatment extreme large urban resource rich country large volume patient across many complex clinical pathway advantage rapid throughput referral effective treatment reducing error due cognitive load stretched staff study implementing millie platform allow system include wider range morphological representation improve throughput accuracy hematological clinical pathway require microscopic assessment blood film bone marrow specimen