introduction x-ray imaging widely used non-destructive high-throughput product quality control agricultural manufacturing product unique penetration property x-ray well suited detecting unwanted foreign object strong density contrast single x-ray view paper use term foreign object general manner referring presence undesirable structure within certain base product example object include insect infestation grain bone fish chicken fillet also structural damage fracture light-alloy casting porosity weld single x-ray view different object feature overlap make image analysis complicated even human expert clearly delineated dense foreign object could detected observer simple algorithm defect complex shape low attenuation contrast surrounding material require sophisticated approach deep convolutional neural network dcnns state-of-the-art method complex image segmentation analysis task learning sizeable set high-quality annotated training image so-called supervised learning however training data standard computer vision task readily available high-quality annotated x-ray image data cumbersome obtain industrial quality control application moreover combination change structure product foreign object one batch another render use deep learning approach infeasible amount data required retraining network prohibitively large paper present simple yet powerful approach overcomes limitation providing fast data-efficient deep-learning strategy real-time detection foreign object industrial product high-throughput approach relies ct-scanning few—or even one—product create basic digital product model used image simulation modifying volume—also including variety digital foreign object configurations—and computing artificial x-ray projection generated structure large training dataset artificially created provides extensive sampling combination base foreign object experimental result show although training data generated using simple physic model x-ray simulation model trained artificial image used effectively real-world x-ray data providing accurate real-time foreign object detection single-image x-ray view source real x-ray image use datasets containing x-ray projection piece modeling clay pebble stone inside also x-ray scan avocado fruit formulate foreign object detection problem later referred fod solved single x-ray image correct prediction ground-truth defined based property studied sample case study present two generation strategy require different amount expert knowledge basic modification strategy limited number transformation reduces amount real data acquisition roughly preserving model accuracy also present complex generative model based scan one object achieves accuracy level would otherwise require ten sample generation artificial data give user full control sample feature training set improving detection accuracy working small real-world datasets related work x-ray imaging successfully applied foreign object detection variety application fish bone could detected accuracy using conventional image processing feature extraction cnns segment bone per-pixel accuracy different stage pest infestation distinguished soybean reaching accuracy uninfested sample classification poultry x-ray projection often combined laser imaging system detect bone fillet sample accuracy manually defined feature x-ray image used achieve accuracy welding defect classification type defect cnns provide mean average precision localization casting defect depending specific application foreign object detection problem formulated different way direct approach detect whether foreign object present x-ray image outcome could either binary yes/no discrete set option multiple might present additionally detection framed binary segmentation every pixel image classified defect alternatively semantic segmentation performed computing full cluster pixel containing single several author proposed apply deep learning approach detection x-ray image approach could achieve high accuracy significant amount annotated training data provided data requirement key obstacle practical use since must represent broad set possible base object foreign object different location segmentation task annotation large amount data becomes additional problem requiring human expert approach required pear scan volume segmented manually gdxray dataset used contains x-ray image automotive part includes annotation bounding box defect case study dataset x-ray image ground-truth binary segmentation used proposed perform scan object generate data foreign object detection fod x-ray image every scan contains large number individual projection used input fod possibility perform volume reconstruction create model sample used generate ground-truth automatically methodology imaging thousand object replaced ten scan certain fod problem fruit inspection however reaching sufficient number scan might infeasible problem involves multiple base object need represented variety data every scan capture single combination base object particular thus training data would require possible pair cover variety base object combined every variation leading combinatorial explosion many field possibility create artificial data considered overcome challenge acquiring large datasets monte-carlo simulation using model object interest proposed variety manufacturing defect detection problem luggage inspection breast x-ray imaging approach could generate realistic data requires detailed knowledge x-ray imaging setup source detector property object supposed studied model material property several study indicate realistic synthetic data created simpler model beer law use data train accurate deep learning model method approach creating artificial x-ray image requires least one scan product generates new image changing volume sample methodology illustrated fig set x-ray projection converted sample volume using reconstruction algorithm volume segmented deformed automatically generate variety artificial volume finally x-ray image computed based artificial volume using forward projector figure proposed approach data generation augmentation performed volume level forward projected get x-ray image full size image x-ray object reconstruction produce distribution attenuation coefficient inside inspected volume every voxel reconstruction corresponds small region object attenuation coefficient mainly defined property matter furthermore reconstruction contains artifact e.g beam hardening noise ring induced difference model implied fdk actual physical imaging process next step segmentation reconstructed volume consider sample combination limited number material segmented volume every voxel corresponds single material base object could consist multiple material segmentation separated additionally attenuation coefficient every material extracted data computing average intensity reconstructed volume using segmentation mask thus segmented volume converted back distribution attenuation using average intensity material artificial sample generation performed create new object volume similar real-world sample deep learning model construct feature space based training data successful generation strategy provide diverse range object train accurate model main challenge lie identifying difference sample important make representative set cover variety possible product might encountered deep learning model construction representative dataset requires introduction prior knowledge object provides constraint data space help represent every sample set parameter configuration space simple example fig consider object structure unit solid sphere main object contains small ball foreign object due symmetry object every possible sample set represented point configuration space four dimension namely radius inner ball three coordinate vector connecting center object subspace parameter shown fig straightforward generation algorithm dataset would evenly sample possible angle distance size foreign object parameter important produce variety image example different polar azimuthal angle equivalent different view object figure example fod problem small ball located inside bigger one sample described using four parameter namely radius inner ball three coordinate vector connecting center object one possible sample dataset subspace configuration space corresponding fixed polar azimuthal angle configuration shown subfigure marked red dot subspace full size image real-world application base object usually complex described small number parameter problem detection crack casting inspection canned food well-defined main object structure used constraint simplify parameterization aim formulate general generation strategy doe use constraint instead attempting map low-dimensional configuration space sample object propose apply deformation known real volume particular deformation model different possible parameter output volume cover region around original volume data space assume variety deformation cover enough data space train accurate deep learning model validate assumption experiment finally forward projection operator used create artificial projection modified volume proposed methodology simple approach forward projection x-ray attenuation follows beer law image calculated computing line integral method doe take account many experimental effect polychromatic spectrum tube detector noise additionally apply post-processing noiseless projection order make similar real data mixed poisson–gaussian noise applied every pixel according aligned noisy i_0 aligned i_0\ noiseless photon count noise parameter value parameter found performing calibration detector result forward projector computed significantly faster monte–carlo simulation data noise distribution roughly imitating real one result deep learning model training validation accuracy evaluation example deep learning model train dcnns efficientnet architecture cross-entropy loss perform classification x-ray image network trained different number training image train evaluate size training set affect network accuracy accuracy determined applying model set test image comparing true class y_i predicted class y_i score computed according formula aligned test i=0 test y_i y_i aligned indicator function test set contains equal number image every class ensure accuracy score biased towards certain class case study collection experimentally acquired scan split training train sample test test sample test set always consists real data projection per sample resulting test test network trained real data training set constructed similarly train train evaluate data generation performance network trained artificial data number projection created fewer volume train train goal data generation method achieve similar fewer train training network stop based validation score training data split advance training validation subset approximately image used validation performance trained neural network might significantly depend random factor initialization nondeterministic algorithm result value change network trained multiple time characterize uncertainty every model trained four time different random seed training data data ct-based approach creating artificial x-ray image illustrated two fod problem first case study based dataset acquired computational imaging group centrum wiskunde informatica cwi amsterdam netherlands data collected example x-ray fod contain image modeling clay pebble stone use data model problem fod piece clay homogeneous main object stone foreign object even though problem doe inherent industrial value pose challenge similar industrial inspection task detection bone poultry glass peat firstly piece clay remolded every scan dataset contains variety main object unpredictable shape secondly despite significant contrast pebble stone still detected single projection due unknown shape sample small size stone training test set contain train =30\ test =30\ sample original collection zero one two stone classification task number foreign object sample chosen class example class shown fig additionally acquired scan sample without pebble stone since original dataset scan experimental setting additional scan similar setting original collection every sample p=72\ projection used x-ray image fod furthermore original data downsampled factor effective pixel size voxel size 190\ acquire second dataset performed x-ray scan twenty five avocado fruit flex-ray laboratory cwi amsterdam netherlands measurement performed voltage power exposure time per projection magnification factor 1.3 original x-ray image size px\ pixel size image acquired every sample fruit stored without refrigeration week scanned throughout period observed time amount air inside avocado increasing thus freshly harvested fruit distinguished ripe one based presence air speed process significantly varies among different sample due inherent biological variability formulate fod problem consider presence air pocket inside avocado foreign object experimental dataset contains train =36\ test =20\ object fruit multiple scan corresponding different day p=72\ projection per object every sample class assigned based fraction air volume respect whole fruit chosen arbitrary threshold air separate two class object example class shown fig faster deep learning model training image reconstruction downsampled factor leading effective pixel size voxel size figure example object differenct class two case study first row corresponds input x-ray image second row show visualization volume based segmentation base object colored green foreign object—red full size image sample generation data generation reduces amount manual data acquisition constructing representative training set consisting artificial x-ray image approach could work artificial real data similar enough trained model applied real image evaluate similarity train dcnn real image artificial image supposed identical real precisely perform segmentation forward projection without change volume first procedure check segmentation accurate enough preserve contrast morphology object feature second evaluate much missing physical effect influence training process dcnn furthermore comparison verifies addition noise could mitigate shortcoming simple forward projection operator presented case study formulating deformation model challenging task since neither base foreign object fixed shape blueprint thus trivial check algorithmically deformed object still object type encountered inspection system e.g avocado fruit deformation still avocado first deformation model propose use affine transformation includes resizing rotation shear translation applying foreign object possible change placement inside base object generate variety volume using single scan blueprint furthermore resizing shear could slightly change shape object preserving morphological feature since size agricultural product often varies certain range however reasoning might break transformation matrix sufficiently different identity matrix e.g deformed object order magnitude smaller original one manual inspection deformed object necessary determine range parameter possible range parameter small produce visibly different image rending affine transformation unsuitable fod problem example avocado case study air pocket might form around specific region fruit translation always applicable reflect case region removal method used non-linear deformation model algorithm split object region randomly assigning number point object different cluster performing nearest neighbor search point certain number cluster removed rest kept region removal method used change shape object considerably preserving position case study present two possible generation strategy require different amount real data expert knowledge define deformation model first one later referred basic modification take multiple sample class generates image class applying deformation model foreign object modelling clay case algorithm start segmentation sample containing two stone class generates two artificial sample one class removing one stone one class removing piece stone removed replacing stone material segmentation modelling clay material thus number training image train 3ps_ train since sample one class used generation method avocado fod problem algorithm take volume class avocado applies region removal reduce amount air result every real-world sample used create two avocado volume class train 2ps_ train crucial remove fraction air otherwise network see example class object air misclassify image test set second data-efficient strategy applies deformation model single real-world object generate many different artificial volume possible first step apply affine transformation mix resizing shear real volume parameter range chosen human expert ensure deformed volume identical original one still look like real sample thus scaling coefficient neighborhood shear coefficient around exact limit used implementation found code repository referenced code data availability modelling clay case original volume chosen class furhermore addition affine transformation whole object pebble stone duplicated using second affine transformation tranformation includes resize shear also translation rotation create class sample two pebble stone shown fig arbitrary choice highlight real sample two required generate artificial sample two basic modification stone object removed artificial volume create class sample avocado case fig affine transformation applied class sample class object generated performing region removal case study number generated image train pgs_ train number artificial volume generated every real scan train figure artificial sample generation based one real-world object modelling clay avocado full size image software implementation astra toolbox used perform reconstruction sample volume based x-ray scan using fdk algorithm segmentation utilizes image processing algorithm otsu convex hull morphological operation implemented scikit-image package deformation model apply affine transformation implemented scipy package region removal algorithm implemented forward-projection operator astra toolbox accuracy modeling clay classification modeling clay fod dcnn performance different amount real data used training drawn blue region fig green dot correspond accuracy score individual instance network training image based train 20\ scan enough achieve 90\ quality artificial data tested subset train 21\ real-world sample model trained generated image corresponding real volume average stay level 90\ real data value noiseless noisy artificial projection shown table mixed noise applied according value noise parameter 1.17\ =20\ simulation noise reduces doe improve average performance accuracy score network trained generated data shown orange region basic modification red point generation one fig basic modification value approximately correspond accuracy score achieved twice many real sample thus generation strategy reduces amount data acquisition half achieves predictive strength generation one sample train value mainly depends number artificial volume generated sample fig 20\ resulting performance rise saturates best value 87\ achieved 45\ corresponds performance could otherwise achieved train 15\ real object important difference doe decrease number generated object rise opposed real data furthermore 60\ mean value getting worse due higher table comparison model accuracy different type training data real image artificial noiseless image artificial image noise added post-processing filter full size table figure dependency modeling clay classification accuracy amount data provided training comparison training real data generated image different number real sample train training artificial image generated based one experimentally scanned sample full size image accuracy avocado classification according experiment real data fig scan train 24\ fruit enough achieve binary classification accuracy 95\ standard deviation decrease stay level data used training subset train 24\ object also used check quality forward projection operator shown table network accuracy significantly drop model trained noiseless data however addition mixed poisson–gaussian noise improves performance model difference accuracy model trained real noisy artificial image lie one standard deviation range accuracy score network trained generated data shown orange region basic modification red point generation one fig network trained image generated basic modification strategy reach best real-data performance 95\ train 12\ instead real object furthermore method outperforms training real data achieving 97\ available class sample thus reduction amount data acquisition train also possible avocado case without loss performance generation one sample strategy lead model accuracy 95\ train =1\ value slightly depends number generated volume fig standard deviation stay even large number 50\ avocado case exact value significantly depend parameter used air region removal variety class sample generated class sample since air cluster removed chosen different way reason experiment data generation repeated multiple time different random seed distribution amount air removed sample case generation one experiment also performed different original object small number train basic modification small value could drop significantly respect reported however generating 100\ artificial volume possible reach performance 92\ different random distribution original real-world volume table comparison model accuracy different type training data real image artificial noiseless image artificial image noise added post-processing filter full size table figure dependency avocado classification accuracy amount data provided training comparison training real data generated image different number real sample train training artificial image generated based one experimentally scanned sample full size image discussion result show two case study real data accurate classification model trained artificial x-ray image based small amount data acquisition modelling clay case one experimentally scanned object provides enough information generation method achieve accuracy corresponding training real sample despite using one real-world avocado model trained generated fruit reach performance would otherwise require object significant reduction amount data acquisition requires change data acquisition approach pose new application-specific challenge related data generation effectively apply methodology user guide acquisition data formulate deformation model adjust forward projection operator despite fod problem formulated single x-ray projection methodology specifically requires scan sample provide enough data reconstruct volume although case study laboratory setup used task industrial case performed two separate system detector factory floor used take low-resolution image low exposure fast fod scanner acquires large number projection different angle high exposure resolution even though scan take time single projection data generation approach requires fewer real-world sample proper choice deformation model access model base foreign object give user direct control possible combination encountered quality control system deformation model applied segmented volume used put foreign object different location base object transformation base object change feature visible single x-ray view manual data acquisition variability would require user provide many different sample representing different combination base object biological nature air gap infestation chemical change tissue possible construct arbitrary sample real life generated algorithmically providing necessary model main limitation sample generation approach lie application-specific expert knowledge make sure variety possible sample represented additionally artificial volume might impossible exist reality due biological physical constraint sample could mislead model decrease predictive ability artificial sample generation utilized reuse existing data extend problem formulation possibility deform sample volume used adapt existing deep learning model another size different shape base object new type scanned separately injected existing model base object data generation strategy many real-world sample basic modification used fix class imbalance manually acquired datasets data generation approach relies assumption artificial x-ray projection similar real projection depending application user adjust forward projection operator presented case study operator include many physical effect simulated monte-carlo method nevertheless result show accurate operator would significantly improve accuracy deep learning model even though compare approach simulation method evaluated performance based real data perfect operator would replicate real image good enough performance simple operator explained low resolution inspected image structure deep learning model might ignore blur small detail significant challenge methodology sensitivity application-specific decision made user implementation detail might significantly change generated data effect evaluated training deep learning model behavior observed artificial avocado amount air generated volume could significantly change resulting accuracy model however similar problem highlighted conventional training real data performance implicitly controlled acquired image picking representative set real-world sample also challenge especially different batch product different pattern data generation approach provides direct way control coverage training data faster way expand existing dataset conclusion efficient application deep learning method industrial quality control requires large annotated datasets rarely available present ct-based method creating artificial x-ray image used train dcnns instead real data methodology requires small number scan significantly reducing amount necessary data acquisition deformation model applied segmented sample volume generate variety possible combination base foreign object create representative dataset sample generation strategy adjusted based amount available data a-priori knowledge problem make approach flexible new feature data extension problem formulation result show even single scan train model capable accurate foreign object detection real-time changing approach data acquisition methodology simplifies use deep learning method industrial quality control task