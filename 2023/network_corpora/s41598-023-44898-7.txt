introduction human communication facial expression contain critical nonverbal information provide additional clue meaning verbal communication study suggested 60–80 communication nonverbal nonverbal information includes facial expression eye contact tone voice hand gesture physical distancing particular facial expression analysis become popular research topic facial emotional recognition fer applied field human–computer interaction hci area autopilot education medical treatment psychological treatment surveillance psychological analysis computer vision psychology computer vision emotion classified categorical dimensional valence arousal model categorical model ekman defined basic human emotion happiness anger disgust fear sadness surprise dimensional model emotion evaluated continuous numerical scale determination valence arousal fer important task computer vision numerous practical application number study fer increased recent year benefiting advance provided deep neural network particular convolutional neural network cnns attained excellent result term extracting feature example proposed residual neural network resnet architecture added residual learning cnn resolve issue vanishing gradient decreasing accuracy deep network several author applied neural network model classify emotion according categorical model dimensional model huang applied residual block architecture vgg cnn perform emotion recognition obtained improved accuracy mao proposed new fer model called poster aim improve performance state-of-the-art technique reduce required computational cost introducing window-based cross attention mechanism facial landmark multi-scale feature incorporate information automatic emotion recognition process recent study fused several modality temporal audio visual modality algorithm moreover attention mechanism adopted several study fer task zhang applied class activation mapping analyze attention map learned model found model could regularized flipping attention map randomly erasing part input image wang introduced attention branch learn face mask highlight discriminative part fer study show attention mechanism play critical role fer several approach fer utilize self-attention mechanism capture local global context set convolutional layer feature extraction extracted feature used input relation attention module utilizes self-attention capture relationship different patch context however practical deployment facial recognition system remains challenging task result presence noise ambiguous annotation complicated scene real-world setting since attention module proven effective computer vision task applying attention module fer task great interest moreover psychology facial feature fer human analyzed result presented beaudry suggest mouth major landmark observing happy emotion eye major landmark observing sad emotion similarly dnn model extract discriminative feature fer beneficial apply class activation mapping identify discriminative feature learned network layer shown class activation mapping method utilized localization recognition around eye movement analysis purpose produced feature map could provide better understanding performance developed model study squeeze-and-excitation module senet used resnet-18 achieve relatively light model fer model fewer trainable parameter approximately 11.27 million approximately million parameter required resnet-50 approximately million parameter vision transformer effectiveness proposed approach evaluated two fer datasets namely affectnet real-world affective face database raf-db datasets contain great quantity facial emotion data including various culture race number image affectnet time raf-db image affectnet diverse wilder raf-db neural network trained extract emotional information affectnet raf-db cross-database validation affectnet dataset raf-db conducted result show training accuracy 79.08 validation accuracy 56.54 achieved affectnet training accuracy 76.51 validation accuracy 65.67 achieved raf-db transfer-learning applied raf-db pretrained weight obtained affectnet prediction accuracy transfer-learning increase dramatically raf-db dataset result suggest transfer learning conducted smaller dataset particular culture region social setting specific application transfer-learning enables model learn facial emotion particular population smaller database achieve accurate result moreover image affectnet raf-db softmax score exceeding selected identify important facial landmark captured network found shallow layer extracted dominant feature fine line whereas deep layer region near mouth nose important database model affectnet database contains 456,349 image facial emotion obtained three search engine google bing yahoo six different language image labeled following emotion neutrality happiness sadness surprise fear disgust anger contempt none uncertain nonface among emotion uncertain mean given image classified one category nonface mean image contains exaggerated expression animation drawing watermark mollahosseini hired annotator manually classify emotion defined affectnet addition affectnet heavily imbalanced term number image emotion category example number image representing happy almost time higher number image representing disgust number image category shown table figure show sample image emotion contained affectnet study use seven category surprise fear disgust anger sadness happiness neutrality affectnet table number image database full size table figure image category face contained affectnet database full size image raf-db provided pattern recognition intelligent system laboratory pris lab beijing university post telecommunication database consists 300,000 facial image sourced internet classified seven category surprise fear disgust anger sadness happiness neutrality image contains accurate landmark location automatic landmark location raf-db also contains wide variety information term age race head gesture light exposure level blocking training set contains five time many image test set figure show sample image seven emotion contained raf-db table show number image used article emotion database figure image category face contained raf-db database full size image senet new image recognition architecture developed network reinforces critical feature comparing correlation among feature channel achieve increased classification accuracy figure show senet architecture contains three major operation squeeze operation extract global feature information previous convolution layer conduct global average pooling feature map obtain feature tensor size number channel element calculated global average pooling operation 2-dimensional matrix represents dimension channel number channel figure schema senet inception module full size image equation followed two fully connected layer first layer reduces number channel reduce required number computation compression rate second layer increase number channel excitation operation defined follows sigmoid activation function rectified linear unit relu excitation function weight reducing increasing dimensionality respectively scale operation multiplies feature tensor excitation operation capture significance channel via feature learning corresponding channel multiplied gained weight discern major minor information computer formula scale operation used obtain final output block shown follows scale dot channelwise multiplication operation output excitation operation resnet proposed solve vanishing gradient problem deep network resnet introduces residual block conventional cnn figure show residual block resnet architecture concept residual block combine output previous convolutional layer next convolutional layer resnet shown several study residual block relieve vanishing gradient issue encountered deeper network therefore residual block adopted several architecture figure residual block resnet architecture full size image se-resnet combine senet resnet architecture presented add block senet resnet block used capture significance channel determine whether contains major minor information feature information previous convolutional layer combined next layer residual block method mitigate decreasing accuracy caused vanishing gradient problem occurs increasing network layer figure show network architecture se-resnet figure schema se-resnet module full size image experimental method study extracted seven category affectnet ensure affectnet raf-db validated identical category se-resnet architecture adopted neural network model training testing comparison cross-database validation conducted raf-db affectnet achieve better performance transfer learning technique used model trained affectnet applied pretrained model train raf-db feature map derived block printed determine facial landmark contain major information network facial emotion image softmax score exceeding adopted ensure objectivity accuracy example feature map printed affectnet shown fig feature map printed raf-db shown fig figure feature map different block layer affectnet full size image figure feature map different block layer raf-db full size image experiment training hardware nvidia titan rtx 24-gb gpu input image size pixel data augmentation training process tone input image changed image randomly rotated degree cropped according four corner center five image size pixel validation purpose input image cropped center final size pixel optimization algorithm loss function stochastic gradient descent cross entropy loss function respectively twenty epoch used initial learning rate set 0.01 momentum 0.9 batch size training result discussion cross-database validation affectnet dataset raf-db cross-database validated study model trained affectnet used predict raf-db model trained raf-db used predict affectnet result shown table affectnet exhibit diversity term facial emotion data image model trained affectnet predicted raf-db accuracy 77.37 achieved significantly higher accuracy achieved directly training raf-db 65.67 contrast low accuracy 42.6 obtained affectnet predicted model trained raf-db difference understood fact image affectnet quantity complex table cross-database validation accuracy achieved affectnet raf-db full size table accuracy accuracy achieved affectnet raf-db se-resnet compared study raf-db result higher accuracy affectnet shown table however expected since raf-db dataset exhibit constrained image accuracy proposed model affectnet slightly lower accuracy obtained original paper proposed affectnet however mentioned original paper agreement two human annotator 36,000 image result comparable agreement rate table comparison validation accuracy achieved affectnet raf-db full size table additionally performed transfer learning pretraining model affectnet followed training raf-db shown table validation accuracy raf-db increased 26.95 accuracy pretrained model—accuracy without pretrained model without pretrained model 83.37–65.67 65.67 higher model trained directly raf-db compared accuracy 76.73 obtained multi-region ensemble cnn transfer learning single network performs better ensemble cnn utilizes global local feature result indicates affectnet provides useful pretrained weight wide diversity dataset diverse cultural racial background image affectnet dataset provides representative inclusive training set leading robust accurate recognition system result highlight significance considering diversity data transfer learning development deployment fer algorithm table comparison validation accuracy achieved raf-db with/without pretrained model full size table normalized confusion matrix predicted model trained affectnet affectnet raf-db shown fig respectively normalized confusion matrix predicted model transfer learning raf-db given fig figure show model tends falsely classify image neutral suggests discriminative feature learned affectnet similar neutral category moreover comparison fig show transfer learning model classifies emotion raf-db accurate even manner figure normalized confusion matrix affectnet raf-db affectnet raf-db raf-db pretrained model full size image seen normalized confusion matrix classification accuracy positively correlated number image dataset given table fig affectnet dataset contains least number disgust image result lowest accuracy normalized confusion matrix contrast number image happy category affectnet therefore yield highest accuracy normalized confusion matrix category conclusion obtained fig raf-db feature map study examines important feature network learns classify facial emotion feature map affectnet softmax score exceeding visualized fig shown mouth nose facial line major information eye ear minor information similar result found beaudry mouth major landmark neural network predicts happy emotion feature map misclassified image also visualized fig comparison correctly classified observing feature map misclassified image evident important feature image similar correctly classified image observed fig network tends detect edge line shallow layer focus local feature like mouth nose deeper layer figure feature map softmax score greater affectnet full size image figure misclassified feature map affectnet full size image asian facial emotion asian facial emotion dataset consists image actor aged year old image taken frontal 3/4 sideways sideways angle figure show example image asian facial emotion dataset number image class given table six labeled category dataset neutrality category provided dataset therefore output layer model trained predict probability category probability neutrality specified zero figure example image asian facial emotion dataset full size image table number image contained category asian descent dataset full size table asian facial emotion dataset tested model trained affectnet image resized pixel cropped pixel face centered derived average accuracy 61.99 slightly higher affectnet similar validation result affectnet happy category yielded highest score fear disgust lowest score normalized confusion matrix shown fig feature map shown fig contrast feature map affectnet discriminative location centered around mouth nose located right half face show model lacked generalizability asian face laboratory setting experiment show model trained affectnet limited prediction performance datasets figure normalized confusion matrix produced asian facial emotion dataset tested model trained affectnet full size image figure feature map produced asian facial emotion dataset full size image process interpreting facial expression also subject cultural individual difference considered model training phase feature map fig show proposed model focused mouth nose eye obtain correct fer result subtle feature wrinkle eye may also critical however proposed model doe capture feature far mouth nose test result obtained asian face emotion dataset show discriminative region skewed toward right half face finding indicates limited generalizability model asian face laboratory setting although affectnet diverse dataset containing representation various culture race still limited tiny portion global population contrast raf-db contains similar ethnic group setting similar affectnet validation result obtained raf-db 77.37 better asian face emotion dataset result show datasets similar ethnic group model trained diverse wilder dataset affectnet performs better prediction constrained dataset raf-db work conclusion study address neural network model learns identify facial emotion feature displayed emotion image derived cnn emotional feature visualized determine facial landmark contains major information conclusion drawn based finding listed cross-database validation experiment conducted affectnet raf-db accuracy 77.37 achieved raf-db predicted model trained affectnet accuracy comparable result accuracy 42.6 achieved affectnet predicted model trained raf-db result agree fact affectnet exhibit diversity raf-db term facial emotion image moreover transfer learning dramatically increase accuracy 26.95 raf-db finding highlight significance using transfer learning improve performance fer algorithm training associated model affectnet pretrained weight visualized emotion feature map show mouth nose contain major information eye ear contain minor information neural network learns perform fer paradigm similar human observes emotion comparing feature map correctly classified softmax score exceeding incorrectly classified seen network model focus similar feature major difference result indicates fer requires observation large patch near distinctive area face