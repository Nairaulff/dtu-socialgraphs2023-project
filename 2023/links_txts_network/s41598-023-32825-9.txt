Introduction Antennas belong to the key components of any wireless communications system. Antenna designs can be classified into low (< 10 dBi), middle (10–20 dBi), and high gain structures (> 20 dBi) 1 . Usually, high-gain antennas can be developed using either of the following two methods: (i) based on the optics theory, which manipulates the curvature of design in order to focus the incoming EM waves and form a beam (e.g., parabolic reflectors, lens antennas 2 ); (ii) antenna array theory, which is based on manipulation of either geometrical, or feeding properties of each element (e.g., waveguide-slot or microstrip patch antenna arrays 3 ). A transmitarray is an alternative high-gain antenna concept, which has been recently attracting a growing interest of researchers 1 , 2 , 3 . Its unique feature is to combine the advantages of both optic and antenna array techniques to develop high-gain structures with low profile and conformal geometries for wide range of applications. Transmitarrays 4 are structures inspired by reflectarray antenna designs 5 , which consist of a planar array of printed elements, and a feeding source. In contrast to the reflectarray antennas, where each unit element reflects the incoming EM waves with a certain phase (cf. Fig. 1 a), in transmitarray antennas, each element manipulates the EM waves propagated from the source with the appropriately set transmission phase shift to produce a focused beam in the desired direction (cf. Figure 1 b) 6 , 7 . Consequently, the main difference between reflectarrays and transmitarrays is analogous to the difference between mirrors and lens structures. The advantage of transmitarrays as compared to reflectarrays is that the former can achieve a high radiation efficiency without the feed blockage. The feed blockage is a challenging problem in reflectarray designs that can only be solved using complex dual-optics antennas or with offset feed configurations 8 . Despite the aforementioned advantages, transmitarray designs also exhibit several drawbacks. One of the most serious issues is a limited bandwidth, which usually does not exceed 5%; its extension can be achieved via complex multilayered element designs 9 . Further, in reflectarray designs, due to the PEC ground layer, the reflection magnitude is close to 0 dB 10 , 11 , so that the designer only needs to calculate the reflection phase of each element, thus the unit element can be considered as a single port model. Whereas, in transmitarray designs, on the top of controlling the phase, the transmission magnitude needs to be close to 0 dB to ensure high aperture efficiency, which makes the unit element design a two port design, which can be clearly seen from Fig. 2 a,b. Consequently, design of transmitarrays is a more challenging task, which requires a manipulation of both the magnitude and the phase of the unit elements. In particular, each unit element in the transmitarray should be designed to obtain the required transmission phase delay, and the highest possible transition magnitude at the same time 12 . This can only be achieved through multi-objective optimization, which is another challenging problem due to the large number of adjustable parameters, as well as the necessity of handling conflicting requirements. Figure 1 Conceptual illustration of ( a ) reflectarray antenna, ( b ) transmitarray antenna, ( c ) illustration of the phase compensation in transmitarray antenna. Full size image Figure 2 3D view of unit cell of ( a ) a pyramidal shaped reflectarray elements as a single port model 5 ; ( b ) proposed transmitarray unit cell element, ( c ) parameterization of the proposed unit element; ( d ) flow diagram of the proposed approach. Full size image Development of transmitarrays in the sense mentioned above requires the employment of numerical optimization techniques. Unfortunately, this is computationally expensive whenever full-wave electromagnetic (EM) models are used for system evaluation. Although there are novel synthesis techniques for design optimization of lens structures which demonstrate promising results 13 , 14 , in the case of array designs, including transmitarrays and reflectarrays, conducting the optimization process directly at the level of full-wave EM models is normally infeasible. Even if the computational model is set with the medium mesh density, the process might take months or years to complete 15 . A possible way of accelerating numerical optimization is the employment of data-driven surrogate models for representing the unit elements of transmitarray (cf. Fig. 2 d). Fast surrogates can be used to determine—at negligible cost—the geometry and material parameters of the elements that ensure the required transmission phase and magnitude characteristics, as well as the distance between the unit element and the feed antenna 16 , 17 . The literature offers the abundance of surrogate-assisted methods, oriented towards improving both the computational efficiency and reliability of the optimization processes 18 , 19 , 20 , 21 , 22 , 23 , 24 . Still, data-driven surrogate modelling is a challenging problem in the context of high-frequency design, primarily due to the high initial cost related to the acquisition of the training and testing data sets. For transmitarray unit elements, the numbers of required samples are typically 4000 and beyond 25 , 26 , 27 . This paper proposes an alternative surrogate-assisted approach to design of high-gain broad-operating bandwidth transmitarray antennas. The presented methodology is based on data-driven surrogates of unit elements of a non-planar 3D printable transmitarray, constructed by means of Artificial Intelligence (AI) techniques, which recently had shown great achievement in design optimization of Reflectarray designs 5 . Herein, instead of modeling of a single port model for characterization of S 11 reflection phase, the handled transmitarray unit element design is a two port model where not only transmission phase but also the transmission magnitude must be included in the modelling process. Our methodology permits a rendition of reliable models using small training data sets, which translates into low initial cost of the surrogate modelling process. In particular, utilization of automated deep learning method allows for obtaining a reliable model of the unit element with only 270 training and 100 hold-out samples acquired from the EM model, which corresponds to less than one full-wave analysis of the entire array. For the sake of illustration, the presented technique is applied to design of three transmitarrays operating in the frequency bands 8–14 GHz, 22–28 GHz, and 28–36 GHz, respectively. The numerical results are validated experimentally. The originality and the technical contributions of this work can be summarized as follows: (i) the development of a novel approach to low-cost surrogate modeling of transmitarray unit cells, (ii) demonstration of the applicability of the presented technique for constructing re-usable models that can be employed for design of TAs operating at various frequencies within the range 1–40 GHz, (iii) demonstrating computational efficiency of the modeling process and its superiority over state-of-the-art data-driven methods, (iv) demonstration the design utility of the developed model using several examples of TAs with numerical results supplemented by experimental validation of the selected array. Transmitarrays: simulation-driven design and challenges As mentioned earlier, transmitarray antennas are similar in terms of the constituent elements to reflectarrays. The fundamental difference is that instead of the reflection phase manipulation in reflectarray, transmitarrays manipulate the transmission phase and magnitude to focus the EM wave, cf. Fig. 1 . The analysis of transmitarray assumes that the unit elements are placed in the far-field region of feed antenna 1 . Under this assumption, the EM field incident to each unit element at a certain angle can be locally considered a plane wave, with the phase proportional to the distance from the phase center of the feed source to the element, corresponding to the spherical wave propagation 1 . In order to compensate for the spatial phase delay due to the distance between the feed and the unit element, each element in transmitarray must be carefully designed to satisfy the required transmission phase delay. Ensuring appropriate phase distribution allows for achieving a focused beam at the requested direction (Fig. 1 c). The transmission phase ψ i for the i th element can be obtained as follows 10 : $$ \psi_{i} = k(R_{i} - \vec{r}_{i} .\hat{r}_{0} ) + \psi_{0} $$ (1) where \(k\) is the propagation constant in free space, R i is the distance between the i th element and the feed, \(\vec{r}_{i}\) is the position vector of the i th element, and \(\hat{r}_{0}\) is the target main beam direction. For a main beam in the broadside direction, the product \(\vec{r}_{i} .\hat{r}_{0}\) must be equal to zero; ψ 0 is a constant phase that indicates that a relative transmission phase rather than the absolute one is required for transmitarray design 1 . Although transmitarrays exhibit the advantages of high gain and no feed blockage as compared to reflectarrays, they also have certain disadvantages. These include a limited bandwidth of up to 5%, and more involved design process that requires a manipulation of both the transmission phase and magnitude. Computationally-efficient and reliable design optimization of high-gain and wideband transmitarrays (TAs) requires addressing the following challenges: The ability to evaluate the transmission magnitude and phase of unit elements in a reliable, accurate, and fast way; The ability to improve the bandwidth of the TA elements without reducing their phase range 28 ; The ability to manipulate both the transmission magnitude and the phase of the unit element, in particular, to maintain the transmission magnitude close to one, while ensuring wide range of transmission phase variation. Low-cost surrogate modeling of unit elements In this section, we explain the unit element modeling techniques for transmitarray design. Section “ Unit element modeling: methods and challenges ” highlights the modeling task and the associated challenges. Section “ Transmitarray unit cell and its properties ” presents the 3D printable unit element considered here for TA design. Finally, Sect.” Proposed surrogate modeling approach ” presents the proposed surrogate modeling framework based on deep learning with automated architecture determination through Bayesian optimization. Unit element modeling: methods and challenges As mentioned earlier, transmitarrays offer an alternative way of realizing high gain antennas, which has a number of advantages over traditional methods, as indicates in Sect. “ Introduction ”. In transmitarray antennas, each element manipulates the EM waves propagated from the source with the appropriately set transmission phase shift to produce a focused beam in the desired direction. To achieve the desired performance, the unit elements of transmitarray antenna must meet certain criteria as mentioned in Sect. “ Transmitarrays: simulation-driven design and challenges ”. In the literature, different types of unit elements have been proposed for implementing high-gain transmitarrays. Examples include multi-layer TA designs with dipole elements and seven conductor layers 5 , or double-square-loop element with four conductor layers 9 , achieving 360 degree of phase manipulation. It should be noted that although it is possible to increase the bandwidth of the TA using multi-layer designs, this approach also increases the thickness and the transmission loss, and, consequently, the weight and the manufacturing cost 9 . More complex unit element deigns such as Jerusalem-cross shapes 7 as are also taken into consideration to reduce the total number of layers at the expense of reduced phase manipulation range of 335 degrees. As mentioned earlier, to reduce the design cost and complexity, the primary challenge is to achieve a full phase range of 360 using a smaller number of conductor layers, while avoiding the reduction of the element transmission magnitude, and maintaining the overall performance of the transmitarray antenna 4 . Thus, design of transmitarrays is a challenging endeavor, which requires careful determination of geometrical parameters of each unit element within the TA, so that both the required transmission phase delay, and the highest possible transmission magnitude is simultaneously achieved 12 . A proper approach is multi-objective optimization, which is an intricate procedure by itself, not only due to the large number of variables, and the necessity of handling conflicting requirements, but also due to the extremely high cost of evaluating TA characteristics, which involves full-wave electromagnetic analysis 13 . To work around direct handling of expensive EM models, surrogate-assisted optimization has been studied by many researches over the last decades. The literature offers a number of algorithmic tools in the context of reflectarray and transmitarray design (e.g., 22 , 23 , 24 ). Notwithstanding, the high initial cost of surrogate model construction, pertinent to the acquisition of the training and testing data samples (typically, 4000 samples or beyond 25 , 26 , 27 ) is still a major practical issue. Transmitarray unit cell and its properties The proposed work is a multidisciplinary work involving microwave antenna theory (Electrical Engineering/Energy) and artificial intelligence (Computational Science) each of which are extremely complex topics. In order to present this topic for all the possible readers’ authors aimed to firstly present the concept of artificial intelligence on a simple TA unit element such as example given in Fig. 2 which can also be modelled using analytical formulations 29 . The fundamental purpose of this example is to present how one should select the design variables with respect to the EM response and how to can be applied on AI models, whereas the second and the third examples provide more challenging design cases that can only be solved via EM simulations and AI techniques. Thus, by this mean, authors aim to illustrate the presented concepts and workflows using simple test case, so that the challenges pertinent to the examples themselves do not make demonstration of the concepts unclear. The modeling technique proposed in this work is accompanied by an exemplary unit element with variable length and relative dielectric constant. This arrangement makes it suitable to satisfy the following requirements: (i) wide range of variation for the transmission phase, (ii) low loss transmission medium for EM signals, (iii) easy fabrication via 3D printing, (iv) broad range of achievable relative dielectric constant values, which can be adjusted between 1.3 and 2.7 30 . The dielectric properties are controlled by the infill rate of material density used during the 3D prototyping, which can also reduce the overall weight of the design. The cell architecture, shown in Fig. 2 b–c, is modeled through full-wave EM analysis (here, using CST MWS). The top and the bottom surfaces of the 3D model are perfectly electric conducting walls, whereas the right and the left walls are perfectly magnetic field walls 11 . The incoming waves will be incident normally onto the element, and transmitted to the second port with a variable transmission phase depending on the length and the relative dielectric constant of the unit element. The length of the E and the H walls of the computational domain, and the position of the waveguide ports are fixed. The range of design variables are taken as 1.9 ≤ ε r ≤ 2.7, 2 ≤ H ≤ 60. The simulation frequency range is from 1 to 40 GHz. The cell width and length are set to W = L and taken in the range of 10 ≤ W ≤ 20 mm for sensitivity analysis. It should be mentioned that although W has a limited effect on both the phase (< 2°) and the magnitude (< 0.01) of the unit cell transmission response, this parameter is important for array design as it determines the overall weight of the structure. Commonly, W is taken as equal to λ 0 /2 (half of the free-space wavelength) 4 , due to wide range of applicability of the unit element (1 ≤ f r ≤ 40 GHz) this value should also be included in the optimization process of transmitarrays weight for the selected operating frequency band. In summary, each of the variables ε r , H, W, f r , has a unique effect not only on the transmission characteristic but also the weight of the cell. Again, as the effect of W on the transmission characteristics of the unit cell is almost negligible, this parameter will not be incorporated into the surrogate model of the cell. Consequently, their determination is the main challenge of this study, as elaborated on in Sect. “ Results and experimental validation ” Figure 3 shows a parametric analysis of the effects of unit cells parameters on the transmission phase response. It can be observed that a broad range of transmission phase variation is achieved, thus the designed unit cell is a suitable candidate for design of high performance transmitarrays. Figure 3 Parametric analysis of the unit cell’s transmission: ( a ) phase, ( b ) magnitude as a function of the normalized variables. Here, each of the variables ε r [1.9 ~ 2.7], H [2 ~ 60] and frequency [1 ~ 40 GHz] are normalized between 0 and 1 to show their effects on the transmission characteristics of the unit element. During the parametric analysis of each variable, the other parameters are fixed as follows: ε r = 2.1, H = 30, frequency = 20, W = L = 15 [mm]. Full size image Table 1 illustrates the effects of the unit cell parameters on its transmission characteristic. A broad range of phase variations can be observed, which is sufficient for transmitarray design purposes. However, it should be emphasized that the design process has to account for additional factors: (i) the lengths of adjacent cells cannot be significantly different from each other to avoid a blockage for the incoming EM waves at the corners or distanced locations of the array; (ii) increasing both the length and the relative dielectric of cell can increase the variation range of transmission phase; however, it would also increase the overall weight and the manufacturing cost of the design. The latter can be calculated by multiplying the unit cell volume by the material density, w 0 = ρV . Table 1 Parametric analysis of the proposed unit element: transmission characteristics for different geometry and material parameter setups (W = L = 15 [mm]). Full size table The transmitarray is to be manufactured using the 3D printing technology. Here, it should be noted that the infill rate of printed design will directly affects the relative dielectric constant of the structure 30 , which can be used for changing the transmission phase, magnitude, and the weight of the design. Further, there are additional parameters that can affect the overall weight of the design, such as the minimum number of solid layers for both ground and top layer of the 3D printed structure, the layer height precision, and material used. The following formula, obtained from the data presented in 5 , allows for calculating the overall weight of a unit cell prototyped by using PLA material: $$ w = 1.276 - 0.321w_{0}^{{}} - 1.235\varepsilon_{r}^{{}} - 0.00542w_{0}^{2} + 0.491w_{0}^{{}} \varepsilon_{r}^{{}} + 0.287\varepsilon_{r}^{2} $$ (2) where w 0 is the weight of a design with 100% infill rate, whereas ε r is the target dielectric constant of the unit cell. The latter is directly related to the infill rate. Proposed surrogate modeling approach For most engineering problems, the relationships between the design parameters and the system characteristics are nonlinear. One of the common methods for modelling nonlinear data are Artificial Neural Networks (ANNs) 31 , 32 . A Multi-Layer Perceptron (MLP) is one of the most well-known and favored ANN architectures 33 . The main reasons include the ability to model multiple outputs at same time, and to transform the modelling space to a higher dimension by using hidden layers and neurons’, which make this method an ideal technique for creating a mapping between the design parameters and the system characteristics. However, in order for MLP to create an accurate model for highly nonlinear systems, the overall complexity, the hidden layer size, and total number of neurons, of the model must also be increased. This leads to one of the major drawbacks of MLP, which is vanishing gradient 34 . One of the efficient methods to mitigate this issue is the employment of more involved Deep Neural Network (DNN) algorithms 35 . With the usage of modern activation functions such as ReLU 36 , LeakyReLU 37 , and the normalization layers, the vanishing gradient problem or the saturation of neuron weighting coefficient can be prevented. A hybrid model between the traditional MLP and the state-of-the-art DNN models is Modified Multi-Layer Perceptron (M2LP) 38 . Another advantage of M2LP, being a result of its hybrid structure, is its intra-space and inter-space transformation capability. In the sub-layer formation of M2LP, the data is handled by two hidden layers of identical neuron sizes to create an initial mapping of the input data, which is referred to as the intra-space transformation. The inter-space transformation is formed between the output and the input of the two sub-layers where the number of hidden neurons is increased twice as compared to the preceding layer. Based on these transformations, M2LP is able to represent complex relationships, which facilitates handling of nonlinear characteristics. Finally, the M2LP an expansion layer is applied to make the model space compatible with the size of the system outputs. Figure 4 shows the architecture of the M2LP model. In each of the blocks an intra-space transformation based on two layers (of same color in the picture) is performed for three sub-layers (marked as green, purple, and orange, respectively). The last layer is the expansion layer (grey). The blue and the red layers represent the inputs ( ε r , H, W, f r ) and the outputs (|S 21 |, ∠ S 21 ,) of the system at hand. Figure 4 General architecture of the proposed M2LP model. The user only defines the number of sub-layers θ , and the multiplication factor β that controls the number of neurons in each interspace transformation. Here, these values are taken as θ = 2, and β = 2, respectively. All other parameters are determined through optimization. Full size image It should be noted that appropriate determination of the model hyper-parameter is instrumental in ensuring the best possible predictive power of the surrogate model. In this work, automated architecture determination of M2LP is carried out using Bayesian Optimization (BO) 39 . The optimum hyper-parameter setup of M2LP is obtained using a search space defined as follows: (i) initial number of neurons ϕ 0 ∈ {16, 32, 64, 128, 256, 512}, (ii) the number of blocks K ∈ {2, 3, 4, 5}, (iii) the leakage parameter of LeakReLU activation function 0.05 ≤ α ≤ 0.25. The number θ of sub-layers and the factor \(\phi \) controlling the increase the number of neurons in the layers is assumed to be fixed and determined by the user. A k -fold cross-validation with k = 3 is being to guide the optimization process using the training data that consists of 270 samples. Furthermore, an additional (hold-out) data set with 100 samples (randomly selected) is used to evaluate the over-fitting performance of the model. Here it is worth mentioning that the total computational cost of the surrogate modelling approach will be calculated based on both training and hold-out data sets since all the data are employed in the modelling process. Each data sample is a vector of the size 1 × 391 representing the evaluation of the unit cell within the frequency band of 1–40 GHz which is uniformly distributed with step size of 0.1 GHz. Modeling results and benchmarking One of the main contributions of this work is a computationally efficient data-driven surrogate modeling with a reduced the number of training data samples required for constructing a globally accurate data-driven surrogate for a TA unit cell. Here, it is noteworthy that the major contribution to the computational cost of data-driven surrogates is the acquisition of the training and testing data samples (typically, 4000 samples and beyond 25 , 26 , 27 ). Reducing this number is challenging yet imperative for improving the computational efficiency of the model process. In this work, by using the modelling approach proposed in Sect. “ Low-cost surrogate modeling of unit elements ”. C , an accurate surrogate model of TA unit cell is obtained only using 370 data points, obtained using a linear sampling technique with the step sizes of 6, 3, 15, for ε r , W, H respectively. For the sake of benchmarking, the proposed M2LP modelling approach is compared to the methods commonly used in the context of surrogate modelling of similar microwave antenna designs: (i) Support Vector Regression 19 , 24 , 40 , (ii) Ensemble Learning 41 , and (iii) Generalized Regression Neural Network (GRNN) 42 . The hyper-parameter configuration of the considered methods are presented in Table 2 . Table 3 gathers the modeling error values for all surrogates based on performance results of hold-out data set. Table 2 Hyper-parameter configuration of surrogate models (benchmark and the proposed one). Full size table Table 3 Modeling results and benchmarking. Full size table As it can be seen from the results provided in Table 3 , although all the models exhibit high accuracy in representing | S 21 |, this is mainly due to the linearity and small range of variation of this response. The proposed M2LP regression model ensures a significantly better MAE value of 5.7 for the transmission phase (Fig. 5 ), which is the most important response from the perspective of TA design. At the same time, the benchmark methods exhibit at three to six time’s higher error. Among these, only the Support Vector Regression surrogate is capable of achieving MAE of less than twenty degrees for the transmission phase, whereas the errors of Ensemble Learning and GRNN are as high as 26.8 and 30.4, respectively. In other words, the modeling approach presented here allows us to ensure sufficient performance even when using sparse data sets. Figure 5 The proposed M2LP surrogate versus EM simulation data for ∠ S 21 , using 100 randomly selected data points from the holdout dataset. Full size image At this point, it should be emphasized that although SVRM and other benchmark surrogates have been demonstrated successful in modeling of different microwave components 19 , 24 , 40 , 44 , the results presented above suggest otherwise in the context of transmitarrays. The main reason for this is that performance of SVRM and other benchmark surrogate modeling techniques is contingent upon the variation ranges of the input parameters (which are normally set rather narrow), and the total number of samples (270 + 100) to generate a globally accurate surrogate model 5 , 45 . If the parameter ranges are restricted or the training dataset cardinality is sufficient, such as shown in the case of modelling the modulus of the transmission characteristic, most of surrogate modelling methods will perform well 5 , 45 . However, the objective of this work is to construct design-ready models suitable for TA development using small datasets (only 370 samples). As demonstrated, this goal is beyond the capabilities of popular models such as SVRM and other traditional approaches. In contrast to this, the proposed M2LP-based surrogate ensured the accuracy sufficient for design purposes owing to its state-of-the-art configuration and utilization of modern activation functions inherited from deep learning methods, both improving its handling of the non-linear relationships between inputs and outputs of the problem. The M2LP model will be used in the next section for design optimization of a large-scale transmitarray designs targeting three different operation frequency ranges. Results and experimental validation This section demonstrates the employment of the M2LP unit cell surrogate model discussed in Sect. “ Low-cost surrogate modeling of unit elements ” to develop a large scale transmitarray. The design goals include optimization of all array cells with respect to their geometrical design parameters, H , W and ε r , so as to achieve the required transmission phase and the maximum magnitude characteristics, but ensure a possibly low weight w , as defined by (2). The cost function utilized in the BO-based optimization of M × N transmitarray has been formulated as follows $$ \begin{gathered} E{(}H{, }\varepsilon_{r} {; }f,W{)} = \sum\limits_{i = 1}^{M} {\sum\limits_{j = }^{N} {[C_{1} \left| {\psi_{{{\text{Req}}_{i,j} }} (f) - \psi_{{P_{i,j} }} {(}H{, }\varepsilon_{r} ;f,W{)}} \right|} } \\ C_{2} \left| {1 - |S_{21} |_{{P_{i,j} }} {(}H{,}\varepsilon_{r} ;f,W{)}} \right| + C_{3} w_{i,j} {(}H{, }\varepsilon_{r} ;f,W{)}] \\ \end{gathered} $$ (3) where \(\psi\) Reqi.j is the required transmission phase at the operating frequency f , \(\psi\) Pi,j is the transmission phase predicted by data driven surrogate model. The second term in the Eq. ( 3 ) is to ensure that the unit element achieves maximum transmission magnitude alongside with the requested phase. w i.j is the weight of the unit element calculated according to (2), whereas C 1 and C 2 are the weighting coefficients representing the relative importance of the phase- and weight-related objectives, respectively. Here, we set C 1 = 0.7 and C 2 = 0.3, and C 3 = 10, these values are taken with respect to the variation limits of each aimed criteria to obtain a balanced effect of each term on the cost function. For example, since the numerical values of the transmission phase may be larger than 100, and the weight of the unit element is usually around 2 g, the weighting factors corresponding to these terms are set lower than unity. Whereas, the magnitude of | S 21 | is smaller than one, therefore, its corresponding weighting factor is set at a larger value. In order to demonstrate the design utility of the surrogate model developed in Sect. “ Transmitarrays: simulation-driven design and challenges ”, it is used along with the cost function (3) to design TAs operating at different frequency ranges: (I) 8–14 GHz, (II) 22–28 GHz, (III) 28–36 GHz. Each of these designs consist of 20 × 20 unit elements, whose parameters are optimally selected via BO-assisted data driven surrogate models. For each of the array elements, BO will make a separate search to determine the optimal values of H , W and ε r , so as to obtain the required transmission phase \(\psi\) Req i.j , the latter calculated using (1) 10 , and the transmission magnitude | S 21 |. The aim of surrogate-assisted BO search is to minimize the error function (3). It should be emphasized that in either of reflect or transmit array designs, the average phase error of ± 10 degrees in each element can be taken as an acceptable tolerance level for having designs with high directivity characteristics 46 , 47 . This means that the accuracy of the surrogate model, especially the part representing the transmission phase, plays a critical role. At the same time, using small datasets reduces the computational cost of training data acquisition, thereby improving the efficacy of the design process. If the surrogate model fails to ensure a sufficiently good predictive power, the resulting TA design would suffer considerable gain loss 48 . The specific designs considered in this work are 20 × 20 arrays, aimed to operate at the aforementioned frequency bands. To simplify the optimization process, all TA designs are assumed to be symmetrical in both the x and y axis, so that the array can be divided into 4 parts consists of 10 × 10 elements. Furthermore, each of the quarters can also be considered diagonally symmetrical. Under this assumption, the total number of elements that have to be optimized is 55. Also, ε r of the design is taken constant for all of the unit elements in a range suitable from the point of view of prototyping by means of 3D printers, and the PLA material 49 , 50 . However, it is worth mentioning that if a high-end professional 3D printer is available to designer, it is possible to prototype a non-homogeneous array where each element might have individual infill-rate, consequently allowing each unit cell to have a unique dielectric constant value. However, the prototyping device used in this work only allows a single value of infill rate in the prototyping process. In this work, to unambiguously present the importance of the accuracy of data-driven surrogate models, the TAs were designs using the proposed M2LP-based model, and the best of the benchmark techniques, SVRM. The BO is selected as the optimization search protocol. It should be noted that although the literature offers a plethora of meta-heuristic 51 , 52 or gradient based 53 , 54 optimization algorithms, the particular choice of the algorithm is not critical here because the optimization process is conducted at the level of fast and analytically tractable metamodel. Even massive evaluations thereof would incur negligible computational expenses. Consequently, the performance measures such as speed or the convergence rate of the algorithms to the global optimum are not in studied in this work. The optimization outcome for both surrogates has been presented in Table 4 . The cost value of M2LP models and SVRM are similar thus the overall performance of the obtained models expected to have similar performance characteristics. However, as the accuracy of SVRM is significantly worse than that of the proposed M2LP surrogate, the actual performance of the respective TAs is dramatically different. As shown in Figs. 6 , 7 and 8 (simulated radiation patterns) and Table 5 (gain and side lobe levels), the designs obtained using SVRM exhibit significant performance loss. Given similar cost function value in Table 3 , the sole reasons for this is the huge performance gap between the accuracy of the models (absolute phase error of 5.7 degrees for M2LP versus 17.6 degrees for SVRM). Table 4 Design specifications of M2LP- and SVRM-based TA designs. Full size table Figure 6 Optimized TAs obtained using M2LP and SVRM. EM-simulated realized gain of designs at ( a ) 8 GHz, ( b ) 10 GHz, ( c ) 12 GHz, ( d ) 14 GHz. Note a significantly better performance of the array developed using the proposed M2LP surrogate over the one obtained with the SVRM model. Full size image Figure 7 Optimized TAs obtained using M2LP and SVRM. ( a ) 22 GHz, ( b ) 24 GHz ( c ) 26 GHz, ( d ) 28 GHz. Full size image Figure 8 Optimized TAs obtained using M2LP and SVRM. ( a ) 28 GHz, ( b ) 30 GHz ( c ) 32 GHz, ( d ) 34 GHz, ( e ) 36 GHz. Full size image Table 5 Simulated performance of M2LP- and SVRM-based TA designs. Full size table In Table 6 , computational performance comparison of the proposed surrogate modeling approach and the Forward Electromagnetic (FW-EM)-based model is presented. The total cost of the proposed approach corresponds to 370 unit cell simulations necessary to obtain the training and hold-out points for generating the surrogate model using the FW-EM simulation model (20 s). The optimally-designed TA, which consist of 20 × 20 = 400 elements is obtained by optimizing 55 unit elements (due to the symmetrical placement of the elements) using surrogate-assisted Bayesian Optimization (set to a computational budget of 50 iterations), and an additional single run of FW-EM tool for the entire array implementing the optimized design. Based on the results of Table 6 , it can be stated that the proposed surrogate modeling approach enables a significant acceleration to the design optimization process as compared to the traditional FW-EM optimization approach. More specifically, the proposed method is almost 100 times faster (267 h vs. 2.85 h). It should also be reiterated that from the method presentation perspective, the specific array designs considered here are merely illustration examples. Table 6 Performance comparison of the proposed approach and FW-EM-model-based design in terms of the computational cost of individual simulations and total design process. The simulations have been done using the following simulation setup: AMD Ryzen 7 3700X 8-Core Processor 3.59 GHz, with 32.0 GB of installed RAM, and NVidia 2080 GPU 8 GB. Full size table Poor accuracy of SVRM translates into inferior performance of the EM-simulated TA, both at the level of individual unit cells (surrogate prediction versus EM evaluation), and the entire system. The data in Table 5 indicates that the TA designs generated using the M2LP surrogates exhibit at least 5 dBi higher radiation gain for any of the three considered designs. For further validation of the proposed modelling approach, the TA model aimed for 8–14 GHz operation band has been manufactured, Fig. 9 a, using the RoboxDual by CEL–A Dual Material 3D printer 55 and Polylactic acid (PLA) 1.75 mm 3D printing filament 56 . A 9 kHz-to-13.5 GHz Vector Network Analyzer, and LB-8180-NF broadband 0.8-to-18 GHz horn antenna, available at Yildiz Technical University have been used for the measurement. The size of the prototyped TA is 4λ × 4λ × 1.67λ, size of the Feed antenna is 1.47λ × 1.07λ × 1.84λ, and the distance of the TA and aperture of feeding antenna is 3.87λ (λ = 3 cm for the center frequency of 10 GHz. Gain of the feed antenna is measured as10-14 dBi for the operation band of 8–14 GHz (Fig. 9 b), and the illumination and spillover efficiencies of the design is presented in Fig. 9 c. The simulated/measured radiation patterns of the prototyped TA at 8 GHz, 10 GHz, 12 GHz, and 14 GHz are presented Fig. 10 a–d. As it can be seen from these results, the experimental data is well aligned with the simulations: the difference does not exceed 1 dBi. The aperture efficiency of prototyped design is measured based on Eq. 4 , where A , λ, \(G_{M}\) are the area of prototyped TA, wavelength at observed frequency, and measured gain. $$ \eta = \frac{{\lambda^{2} G_{M} }}{4\pi A} $$ (4) Figure 9 (a) Photograph of the 3D printed arrays optimized using M2LP; (b) Measured gain of the feed antenna; (c) Efficiencies of the TA design. Full size image Figure 10 Experimental validation of the transmitarray [12 × 12 × 5] cm design: ( a )–( d ) measured realized gain [dBi] for: ( a ) 8 GHz, ( b ) 10 GHz ( c ) 12 GHz, ( d ) 14 GHz. Surrogate-predicted and measured data shown using solid and dashed lines, respectively. Full size image Furthermore, in Table 7 , series of counterpart TA designs from literature 57 , 58 , 59 , 60 , 61 , 62 , 63 , 64 , 65 are taken under study to compare the performance of prototyped TA with proposed approach. Performance measures such as operation band, size, maximum gain and aperture efficiency of each designs are taken under investigation. As a results, the proposed design achieves a good overall performance compared to its counterpart design. Here it must be empathized that the performances such as maximum gain of the TA can further improved by simply increasing the distance of the TA design from the aperture of the feed antenna and by increasing the total number of element, i.e., enlarging the design or by including other design considerations to the model such as diffraction, local periodicity assumption which here might be effected by the height difference between two neighbors, coupling effects of neighboring unit elements etc. which can affect the radiation performance of the design. On the other hand, it should be reiterated that the main purpose of the work was to introduce a surrogate modeling technique capable of providing low-cost models suitable for rapid EM-driven design optimization of transmitarray antenna designs, rather than to propose a new design of a high-performance TA. From this perspective, the specific array design is merely an illustration example. Yet, as it can be seen form the results the obtained measured results suggested that the proposed approach even with its limitations on modeling side and conflicting optimization goal of design must have lowest possible weight which would reduce the fitting (difference between desired transmission phase/ magnitude and the elements response) between optimal transmission phase and magnitude that directly effects the radiation performance, the overall performance of the design is compatible and even superior to series of counterpart design in literature (cf. Table 7 ). Table 7 Table of comparison for different TA deigns. Full size table To further illustrate the proposed methodology and its performance, a series of additional analyses are presented. First, the performance of the 3D printable antenna design is compared to a dielectric lens antenna. In Fig. 11 a–d, the 3D models and simulated results of two dielectric antenna designs are presented to serve as a benchmark for the design studied in this work (Fig. 11 c). For fair comparison, all considered designs are developed to feature similar sizes and configuration to the proposed TA. As it can be seen form the simulated maximum gain data, the proposed TA does not only exhibit higher gain but also its overall weight is significantly lower than that of the benchmark designs. The only disadvantage of the proposed TA design is the design complexity due to the unit cell and high number of design variables which, has been effectively addressed by the proposed methodology (specifically developed to handle design-related issues). Figure 11 3D views of ( a ) a simple single-layer antenna, ( b ) multi-layer dielectric lens antenna; ( c ) 3D printed TA design designed using the proposed methodology, ( d ) simulated maximum gain over the frequency band. Full size image As it mentioned before the first TA unit example was selected to illustrate the presented concepts and workflows using simple test case, so that the challenges pertinent to the examples themselves do not make demonstration of the concepts unclear. At this stage in order to clearly demonstrate applicability of the proposed methodology to different types of unit elements two additional example is presented, whereas these examples provide more challenging design cases that can only be solved via EM simulations and AI techniques (Figs. 12 and 13 ). The first design (Fig. 12 a) is based on a recently reported work that aimed to create a high performance TA design with meta-material design and FW-EM simulation approach 66 . This will be referred to as Model 2 throughout the rest of the paper. Figure 12 a shows the architecture of Model 2. To achieve high directivity, 10 layers of identical unit cells (Fig. 12 b) are taken as the unit element for surrogate modelling purposes. Rogers’s 4350 substrate of the height of 0.42 mm is employed to implement the design. The variables of the Model 2 are R (the diameter of the square ring with the range of 1.4–2.4 mm) and w (the width of the ring with the range of 0.2–0.8 mm). Each data sample is a vector of the size 1 × 41 representing the evaluation of the unit cell within the frequency band of 8–14 GHz, which is uniformly distributed with step size of 0.1 GHz. The sampling step size of 0.05 mm is applied for each geometry parameters, leading to the total of 373 samples generated for training, and 100 randomly generated sample points for the hold-out of the M2LP surrogate. MAE values for Model 2 are found as 0.014 and 4.8 for |S 21 | and ∠ S 21 respectively. With deployment of the M2LP unit cell surrogate model of Model 2 TA alongside of BO based optimization with a similar cost in Eq. ( 3 ) but without third term of weighting the TA design in Fig. 12 c is obtained. The simulated radiation characteristics of the model for 8 GHz, 10 GHz, and 14 GHz are found as 20.7 [dBi], 22.6 [dBi], 23.1 [dBi] respectively and depicted in Fig. 12 d–f. Here, it is worth mentioning that as opposed to 66 , the unit elements in each layer are taken as identical elements, which limits the performance of the TA design at a certain level. However, for a unit element consisting of ten layers, individualizing geometry parameters for each of them makes the modeling problem extremely challenging, addressing of which is outside the scope of this paper. Thus, for illustration of the proposed surrogate modeling approach the unit elements are taken as identical at all layers. Yet, even with identical unit cell the Model 2 TA achieves high performance, which can be furthered improved. One of the objectives of the future work is to consider a decomposition-based method for computationally efficient surrogate modeling of multi-layer TA design with distinctive unit cell in each layer. Figure 12 Schematic view of Model 2 unit cell, ( b ) 10 layers of identical unit cell of Model 2; ( c ) optimized Model 2 TAs obtained using M2LP: EM-simulated realized gain of designs at ( d ) 8 GHz, ( e ) 10 GHz, (f) 14 GHz. Full size image Figure 13 Schematic view of Model 3 unit cell, ( b ) optimized Model 3 TAs obtained using M2LP: EM-simulated realized gain of designs at ( c ) 10 GHz, ( d ) 12 GHz, ( e ) 14 GHz. Full size image The last example, shown in Fig. 13 a, is based on a metallic Minkowski fractal design, and a dielectric substrate material 67 . This model will be referred to as Model 3 throughout the rest of the paper. Figure 13 a shows the parameterized architecture of the unit cell. The variables are H (the height of the dielectric substrate with the range of 1.0–10.0 mm), ε (the dielectric constant of the substrate with the range of 1.2 to 2.7), w (the width of the Minkowski fractal with the range of 3.0–14.0 mm), L (the length of the Minkowski fractal inner part equal to w × α where the range of α is 0.1–0.9), and t (the thickness of the metallic surface that varies between the range of 0.035 to 0.5 mm). Each data sample is a vector of the size 1 × 41 representing the evaluation of the unit cell within the frequency band of 10–14 GHz, which is uniformly distributed with step size of 0.1 GHz. The Latin Hypercube Sampling technique is applied to generate the dataset, leading to the total of 800 samples used for training, and 100 randomly generated sample points for the hold-out of the M2LP surrogate. MAE values for Model 3 are found as 0.021 and 5.6 for |S 21 | and ∠ S 21 , respectively. Similarly to the first and second designs, the same approach is employed for this unit element to create the TA design shown in Fig. 13 b. The simulated radiation characteristics of the TA obtained for 10 GHz, 12 GHz, and 14 GHz are shown in Fig. 13 c and e, respectively. The corresponding gain values are 19.4 [dBi], 21.6 [dBi], 23.4 [dBi], respectively. It should be reiterated that—as opposed to the first and second unit elements—Model 3 is considerably more involved of higher dimensionality and complexity. Consequently, it cannot be handled using traditional analytical or FW-EM approach modeling. On the other hand, behavioral modeling as presented in this work, offers a practical way of handling the structure and conducting the complete TA design. At the same time, this example corroborated applicability of the proposed methodology to handle more complex cases, including unit elements described by a larger number of geometry parameters. One of the objectives of the future work is to create a surrogate model within higher dimensionality parameter space not only to handle more complex geometrical designs but also to allow utilization of different unit element architectures (e.g., 1: Minkowski fractal, 2: simple square, 3: elliptical shapes, 4: rings, etc.) within the same array. In other words, rather than using a single unit cell architecture within the TA, a variety of structures selected from a pre-defined unit cell library would be employed, all described by the (compound) surrogate model. An additional input variable corresponding to the type of the unit cell structure would be used to make a selection of the unit cell architecture. This would allow to replace a specific unit element by its more suitable counterparts in case if certain transmission phase (or other) requirements cannot be met. Conclusion This paper introduced a novel technique for rapid optimization of transmitarray (TA) designs using low-cost and accurate surrogate models. The proposed methodology capitalizes on a neural-network-based metamodel of flexible architecture, developed to represent the magnitude and phase of the transmission response of the unit elements being the building blocks of the TA. The particular structure of the model, including the arrangement of layers, the number of neurons, hyper-parameters, etc., is automatically adjusted through Bayesian optimization. The model is shown to exhibit competitive performance with transmission phase error not exceeding five degrees, while being established using less than three hundred training data samples. Meanwhile, the predictive power of the benchmark technique, including the most popular SVRM surrogate, is three to six time worse. At the same time, the model covers a very broad frequency range from 1 to 40 GHz, which makes it suitable for the design of TAs operating in a variety of frequency bands within this spectrum. For illustration purposes, three transmitarray designs are generated using the same model, and demonstrated to exhibit satisfactory performance. For the sake of comparison, the arrays obtained using the SVRM model shown inferior performance both in terms of the radiation gain and the side lobe levels. A selected design is manufactured and experimentally validated to corroborate design utility of the presented technique. The approach proposed in this work may be considered a viable alternative to existing techniques when it comes to cost-efficient and reliable design of large transmitarrays. Here it worth mentioning that, additional parameters such as diffraction or coupling effects of neighbouring unit elements are not taken into consideration in this work. If these parameters were also taken into the study the overall performance of the model might be enhanced. Nonetheless, authors aims to add these effects to their modeling approach in their future work for modeling of TAs/lenses/Reflectarray designs.