Introduction In computed tomography (CT) research and clinical practice, anthropomorphic and geometric phantoms play a crucial role. Highly accurate, customizable, and realistic phantoms are particularly valuable for a variety of purposes, including maintenance, optimization, and development of software and hardware components of scanners. In recent years, there have been significant advancements in three-dimensional (3D) printing technology, resulting in numerous studies on 3D-printed patient-based phantoms for medical imaging 1 , 2 , 3 , 4 , 5 . Compared to conventional phantoms, 3D-printed phantoms are highly accessible, customizable, and cost-effective. For example, inexpensive and widely available fused deposition modeling (FDM) printers can create high-quality anthropomorphic phantoms that accurately depict human anatomy at reasonable costs. Conventional 3D printing techniques prioritize the replication of object and organ shapes. Typically, these approaches include segmenting organs of interest from CT scans according to their specific densities, converting the results into surface meshes (STL files), 3D-printing each object separately, and then assembling them into a complete phantom 3 , 4 , 6 , 7 . However, each 3D-printed component has a uniform Hounsfield unit (HU), resulting in phantoms with lacking realistic image textures because their HUs cannot be modulated pixel-by-pixel 8 , 9 , 10 , 11 . Furthermore, the lack of natural transitions between different regions, e.g., organs, leads to loss of detail. A promising alternative is to directly translate digital imaging and communications in medicine (DICOM) image data into G-code. G-code is a Computer Numerical Control (CNC) programming language. G-code instructions tell the printer to move in specific directions and at specific speeds to produce a specific shape or object. One means of controlling the density (as required for CT phantoms) is to vary the filament extrusion rate (per unit time) on a pixel-by-pixel basis while maintaining a constant printing speed. A similar approach was used by Okkalidis et al. 12 , 13 , 14 , 15 , 16 , 17 . in conjunction with edge detection and morphological operations to enhance and separate organs. Such processes still yield segmentation errors and loss of small features. Altering the line width by varying the extrusion rate alone does not provide sufficient spatial resolution due to the inherently slow response time of the extrusion process. Our group recently developed PixelPrint 18 , a methodology that combines a software tool as well as a standard FDM printer to create phantoms 19 , 20 , 21 , 22 , 23 . In PixelPrint, DICOM images of the original patient are directly converted into G-code on a pixel-by-pixel basis. In order to emulate attenuation at each voxel, density is modeled as a ratio of filament to voxel volume, generating partial volume effects. The filament ratio is continuously modified by varying the printing speed. Polylactic acid (PLA), a common printing filament, allows a print range approximately from − 850 to 200 HU at different filament ratios, and has been used to print various patient-based lung phantoms 19 . In parallel, significant progress has been made in developing filament materials suitable for FDM printing in medical applications. Several studies have explored and compared different types of filament materials for printing human soft tissue and bones 24 , 25 , 26 , 27 . Conventional materials, such as PLA and acrylonitrile butadiene styrene (ABS), are widely available and easy to print with. They have densities ranging from 0.8 to 1.2 g/ml and can represent various human soft tissues for CT or X-ray examinations. Special materials, such as thermoplastic polyurethanes (TPU), can provide distinct physical properties to the print, i.e. durability, strength, and elasticity. Specifically for bone, materials tailored for clinical applications have been introduced for 3D-printed implants. They are biodegradable by the patient’s osteoclasts. As a result, printed objects with such materials can be fused with the patient’s bone, through remodeling during the osteo-cycle 28 , 29 , 30 . Additionally, denser PLA filament mixed with gravimetric powdered stone (PLA/Stone) has become commercially available. In previous studies, this type of filament has been utilized for printing phantoms for both diagnostic imaging and radiation therapy 8 , 14 , 31 , 32 , 33 , 34 , 35 . For printing even higher density objects, commercially available filament materials mixed with micro metal powders, i.e. iron or copper, have also been utilized in phantom studies 6 . Recent studies have shown various approaches of printing bone and soft tissue separately 6 , 14 , or later assembled together to form a complete phantom 31 , 33 , 36 . Printing a high-resolution bone specimen with adjacent soft tissue directly and realistically connected to each other remains a challenge, partly because it covers a wide range of different densities. This study builds upon various aspects of the previously published PixelPrint technique, encompassing filament line spacing and print speed. Additionally, the incorporation of calcium-doped PLA filament extended the density range of our phantoms, facilitating the reproduction of bony structures. Our findings demonstrate the capacity of the PixelPrint technique to fabricate lifelike phantoms mimicking the human spine and knee joint, complete with adjacent soft tissue. The resultant phantoms not only accurately replicate geometry, visual image texture, and attenuation but also manifest analogous spectral attenuation profiles. Materials and methods PixelPrint and 3D printing The previously published PixelPrint algorithm was used to create G-code from CT image data to produce 3D-printed phantoms 18 . Briefly, density information was extracted from the clinical patient images to generate filament lines that varied in width according to the HU of individual pixels. These lines were uniformly spaced within each layer and perpendicular on adjacent layers. By adjusting the filament line widths pixel-by-pixel, volumetric filament per unit space, or infill ratio, was varied despite only using one type of filament. These different infill ratios then produced different attenuation in CT images due to the partial volume effect. In this study, the filament lines were equally spaced at 0.5 mm. The width of the filament line changed at resolution of 0.167 mm. The minimum and maximum line widths were 0.2 and 0.5 mm, corresponding to the infill ratio ranging between 40 and 100%, respectively. Keeping a constant extrusion rate, the print head traveled at varying speeds based on the width of the extruded filament line. The slowest speed was 180 mm/min for the widest width of 0.5 mm, while the fastest was 450 mm/min for the smallest width of 0.2 mm. Each layer had a uniform height of 0.2 mm. The resulting volumetric rate of filament extrusion during the whole print remained constant at 18 mm 3 /min. To prevent overlapping of lines in consecutive layers with the same filament line direction, an offset of 0.167 mm (1/3 of the 0.5 mm line spacing) was introduced. All phantoms were printed with Lulzbot TAZ 6 or Sidekick 747 (Fargo Additive Manufacturing Equipment 3D, LLC Fargo, ND, USA), paired with M175 v2 tool heads and 0.40 mm steel nozzles. Calcium-doped PLA filament (StoneFil, FormFutura, AM Nijmegen, the Netherlands) with a diameter 1.75 mm was utilized. This PLA-based filament is filled with powdered stone. Further details can be found on: https://formfutura.com/product/stonefil/ . The temperature of the nozzle was set at 200 °C and the bed was warmed to 50 °C to enhance adherence. Acceleration of the print head was to 500 mm/s 2 and the threshold (jerk setting) was 8 mm/s. Phantom design Micro-CT phantom Three cylindrical phantoms were designed and produced using PixelPrint filament lines to examine their stability and reproducibility. These filament lines constructed a matrix smaller than the typical resolution limit of clinical CT scanners. Three phantoms were printed with identical G-code instructions. These phantoms are 60 mm in length and 20 mm in diameter. Each of them consists of four sections with different but homogeneous infill ratios (100%, 70%, 50% and 30%). Calcium-doped PLA filament lines were printed at a spacing of 1 mm in all four sections but with corresponding line widths of 1.0, 0.7, 0.5, and 0.3 mm, respectively. A thin outer layer was added to the phantom for support, particularly for low infill ratio sections. Calibration phantom To compute the conversion between calcium-doped PLA filament infill ratios and HUs, a calibration phantom was designed. The phantom is a cylinder with a diameter of 10 cm and height of 1 cm. It consists of seven equally divided pie slice-shaped sections. Each section was printed at a fixed line spacing of 0.5 mm but with different filament line widths (0.2–0.5 mm), corresponding to seven infill ratios (40 -100%, with 10% intervals). Cervical vertebrae phantom Due to the retrospective nature of the study, the Institutional Review Board of University of Pennsylvania waived the need of obtaining informed consent. A cervical vertebrae phantom was created based on a patient image volume (10 × 10 × 10 cm 3 ) that was acquired on a clinical CT scanner (Siemens SOMATOM Definition Edge, Siemens Healthcare GmbH, Erlangen, Germany) at a tube voltage of 120 kVp with a standard diagnostic protocol. Table 1 lists detailed acquisition and reconstruction parameters for the patient scan. The patient data consist of four cervical vertebrae (C4 to C7), including the trachea and esophagus. A circular region of interest with a diameter of 10 cm was cropped in axial slices to form the phantom. HUs were converted to infill ratios based on the calibration phantom. Table 1 Acquisition parameters of CT image for phantom generation. Full size table Knee phantom A knee phantom was similarly generated using a patient scan on a clinical dual-layer CT scanner (IQon spectral CT, Philips Healthcare, the Netherlands) at a tube voltage of 120 kVp, as detailed in Table 1 . A circular region of interest with a diameter of 10 cm was cropped from the axial slices of the patient's left knee. HUs were then converted to infill ratios. It's important to note that all image data used in this study were collected retrospectively and anonymized. The imaging procedures were conducted as part of routine clinical practice. The parameter selections outlined in Table 1 were guided by the imaging protocols established within the department. The experimental protocol was approved by the institutional committee in University of Pennsylvania. All methods were performed in accordance with relevant guidelines and regulations. Data acquisition Three micro-CT phantoms were separately scanned on a commercial micro-CT (U-CT system, MILabs, CD Houten, the Netherlands) with a tube voltage of 50 kVp. In addition, these phantoms were also scanned on a clinical dual-layer CT system (IQon spectral CT, Philips Healthcare, the Netherlands) at a tube voltage of 120 kVp with a high-resolution protocol and a small field-of-view of 100 mm. Additional acquisition and reconstruction parameters of the two scans are listed in Table 2 . The micro-CT scanning protocol adheres to the guidelines provided by the manufacturer for imaging objects characterized by these dimensions and feature scales. Micro-CT images were exported from the scanner and reprocessed with a multi-planar reconstruction algorithm (MPR) in an imaging post-processing software (Horos Project, Annapolis, MD, USA) to ensure filament lines were parallel to the axial plane. Table 2 Scan protocols for the micro-CT phantom. Full size table The calibration, cervical vertebrae, and the knee phantom were scanned inside the QRM chest phantom (Quality Assurance in Radiology and Medicine GmbH, Möhrendorf, Germany) with the clinical dual-layer CT system. The protocol parameters matched those of the original clinical examination of the patient, maintaining the same pixel spacing and slice thickness as indicated in Table 1 . In the case of the cervical phantom, a 400 mg/ml QRM hydroxyapatite (HA) insert was also scanned along with the phantom to serve as a reference for bone mineral density. For both patient-based phantoms, additional high-dose scans were conducted using 1000 mAs while retaining the other scanning parameters unchanged. These high-exposure scans were included to reduce noise and facilitate comparisons of image quality. Calibration and data analysis For computing the conversion between HUs and infill ratios, mean and standard deviation HU values of seven areas were measured in the calibration phantom. Square regions of interest (ROI) of 19 × 19 pixel 2 (13 × 13 mm 2 ) were manually placed in each of the seven density regions within 10-mm-thick center of the phantom. A linear regression was computed, and the resulting Pearson’s correlation coefficient (r) was reported. All measurements were performed on a workstation with ImageJ (U. S. National Institutes of Health, https://imagej.nih.gov ), and all analyses were computed with Python (Python Software Foundation, https://www.python.org/ ). For the cervical vertebrae phantom and the knee phantom, CT images were exported from the scanner and registered to the original patient data (2D-wise) using the OpenCV Library (Open Source Computer Vision Library 37 , https://opencv.org ). Mean and standard deviation in regions of interest for different tissue types were measured. Line profiles of the phantom scan were also compared with the original patient scan. Additionally, virtual monoenergetic images from 40 to 200 keV were extracted to quantify the spectral response of the bone regions within the patient-based phantoms. Results The high reproducibility of PixelPrint was demonstrated by comparing three identically manufactured phantoms (Fig. 1 ). In micro-CT scans of the phantoms, the grid-like structures generated by PixelPrint were clearly visible. Filament lines printed within each region had equal spacings of 1 mm (standard deviation ± 0.008 mm) and a constant width (errors ± 0.022 mm) in the micro-CT scans, see Supplemental Fig. 1 . The layered structure with introduced offsets (1/3 of 1 mm line spacing) was distinctly visible in orthogonal views (Fig. 1 f,g,h, Supplemental Fig. 2 ). However, in clinical CT scans with high resolution protocols, these structures were imperceptible because their size was smaller than the detector resolution. Instead, they appeared as constant regions due to partial volume effect (Fig. 1 e,i). Furthermore, both the micro-CT and clinical CT scans showed a high linear relationship between infill ratios and mean HUs in four regions (Pearson’s correlation coefficient r = 0.984 and 0.982, respectively). Figure 1 Micro-CT phantoms. ( a ) A photo of one of the three printed micro-CT phantoms. ( b – d ) Orthogonal views of the three different micro-CT phantoms scanned on a micro-CT. ( e ) Clinical CT image of one of the micro-CT phantoms. ( f – i ) Zoomed views of the regions enclosed by blue squares in ( b – e ). Window level/width are − 750/3500 HU for micro-CT images and 0/2000 HU for clinical CT images. Full size image In the calibration phantom, the infill ratio and HU also demonstrated excellent linearity across the seven regions (Fig. 2 ). The highest infill ratio (100%) region measured 851 ± 24.7 HU, while the lowest infill ratio (40%) measured -227 ± 25.4 HU. Pearson’s correlation coefficient of greater than 0.99 indicated a very high positive linear correlation between infill ratios and HUs. A conversion equation was computed for converting HU to infill ratio: $$5.5258{\text{ x }}10^{ - 4} \, \times { }\,{\text{HU }}\, + \,{ }0.52797\, = \,{\text{Infill }}\,\,{\text{Ratio}}\,{(}\% )$$ Figure 2 Linear correlation of filament infill ratio and HUs. ( a ) CT image of calibration phantom. Window level and width are 0 HU and 2000 HU. ( b ) Linear relationship between attenuation and infill ratio. Mean and standard deviation were measured in regions of interest in each area with a distinct infill ratio. Standard deviations are indicated with error bars. Full size image In Fig. 3 , the CT images of the cervical vertebrae phantom are illustrated, while Fig. 4 presents a visual representation of the knee phantom. PixelPrint phantoms demonstrate remarkable visual fidelity to the original CT images, adeptly preserving the intricate anatomical structures and internal details of the bones. Notably, the high-dose knee phantom scan faithfully replicates the visual attributes of the original patient image. The patient CT-to-phantom pipeline is susceptible to various degradations that limit the quality of the printed phantom. In particular, the 3D printer itself has an intrinsic print resolution. This effect is noticeable in the presented results where the CT scan of the print has slightly reduced spatial resolution as compared with the original CT. Figure 3 Comparison between patient CT images and the PixelPrint cervical phantom images. Images in the first row ( a – d ) are original DICOM images used to create the PixelPrint cervical phantom. Images on the second row ( e – h ) are the CT images of the phantom. All images have window level of 0 HU and width of 1200 HU. Sagittal and coronal images are not registered but are approximately at the same location. Full size image Figure 4 Comparison between patient image and the PixelPrint knee phantom. Images in the first column are original DICOM images used to create the PixelPrint knee phantom. Images on the second to fourth column are the CT images of the phantom: ( b / f ) high dose sharp kernel. ( c / g ) high dose standard kernel. ( d / h ) standard dose sharp kernel. All images have window level of 0 HU and width of 1200 HU. Images are not registered but are approximately at the same location. Full size image Patient phantoms demonstrated high accuracy. Line profiles revealed correspondence in HUs between the CT image of the cervical vertebrae phantom and the actual patient data (see Fig. 5 ). Quantitative measurements in selected regions of trabecular and cortical bones, as well as adipose- and muscle-like soft tissues, are provided in Table 3 . Measurements indicated that, except for the cortical bone, all other regions had differences of less than 15 HU compared to the patient image. The size of the error is comparable to that of commercial phantoms. For bone inserts, a vendor-specific tolerance of about ± 20 HU at 120 kVp is reported. Due to the density limitations of the utilized filament, HUs for the cortical bone (region 3 in Fig. 6 ) were lower than expected. Figure 5 Line profiles of the PixelPrint phantom and the patient CT images. Images on the left show the CT images of the phantom (upper) and the patient images (lower). Red and blue lines indicate the location used to measure the line profile plot on the right. Window level and width are 0 HU and 2000 HU. Images were assumed to be at the same location and registered 2D-wise. Full size image Table 3 Measured Hounsfield units for different tissue types in patient and phantom. Full size table Figure 6 Virtual monoenergetic HU measured with spectral CT. Regions of interest (ROI) are marked in left. Window level and width are 100 and 800 HU. Reference values from a 400 mg/ml hydroxyapatite (HA) insert are marked by dark blue squares. Full size image Comparable spectral characteristics of the phantom to those of human bone were observed. Figure 6 depicts the spectral attenuation profile of various regions of interest (marked in the left panel) and a commercial 400 mg/ml hydroxyapatite (HA) insert (displayed in dark blue squares in right panel). The attenuation values from different bone regions exhibit visual similarity in shape with the commercial HA 400 mg/ml inserts. After scaling the attenuation curves with a HA 400 mg/ml insert, the root mean square errors (RMSE) are 3.3, 17.7, and 28.3 HU for regions 1, 2, and 3, respectively. It is noteworthy that the phantom was fabricated using only one type of filament, and thus, the background, which represents soft tissue, has artificial amounts of calcium. Discussion This study illustrates the application of PixelPrint in the fabrication of patient-specific 3D printed bone and soft tissue CT phantoms, utilizing a single filament. Our methodology offers a cost-effective and streamlined approach for generating lifelike CT phantoms. These phantoms exhibit high accuracy in terms of HU and visual CT image texture characteristics. Consequently, they serve as valuable tools for diverse academic investigations and the clinical assessment of CT performance. In contrast to prior studies of image-based 3D printed bone phantoms using slices of the human head/skull 13 , chest/thoracic cage 15 , pelvis 14 and femoral shaft 6 , this study printed the human cervical vertebrae with surrounding soft tissue. Human vertebrae particularly present a challenging task for 3D printing, as they contain intricate details and are comparatively smaller in size. Nevertheless, these areas, especially in combination with the adjacent soft tissues, are not only fundamental in clinical diagnostic applications, such as the assessment of severe fractures or degenerative diseases, but also crucial in surgical interventional planning. Our phantoms possess the potential to be utilized for those applications, such as optimizing CT protocols for the assessment of bone mineral density 38 among others. In this study, we focused on fabricating phantoms of human cervical vertebrae and knee joints. However, it's important to note that our methodology can be readily expanded to replicate other bone structures as well. By utilizing a calcium-doped PLA filament, we achieved a CT density range of approximately -227 HU to 851 HU when subjected to CT scans with a tube voltage of 120 kVp. Our approach, implemented through PixelPrint, consistently yielded results with a deviation of less than 15 HU when compared to actual patient data. As this density range effectively covers the majority of tissue types present in the human body, it is a versatile solution suitable for a wide range of research purposes. Continuing our previously published research on the PixelPrint lung phantom 18 , 19 , this study not only extended the types of human tissue printed, but also enhanced the printing resolution and stability of PixelPrint. Filament line spacing was reduced from 1.0 to 0.5 mm, compared to our previous work, potentially doubling the resolution capabilities of the printed phantoms. Phantoms produced using this approach can have greater filament coverage and finer details in a given area, serving as valuable tools to evaluate the efficacy of novel higher resolution CT systems such as photon-counting CT 39 , 40 , 41 . Printing finer lines with PLA/Stone filament poses more challenges to printer stability control and requires finer system tuning. By optimizing extrusion rate, printing speed, nozzle temperature, and acceleration speed, PixelPrint can still produce highly accurate patient phantoms in reliable stability as demonstrated by qualitative and quantitative evaluation. Additionally, micro-CT acquisitions revealed that filament lines and underlying structure can be generated with high degree of consistency. With the growing popularity and accessibility of 3D printing technology, a variety of printing filaments are now available for printing human bone and soft tissue. Several studies have discussed materials for 3D-printed phantoms in CT 24 , 25 , 26 . Novel filament materials composed of hydroxyapatite and biocompatible, biodegradable polymers, such as CT-Bone (Xilloc Medical Int., Sittard-Geleen, the Netherlands), can be utilized for printing synthetic bone implants that rapidly induce bone regeneration and growth 42 , 43 . Filaments made from composites of fatty acids and ceramic powders have also been explored 28 . However, bone-like filaments available in the general market (FibreTuff, Toledo, OH, USA), suitable for medical surgery purposes 29 , 30 , do not necessarily have high radiometric densities and are not capable to reach much higher than 400 HU in CT scans. While cancellous bone is about 300 to 400 HU in CT images, cortical bone can range from 500 HU and up to over 1900 HU 44 . By contrast, materials such as vinyl and calcium-doped PLA can offer up to nearly 1000 HU at 96.9% infill ratio at tube voltage of 120 kVp. Additionally, considering materials for spectral CT phantoms, high impact polystyrene (HIPS) based filaments may be suitable for mimicking CT numbers in applications where energy dependence is important 26 , because they show similar spectral profiles as the human body. In this study, we employed StoneFil filament, one type of calcium-doped PLA. Unlike normal PLA, StoneFil filament is gravimetrically filled with 50% powdered stones, resulting in significantly higher material density and enabling denser printed objects. Carbonate calcium-containing limestones exhibit a CT (computed tomography) X-ray response similar to that of human bones, which derive their density from hydroxyapatite. This characteristic was evident in the spectral response of the printed vertebrae, as it closely resembled that of hydroxyapatite. This study has a few limitations: (i) The filament used in our study did not encompass the entire range of HU required for bone structures. This may limit some of the applications of the phantom, such as cortical bone related evaluations in CT. Future research should focus on the development of next-generation filaments that cover the full HU range while preserving spectral capabilities. (ii) The calcium-based material used in the printing process was applied to the entire print, including soft tissue regions. For current applications in conventional CT as well as spectral CT this does not appear to be a major drawback since: Firstly, the attenuation profile of the phantom closely matches that of actual patients at 120 kVp. Secondly, for spectral imaging, the calcium content within the soft tissue remains below the detection threshold of clinical spectral CT, thereby ensuring the integrity of the results. Please note that the filament used is not pure calcium; rather, it's a calcium-doped PLA (polylactic acid). Future efforts will concentrate on exploring the possibilities of a dual-filament approach, incorporating multiple materials for potential advancements. (iii) The phantoms presented in this work have a diameter of 10 cm. This size was chosen for convenience to ensure compatibility with an existing standard CT phantom for imaging purposes. From the software perspective, there are no technical limitations in field of view for PixelPrint. FDM printers with build plates of 50 cm or more do exist and can be utilized in combination with PixelPrint. (iv) The CT-to-phantom pipeline is vulnerable to multiple factors that degrade the quality of the produced phantom. Notably, the intrinsic print resolution of the 3D printer plays a significant role in this process. This phenomenon has been evident in our findings, wherein the CT scan of the printed object exhibits a slightly diminished spatial resolution when compared to the initial CT scan. To be more precise, a transfer function exists between the input CT data and the resulting phantom, influencing both resolution and noise characteristics in the final 3D print. In forthcoming research, we intend to formulate approaches aimed at alleviating the impact of this transfer function during the printing process. (v) The phantoms in this study are derived from CT acquisitions conducted at a tube voltage of 120 kVp. Due to the use of a single filament in the printing of the phantom, there may exist non-linear transformations when adapting to different tube voltages. Employing a multi-material printing approach would be beneficial in mitigating the impact of this constraint. Conclusion Our study has successfully demonstrated the feasibility of utilizing PixelPrint and calcium-doped PLA filament for 3D printing patient-specific bone phantoms, complete with surrounding soft tissue, suitable for application in clinical CT scenarios. Despite the limitations outlined above, PixelPrint phantoms have the potential to aid in the development and evaluation of CT technology. However, further research is essential to develop phantoms that are more versatile and suitable for both conventional and spectral CT imaging. The potential integration of these phantoms into spectral CT holds promise for significant advancements in academic research, technological innovation, and clinical practice.